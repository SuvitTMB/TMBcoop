<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Table Compact styling */
        .table-compact thead tr { height: 50px; }
        .table-compact tbody tr { height: 45px; font-size: 0.95rem; }
        .table-compact tbody tr:nth-child(even) { background-color: #f8fafc; }
        .table-compact td, .table-compact th { vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem; }

        /* Specific height for live results table (40px) */
        .table-results tbody tr { height: 40px !important; }
        .table-results tbody td { 
            height: 40px !important; 
            padding-top: 0 !important; 
            padding-bottom: 0 !important; 
            font-size: 0.85rem; 
            line-height: 1.2;
        }

        .sortable-header { cursor: pointer; user-select: none; transition: background 0.2s; }
        .sortable-header:hover { background-color: rgba(0,0,0,0.05); }

        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-[100] flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="play-circle" width="20"></i> ระบบสุ่มรางวัล
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('dividend-info')" id="nav-dividend-info" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                <i data-lucide="badge-dollar-sign" width="20"></i> ข้อมูลเงินปันผล
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                    <i data-lucide="qr-code" width="20"></i> QR Code ลงทะเบียน
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                    <i data-lucide="qr-code" width="20"></i> QR Code เช็คปันผล
                </button>
            </div>

            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">System Info</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                    <i data-lucide="database" width="20"></i> Upload ข้อมูลสมาชิก
                </button>
                <button onclick="window.app.switchTab('dividend')" id="nav-dividend" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm text-left">
                    <i data-lucide="wallet" width="20"></i> Upload ข้อมูลปันผล
                </button>
            </div>

            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">ลิงก์ภายนอก</p>
                <a href="coop-random.html" target="_blank" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="external-link" width="20"></i> ลิงก์ระบบสุ่ม
                </a>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวม (Dashboard)</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">A</div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-slate-600"><i data-lucide="database" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">จำนวนสมาชิกทั้งหมด</p>
                        <h3 id="dash-stat-total" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-blue-600"><i data-lucide="users" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเข้า</p>
                        <h3 id="dash-stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-emerald-600"><i data-lucide="check-square" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">สมาชิกรับบัตรเลือกตั้ง</p>
                        <h3 id="dash-stat-voting" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-indigo-600"><i data-lucide="log-in" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเงินปันผล</p>
                        <h3 id="dash-stat-div-reg" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-green-600"><i data-lucide="user-check" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ยืนยันเข้าร่วมประชุม</p>
                        <h3 id="dash-stat-div-join" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียน (Real-time)</h3>
                            <div class="h-64"><canvas id="registrationChart"></canvas></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full"> 
                        <h3 class="font-bold text-lg mb-4 text-slate-700">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1 max-h-[400px]">
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZES -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 h-fit">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2"><i data-lucide="plus-circle" class="text-indigo-600"></i> เพิ่มของรางวัล</h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-indigo-100 outline-none text-sm">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">สุ่มต่อรอบ</label>
                                    <input type="number" id="prize-qty" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">รวมทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition text-sm">บันทึกของรางวัล</button>
                        </form>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg mb-4 text-slate-800">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left table-compact">
                                <thead class="bg-slate-200 font-bold">
                                    <tr>
                                        <th class="px-4 py-3">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">สุ่ม/รอบ</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-blue-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-indigo-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้มีสิทธิ์ลุ้นรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-slate-400">
                        <p class="text-slate-600 text-xs font-bold uppercase">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-red-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มไม่ได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-no" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-green-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-win" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    <div class="lg:col-span-4 bg-white p-6 rounded-2xl shadow-md border">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-slate-800"><i data-lucide="settings-2"></i> ตั้งค่าการสุ่ม</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">เลือกของรางวัล</label>
                                <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border rounded-xl outline-none bg-white text-sm">
                                    <option value="">-- เลือกของรางวัล --</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">จำนวนสุ่มต่อรอบ (คน)</label>
                                <input type="number" id="input-draw-qty" value="1" min="1" max="100" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border rounded-xl text-center text-lg font-bold outline-none text-sm">
                                <p id="qty-warning" class="text-xs text-red-500 mt-1 hidden font-bold">สุ่มเกินสต็อกคงเหลือ!</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-xl border space-y-2">
                                <div class="flex justify-between text-sm"><span class="text-slate-500">คงเหลือในสต็อก</span><span id="label-stock-count" class="font-bold text-orange-600">0</span></div>
                                <div class="flex justify-between text-sm"><span class="text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span><span id="label-eligible-count" class="font-bold text-indigo-600">0</span></div>
                            </div>
                            <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-40 active:scale-95 transition-all flex items-center justify-center gap-2 text-sm">
                                <i data-lucide="play" width="24" class="fill-current"></i> เริ่มการสุ่มรางวัล
                            </button>
                        </div>
                    </div>
                    <div class="lg:col-span-8 bg-slate-900 rounded-3xl h-[600px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700">
                        <div class="text-center mb-6 relative z-10 border-b border-white/10 pb-4">
                            <h1 id="screen-prize-title" class="text-2xl font-bold text-yellow-400 tracking-widest uppercase italic">LUCKY DRAW SYSTEM</h1>
                        </div>
                        <div id="screen-display-area" class="flex-1 overflow-y-auto custom-scroll-dark pr-2 space-y-4 relative z-10">
                            <div class="flex flex-col items-center justify-center h-full opacity-20 text-white">
                                <i data-lucide="gift" width="64" height="64" class="mb-4"></i>
                                <p class="text-lg font-bold">READY TO SPIN</p>
                            </div>
                        </div>
                        <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/90 backdrop-blur-sm z-20 flex items-center justify-center">
                            <div class="text-white text-center">
                                <div class="w-20 h-20 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                <h2 class="text-2xl font-bold uppercase tracking-widest">Randomizing...</h2>
                                <p class="text-indigo-400 mt-2 text-sm">กรุณารอสักครู่ ระบบกำลังสุ่มรายชื่อ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนรางวัลทั้งหมด</p>
                        <h3 id="res-stat-total-prizes" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">รางวัลที่ได้สุ่มแล้ว</p>
                        <h3 id="res-stat-total-drawn" class="text-2xl font-bold text-blue-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนผู้ได้รับรางวัล</p>
                        <h3 id="res-stat-winners" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัลแล้ว</p>
                        <h3 id="res-stat-claimed" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ที่ยังไม่มารับรางวัล</p>
                        <h3 id="res-stat-unclaimed" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b flex justify-between items-center bg-slate-200">
                        <h3 class="font-bold text-lg text-slate-800">รายชื่อผู้โชคดี (เรียลไทม์)</h3>
                        <div class="flex items-center gap-4">
                            <select id="filter-results-status" onchange="window.app.renderResults()" class="border p-2 text-sm rounded-lg outline-none bg-white">
                                <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                                <option value="unclaimed">ยังไม่ยืนยันสิทธิ์</option>
                                <option value="claimed">ยืนยันรับรางวัลแล้ว</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left table-compact table-results">
                            <thead class="bg-slate-200 font-bold border-b text-slate-700">
                                <tr>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('index')">
                                        ลำดับ <span id="rsort-index"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="rsort-EmpName"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('reward')">
                                        รางวัลที่ได้ <span id="rsort-reward"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('rewardTime')">
                                        เวลาที่สุ่มได้ <span id="rsort-rewardTime"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('ConfirmReward')">
                                        สถานะการรับรางวัล <span id="rsort-ConfirmReward"></span>
                                    </th>
                                    <th class="px-6 py-4 text-right text-xs">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE (REGISTRATION) -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border flex flex-col md:flex-row gap-4 items-end">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-slate-600 mb-2">ค้นหาสมาชิกเพื่อลงทะเบียน (รหัส/ชื่อ)</label>
                        <input type="text" id="member-search-input" oninput="window.app.validateMemberSearch()" placeholder="ใส่รหัสสมาชิก หรือ ชื่อ..." class="w-full p-3 border rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                    </div>
                    <button id="member-search-btn" onclick="window.app.openMemberSearchModal()" disabled class="px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold opacity-50 cursor-not-allowed hover:bg-indigo-700 transition flex items-center gap-2 text-sm">
                        <i data-lucide="search" width="20"></i> ค้นหารายชื่อ
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิก</p>
                        <h3 id="reg-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ลงทะเบียนแล้ว</p>
                        <h3 id="reg-stat-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">รับบัตรเลือกตั้งแล้ว</p>
                        <h3 id="reg-stat-voting" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัล</p>
                        <h3 id="reg-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-4 border-b flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4 text-slate-800">
                        <h3 class="font-bold text-lg">ข้อมูลพนักงานลงทะเบียนทั้งหมด</h3>
                        <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="กรองในตาราง..." class="p-2 border rounded-lg text-sm outline-none bg-white w-full md:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-300 font-bold border-b text-slate-700 sticky top-0 z-10">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeSort('EmpMember')">
                                        no <span id="sort-EmpMember"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="sort-EmpName"></span>
                                    </th>
                                    <th class="text-sm text-center">เวลาเข้าระบบ</th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CheckIN')">
                                        Check-In <span id="sort-CheckIN"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CardPoll')">
                                        รับบัตร <span id="sort-CardPoll"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmVotingCard')">
                                        วันที่รับบัตร <span id="sort-ConfirmVotingCard"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('reward')">
                                        รางวัล <span id="sort-reward"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmReward')">
                                        วันที่รับรางวัล <span id="sort-ConfirmReward"></span>
                                    </th>
                                    <th class="text-center text-sm">สถานะรางวัล</th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <p id="data-table-info" class="text-slate-400 font-medium">กำลังดึงข้อมูล...</p>
                            <div class="flex gap-2">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100" id="btn-prev">Prev</button>
                                <span id="page-indicator" class="font-bold self-center px-4">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 10: DIVIDEND INFO -->
            <div id="view-dividend-info" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิกรวม</p>
                        <h3 id="div-summary-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนลงทะเบียน</p>
                        <h3 id="div-summary-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งเข้าร่วม</p>
                        <h3 id="div-summary-join" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งไม่เข้าร่วม</p>
                        <h3 id="div-summary-nojoin" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border overflow-hidden">
                    <div class="p-6 border-b bg-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลเงินปันผล (Dividend)</h3>
                        <input type="text" id="search-dividend" oninput="window.app.handleDividendSearch(this.value)" placeholder="ค้นหารหัส/ชื่อ..." class="p-2 border rounded-lg text-sm outline-none w-64 bg-white">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 font-bold">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeDivSort('no')">
                                        ลำดับ <span id="dsort-no"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeDivSort('empname')">
                                        ชื่อ-นามสกุล <span id="dsort-empname"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('dividend')">
                                        ปันผล <span id="dsort-dividend"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('moneyback')">
                                        เงินเฉลี่ยคืน <span id="dsort-moneyback"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('gratuity')">
                                        เงินสมนาคุณ <span id="dsort-gratuity"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('netpayment')">
                                        รวมปันผล <span id="dsort-netpayment"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('DateLogin')">
                                        ลงทะเบียน <span id="dsort-DateLogin"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('RegisMeeting')">
                                        แจ้งเข้าร่วม <span id="dsort-RegisMeeting"></span>
                                    </th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="dividend-table-body" class="divide-y"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <div class="flex items-center gap-4">
                                <p id="div-table-info" class="text-slate-400 font-medium">แสดงผล...</p>
                                <button onclick="window.app.downloadDividendCSV()" class="px-4 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-xs font-bold transition flex items-center gap-2 shadow-sm">
                                    <i data-lucide="download" width="14"></i> Download CSV File
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: IMPORT & DATA MANAGE -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนรายชื่อพนักงานทั้งหมดในระบบ</p>
                        <h3 id="manage-total-docs" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-full text-blue-600">
                        <i data-lucide="users" width="32"></i>
                    </div>
                </div>
                
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-blue-600"><i data-lucide="upload-cloud"></i> Upload ข้อมูลสมาชิก</h3>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium">ลากไฟล์มาวางที่นี่ หรือ คลิกเพื่อเลือกไฟล์ (.json, .csv)</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-4 rounded-xl flex justify-between items-center text-sm text-blue-700">
                                <span id="file-name" class="font-bold"></span>
                                <button onclick="window.app.clearFileSelection()" class="hover:text-red-500 transition"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-blue-700 text-sm">เริ่มประมวลผลนำเข้าข้อมูลพนักงาน</button>
                            <div id="import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="import-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4">
                            <button onclick="window.app.openResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะการลงทะเบียนพนักงาน
                            </button>
                            <button onclick="window.app.openDeleteAllModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลพนักงานทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: DIVIDEND MANAGE (IMPORT) -->
            <div id="view-dividend" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนสมาชิกปันผลทั้งหมดในระบบ</p>
                        <h3 id="manage-dividend-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-emerald-100 p-3 rounded-full text-emerald-600">
                        <i data-lucide="wallet" width="32"></i>
                    </div>
                </div>

                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-emerald-600"><i data-lucide="wallet"></i> Upload ข้อมูลปันผล</h3>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('dividend-file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium">เลือกไฟล์ข้อมูลเงินปันผล (.json, .csv)</p>
                                <input type="file" id="dividend-file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleDividendFileSelect(event)">
                            </div>
                            <div id="dividend-file-info" class="hidden bg-emerald-50 p-4 rounded-xl flex justify-between items-center text-sm text-emerald-700">
                                <span id="dividend-file-name" class="font-bold"></span>
                                <button onclick="window.app.clearDividendFileSelection()" class="hover:text-red-500 transition"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processDividendImport()" id="btn-dividend-import" disabled class="w-full bg-emerald-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-emerald-700 text-sm">เริ่มประมวลผลนำเข้าข้อมูลเงินปันผล</button>
                            <div id="dividend-import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="dividend-import-bar" class="bg-emerald-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4">
                            <button onclick="window.app.openDividendResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะปันผลทั้งหมด
                            </button>
                            <button onclick="window.app.openDeleteAllDividendModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลเงินปันผลทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: QR Code IN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-blue-800 mb-6 tracking-widest text-center">QR Code ลงทะเบียน</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-register.png" alt="Check-IN QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
            <!-- VIEW: QR Code OUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-orange-600 mb-6 tracking-widest text-center">QR Code เช็คปันผล</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-dividend.png" alt="Check-OUT QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- MODALS -->

    <!-- Edit Prize Modal -->
    <div id="edit-prize-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8">
            <h3 class="text-xl font-bold mb-6 text-slate-800 flex items-center gap-2">
                <i data-lucide="edit-3" class="text-indigo-600"></i> แก้ไขข้อมูลรางวัล
            </h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อรางวัล</label>
                    <input type="text" id="edit-prize-name" class="w-full p-3 border rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 text-sm font-bold">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">สุ่มต่อรอบ</label>
                        <input type="number" id="edit-prize-qty" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">รวมทั้งหมด</label>
                        <input type="number" id="edit-prize-total" min="1" class="w-full p-3 border rounded-xl outline-none text-sm font-bold text-blue-600">
                    </div>
                </div>
            </div>
            <div class="flex gap-4 mt-8">
                <button onclick="window.app.closeEditPrizeModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 font-bold transition text-sm">ยกเลิก</button>
                <button onclick="window.app.saveEditedPrize()" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition text-sm shadow-lg">บันทึกรายการ</button>
            </div>
        </div>
    </div>
    
    <!-- Confirm Reset Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2">รีเซ็ตสถานะ?</h3>
            <p class="text-slate-500 text-sm mb-6">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest">Reset</span> เพื่อยืนยันการล้างข้อมูล Check-IN/OUT</p>
            <input type="text" id="confirm-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold" placeholder="พิมพ์ Reset">
            <div class="flex gap-4">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700">รีเซ็ตข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Modal -->
    <div id="delete-all-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2 text-red-600">ลบข้อมูลทั้งหมด?</h3>
            <p class="text-slate-500 text-sm mb-6">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest">Delete</span> เพื่อยืนยันการลบข้อมูลพนักงาน</p>
            <input type="text" id="confirm-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold" placeholder="พิมพ์ Delete">
            <div class="flex gap-4">
                <button onclick="window.app.closeDeleteAllModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-700">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Confirm Reset Dividend Modal -->
    <div id="dividend-reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2">รีเซ็ตสถานะปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest">Reset</span> เพื่อรีเซ็ตการรับปันผล</p>
            <input type="text" id="confirm-div-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold" placeholder="พิมพ์ Reset">
            <div class="flex gap-4">
                <button onclick="window.app.closeDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold">ยกเลิก</button>
                <button onclick="window.app.confirmResetDividendData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold">รีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Dividend Modal -->
    <div id="dividend-delete-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2 text-red-600">ลบฐานปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest">Delete</span> เพื่อลบข้อมูลปันผลถาวร</p>
            <input type="text" id="confirm-div-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold">
            <div class="flex gap-4">
                <button onclick="window.app.closeDeleteAllDividendModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllDividendData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Single Dividend Reset Modal -->
    <div id="dividend-single-reset-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="alert-triangle" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2">ล้างข้อมูลเงินปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">คุณกำลังจะล้างสถานะการลงทะเบียนและการแจ้งเข้าร่วมของสมาชิกท่านนี้</p>
            <div class="flex gap-4">
                <button onclick="window.app.closeSingleDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmSingleDividendReset()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition text-sm">ยืนยันการล้างข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Member Search Modal -->
    <div id="member-search-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center">
            <div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="user" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-4">ข้อมูลพนักงาน</h3>
            <div id="search-member-details" class="text-left bg-slate-50 p-6 rounded-2xl mb-8 space-y-2 text-sm border italic"></div>
            <div class="flex flex-col gap-3">
                <div class="flex gap-2">
                    <button onclick="window.app.closeMemberSearchModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                    <button id="btn-confirm-regis" onclick="window.app.confirmRegistrationViaSearch(false)" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition text-sm">ลงทะเบียน</button>
                </div>
                <button id="btn-confirm-regis-card" onclick="window.app.confirmRegistrationViaSearch(true)" class="w-full py-4 rounded-xl bg-emerald-600 text-white font-bold hover:bg-emerald-700 transition text-sm shadow-lg flex items-center justify-center gap-2">
                    <i data-lucide="check-square" width="18"></i> ยืนยันการรับบัตรเลือกตั้ง
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK Logic -->
    <script type="module">
const _0x439e11=_0x41e7;(function(_0xbd485e,_0x7efa40){const _0x1b765e=_0x41e7,_0x550f4d=_0xbd485e();while(!![]){try{const _0x252d47=parseInt(_0x1b765e(0x1e3))/0x1*(parseInt(_0x1b765e(0xcc))/0x2)+parseInt(_0x1b765e(0x1be))/0x3+parseInt(_0x1b765e(0x1cc))/0x4+-parseInt(_0x1b765e(0x10c))/0x5*(-parseInt(_0x1b765e(0xe9))/0x6)+parseInt(_0x1b765e(0x9c))/0x7+-parseInt(_0x1b765e(0x12b))/0x8+-parseInt(_0x1b765e(0x1ae))/0x9*(parseInt(_0x1b765e(0x14e))/0xa);if(_0x252d47===_0x7efa40)break;else _0x550f4d['push'](_0x550f4d['shift']());}catch(_0x44de08){_0x550f4d['push'](_0x550f4d['shift']());}}}(_0x2696,0x750c5));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';function _0x2696(){const _0x4b1b16=['dash-stat-total','ไม่เข้าร่วม','toLocaleString','validateRandomizerInput','Upload\x20ข้อมูลสมาชิก','ภาพรวม','includes','confirm-delete-input','currentPage','from','status','dash-stat-div-join','classList','reset-confirm-modal','asc','gratuity','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-2\x20gap-y-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>ชื่อ-นามสกุล:</b>\x20<span\x20class=\x22font-bold\x20text-slate-800\x22>','filter','<span\x20class=\x22text-green-600\x20font-bold\x22>เช็คอินแล้ว</span>','opacity-0','label-eligible-count','18nobRAH','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x22>','encode','Download\x20CSV\x20สำเร็จ','padStart','ข้อมูลลงทะเบียน','rowsPerPage','ลบพนักงานทั้งหมดแล้ว','onPrizeSelect','click','href','เกิดข้อผิดพลาดในการบันทึก','ttb-register.firebasestorage.app','files','Online\x20(Connected)','res-stat-total-drawn','notRewarded','toLowerCase','forEach','</div>','coop_gift','width','openDividendResetModal','switchTab','openEditPrizeModal','<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22inline\x20w-3\x20opacity-30\x22></i>','update','btn-next','find','รีเซ็ตสถานะสำเร็จ','eligible','showToast','พิมพ์\x20Delete\x20เพื่อยืนยัน','status-indicator','</span>\x20<span\x20class=\x22text-[10px]\x20text-slate-400\x20font-mono\x22>','342330tMqJEL','text','ประกาศผลรางวัล','innerHTML','text-white','Active','bg-green-500','<i\x20data-lucide=\x22chevron-up\x22></i>','dividend-reset-confirm-modal','บันทึกรางวัลสำเร็จ','rsort-','prizeIdToEdit','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-800\x22>','prize-total','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20font-mono\x20text-slate-500\x22>','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-500\x20transition\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x22>','member-search-modal','th-TH','delete','sortBy','.nav-item','file-info','rand-stat-eligible-view','citizenId','import-bar','dividend-file-info','view-','<i\x20data-lucide=\x22chevron-down\x22></i>','nav-','text/csv;charset=utf-8;','6129336yLKgJZ','getElementById','querySelectorAll','Reset','ceil','createElement','toast-container','\x20p-4\x20rounded-lg\x20shadow-xl\x20flex\x20items-center\x20gap-3\x20toast-enter\x20pointer-events-auto','นำเข้าข้อมูลรายชื่อสำเร็จ','split','openDeleteAllDividendModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-medium\x20text-slate-600\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20text-slate-500\x20font-mono\x20text-center\x22>','toLocaleTimeString','trim','select-prize','map','handleDividendFileSelect','ล้างข้อมูลรางวัลพนักงานท่านนี้?','\x20of\x20','data','DateMeeting','closeMemberSearchModal','RegisMeeting','rewardTime','reg-stat-total','line','bg-white\x20p-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-400\x20flex\x20justify-between\x20items-center\x20fade-in-up','dividendUsers','เงินเฉลี่ยคืน','btn-prev','จัดการของรางวัล',':00','member-search-btn','dividend-table-body','8086190kSFHEc','resultsSortBy','<i\x20data-lucide=\x22chevron-up\x22\x20class=\x22inline\x20w-3\x22></i>','closeSingleDividendResetModal','innerText','dividend-file-name','qtyPerDraw','input-draw-qty','พิมพ์\x20Delete','createIcons','reg-stat-registered','div-summary-join','\x27)\x22\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x20hover:bg-red-200\x20transition\x22>ยังไม่รับ</button>','ConfirmReward','checkin','dividend-single-reset-modal','res-stat-winners','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-blue-600\x22>','ผู้มีสิทธิ์ลุ้นไม่เพียงพอ','ConfirmVotingCard','translate-x-full','desc','check-circle','Upload\x20ข้อมูลปันผล','delete-all-confirm-modal','screen-display-area','success','div','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-center\x22>','prize-form','CheckOUT','\x27)\x22\x20class=\x22text-indigo-500\x20hover:text-indigo-700\x20transition\x22\x20title=\x22แก้ไข\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22edit-3\x22\x20width=\x2216\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.deletePrize(\x27','ล้างข้อมูลสถานะของพนักงานคนนี้ทั้งหมด?','edit-prize-modal','res-stat-claimed','ยืนยันการรับรางวัลสำเร็จ','divSearchTerm','ล้างข้อมูลสำเร็จ','getContext','length','dividendIdToReset','getHours','disabled','push','changePage','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-indigo-600\x22>','EmpMember','\x20รายการ','prizes','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','qty-warning','set','searchCandidate','text-slate-400','reg-stat-voting','parse','พิมพ์\x20Reset\x20เพื่อยืนยัน','selectedIndex','digest','toString','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20transition\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','totalDocs','confirmResetDividendData','ระบบสุ่มรางวัล','reset','citizenID','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x22>','<span\x20class=\x22text-emerald-600\x20font-bold\x22>รับแล้ว</span>','download','dsort-','createObjectURL','confirmDeleteAllData','appendChild','preventDefault','current-time','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x20text-center\x22>','ข้อมูลเงินปันผล','replace','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-bold\x20text-blue-600\x22>','closeDividendResetModal','dividend','notYetDrawn','confirm-div-reset-input','clearFileSelection','view-dividend-info','style','confirmDeleteAllDividendData','table-body','toLocaleDateString','dividend-import-progress','DateLogin','recent-activity-list','all_winners','</span>','dash-stat-div-reg','reduce','18nUaJmM','.view-section','border-green-500\x20text-green-700','tmb_coop_dividend','Check-IN','fileToImport','slice','total','handleDividendSearch','<span\x20class=\x22text-xs\x20font-normal\x20text-white\x20','clearDividendFileSelection','แก้ไขข้อมูลไม่สำเร็จ','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รับบัตรเลือกตั้ง:</b>\x20<span>','member-search-input','prize-qty','edit-prize-name','2622297KmRWJv','setAttribute','<button\x20onclick=\x22window.app.manualConfirmReward(\x27','dividendFileToImport','divNoJoin','target','ลบฐานข้อมูลเงินปันผลแล้ว','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20transition\x22\x20title=\x22ลบ\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','confirm-reset-input','edit-prize-total','</p><p\x20class=\x22text-xs\x20text-slate-400\x20font-mono\x22>NO:\x20','รับบัตรเลือกตั้ง','confirm-div-delete-input','edit-prize-qty','1778596BwPbLM','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-bold\x22>','regChartInst','divSortBy','reward','changeResSort','add','closeResetModal','ลำดับ','G-9DJLWJ5LQ1','dividendTotal','openDeleteAllModal','ref','\x22\x20width=\x2220\x22></i><div\x20class=\x22flex-1\x20text-sm\x20font-bold\x22>','results','manage-dividend-total','\x22\x20data-total=\x22','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x22>','renderResults','Page\x20','handleSearch','handlePrizeSubmit','screen-overlay-controls','5yktAfA','btn-import','เกิดข้อผิดพลาด','closeDeleteAllModal','search-member-details','label-stock-count','resultsSortOrder','resetWinnerStatus','rewarded','size','totalQty','dataset','handleFileSelect','isDrawing','EmpName','divSortOrder','toDate','CitizenId','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x22>','dividend-delete-confirm-modal','users','<div><p\x20class=\x22font-bold\x20text-lg\x20text-slate-800\x22>','commit','divJoin','bg-white\x20border-l-4\x20','\x20พร้อมยืนยันรับบัตร','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-800\x22>','totalPrizesQuota','closeDeleteAllDividendModal','changeDivSort','dividend-info','</p></div><span\x20class=\x22text-xs\x20font-bold\x20bg-indigo-100\x20text-indigo-700\x20px-3\x20py-1\x20rounded-lg\x20uppercase\x22>','status-text','join','sortOrder','btn-dividend-import','subtle','CardPoll','options','netpayment','page-title','hidden','div-table-info','ไม่ได้รับรางวัล','.csv','unclaimed','randomizer','claimed','prize-list-body','6158236LHPrkv','แจ้งเข้าร่วม','confirmRegistrationViaSearch','<option\x20value=\x22\x22>--\x20เลือกของรางวัล\x20--</option>','openResetModal','opacity-50','moneyback','TimeLogin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','app','qty','1070273157855','className','votingCards','validateMemberSearch','deletePrize','btn-start-random','prize-name','res-stat-unclaimed','div-summary-total','localeCompare','manage-total-docs','searchTerm','res-stat-total-prizes','bg-red-500','พิมพ์\x20Reset','startRandomizer','value','stats','\x27)\x22\x20class=\x22text-slate-300\x20hover:text-red-500\x20transition\x22\x20title=\x22ล้างข้อมูล\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','\x20px-2\x20py-0.5\x20rounded\x22>','toggle','เงินสมนาคุณ','rand-stat-drawn-win','dashboard','เข้าร่วม','saveEditedPrize','ชื่อ-นามสกุล','totalPrizesDrawn','empname','rand-stat-drawn-no','sort','endsWith','CheckIN','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-right\x22><button\x20onclick=\x22window.app.resetWinnerStatus(\x27','remove','div-summary-registered','</span></div>','183576DPgsYg','QR\x20Code\x20ลงทะเบียน','member','<div\x20class=\x22flex\x20items-center\x20gap-3\x20p-3\x20bg-slate-50\x20rounded-xl\x20text-sm\x20border-l-4\x20border-indigo-500\x20shadow-sm\x20font-medium\x22><span\x20class=\x22font-bold\x20text-indigo-700\x22>IN</span>\x20<span\x20class=\x22flex-1\x22>','name','error','confirmResetData','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ'];_0x2696=function(){return _0x4b1b16;};return _0x2696();}import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const firebaseConfig={'apiKey':_0x439e11(0xd3),'authDomain':'ttb-register.firebaseapp.com','databaseURL':'https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','projectId':'ttb-register','storageBucket':_0x439e11(0xf5),'messagingSenderId':_0x439e11(0xa7),'appId':'1:1070273157855:web:5c8120e1df27e233d8676a','measurementId':_0x439e11(0x1d5)},finalCollectionPath='tmb_coop',prizesCollectionPath=_0x439e11(0xfd),dividendCollectionPath=_0x439e11(0x1b1),app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'dividendUsers':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0,'votingCards':0x0,'dividendTotal':0x0,'divRegistered':0x0,'divJoin':0x0,'divNoJoin':0x0,'totalPrizesQuota':0x0,'totalPrizesDrawn':0x0},'isDrawing':![],'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x439e11(0xc7),'sortOrder':_0x439e11(0x163),'searchTerm':'','divRowsPerPage':0x32,'divCurrentPage':0x1,'divSearchTerm':'','divSortBy':_0x439e11(0x1a8),'divSortOrder':_0x439e11(0x163),'fileToImport':null,'dividendFileToImport':null,'searchCandidate':null,'resultsSortBy':_0x439e11(0x1d0),'resultsSortOrder':_0x439e11(0xe2),'dividendIdToReset':null,'prizeIdToEdit':null};async function sha256(_0x4456c9){const _0x15c16e=_0x439e11,_0x333f1b=new TextEncoder()[_0x15c16e(0xeb)](_0x4456c9),_0x21d261=await crypto[_0x15c16e(0x207)][_0x15c16e(0x188)]('SHA-256',_0x333f1b),_0x13eb89=Array[_0x15c16e(0xdd)](new Uint8Array(_0x21d261));return _0x13eb89[_0x15c16e(0x13b)](_0x1f4312=>_0x1f4312[_0x15c16e(0x189)](0x10)[_0x15c16e(0xed)](0x2,'0'))[_0x15c16e(0x204)]('');}window[_0x439e11(0xa5)]=window[_0x439e11(0xa5)]||{},window[_0x439e11(0xa5)]['showToast']=(_0x426573,_0x6a2f8e=_0x439e11(0x168))=>{const _0xcf5e77=_0x439e11,_0x38a870=document[_0xcf5e77(0x12c)](_0xcf5e77(0x131)),_0x35636a=document[_0xcf5e77(0x130)](_0xcf5e77(0x169));let _0x3b6057=_0x6a2f8e==='success'?_0xcf5e77(0x1b0):'border-red-500\x20text-red-700',_0x1d4642=_0x6a2f8e===_0xcf5e77(0x168)?_0xcf5e77(0x164):'alert-circle';_0x35636a[_0xcf5e77(0xa8)]=_0xcf5e77(0x1fb)+_0x3b6057+_0xcf5e77(0x132),_0x35636a['innerHTML']='<i\x20data-lucide=\x22'+_0x1d4642+_0xcf5e77(0x1d9)+_0x426573+_0xcf5e77(0xfc),_0x38a870[_0xcf5e77(0x196)](_0x35636a),lucide['createIcons'](),setTimeout(()=>{const _0x3301ca=_0xcf5e77;_0x35636a[_0x3301ca(0xe0)]['add'](_0x3301ca(0xe7),_0x3301ca(0x162)),setTimeout(()=>_0x35636a[_0x3301ca(0xc9)](),0x12c);},0xbb8);},window['app'][_0x439e11(0x100)]=_0x13092a=>{const _0x480bcc=_0x439e11;document[_0x480bcc(0x12d)](_0x480bcc(0x1af))[_0x480bcc(0xfb)](_0x2de2ce=>_0x2de2ce[_0x480bcc(0xe0)][_0x480bcc(0x1d2)](_0x480bcc(0x94)));const _0x3b7e75=document[_0x480bcc(0x12c)](_0x480bcc(0x127)+_0x13092a);if(_0x3b7e75)_0x3b7e75[_0x480bcc(0xe0)]['remove']('hidden');document[_0x480bcc(0x12d)](_0x480bcc(0x121))[_0x480bcc(0xfb)](_0x499a54=>{const _0x3ad60a=_0x480bcc;_0x499a54[_0x3ad60a(0xe0)][_0x3ad60a(0xc9)]('bg-slate-700',_0x3ad60a(0x110)),_0x499a54[_0x3ad60a(0xe0)][_0x3ad60a(0x1d2)](_0x3ad60a(0x183));});const _0x2de10a=document[_0x480bcc(0x12c)](_0x480bcc(0x129)+_0x13092a);_0x2de10a&&(_0x2de10a[_0x480bcc(0xe0)]['remove']('text-slate-400'),_0x2de10a[_0x480bcc(0xe0)]['add']('bg-slate-700','text-white'));let _0x23f9c1={'dashboard':_0x480bcc(0xd9),'prizes':_0x480bcc(0x14a),'randomizer':_0x480bcc(0x18d),'results':_0x480bcc(0x10e),'data':_0x480bcc(0xee),'dividend-info':_0x480bcc(0x19a),'import':_0x480bcc(0xd8),'dividend':_0x480bcc(0x165),'qrcode-in':_0x480bcc(0xcd),'qrcode-out':'QR\x20Code\x20เช็คปันผล'};document[_0x480bcc(0x12c)](_0x480bcc(0x20b))['innerText']=_0x23f9c1[_0x13092a]||_0x13092a;if(_0x13092a===_0x480bcc(0x13f))renderTable(state[_0x480bcc(0x1f7)]);if(_0x13092a===_0x480bcc(0x201))renderDividendTable(state[_0x480bcc(0x147)]);if(_0x13092a===_0x480bcc(0x99))window[_0x480bcc(0xa5)]['onPrizeSelect']();if(_0x13092a===_0x480bcc(0x1da))window[_0x480bcc(0xa5)][_0x480bcc(0x1de)]();lucide[_0x480bcc(0x157)]();};function processSnapshot(_0x3a3c18){const _0x27fffe=_0x439e11,_0x2d9a51=[],_0x3d3c50={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':_0x3a3c18[_0x27fffe(0x1ec)],'notYetDrawn':0x0,'votingCards':0x0,'totalPrizesDrawn':0x0},_0x5a6a74={};_0x3a3c18[_0x27fffe(0xfb)](_0x4c2439=>{const _0x47eefc=_0x27fffe,_0x341f89=_0x4c2439[_0x47eefc(0x13f)](),_0x3f2f01={'id':_0x4c2439['id'],..._0x341f89};_0x2d9a51['push'](_0x3f2f01);if(_0x341f89[_0x47eefc(0xc7)]){_0x3d3c50[_0x47eefc(0x15c)]++;const _0x4370ad=(_0x341f89[_0x47eefc(0xc7)]['toDate']?.()||new Date(_0x341f89[_0x47eefc(0xc7)]))[_0x47eefc(0x177)]();_0x5a6a74[_0x4370ad]=(_0x5a6a74[_0x4370ad]||0x0)+0x1;}_0x341f89[_0x47eefc(0x16c)]&&_0x3d3c50['checkout']++;if(_0x341f89[_0x47eefc(0x208)]===_0x47eefc(0x1c9))_0x3d3c50[_0x47eefc(0xa9)]++;if(_0x341f89['reward']){if(_0x341f89[_0x47eefc(0x1d0)]==='ไม่ได้รับรางวัล')_0x3d3c50[_0x47eefc(0xf9)]++;else _0x3d3c50['rewarded']++,_0x3d3c50[_0x47eefc(0xc2)]++;}if(_0x341f89['ConfirmReward'])_0x3d3c50[_0x47eefc(0x9a)]++;if(_0x341f89[_0x47eefc(0xde)]===_0x47eefc(0x111)){_0x3d3c50[_0x47eefc(0x107)]++;if(!_0x341f89[_0x47eefc(0x1d0)])_0x3d3c50[_0x47eefc(0x19f)]++;}}),state['users']=_0x2d9a51,state[_0x27fffe(0xb8)]={...state[_0x27fffe(0xb8)],..._0x3d3c50},updateDashboardUI(state['stats']),updateCharts(_0x5a6a74),renderActivityFeed(_0x2d9a51),renderTable(_0x2d9a51),window[_0x27fffe(0xa5)]['renderResults']();}function updateDashboardUI(_0x2f7dfd){const _0x1c6a4e=_0x439e11,_0x3eb182=[_0x1c6a4e(0xd4),'dash-stat-checkin','dash-stat-voting',_0x1c6a4e(0x1ac),_0x1c6a4e(0xdf),'rand-stat-total',_0x1c6a4e(0x123),'rand-stat-noreward',_0x1c6a4e(0xc4),_0x1c6a4e(0xbd),_0x1c6a4e(0xb1),_0x1c6a4e(0x144),_0x1c6a4e(0x158),_0x1c6a4e(0x184),'reg-stat-rewarded',_0x1c6a4e(0xaf),_0x1c6a4e(0xca),_0x1c6a4e(0x159),'div-summary-nojoin',_0x1c6a4e(0xf8),_0x1c6a4e(0x1db)],_0x3e7fb7={'dash-stat-total':_0x2f7dfd[_0x1c6a4e(0x18b)],'dash-stat-checkin':_0x2f7dfd[_0x1c6a4e(0x15c)],'dash-stat-voting':_0x2f7dfd[_0x1c6a4e(0xa9)],'dash-stat-div-reg':_0x2f7dfd['divRegistered'],'dash-stat-div-join':_0x2f7dfd[_0x1c6a4e(0x1fa)],'rand-stat-total':_0x2f7dfd[_0x1c6a4e(0x18b)],'rand-stat-eligible-view':_0x2f7dfd['eligible'],'rand-stat-noreward':_0x2f7dfd[_0x1c6a4e(0x19f)],'rand-stat-drawn-no':_0x2f7dfd[_0x1c6a4e(0xf9)],'rand-stat-drawn-win':_0x2f7dfd['rewarded'],'manage-total-docs':_0x2f7dfd['totalDocs'],'reg-stat-total':_0x2f7dfd[_0x1c6a4e(0x18b)],'reg-stat-registered':_0x2f7dfd['checkin'],'reg-stat-voting':_0x2f7dfd['votingCards'],'reg-stat-rewarded':_0x2f7dfd[_0x1c6a4e(0x1eb)],'div-summary-total':_0x2f7dfd[_0x1c6a4e(0x1d6)],'div-summary-registered':_0x2f7dfd['divRegistered'],'div-summary-join':_0x2f7dfd['divJoin'],'div-summary-nojoin':_0x2f7dfd[_0x1c6a4e(0x1c2)],'res-stat-total-drawn':_0x2f7dfd['totalPrizesDrawn'],'manage-dividend-total':_0x2f7dfd['dividendTotal']};_0x3eb182['forEach'](_0x2ff25f=>{const _0x2004ce=_0x1c6a4e;if(document[_0x2004ce(0x12c)](_0x2ff25f))document[_0x2004ce(0x12c)](_0x2ff25f)[_0x2004ce(0x152)]=_0x3e7fb7[_0x2ff25f]||0x0;});}window['app'][_0x439e11(0x1de)]=()=>{const _0x2b05c7=_0x439e11,_0x76b205=document[_0x2b05c7(0x12c)]('filter-results-status')?.[_0x2b05c7(0xb7)]||_0x2b05c7(0x1aa),_0x521dde=state[_0x2b05c7(0x1f7)][_0x2b05c7(0xe5)](_0x1deb35=>_0x1deb35[_0x2b05c7(0x1d0)]&&_0x1deb35['reward']!=='ไม่ได้รับรางวัล')[_0x2b05c7(0x175)],_0x380309=state[_0x2b05c7(0x1f7)][_0x2b05c7(0xe5)](_0x2fe801=>_0x2fe801[_0x2b05c7(0x15b)])[_0x2b05c7(0x175)],_0x493e82=_0x521dde-_0x380309;if(document[_0x2b05c7(0x12c)](_0x2b05c7(0xb3)))document[_0x2b05c7(0x12c)]('res-stat-total-prizes')[_0x2b05c7(0x152)]=state[_0x2b05c7(0xb8)][_0x2b05c7(0x1fe)]||0x0;if(document[_0x2b05c7(0x12c)](_0x2b05c7(0xf8)))document[_0x2b05c7(0x12c)]('res-stat-total-drawn')[_0x2b05c7(0x152)]=state[_0x2b05c7(0xb8)][_0x2b05c7(0xc2)]||0x0;if(document[_0x2b05c7(0x12c)](_0x2b05c7(0x15e)))document[_0x2b05c7(0x12c)](_0x2b05c7(0x15e))['innerText']=_0x521dde;if(document[_0x2b05c7(0x12c)](_0x2b05c7(0x170)))document[_0x2b05c7(0x12c)](_0x2b05c7(0x170))[_0x2b05c7(0x152)]=_0x380309;if(document['getElementById'](_0x2b05c7(0xae)))document['getElementById'](_0x2b05c7(0xae))[_0x2b05c7(0x152)]=_0x493e82;let _0x52f062=state['users'][_0x2b05c7(0xe5)](_0x506659=>_0x506659[_0x2b05c7(0x1d0)]&&_0x506659[_0x2b05c7(0x1d0)]!=='ไม่ได้รับรางวัล');if(_0x76b205===_0x2b05c7(0x98))_0x52f062=_0x52f062[_0x2b05c7(0xe5)](_0x58ff70=>!_0x58ff70[_0x2b05c7(0x15b)]);if(_0x76b205===_0x2b05c7(0x9a))_0x52f062=_0x52f062[_0x2b05c7(0xe5)](_0x22817d=>_0x22817d[_0x2b05c7(0x15b)]);_0x52f062[_0x2b05c7(0xc5)]((_0x392e95,_0x2f072a)=>{const _0x1b37d4=_0x2b05c7;let _0x3bc064=_0x392e95[state['resultsSortBy']],_0x3f702c=_0x2f072a[state[_0x1b37d4(0x14f)]];if(state[_0x1b37d4(0x14f)]===_0x1b37d4(0x143)||state[_0x1b37d4(0x14f)]===_0x1b37d4(0x15b)){_0x3bc064=_0x3bc064?.['toDate']?.()||(_0x3bc064?new Date(_0x3bc064):null),_0x3f702c=_0x3f702c?.[_0x1b37d4(0x1f3)]?.()||(_0x3f702c?new Date(_0x3f702c):null);if(!_0x3bc064)return 0x1;if(!_0x3f702c)return-0x1;return state['resultsSortOrder']===_0x1b37d4(0xe2)?_0x3bc064-_0x3f702c:_0x3f702c-_0x3bc064;}return _0x3bc064=String(_0x3bc064||'')[_0x1b37d4(0xfa)](),_0x3f702c=String(_0x3f702c||'')['toLowerCase'](),state[_0x1b37d4(0x1e9)]==='asc'?_0x3bc064[_0x1b37d4(0xb0)](_0x3f702c):_0x3f702c[_0x1b37d4(0xb0)](_0x3bc064);});const _0x5ca226=['EmpName','reward',_0x2b05c7(0x143),_0x2b05c7(0x15b)];_0x5ca226['forEach'](_0x2709de=>{const _0x374f01=_0x2b05c7,_0x3dd493=document[_0x374f01(0x12c)](_0x374f01(0x116)+_0x2709de);_0x3dd493&&(state[_0x374f01(0x14f)]===_0x2709de?_0x3dd493['innerHTML']=state['resultsSortOrder']===_0x374f01(0xe2)?_0x374f01(0x113):_0x374f01(0x128):_0x3dd493['innerHTML']='<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22opacity-30\x22></i>');});const _0x19e979=document['getElementById']('results-table-body');if(!_0x19e979)return;if(_0x52f062[_0x2b05c7(0x175)]===0x0){_0x19e979[_0x2b05c7(0x10f)]='<tr><td\x20colspan=\x226\x22\x20class=\x22text-center\x20py-8\x20text-slate-400\x22>ไม่พบข้อมูล</td></tr>';return;}_0x19e979[_0x2b05c7(0x10f)]=_0x52f062[_0x2b05c7(0x13b)]((_0x2a6c2e,_0x2d749d)=>{const _0x5e0224=_0x2b05c7,_0x1a1256=_0x2a6c2e[_0x5e0224(0x143)]?(_0x2a6c2e[_0x5e0224(0x143)][_0x5e0224(0x1f3)]?.()||new Date(_0x2a6c2e[_0x5e0224(0x143)]))[_0x5e0224(0x138)](_0x5e0224(0x11e)):'-';let _0x4bc4d7='-';return _0x2a6c2e[_0x5e0224(0x15b)]?_0x4bc4d7='<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับแล้ว</span>':_0x4bc4d7='<button\x20onclick=\x22window.app.manualConfirmReward(\x27'+_0x2a6c2e['id']+_0x5e0224(0x15a),_0x5e0224(0x11a)+(_0x2d749d+0x1)+_0x5e0224(0x118)+(_0x2a6c2e[_0x5e0224(0x1f1)]||'-')+_0x5e0224(0x11c)+_0x2a6c2e[_0x5e0224(0x1d0)]+_0x5e0224(0x137)+_0x1a1256+_0x5e0224(0x16a)+_0x4bc4d7+_0x5e0224(0xc8)+_0x2a6c2e['id']+_0x5e0224(0x18a);})[_0x2b05c7(0x204)](''),lucide[_0x2b05c7(0x157)]();},window[_0x439e11(0xa5)][_0x439e11(0x1d1)]=_0x38c66e=>{const _0x275146=_0x439e11;state[_0x275146(0x14f)]===_0x38c66e?state[_0x275146(0x1e9)]=state['resultsSortOrder']===_0x275146(0xe2)?_0x275146(0x163):_0x275146(0xe2):(state[_0x275146(0x14f)]=_0x38c66e,state['resultsSortOrder']=_0x275146(0xe2)),window['app'][_0x275146(0x1de)]();};function renderTable(_0x3e1516){const _0x468ad5=_0x439e11,_0x325632=document[_0x468ad5(0x12c)](_0x468ad5(0x1a5));if(!_0x325632)return;let _0x14db91=[..._0x3e1516];state[_0x468ad5(0xb2)]&&(_0x14db91=_0x14db91[_0x468ad5(0xe5)](_0x3ecc94=>(_0x3ecc94[_0x468ad5(0x1f1)]||'')[_0x468ad5(0xfa)]()['includes'](state[_0x468ad5(0xb2)])||(_0x3ecc94[_0x468ad5(0x17c)]||'')[_0x468ad5(0x189)]()[_0x468ad5(0xda)](state['searchTerm'])));_0x14db91[_0x468ad5(0xc5)]((_0x42e2b0,_0x36d62e)=>{const _0x3f7dcc=_0x468ad5;let _0x285dd9=_0x42e2b0[state[_0x3f7dcc(0x120)]],_0x231fcc=_0x36d62e[state[_0x3f7dcc(0x120)]];if([_0x3f7dcc(0xc7),'ConfirmVotingCard','ConfirmReward'][_0x3f7dcc(0xda)](state['sortBy'])){_0x285dd9=_0x285dd9?.['toDate']?.()||(_0x285dd9?new Date(_0x285dd9):null),_0x231fcc=_0x231fcc?.[_0x3f7dcc(0x1f3)]?.()||(_0x231fcc?new Date(_0x231fcc):null);if(!_0x285dd9)return 0x1;if(!_0x231fcc)return-0x1;return state['sortOrder']===_0x3f7dcc(0xe2)?_0x285dd9-_0x231fcc:_0x231fcc-_0x285dd9;}if(state['sortBy']===_0x3f7dcc(0x17c))return state[_0x3f7dcc(0x205)]===_0x3f7dcc(0xe2)?(parseInt(_0x285dd9)||0x0)-(parseInt(_0x231fcc)||0x0):(parseInt(_0x231fcc)||0x0)-(parseInt(_0x285dd9)||0x0);return _0x285dd9=String(_0x285dd9||'')[_0x3f7dcc(0xfa)](),_0x231fcc=String(_0x231fcc||'')['toLowerCase'](),state['sortOrder']===_0x3f7dcc(0xe2)?_0x285dd9[_0x3f7dcc(0xb0)](_0x231fcc):_0x231fcc[_0x3f7dcc(0xb0)](_0x285dd9);});const _0x35fb09=[_0x468ad5(0x17c),'EmpName',_0x468ad5(0xc7),'CardPoll','ConfirmVotingCard',_0x468ad5(0x1d0),_0x468ad5(0x15b)];_0x35fb09[_0x468ad5(0xfb)](_0x33ab7a=>{const _0x2676e2=_0x468ad5,_0x3898a0=document[_0x2676e2(0x12c)]('sort-'+_0x33ab7a);_0x3898a0&&(state[_0x2676e2(0x120)]===_0x33ab7a?_0x3898a0[_0x2676e2(0x10f)]=state[_0x2676e2(0x205)]===_0x2676e2(0xe2)?'<i\x20data-lucide=\x22chevron-up\x22\x20class=\x22inline\x20w-3\x22></i>':'<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x22></i>':_0x3898a0[_0x2676e2(0x10f)]=_0x2676e2(0x102));});const _0x357c15=state[_0x468ad5(0xef)],_0x638773=Math[_0x468ad5(0x12f)](_0x14db91[_0x468ad5(0x175)]/_0x357c15)||0x1,_0x45b5a6=_0x14db91[_0x468ad5(0x1b4)]((state[_0x468ad5(0xdc)]-0x1)*_0x357c15,state[_0x468ad5(0xdc)]*_0x357c15);if(document[_0x468ad5(0x12c)]('page-indicator'))document['getElementById']('page-indicator')[_0x468ad5(0x152)]=_0x468ad5(0x1df)+state[_0x468ad5(0xdc)]+_0x468ad5(0x13e)+_0x638773;if(document[_0x468ad5(0x12c)](_0x468ad5(0x149)))document[_0x468ad5(0x12c)](_0x468ad5(0x149))[_0x468ad5(0x178)]=state['currentPage']<=0x1;if(document[_0x468ad5(0x12c)](_0x468ad5(0x104)))document[_0x468ad5(0x12c)](_0x468ad5(0x104))[_0x468ad5(0x178)]=state[_0x468ad5(0xdc)]>=_0x638773;_0x325632[_0x468ad5(0x10f)]=_0x45b5a6[_0x468ad5(0x13b)](_0x54a7a5=>{const _0x4ce64e=_0x468ad5,_0x16a5eb=_0x54a7a5[_0x4ce64e(0xc7)]?(_0x54a7a5[_0x4ce64e(0xc7)][_0x4ce64e(0x1f3)]?.()||new Date(_0x54a7a5[_0x4ce64e(0xc7)]))['toLocaleTimeString'](_0x4ce64e(0x11e)):'-',_0x3fc2ca=_0x54a7a5[_0x4ce64e(0x161)]?(_0x54a7a5[_0x4ce64e(0x161)][_0x4ce64e(0x1f3)]?.()||new Date(_0x54a7a5[_0x4ce64e(0x161)]))[_0x4ce64e(0xd6)]('th-TH'):'-',_0x3a1ea8=_0x54a7a5['ConfirmReward']?(_0x54a7a5['ConfirmReward']['toDate']?.()||new Date(_0x54a7a5[_0x4ce64e(0x15b)]))[_0x4ce64e(0xd6)]('th-TH'):'-';let _0x25a94a='-';if(_0x54a7a5['ConfirmReward'])_0x25a94a='<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับแล้ว</span>';else _0x54a7a5[_0x4ce64e(0x1d0)]&&_0x54a7a5[_0x4ce64e(0x1d0)]!==_0x4ce64e(0x96)&&(_0x25a94a=_0x4ce64e(0x1c0)+_0x54a7a5['id']+_0x4ce64e(0x15a));return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x20text-slate-500\x22>'+(_0x54a7a5[_0x4ce64e(0x17c)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-700\x22>'+(_0x54a7a5['EmpName']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20font-bold\x20text-slate-700\x22>'+(_0x54a7a5['TimeLogin']||'-')+_0x4ce64e(0x136)+_0x16a5eb+_0x4ce64e(0x15f)+(_0x54a7a5['CardPoll']||'-')+_0x4ce64e(0x190)+_0x3fc2ca+_0x4ce64e(0x17b)+(_0x54a7a5['reward']||'-')+_0x4ce64e(0x199)+_0x3a1ea8+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x22>'+_0x25a94a+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.deleteSingleData(\x27'+_0x54a7a5['id']+_0x4ce64e(0xb9);})['join'](''),lucide[_0x468ad5(0x157)]();}function renderDividendTable(_0x1de0a1){const _0x47fffc=_0x439e11,_0x3ca72d=document['getElementById'](_0x47fffc(0x14d));if(!_0x3ca72d)return;let _0x2b7d29=[..._0x1de0a1];state[_0x47fffc(0x172)]&&(_0x2b7d29=_0x2b7d29[_0x47fffc(0xe5)](_0x505c7d=>(_0x505c7d[_0x47fffc(0xc3)]||'')[_0x47fffc(0xfa)]()['includes'](state[_0x47fffc(0x172)])||(_0x505c7d['no']||'')[_0x47fffc(0x189)]()[_0x47fffc(0xda)](state[_0x47fffc(0x172)])));_0x2b7d29['sort']((_0x41e6ab,_0x2584cf)=>{const _0x40ab79=_0x47fffc;let _0x12d462=_0x41e6ab[state['divSortBy']],_0x22d526=_0x2584cf[state[_0x40ab79(0x1cf)]];if(state[_0x40ab79(0x1cf)]===_0x40ab79(0x1a8)){_0x12d462=_0x12d462?.[_0x40ab79(0x1f3)]?.()||(_0x12d462?new Date(_0x12d462):null),_0x22d526=_0x22d526?.[_0x40ab79(0x1f3)]?.()||(_0x22d526?new Date(_0x22d526):null);if(!_0x12d462)return 0x1;if(!_0x22d526)return-0x1;return state['divSortOrder']==='asc'?_0x12d462-_0x22d526:_0x22d526-_0x12d462;}if([_0x40ab79(0x19e),_0x40ab79(0xa2),_0x40ab79(0xe3),_0x40ab79(0x20a),'no'][_0x40ab79(0xda)](state[_0x40ab79(0x1cf)]))return state[_0x40ab79(0x1f2)]===_0x40ab79(0xe2)?(parseFloat(_0x12d462)||0x0)-(parseFloat(_0x22d526)||0x0):(parseFloat(_0x22d526)||0x0)-(parseFloat(_0x12d462)||0x0);return _0x12d462=String(_0x12d462||'')['toLowerCase'](),_0x22d526=String(_0x22d526||'')[_0x40ab79(0xfa)](),state[_0x40ab79(0x1f2)]===_0x40ab79(0xe2)?_0x12d462[_0x40ab79(0xb0)](_0x22d526):_0x22d526[_0x40ab79(0xb0)](_0x12d462);});const _0x3b25c3=['no',_0x47fffc(0xc3),'dividend',_0x47fffc(0xa2),_0x47fffc(0xe3),_0x47fffc(0x20a),_0x47fffc(0x1a8),_0x47fffc(0x142)];_0x3b25c3[_0x47fffc(0xfb)](_0x3c85dc=>{const _0x3e60f7=_0x47fffc,_0xf5bb90=document[_0x3e60f7(0x12c)](_0x3e60f7(0x193)+_0x3c85dc);_0xf5bb90&&(state[_0x3e60f7(0x1cf)]===_0x3c85dc?_0xf5bb90[_0x3e60f7(0x10f)]=state[_0x3e60f7(0x1f2)]===_0x3e60f7(0xe2)?_0x3e60f7(0x150):'<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x22></i>':_0xf5bb90[_0x3e60f7(0x10f)]=_0x3e60f7(0x102));});const _0x2ea85d=_0x2b7d29[_0x47fffc(0x1b4)](0x0,0x64),_0x40514b=document[_0x47fffc(0x12c)](_0x47fffc(0x95));if(_0x40514b)_0x40514b['innerText']='แสดงผล\x20'+_0x2ea85d[_0x47fffc(0x175)]+'\x20จากทั้งหมด\x20'+_0x2b7d29['length']+_0x47fffc(0x17d);_0x3ca72d[_0x47fffc(0x10f)]=_0x2ea85d[_0x47fffc(0x13b)](_0xb6b396=>{const _0x5495b5=_0x47fffc;let _0x29bfe9='-';if(_0xb6b396[_0x5495b5(0x140)]&&_0xb6b396[_0x5495b5(0x140)]!==''){const _0x4fb376=_0xb6b396[_0x5495b5(0x142)]===_0x5495b5(0xd5)?_0x5495b5(0xb4):_0x5495b5(0x112);_0x29bfe9=_0x5495b5(0x1b7)+_0x4fb376+_0x5495b5(0xba)+(_0xb6b396[_0x5495b5(0x142)]||_0x5495b5(0xbf))+_0x5495b5(0x1ab);}const _0x42ea7f=_0xb6b396[_0x5495b5(0x1a8)]?(_0xb6b396[_0x5495b5(0x1a8)][_0x5495b5(0x1f3)]?.()||new Date(_0xb6b396[_0x5495b5(0x1a8)]))[_0x5495b5(0xd6)](_0x5495b5(0x11e)):'-';return _0x5495b5(0x1f5)+(_0xb6b396['no']||'-')+_0x5495b5(0x1fd)+(_0xb6b396['empname']||'-')+_0x5495b5(0x1dd)+parseFloat(_0xb6b396[_0x5495b5(0x19e)]||0x0)[_0x5495b5(0xd6)]()+_0x5495b5(0x1dd)+parseFloat(_0xb6b396[_0x5495b5(0xa2)]||0x0)[_0x5495b5(0xd6)]()+_0x5495b5(0x1dd)+parseFloat(_0xb6b396[_0x5495b5(0xe3)]||0x0)[_0x5495b5(0xd6)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20font-bold\x20text-emerald-600\x22>'+parseFloat(_0xb6b396[_0x5495b5(0x20a)]||0x0)['toLocaleString']()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x22>'+_0x42ea7f+_0x5495b5(0xea)+_0x29bfe9+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x22><button\x20onclick=\x22window.app.resetSingleDividendData(\x27'+_0xb6b396['id']+_0x5495b5(0x11b);})[_0x47fffc(0x204)](''),lucide[_0x47fffc(0x157)]();}window['app'][_0x439e11(0x200)]=_0x3c6876=>{const _0x3f8034=_0x439e11;state[_0x3f8034(0x1cf)]===_0x3c6876?state['divSortOrder']=state[_0x3f8034(0x1f2)]===_0x3f8034(0xe2)?'desc':_0x3f8034(0xe2):(state[_0x3f8034(0x1cf)]=_0x3c6876,state['divSortOrder']=_0x3c6876===_0x3f8034(0x1a8)?_0x3f8034(0x163):_0x3f8034(0xe2)),renderDividendTable(state[_0x3f8034(0x147)]);},window['app']['downloadDividendCSV']=()=>{const _0x39d92e=_0x439e11,_0x1f600d=state[_0x39d92e(0x147)],_0x1aa93c=[_0x39d92e(0x1d4),_0x39d92e(0xc1),'ปันผล',_0x39d92e(0x148),_0x39d92e(0xbc),'รวมปันผล','ลงทะเบียน',_0x39d92e(0x9d)],_0x5ae8c4=[_0x1aa93c['join'](',')];_0x1f600d[_0x39d92e(0xfb)](_0x1c1c5a=>{const _0x2495ce=_0x39d92e,_0x3d0f24=_0x1c1c5a['DateLogin']?(_0x1c1c5a[_0x2495ce(0x1a8)][_0x2495ce(0x1f3)]?.()||new Date(_0x1c1c5a[_0x2495ce(0x1a8)]))[_0x2495ce(0xd6)](_0x2495ce(0x11e)):'-',_0x5bfbc0=_0x1c1c5a[_0x2495ce(0x140)]&&_0x1c1c5a[_0x2495ce(0x140)]!==''?_0x1c1c5a[_0x2495ce(0x142)]||_0x2495ce(0xbf):_0x2495ce(0xd5),_0x25ca9d=[_0x1c1c5a['no']||'','\x22'+(_0x1c1c5a[_0x2495ce(0xc3)]||'')+'\x22',_0x1c1c5a[_0x2495ce(0x19e)]||0x0,_0x1c1c5a[_0x2495ce(0xa2)]||0x0,_0x1c1c5a[_0x2495ce(0xe3)]||0x0,_0x1c1c5a[_0x2495ce(0x20a)]||0x0,'\x22'+_0x3d0f24+'\x22','\x22'+_0x5bfbc0+'\x22'];_0x5ae8c4[_0x2495ce(0x179)](_0x25ca9d[_0x2495ce(0x204)](','));});const _0x1bf2bd='\ufeff'+_0x5ae8c4[_0x39d92e(0x204)]('\x0a'),_0x1d6c59=new Blob([_0x1bf2bd],{'type':_0x39d92e(0x12a)}),_0x5487b9=URL[_0x39d92e(0x194)](_0x1d6c59),_0x111e36=document['createElement']('a');_0x111e36[_0x39d92e(0x1bf)](_0x39d92e(0xf3),_0x5487b9),_0x111e36[_0x39d92e(0x1bf)](_0x39d92e(0x192),'dividend_report_'+new Date()[_0x39d92e(0x1a6)](_0x39d92e(0x11e))+_0x39d92e(0x97)),_0x111e36[_0x39d92e(0xf2)](),window['app'][_0x39d92e(0x108)](_0x39d92e(0xec));},window['app']['changeSort']=_0x1da837=>{const _0x2f366a=_0x439e11;state[_0x2f366a(0x120)]===_0x1da837?state[_0x2f366a(0x205)]=state[_0x2f366a(0x205)]===_0x2f366a(0xe2)?_0x2f366a(0x163):_0x2f366a(0xe2):(state[_0x2f366a(0x120)]=_0x1da837,state[_0x2f366a(0x205)]=_0x1da837===_0x2f366a(0xc7)?_0x2f366a(0x163):_0x2f366a(0xe2)),renderTable(state[_0x2f366a(0x1f7)]);},window[_0x439e11(0xa5)][_0x439e11(0xaa)]=()=>{const _0x253ab9=_0x439e11,_0x243c76=document[_0x253ab9(0x12c)](_0x253ab9(0x1bb))[_0x253ab9(0xb7)][_0x253ab9(0x139)]()[_0x253ab9(0xfa)](),_0x11c297=document[_0x253ab9(0x12c)](_0x253ab9(0x14c)),_0x2fc27a=state[_0x253ab9(0x1f7)][_0x253ab9(0x105)](_0xbcad57=>(_0xbcad57[_0x253ab9(0x1f1)]||'')[_0x253ab9(0xfa)]()[_0x253ab9(0xda)](_0x243c76)||(_0xbcad57[_0x253ab9(0x17c)]||'')[_0x253ab9(0x189)]()===_0x243c76);state['searchCandidate']=_0x2fc27a,_0x11c297['disabled']=!_0x2fc27a,_0x11c297['classList'][_0x253ab9(0xbb)](_0x253ab9(0xa1),!_0x2fc27a),_0x11c297[_0x253ab9(0xe0)][_0x253ab9(0xbb)]('cursor-not-allowed',!_0x2fc27a);},window[_0x439e11(0xa5)]['openMemberSearchModal']=()=>{const _0x456260=_0x439e11,_0x5159eb=state[_0x456260(0x182)];if(!_0x5159eb)return;document['getElementById'](_0x456260(0x1e7))[_0x456260(0x10f)]=_0x456260(0xe4)+_0x5159eb[_0x456260(0x1f1)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รหัสสมาชิก:</b>\x20<span\x20class=\x22font-mono\x22>'+_0x5159eb[_0x456260(0x17c)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>สถานะเช็คอิน:</b>\x20<span>'+(_0x5159eb[_0x456260(0xc7)]?_0x456260(0xe6):'ยังไม่เช็คอิน')+_0x456260(0x1ba)+(_0x5159eb[_0x456260(0x208)]?_0x456260(0x191):'ยังไม่ได้รับ')+_0x456260(0x17f),document[_0x456260(0x12c)]('member-search-modal')[_0x456260(0xe0)][_0x456260(0xc9)](_0x456260(0x94)),lucide['createIcons']();},window[_0x439e11(0xa5)][_0x439e11(0x9e)]=async _0x3095d3=>{const _0x413d45=_0x439e11,_0xb33d0c=state[_0x413d45(0x182)];if(!_0xb33d0c)return;const _0x341bc5={};!_0xb33d0c[_0x413d45(0xa3)]||_0xb33d0c[_0x413d45(0xa3)]===''?(_0x341bc5[_0x413d45(0xa3)]=0x1,_0x341bc5['CheckIN']=serverTimestamp(),_0x341bc5[_0x413d45(0xde)]=_0x413d45(0x111)):_0x341bc5[_0x413d45(0xde)]=_0x413d45(0x111);_0x3095d3&&(_0x341bc5[_0x413d45(0x208)]=_0x413d45(0x1c9),_0x341bc5['ConfirmVotingCard']=serverTimestamp());try{await updateDoc(doc(db,finalCollectionPath,_0xb33d0c['id']),_0x341bc5),window[_0x413d45(0xa5)][_0x413d45(0x108)]('ลงทะเบียนพนักงานสำเร็จ'+(_0x3095d3?_0x413d45(0x1fc):'')),window[_0x413d45(0xa5)]['closeMemberSearchModal'](),document[_0x413d45(0x12c)](_0x413d45(0x1bb))['value']='',window['app'][_0x413d45(0xaa)]();}catch(_0xadfeea){window[_0x413d45(0xa5)]['showToast'](_0x413d45(0xf4),'error');}},window['app']['manualConfirmReward']=async _0x3407fd=>{const _0x3b5421=_0x439e11;try{await updateDoc(doc(db,finalCollectionPath,_0x3407fd),{'ConfirmReward':serverTimestamp()}),window[_0x3b5421(0xa5)]['showToast'](_0x3b5421(0x171));}catch(_0x46bc59){window['app'][_0x3b5421(0x108)]('อัปเดตไม่สำเร็จ',_0x3b5421(0xd1));}},window[_0x439e11(0xa5)]['deleteSingleData']=async _0x1b7d2a=>{const _0x5e29fe=_0x439e11;if(confirm(_0x5e29fe(0x16e)))try{await updateDoc(doc(db,finalCollectionPath,_0x1b7d2a),{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'status':deleteField(),'ConfirmReward':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField(),'TimeLogin':deleteField()}),window[_0x5e29fe(0xa5)]['showToast'](_0x5e29fe(0x173));}catch(_0x144937){window[_0x5e29fe(0xa5)][_0x5e29fe(0x108)](_0x5e29fe(0x1e5),'error');}},window['app'][_0x439e11(0x101)]=_0x209958=>{const _0x8a9088=_0x439e11,_0x2dd8fb=state[_0x8a9088(0x17e)][_0x8a9088(0x105)](_0x47e54e=>_0x47e54e['id']===_0x209958);if(!_0x2dd8fb)return;state[_0x8a9088(0x117)]=_0x209958,document[_0x8a9088(0x12c)](_0x8a9088(0x1bd))[_0x8a9088(0xb7)]=_0x2dd8fb[_0x8a9088(0xd0)]||'',document[_0x8a9088(0x12c)](_0x8a9088(0x1cb))[_0x8a9088(0xb7)]=_0x2dd8fb[_0x8a9088(0x154)]||0x1,document[_0x8a9088(0x12c)](_0x8a9088(0x1c7))['value']=_0x2dd8fb[_0x8a9088(0x1ed)]||0x1,document[_0x8a9088(0x12c)](_0x8a9088(0x16f))['classList'][_0x8a9088(0xc9)](_0x8a9088(0x94)),lucide[_0x8a9088(0x157)]();},window['app']['closeEditPrizeModal']=()=>{const _0x2cfbf1=_0x439e11;state['prizeIdToEdit']=null,document['getElementById'](_0x2cfbf1(0x16f))['classList']['add'](_0x2cfbf1(0x94));},window[_0x439e11(0xa5)][_0x439e11(0xc0)]=async()=>{const _0x263c10=_0x439e11;if(!state[_0x263c10(0x117)])return;const _0x12702f=document['getElementById'](_0x263c10(0x1bd))[_0x263c10(0xb7)],_0x2dd4fb=parseInt(document[_0x263c10(0x12c)](_0x263c10(0x1cb))[_0x263c10(0xb7)]),_0x4336d8=parseInt(document[_0x263c10(0x12c)]('edit-prize-total')[_0x263c10(0xb7)]);try{await updateDoc(doc(db,prizesCollectionPath,state[_0x263c10(0x117)]),{'name':_0x12702f,'qtyPerDraw':_0x2dd4fb,'totalQty':_0x4336d8}),window[_0x263c10(0xa5)]['showToast']('แก้ไขข้อมูลรางวัลสำเร็จ'),window[_0x263c10(0xa5)]['closeEditPrizeModal']();}catch(_0x56c873){window[_0x263c10(0xa5)]['showToast'](_0x263c10(0x1b9),_0x263c10(0xd1));}},window[_0x439e11(0xa5)]['resetSingleDividendData']=_0x1988e1=>{const _0x4dabba=_0x439e11;state['dividendIdToReset']=_0x1988e1,document[_0x4dabba(0x12c)](_0x4dabba(0x15d))[_0x4dabba(0xe0)][_0x4dabba(0xc9)]('hidden');},window[_0x439e11(0xa5)][_0x439e11(0x151)]=()=>{const _0x47fc83=_0x439e11;state['dividendIdToReset']=null,document[_0x47fc83(0x12c)]('dividend-single-reset-modal')[_0x47fc83(0xe0)][_0x47fc83(0x1d2)]('hidden');},window[_0x439e11(0xa5)]['confirmSingleDividendReset']=async()=>{const _0x2cc9b6=_0x439e11,_0x9b30b6=state[_0x2cc9b6(0x176)];if(!_0x9b30b6)return;try{await updateDoc(doc(db,dividendCollectionPath,_0x9b30b6),{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()}),window[_0x2cc9b6(0xa5)][_0x2cc9b6(0x108)](_0x2cc9b6(0x173)),window[_0x2cc9b6(0xa5)]['closeSingleDividendResetModal']();}catch(_0x4554b7){window[_0x2cc9b6(0xa5)][_0x2cc9b6(0x108)]('เกิดข้อผิดพลาด',_0x2cc9b6(0xd1));}},window[_0x439e11(0xa5)][_0x439e11(0x1ef)]=_0x3bfe2f=>{const _0x42d82d=_0x439e11,_0xf72e5b=_0x3bfe2f[_0x42d82d(0x1c3)][_0x42d82d(0xf6)][0x0];_0xf72e5b&&(state[_0x42d82d(0x1b3)]=_0xf72e5b,document[_0x42d82d(0x12c)]('file-name')[_0x42d82d(0x152)]=_0xf72e5b['name'],document[_0x42d82d(0x12c)]('file-info')[_0x42d82d(0xe0)][_0x42d82d(0xc9)](_0x42d82d(0x94)),document[_0x42d82d(0x12c)]('btn-import')[_0x42d82d(0x178)]=![]);},window[_0x439e11(0xa5)]['clearFileSelection']=()=>{const _0xcd324c=_0x439e11;state[_0xcd324c(0x1b3)]=null,document[_0xcd324c(0x12c)](_0xcd324c(0x122))['classList'][_0xcd324c(0x1d2)](_0xcd324c(0x94)),document[_0xcd324c(0x12c)](_0xcd324c(0x1e4))[_0xcd324c(0x178)]=!![];},window[_0x439e11(0xa5)][_0x439e11(0x13c)]=_0x419ead=>{const _0x5bbe5a=_0x439e11,_0x24d3a6=_0x419ead['target']['files'][0x0];_0x24d3a6&&(state['dividendFileToImport']=_0x24d3a6,document[_0x5bbe5a(0x12c)](_0x5bbe5a(0x153))[_0x5bbe5a(0x152)]=_0x24d3a6[_0x5bbe5a(0xd0)],document['getElementById']('dividend-file-info')[_0x5bbe5a(0xe0)]['remove'](_0x5bbe5a(0x94)),document['getElementById'](_0x5bbe5a(0x206))['disabled']=![]);},window['app'][_0x439e11(0x1b8)]=()=>{const _0x4177e8=_0x439e11;state[_0x4177e8(0x1c1)]=null,document[_0x4177e8(0x12c)](_0x4177e8(0x126))[_0x4177e8(0xe0)][_0x4177e8(0x1d2)](_0x4177e8(0x94)),document[_0x4177e8(0x12c)](_0x4177e8(0x206))[_0x4177e8(0x178)]=!![];},window[_0x439e11(0xa5)]['processImport']=async()=>{const _0x47c59f=_0x439e11,_0x1fa615=state[_0x47c59f(0x1b3)];if(!_0x1fa615)return;const _0x3d9bb9=await _0x1fa615['text']();let _0x472cb9=_0x1fa615[_0x47c59f(0xd0)][_0x47c59f(0xc6)](_0x47c59f(0x97))?csvToJson(_0x3d9bb9):JSON[_0x47c59f(0x185)](_0x3d9bb9);document[_0x47c59f(0x12c)]('import-progress')['classList'][_0x47c59f(0xc9)](_0x47c59f(0x94));const _0x5b7a4b=_0x472cb9[_0x47c59f(0x175)],_0x21bd0c=0x12c;for(let _0x149ecf=0x0;_0x149ecf<_0x5b7a4b;_0x149ecf+=_0x21bd0c){const _0x477b2f=_0x472cb9[_0x47c59f(0x1b4)](_0x149ecf,_0x149ecf+_0x21bd0c),_0x23b8e2=writeBatch(db);for(const _0x3a1f13 of _0x477b2f){const _0x3e39cd=_0x3a1f13[_0x47c59f(0x124)]||_0x3a1f13[_0x47c59f(0x18f)]||'',_0x26ec2e=await sha256(_0x3e39cd[_0x47c59f(0x189)]()[_0x47c59f(0x19b)](/-/g,'')[_0x47c59f(0x139)]()),_0x47c720=doc(collection(db,finalCollectionPath));_0x23b8e2[_0x47c59f(0x181)](_0x47c720,{..._0x3a1f13,'citizenId':_0x26ec2e,'importedAt':serverTimestamp()});}await _0x23b8e2[_0x47c59f(0x1f9)](),document[_0x47c59f(0x12c)](_0x47c59f(0x125))[_0x47c59f(0x1a3)][_0x47c59f(0xfe)]=(_0x149ecf+_0x477b2f[_0x47c59f(0x175)])/_0x5b7a4b*0x64+'%';}window['app'][_0x47c59f(0x108)](_0x47c59f(0x133)),window['app'][_0x47c59f(0x1a1)]();},window[_0x439e11(0xa5)]['processDividendImport']=async()=>{const _0x5b9f3b=_0x439e11,_0x43fb8e=state[_0x5b9f3b(0x1c1)];if(!_0x43fb8e)return;const _0x25ac6f=await _0x43fb8e[_0x5b9f3b(0x10d)]();let _0x33121c=_0x43fb8e[_0x5b9f3b(0xd0)]['endsWith'](_0x5b9f3b(0x97))?csvToJson(_0x25ac6f):JSON['parse'](_0x25ac6f);document[_0x5b9f3b(0x12c)](_0x5b9f3b(0x1a7))[_0x5b9f3b(0xe0)][_0x5b9f3b(0xc9)]('hidden');const _0x2d4cb9=_0x33121c[_0x5b9f3b(0x175)],_0xc1499a=0x12c;for(let _0x84ddb0=0x0;_0x84ddb0<_0x2d4cb9;_0x84ddb0+=_0xc1499a){const _0x3a035e=_0x33121c[_0x5b9f3b(0x1b4)](_0x84ddb0,_0x84ddb0+_0xc1499a),_0x4d5861=writeBatch(db);for(const _0x26713e of _0x3a035e){const _0x29093f=_0x26713e[_0x5b9f3b(0x124)]||_0x26713e[_0x5b9f3b(0x18f)]||_0x26713e[_0x5b9f3b(0x1f4)]||'',_0xa26c49=_0x29093f?await sha256(_0x29093f[_0x5b9f3b(0x189)]()[_0x5b9f3b(0x19b)](/-/g,'')[_0x5b9f3b(0x139)]()):'',_0x27fedf=doc(collection(db,dividendCollectionPath));_0x4d5861[_0x5b9f3b(0x181)](_0x27fedf,{..._0x26713e,'citizenId':_0xa26c49,'membertype':_0x5b9f3b(0xce),'importedAt':serverTimestamp()});}await _0x4d5861[_0x5b9f3b(0x1f9)](),document['getElementById']('dividend-import-bar')['style']['width']=(_0x84ddb0+_0x3a035e[_0x5b9f3b(0x175)])/_0x2d4cb9*0x64+'%';}window[_0x5b9f3b(0xa5)]['showToast']('นำเข้าข้อมูลปันผลสำเร็จ'),window['app'][_0x5b9f3b(0x1b8)]();},window['app'][_0x439e11(0xa0)]=()=>{const _0x517e5f=_0x439e11;document[_0x517e5f(0x12c)](_0x517e5f(0x1c6))[_0x517e5f(0xb7)]='',document[_0x517e5f(0x12c)]('reset-confirm-modal')[_0x517e5f(0xe0)]['remove'](_0x517e5f(0x94));},window['app'][_0x439e11(0x1d3)]=()=>document[_0x439e11(0x12c)](_0x439e11(0xe1))[_0x439e11(0xe0)]['add']('hidden'),window[_0x439e11(0xa5)][_0x439e11(0x1d7)]=()=>{const _0x28abfd=_0x439e11;document[_0x28abfd(0x12c)](_0x28abfd(0xdb))[_0x28abfd(0xb7)]='',document['getElementById'](_0x28abfd(0x166))[_0x28abfd(0xe0)][_0x28abfd(0xc9)](_0x28abfd(0x94));},window[_0x439e11(0xa5)][_0x439e11(0x1e6)]=()=>document['getElementById'](_0x439e11(0x166))['classList']['add'](_0x439e11(0x94)),window[_0x439e11(0xa5)][_0x439e11(0xff)]=()=>{const _0x3b4b62=_0x439e11;document[_0x3b4b62(0x12c)](_0x3b4b62(0x1a0))[_0x3b4b62(0xb7)]='',document['getElementById'](_0x3b4b62(0x114))[_0x3b4b62(0xe0)]['remove'](_0x3b4b62(0x94));},window[_0x439e11(0xa5)][_0x439e11(0x19d)]=()=>document[_0x439e11(0x12c)](_0x439e11(0x114))['classList'][_0x439e11(0x1d2)]('hidden'),window['app'][_0x439e11(0x135)]=()=>{const _0x5a3aa9=_0x439e11;document[_0x5a3aa9(0x12c)](_0x5a3aa9(0x1ca))[_0x5a3aa9(0xb7)]='',document[_0x5a3aa9(0x12c)](_0x5a3aa9(0x1f6))[_0x5a3aa9(0xe0)][_0x5a3aa9(0xc9)](_0x5a3aa9(0x94));},window[_0x439e11(0xa5)][_0x439e11(0x1ff)]=()=>document[_0x439e11(0x12c)](_0x439e11(0x1f6))[_0x439e11(0xe0)][_0x439e11(0x1d2)](_0x439e11(0x94)),window[_0x439e11(0xa5)][_0x439e11(0x141)]=()=>document[_0x439e11(0x12c)](_0x439e11(0x11d))['classList'][_0x439e11(0x1d2)](_0x439e11(0x94)),window[_0x439e11(0xa5)][_0x439e11(0xd2)]=async()=>{const _0x31a261=_0x439e11;if(document['getElementById'](_0x31a261(0x1c6))[_0x31a261(0xb7)][_0x31a261(0x139)]()!==_0x31a261(0x12e))return window[_0x31a261(0xa5)][_0x31a261(0x108)](_0x31a261(0x186),'error');window[_0x31a261(0xa5)]['closeResetModal']();const _0x42af3e=await getDocs(query(collection(db,finalCollectionPath))),_0x43a402=writeBatch(db);_0x42af3e[_0x31a261(0xfb)](_0x20b810=>_0x43a402['update'](_0x20b810[_0x31a261(0x1d8)],{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField(),'status':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField(),'TimeLogin':deleteField()})),await _0x43a402['commit'](),window[_0x31a261(0xa5)][_0x31a261(0x108)](_0x31a261(0x106));},window[_0x439e11(0xa5)][_0x439e11(0x195)]=async()=>{const _0x2c6653=_0x439e11;if(document['getElementById']('confirm-delete-input')[_0x2c6653(0xb7)][_0x2c6653(0x139)]()!=='Delete')return window['app'][_0x2c6653(0x108)](_0x2c6653(0x109),_0x2c6653(0xd1));window['app'][_0x2c6653(0x1e6)]();const _0x4c6fcd=await getDocs(query(collection(db,finalCollectionPath))),_0x291273=writeBatch(db);_0x4c6fcd[_0x2c6653(0xfb)](_0x31c380=>_0x291273[_0x2c6653(0x11f)](_0x31c380['ref'])),await _0x291273[_0x2c6653(0x1f9)](),window[_0x2c6653(0xa5)]['showToast'](_0x2c6653(0xf0));},window[_0x439e11(0xa5)][_0x439e11(0x18c)]=async()=>{const _0x57ecac=_0x439e11;if(document[_0x57ecac(0x12c)]('confirm-div-reset-input')[_0x57ecac(0xb7)][_0x57ecac(0x139)]()!==_0x57ecac(0x12e))return window[_0x57ecac(0xa5)]['showToast'](_0x57ecac(0xb5),'error');window[_0x57ecac(0xa5)][_0x57ecac(0x19d)]();const _0x35769f=await getDocs(query(collection(db,dividendCollectionPath))),_0x28750d=writeBatch(db);_0x35769f[_0x57ecac(0xfb)](_0x58c6ec=>_0x28750d[_0x57ecac(0x103)](_0x58c6ec[_0x57ecac(0x1d8)],{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()})),await _0x28750d[_0x57ecac(0x1f9)](),window['app'][_0x57ecac(0x108)]('รีเซ็ตสถานะปันผลแล้ว');},window[_0x439e11(0xa5)][_0x439e11(0x1a4)]=async()=>{const _0x328265=_0x439e11;if(document[_0x328265(0x12c)](_0x328265(0x1ca))['value'][_0x328265(0x139)]()!=='Delete')return window['app'][_0x328265(0x108)](_0x328265(0x156),'error');window['app']['closeDeleteAllDividendModal']();const _0x6c14cf=await getDocs(query(collection(db,dividendCollectionPath))),_0x41a868=writeBatch(db);_0x6c14cf[_0x328265(0xfb)](_0xf65d1a=>_0x41a868[_0x328265(0x11f)](_0xf65d1a['ref'])),await _0x41a868['commit'](),window[_0x328265(0xa5)][_0x328265(0x108)](_0x328265(0x1c4));},window[_0x439e11(0xa5)][_0x439e11(0xf1)]=()=>{const _0x47c42c=_0x439e11,_0xe56551=document[_0x47c42c(0x12c)](_0x47c42c(0x13a)),_0x1ef519=_0xe56551[_0x47c42c(0x209)][_0xe56551['selectedIndex']];if(!_0xe56551['value'])return;const _0x324925=parseInt(_0x1ef519[_0x47c42c(0x1ee)][_0x47c42c(0x1b5)]),_0x2723ec=state[_0x47c42c(0x1f7)][_0x47c42c(0xe5)](_0x5b050a=>_0x5b050a[_0x47c42c(0x1d0)]===_0x1ef519[_0x47c42c(0x10d)])['length'],_0xc15866=_0x324925-_0x2723ec;document[_0x47c42c(0x12c)](_0x47c42c(0x1e8))[_0x47c42c(0x152)]=_0xc15866,document[_0x47c42c(0x12c)](_0x47c42c(0xe8))['innerText']=state[_0x47c42c(0xb8)]['notYetDrawn'],document['getElementById']('input-draw-qty')['value']=_0x1ef519[_0x47c42c(0x1ee)][_0x47c42c(0xa6)],window[_0x47c42c(0xa5)][_0x47c42c(0xd7)]();},window[_0x439e11(0xa5)][_0x439e11(0xd7)]=()=>{const _0x3c99af=_0x439e11,_0x5f0ba4=document[_0x3c99af(0x12c)]('select-prize'),_0x38cc05=parseInt(document[_0x3c99af(0x12c)](_0x3c99af(0x155))[_0x3c99af(0xb7)]),_0x2eae91=parseInt(document[_0x3c99af(0x12c)](_0x3c99af(0x1e8))[_0x3c99af(0x152)]),_0x256e92=_0x38cc05>0x0&&_0x38cc05<=_0x2eae91&&_0x5f0ba4['value'];document[_0x3c99af(0x12c)]('btn-start-random')[_0x3c99af(0x178)]=!_0x256e92,document[_0x3c99af(0x12c)](_0x3c99af(0x180))[_0x3c99af(0xe0)][_0x3c99af(0xbb)]('hidden',_0x38cc05<=_0x2eae91);},window[_0x439e11(0xa5)][_0x439e11(0xb6)]=async()=>{const _0x5d1a36=_0x439e11;if(state[_0x5d1a36(0x1f0)])return;const _0xe059a=document[_0x5d1a36(0x12c)](_0x5d1a36(0x13a)),_0x456f52=_0xe059a[_0x5d1a36(0x209)][_0xe059a[_0x5d1a36(0x187)]][_0x5d1a36(0x10d)],_0x7d4cf3=parseInt(document[_0x5d1a36(0x12c)](_0x5d1a36(0x155))[_0x5d1a36(0xb7)]),_0x2ff0df=state[_0x5d1a36(0x1f7)][_0x5d1a36(0xe5)](_0x52c57c=>_0x52c57c[_0x5d1a36(0xde)]===_0x5d1a36(0x111)&&!_0x52c57c[_0x5d1a36(0x1d0)]);if(_0x2ff0df[_0x5d1a36(0x175)]<_0x7d4cf3)return window[_0x5d1a36(0xa5)][_0x5d1a36(0x108)](_0x5d1a36(0x160),_0x5d1a36(0xd1));state[_0x5d1a36(0x1f0)]=!![],document['getElementById'](_0x5d1a36(0xac))[_0x5d1a36(0x178)]=!![],document[_0x5d1a36(0x12c)](_0x5d1a36(0x1e2))[_0x5d1a36(0xe0)][_0x5d1a36(0xc9)](_0x5d1a36(0x94)),await new Promise(_0x3a0c30=>setTimeout(_0x3a0c30,0x3e8)),document[_0x5d1a36(0x12c)](_0x5d1a36(0x1e2))[_0x5d1a36(0xe0)][_0x5d1a36(0x1d2)]('hidden'),document[_0x5d1a36(0x12c)](_0x5d1a36(0x167))[_0x5d1a36(0x10f)]='';const _0x4c9ff5=_0x2ff0df[_0x5d1a36(0xc5)](()=>0.5-Math['random']())[_0x5d1a36(0x1b4)](0x0,_0x7d4cf3);for(let _0x46fbd4=0x0;_0x46fbd4<_0x4c9ff5[_0x5d1a36(0x175)];_0x46fbd4++){const _0x2bc829=_0x4c9ff5[_0x46fbd4],_0x57c46c=document[_0x5d1a36(0x130)]('div');_0x57c46c[_0x5d1a36(0xa8)]=_0x5d1a36(0x146),_0x57c46c[_0x5d1a36(0x10f)]=_0x5d1a36(0x1f8)+_0x2bc829[_0x5d1a36(0x1f1)]+_0x5d1a36(0x1c8)+_0x2bc829[_0x5d1a36(0x17c)]+_0x5d1a36(0x202)+_0x456f52+_0x5d1a36(0x1ab),document[_0x5d1a36(0x12c)](_0x5d1a36(0x167))[_0x5d1a36(0x196)](_0x57c46c),confetti({'particleCount':0x64,'spread':0x46,'origin':{'y':0.6}}),await updateDoc(doc(db,finalCollectionPath,_0x2bc829['id']),{'reward':_0x456f52,'rewardTime':serverTimestamp()});if(_0x46fbd4<_0x4c9ff5[_0x5d1a36(0x175)]-0x1)await new Promise(_0x47a643=>setTimeout(_0x47a643,0x7d0));}state[_0x5d1a36(0x1f0)]=![],window[_0x5d1a36(0xa5)][_0x5d1a36(0xf1)]();};function _0x41e7(_0x414d15,_0x5d05bc){_0x414d15=_0x414d15-0x94;const _0x269600=_0x2696();let _0x41e7d2=_0x269600[_0x414d15];return _0x41e7d2;}function updateCharts(_0x30eaa2){const _0x116a14=_0x439e11,_0x3e095d=Array['from']({'length':0x18},(_0x56434a,_0x149e26)=>_0x149e26+_0x116a14(0x14b)),_0x5b0aad=document[_0x116a14(0x12c)]('registrationChart')?.[_0x116a14(0x174)]('2d');if(!_0x5b0aad)return;window[_0x116a14(0x1ce)]?(window[_0x116a14(0x1ce)]['data']['datasets'][0x0][_0x116a14(0x13f)]=_0x3e095d[_0x116a14(0x13b)]((_0x15caf5,_0x51eee1)=>_0x30eaa2[_0x51eee1]||0x0),window[_0x116a14(0x1ce)]['update']()):window[_0x116a14(0x1ce)]=new Chart(_0x5b0aad,{'type':_0x116a14(0x145),'data':{'labels':_0x3e095d,'datasets':[{'label':_0x116a14(0x1b2),'data':_0x3e095d[_0x116a14(0x13b)]((_0x3b099e,_0x4292e8)=>_0x30eaa2[_0x4292e8]||0x0),'borderColor':'#4f46e5','backgroundColor':'rgba(79,\x2070,\x20229,\x200.1)','fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![]}});}function renderActivityFeed(_0x190417){const _0xf6f32c=_0x439e11,_0x29e669=document[_0xf6f32c(0x12c)](_0xf6f32c(0x1a9));if(!_0x29e669)return;const _0x363415=[];_0x190417[_0xf6f32c(0xfb)](_0x1f8af6=>{const _0x2396a9=_0xf6f32c;if(_0x1f8af6[_0x2396a9(0xc7)])_0x363415[_0x2396a9(0x179)]({'t':'IN','d':_0x1f8af6[_0x2396a9(0xc7)][_0x2396a9(0x1f3)]?.()||new Date(_0x1f8af6['CheckIN']),'n':_0x1f8af6[_0x2396a9(0x1f1)]});}),_0x363415['sort']((_0x3fb4aa,_0x3e5d69)=>_0x3e5d69['d']-_0x3fb4aa['d']),_0x29e669[_0xf6f32c(0x10f)]=_0x363415[_0xf6f32c(0x1b4)](0x0,0xf)[_0xf6f32c(0x13b)](_0x2e47c8=>_0xf6f32c(0xcf)+_0x2e47c8['n']+_0xf6f32c(0x10b)+_0x2e47c8['d'][_0xf6f32c(0x138)](_0xf6f32c(0x11e))+_0xf6f32c(0xcb))[_0xf6f32c(0x204)]('');}const csvToJson=_0x57a0b7=>{const _0x5afee6=_0x439e11,_0x64e0f3=_0x57a0b7[_0x5afee6(0x134)]('\x0a'),_0x30c673=_0x64e0f3[0x0][_0x5afee6(0x134)](',')[_0x5afee6(0x13b)](_0x3e6984=>_0x3e6984[_0x5afee6(0x139)]());return _0x64e0f3[_0x5afee6(0x1b4)](0x1)[_0x5afee6(0x13b)](_0x2061cc=>{const _0x31c6d9=_0x5afee6,_0x2b862c=_0x2061cc[_0x31c6d9(0x134)](',');if(_0x2b862c[_0x31c6d9(0x175)]<_0x30c673['length'])return null;return _0x30c673[_0x31c6d9(0x1ad)]((_0x2d80d8,_0x454bb6,_0xf842e)=>{const _0x38b1e7=_0x31c6d9;return _0x2d80d8[_0x454bb6]=_0x2b862c[_0xf842e]?_0x2b862c[_0xf842e][_0x38b1e7(0x139)]():'',_0x2d80d8;},{});})[_0x5afee6(0xe5)](_0x57c21c=>_0x57c21c);};setInterval(()=>{const _0x5734f2=_0x439e11;if(document['getElementById'](_0x5734f2(0x198)))document[_0x5734f2(0x12c)](_0x5734f2(0x198))[_0x5734f2(0x152)]=new Date()[_0x5734f2(0x138)](_0x5734f2(0x11e));},0x3e8),window[_0x439e11(0xa5)][_0x439e11(0x1e1)]=async _0x54a426=>{const _0x352263=_0x439e11;_0x54a426[_0x352263(0x197)]();const _0x594443=document['getElementById'](_0x352263(0xad))[_0x352263(0xb7)],_0x5009ba=parseInt(document[_0x352263(0x12c)](_0x352263(0x1bc))[_0x352263(0xb7)]),_0x5d7974=parseInt(document[_0x352263(0x12c)](_0x352263(0x119))[_0x352263(0xb7)]);await addDoc(collection(db,prizesCollectionPath),{'name':_0x594443,'qtyPerDraw':_0x5009ba,'totalQty':_0x5d7974,'createdAt':serverTimestamp()}),document[_0x352263(0x12c)](_0x352263(0x16b))[_0x352263(0x18e)](),window[_0x352263(0xa5)]['showToast'](_0x352263(0x115));},window['app'][_0x439e11(0xab)]=async _0x22761f=>{if(confirm('ลบรางวัลนี้?'))await deleteDoc(doc(db,prizesCollectionPath,_0x22761f));},window[_0x439e11(0xa5)][_0x439e11(0x1ea)]=async _0x56aee1=>{const _0x13ffb6=_0x439e11;if(confirm(_0x13ffb6(0x13d)))await updateDoc(doc(db,finalCollectionPath,_0x56aee1),{'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField()});},window[_0x439e11(0xa5)][_0x439e11(0x1e0)]=_0x5c070a=>{const _0x51400e=_0x439e11;state['searchTerm']=_0x5c070a[_0x51400e(0xfa)](),state[_0x51400e(0xdc)]=0x1,renderTable(state[_0x51400e(0x1f7)]);},window[_0x439e11(0xa5)][_0x439e11(0x1b6)]=_0x43ffa8=>{const _0x4e1114=_0x439e11;state[_0x4e1114(0x172)]=_0x43ffa8[_0x4e1114(0xfa)](),renderDividendTable(state[_0x4e1114(0x147)]);},window['app'][_0x439e11(0x17a)]=_0x4ad5a0=>{const _0x35440f=_0x439e11;state[_0x35440f(0xdc)]+=_0x4ad5a0,renderTable(state[_0x35440f(0x1f7)]);};async function init(){const _0x2ed427=_0x439e11;try{await signInAnonymously(auth),document[_0x2ed427(0x12c)](_0x2ed427(0x10a))?.[_0x2ed427(0xe0)]['replace'](_0x2ed427(0xb4),_0x2ed427(0x112));if(document['getElementById'](_0x2ed427(0x203)))document[_0x2ed427(0x12c)]('status-text')[_0x2ed427(0x152)]=_0x2ed427(0xf7);onSnapshot(query(collection(db,finalCollectionPath)),_0x1a6aa6=>processSnapshot(_0x1a6aa6)),onSnapshot(query(collection(db,prizesCollectionPath)),_0x19fdaf=>{const _0x52f8be=_0x2ed427,_0x225f0c=[];let _0x3187db=0x0;_0x19fdaf[_0x52f8be(0xfb)](_0x1e961f=>{const _0x1d8eb9=_0x52f8be,_0x24b32d=_0x1e961f[_0x1d8eb9(0x13f)]();_0x225f0c['push']({'id':_0x1e961f['id'],..._0x24b32d}),_0x3187db+=parseInt(_0x24b32d[_0x1d8eb9(0x1ed)])||0x0;}),state[_0x52f8be(0x17e)]=_0x225f0c,state[_0x52f8be(0xb8)][_0x52f8be(0x1fe)]=_0x3187db;const _0xf9bf8=document['getElementById'](_0x52f8be(0x13a));if(_0xf9bf8)_0xf9bf8[_0x52f8be(0x10f)]=_0x52f8be(0x9f)+_0x225f0c['map'](_0x511a01=>'<option\x20value=\x22'+_0x511a01['id']+'\x22\x20data-qty=\x22'+_0x511a01[_0x52f8be(0x154)]+_0x52f8be(0x1dc)+_0x511a01[_0x52f8be(0x1ed)]+'\x22>'+_0x511a01[_0x52f8be(0xd0)]+'</option>')['join']('');const _0x2a58e4=document[_0x52f8be(0x12c)](_0x52f8be(0x9b));if(_0x2a58e4)_0x2a58e4[_0x52f8be(0x10f)]=_0x225f0c['map'](_0x25c3bb=>_0x52f8be(0xa4)+_0x25c3bb[_0x52f8be(0xd0)]+_0x52f8be(0x1cd)+_0x25c3bb[_0x52f8be(0x154)]+_0x52f8be(0x19c)+_0x25c3bb[_0x52f8be(0x1ed)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20px-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-end\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.openEditPrizeModal(\x27'+_0x25c3bb['id']+_0x52f8be(0x16d)+_0x25c3bb['id']+_0x52f8be(0x1c5))[_0x52f8be(0x204)]('');lucide[_0x52f8be(0x157)]();}),onSnapshot(query(collection(db,dividendCollectionPath)),_0x7b0c5a=>{const _0x57b195=_0x2ed427,_0x51698c=[];let _0x47eed5=0x0,_0xd42fa4=0x0,_0x4b7556=0x0;_0x7b0c5a[_0x57b195(0xfb)](_0x256b9b=>{const _0x565da4=_0x57b195,_0x57e596=_0x256b9b[_0x565da4(0x13f)]();_0x51698c['push']({'id':_0x256b9b['id'],..._0x57e596});if(_0x57e596['DateLogin'])_0x47eed5++;if(_0x57e596[_0x565da4(0x140)]&&_0x57e596[_0x565da4(0x140)]!==''){if(_0x57e596[_0x565da4(0x142)]==='ไม่เข้าร่วม')_0x4b7556++;else _0xd42fa4++;}}),state[_0x57b195(0x147)]=_0x51698c,state[_0x57b195(0xb8)]['dividendTotal']=_0x7b0c5a[_0x57b195(0x1ec)],state[_0x57b195(0xb8)]['divRegistered']=_0x47eed5,state[_0x57b195(0xb8)][_0x57b195(0x1fa)]=_0xd42fa4,state[_0x57b195(0xb8)][_0x57b195(0x1c2)]=_0x4b7556,updateDashboardUI(state[_0x57b195(0xb8)]);if(!document[_0x57b195(0x12c)](_0x57b195(0x1a2))['classList']['contains'](_0x57b195(0x94)))renderDividendTable(_0x51698c);}),window['app']['switchTab'](_0x2ed427(0xbe));}catch(_0x201d7b){console[_0x2ed427(0xd1)](_0x201d7b);}}init(),lucide[_0x439e11(0x157)]();
    </script>
</body>
</html>
