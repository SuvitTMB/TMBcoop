<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Table Compact styling */
        .table-compact thead tr { height: 50px; }
        .table-compact tbody tr { height: 45px; font-size: 0.95rem; }
        .table-compact tbody tr:nth-child(even) { background-color: #f8fafc; }
        .table-compact td, .table-compact th { vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem; }

        /* Specific height for live results table as requested (40px) */
        .table-results tbody tr { height: 40px !important; }
        .table-results tbody td { 
            height: 40px !important; 
            padding-top: 0 !important; 
            padding-bottom: 0 !important; 
            font-size: 0.85rem; 
            line-height: 1.2;
        }

        .sortable-header { cursor: pointer; user-select: none; transition: background 0.2s; }
        .sortable-header:hover { background-color: rgba(0,0,0,0.05); }

        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-[100] flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="play-circle" width="20"></i> ระบบสุ่มรางวัล
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('dividend-info')" id="nav-dividend-info" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="badge-dollar-sign" width="20"></i> ข้อมูลเงินปันผล
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="qr-code" width="20"></i> QR Code ลงทะเบียน
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="qr-code" width="20"></i> QR Code เช็คปันผล
                </button>
            </div>

            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">System Info</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="database" width="20"></i> Upload ข้อมูลสมาชิก
                </button>
                <button onclick="window.app.switchTab('dividend')" id="nav-dividend" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="wallet" width="20"></i> Upload ข้อมูลปันผล
                </button>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวม (Dashboard)</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">A</div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-slate-600"><i data-lucide="database" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">จำนวนสมาชิกทั้งหมด</p>
                        <h3 id="dash-stat-total" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-blue-600"><i data-lucide="users" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเข้า</p>
                        <h3 id="dash-stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-emerald-600"><i data-lucide="check-square" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">สมาชิกรับบัตรเลือกตั้ง</p>
                        <h3 id="dash-stat-voting" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-indigo-600"><i data-lucide="log-in" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเงินปันผล</p>
                        <h3 id="dash-stat-div-reg" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-green-600"><i data-lucide="user-check" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">สมาชิกยืนยันเข้าร่วมประชุม</p>
                        <h3 id="dash-stat-div-join" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียน (Real-time)</h3>
                            <div class="h-64"><canvas id="registrationChart"></canvas></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full"> 
                        <h3 class="font-bold text-lg mb-4 text-slate-700">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1 max-h-[400px]">
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZES -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 h-fit">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2"><i data-lucide="plus-circle" class="text-indigo-600"></i> เพิ่มของรางวัล</h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-indigo-100 outline-none text-sm">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">สุ่มต่อรอบ</label>
                                    <input type="number" id="prize-qty" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">รวมทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition text-sm">บันทึกของรางวัล</button>
                        </form>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg mb-4 text-slate-800">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left table-compact">
                                <thead class="bg-slate-200 font-bold">
                                    <tr>
                                        <th class="px-4 py-3">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">สุ่ม/รอบ</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-blue-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-indigo-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้มีสิทธิ์ลุ้นรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-slate-400">
                        <p class="text-slate-600 text-xs font-bold uppercase">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-red-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มไม่ได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-no" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-green-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-win" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    <div class="lg:col-span-4 bg-white p-6 rounded-2xl shadow-md border">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-slate-800"><i data-lucide="settings-2"></i> ตั้งค่าการสุ่ม</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">เลือกของรางวัล</label>
                                <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border rounded-xl outline-none bg-white text-sm">
                                    <option value="">-- เลือกของรางวัล --</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">จำนวนสุ่มต่อรอบ (คน)</label>
                                <input type="number" id="input-draw-qty" value="1" min="1" max="100" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border rounded-xl text-center text-lg font-bold outline-none text-sm">
                                <p id="qty-warning" class="text-xs text-red-500 mt-1 hidden font-bold">สุ่มเกินสต็อกคงเหลือ!</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-xl border space-y-2">
                                <div class="flex justify-between text-sm"><span class="text-slate-500">คงเหลือในสต็อก</span><span id="label-stock-count" class="font-bold text-orange-600 text-lg text-sm">0</span></div>
                                <div class="flex justify-between text-sm"><span class="text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span><span id="label-eligible-count" class="font-bold text-indigo-600 text-lg text-sm">0</span></div>
                            </div>
                            <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-40 active:scale-95 transition-all flex items-center justify-center gap-2 text-lg text-sm">
                                <i data-lucide="play" width="24" class="fill-current"></i> เริ่มการสุ่มรางวัล
                            </button>
                        </div>
                    </div>
                    <div class="lg:col-span-8 bg-slate-900 rounded-3xl h-[600px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700">
                        <div class="text-center mb-6 relative z-10 border-b border-white/10 pb-4">
                            <h1 id="screen-prize-title" class="text-2xl font-bold text-yellow-400 tracking-widest uppercase italic text-sm">LUCKY DRAW SYSTEM</h1>
                        </div>
                        <div id="screen-display-area" class="flex-1 overflow-y-auto custom-scroll-dark pr-2 space-y-4 relative z-10">
                            <div class="flex flex-col items-center justify-center h-full opacity-20 text-white">
                                <i data-lucide="gift" width="64" height="64" class="mb-4"></i>
                                <p class="text-lg font-bold">READY TO SPIN</p>
                            </div>
                        </div>
                        <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/90 backdrop-blur-sm z-20 flex items-center justify-center">
                            <div class="text-white text-center">
                                <div class="w-20 h-20 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                <h2 class="text-2xl font-bold uppercase tracking-widest">Randomizing...</h2>
                                <p class="text-indigo-400 mt-2 text-sm">กรุณารอสักครู่ ระบบกำลังสุ่มรายชื่อ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนรางวัลทั้งหมด</p>
                        <h3 id="res-stat-total-prizes" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">รางวัลที่ได้สุ่มแล้ว</p>
                        <h3 id="res-stat-total-drawn" class="text-2xl font-bold text-blue-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนผู้ได้รับรางวัล</p>
                        <h3 id="res-stat-winners" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัลแล้ว</p>
                        <h3 id="res-stat-claimed" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 ">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ที่ยังไม่มารับรางวัล</p>
                        <h3 id="res-stat-unclaimed" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b flex justify-between items-center bg-slate-200">
                        <h3 class="font-bold text-lg text-slate-800">รายชื่อผู้โชคดี (เรียลไทม์)</h3>
                        <div class="flex items-center gap-4">
                            <select id="filter-results-status" onchange="window.app.renderResults()" class="border p-2 text-sm rounded-lg outline-none bg-white">
                                <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                                <option value="unclaimed">ยังไม่ยืนยันสิทธิ์</option>
                                <option value="claimed">ยืนยันรับรางวัลแล้ว</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left table-compact table-results">
                            <thead class="bg-slate-200 font-bold border-b text-slate-700">
                                <tr>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('index')">
                                        ลำดับ <span id="rsort-index"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="rsort-EmpName"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('reward')">
                                        รางวัลที่ได้ <span id="rsort-reward"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('rewardTime')">
                                        เวลาที่สุ่มได้ <span id="rsort-rewardTime"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('ConfirmReward')">
                                        สถานะการรับรางวัล <span id="rsort-ConfirmReward"></span>
                                    </th>
                                    <th class="px-6 py-4 text-right text-xs">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE (REGISTRATION) -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border flex flex-col md:flex-row gap-4 items-end">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-slate-600 mb-2">ค้นหาสมาชิกเพื่อลงทะเบียน (รหัส/ชื่อ)</label>
                        <input type="text" id="member-search-input" oninput="window.app.validateMemberSearch()" placeholder="ใส่รหัสสมาชิก หรือ ชื่อ..." class="w-full p-3 border rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                    </div>
                    <button id="member-search-btn" onclick="window.app.openMemberSearchModal()" disabled class="px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold opacity-50 cursor-not-allowed hover:bg-indigo-700 transition flex items-center gap-2 text-sm">
                        <i data-lucide="search" width="20"></i> ค้นหารายชื่อ
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิก</p>
                        <h3 id="reg-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">ลงทะเบียนแล้ว</p>
                        <h3 id="reg-stat-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">รับบัตรเลือกตั้งแล้ว</p>
                        <h3 id="reg-stat-voting" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัล</p>
                        <h3 id="reg-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-4 border-b flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4 text-slate-800">
                        <h3 class="font-bold text-lg">ข้อมูลพนักงานลงทะเบียนทั้งหมด</h3>
                        <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="กรองในตาราง..." class="p-2 border rounded-lg text-sm outline-none bg-white w-full md:w-64 text-sm">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-300 font-bold border-b text-slate-700 sticky top-0 z-10">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeSort('EmpMember')">
                                        no <span id="sort-EmpMember"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="sort-EmpName"></span>
                                    </th>
                                    <th class="text-sm text-center">จำนวน</th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CheckIN')">
                                        Check-In <span id="sort-CheckIN"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CardPoll')">
                                        รับบัตร <span id="sort-CardPoll"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmVotingCard')">
                                        วันที่รับบัตร <span id="sort-ConfirmVotingCard"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('reward')">
                                        รางวัล <span id="sort-reward"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmReward')">
                                        วันที่รับรางวัล <span id="sort-ConfirmReward"></span>
                                    </th>
                                    <th class="text-center text-sm">สถานะรางวัล</th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <p id="data-table-info" class="text-slate-400 font-medium">กำลังดึงข้อมูล...</p>
                            <div class="flex gap-2">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100 text-xs" id="btn-prev">Prev</button>
                                <span id="page-indicator" class="font-bold self-center px-4 text-sm">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100 text-xs" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 10: DIVIDEND INFO -->
            <div id="view-dividend-info" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิกรวม</p>
                        <h3 id="div-summary-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนลงทะเบียน</p>
                        <h3 id="div-summary-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งเข้าร่วม</p>
                        <h3 id="div-summary-join" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งไม่เข้าร่วม</p>
                        <h3 id="div-summary-nojoin" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border overflow-hidden">
                    <div class="p-6 border-b bg-slate-200 flex justify-between items-center text-sm">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลเงินปันผล (Dividend)</h3>
                        <input type="text" id="search-dividend" oninput="window.app.handleDividendSearch(this.value)" placeholder="ค้นหารหัส/ชื่อ..." class="p-2 border rounded-lg text-sm outline-none w-64 bg-white">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 font-bold">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeDivSort('no')">
                                        ลำดับ <span id="dsort-no"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeDivSort('empname')">
                                        ชื่อ-นามสกุล <span id="dsort-empname"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('dividend')">
                                        ปันผล <span id="dsort-dividend"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('moneyback')">
                                        เงินเฉลี่ยคืน <span id="dsort-moneyback"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('gratuity')">
                                        เงินสมนาคุณ <span id="dsort-gratuity"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('netpayment')">
                                        รวมปันผล <span id="dsort-netpayment"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('DateLogin')">
                                        ลงทะเบียน <span id="dsort-DateLogin"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('RegisMeeting')">
                                        แจ้งเข้าร่วม <span id="dsort-RegisMeeting"></span>
                                    </th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="dividend-table-body" class="divide-y"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <div class="flex items-center gap-4">
                                <p id="div-table-info" class="text-slate-400 font-medium text-xs">แสดงผล...</p>
                                <button onclick="window.app.downloadDividendCSV()" class="px-4 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-xs font-bold transition flex items-center gap-2 shadow-sm">
                                    <i data-lucide="download" width="14"></i> Download CSV File
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: IMPORT & DIVIDEND MANAGE -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center text-sm">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนรายชื่อพนักงานทั้งหมดในระบบ</p>
                        <h3 id="manage-total-docs" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-full text-blue-600 text-sm">
                        <i data-lucide="users" width="32"></i>
                    </div>
                </div>
                
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit text-sm">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-blue-600"><i data-lucide="upload-cloud"></i> Upload ข้อมูลสมาชิก</h3>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium text-xs">ลากไฟล์มาวางที่นี่ หรือ คลิกเพื่อเลือกไฟล์ (.json, .csv)</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-4 rounded-xl flex justify-between items-center text-sm text-blue-700">
                                <span id="file-name" class="font-bold"></span>
                                <button onclick="window.app.clearFileSelection()" class="hover:text-red-500 transition text-sm text-sm"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-blue-700 text-sm text-sm">เริ่มประมวลผลนำเข้าข้อมูลพนักงาน</button>
                            <div id="import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="import-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit text-sm">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4">
                            <button onclick="window.app.openResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-sm text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะการลงทะเบียนพนักงาน
                            </button>
                            <button onclick="window.app.openDeleteAllModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-sm text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลพนักงานทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: DIVIDEND MANAGE (IMPORT) -->
            <div id="view-dividend" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนสมาชิกปันผลทั้งหมดในระบบ</p>
                        <h3 id="manage-dividend-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-emerald-100 p-3 rounded-full text-emerald-600 text-2xl">
                        <i data-lucide="wallet" width="32"></i>
                    </div>
                </div>

                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit text-sm">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-emerald-600"><i data-lucide="wallet"></i> Upload ข้อมูลปันผล</h3>
                        <div class="space-y-4 text-sm">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('dividend-file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium text-xs text-sm">เลือกไฟล์ข้อมูลเงินปันผล (.json, .csv)</p>
                                <input type="file" id="dividend-file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleDividendFileSelect(event)">
                            </div>
                            <div id="dividend-file-info" class="hidden bg-emerald-50 p-4 rounded-xl flex justify-between items-center text-sm text-emerald-700 text-sm">
                                <span id="dividend-file-name" class="font-bold text-sm text-sm"></span>
                                <button onclick="window.app.clearDividendFileSelection()" class="hover:text-red-500 transition text-sm text-sm"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processDividendImport()" id="btn-dividend-import" disabled class="w-full bg-emerald-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-emerald-700 text-sm text-sm">เริ่มประมวลผลนำเข้าข้อมูลเงินปันผล</button>
                            <div id="dividend-import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="dividend-import-bar" class="bg-emerald-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit text-sm text-sm text-sm">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm text-sm text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4 text-sm">
                            <button onclick="window.app.openDividendResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-xs text-sm text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะปันผลทั้งหมด
                            </button>
                            <button onclick="window.app.openDeleteAllDividendModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-xs text-sm text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลเงินปันผลทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: QR Code IN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-blue-800 mb-6 tracking-widest text-center">QR Code ลงทะเบียน</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-register.png" alt="Check-IN QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
            <!-- VIEW: QR Code OUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-orange-600 mb-6 tracking-widest text-center">QR Code เช็คปันผล</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-dividend.png" alt="Check-OUT QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- LIGHTBOX MODALS -->
    
    <!-- Confirm Reset Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2">รีเซ็ตสถานะ?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm">Reset</span> เพื่อยืนยันการล้างข้อมูล Check-IN/OUT</p>
            <input type="text" id="confirm-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold text-sm text-sm" placeholder="พิมพ์ Reset">
            <div class="flex gap-4">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-sm text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 text-sm text-sm text-sm text-sm">รีเซ็ตข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Modal -->
    <div id="delete-all-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2 text-red-600 text-sm text-sm text-sm">ลบข้อมูลทั้งหมด?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm">Delete</span> เพื่อยืนยันการลบข้อมูลพนักงาน</p>
            <input type="text" id="confirm-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold text-sm text-sm text-sm text-sm text-sm" placeholder="พิมพ์ Delete">
            <div class="flex gap-4">
                <button onclick="window.app.closeDeleteAllModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs text-sm text-sm text-sm text-sm text-sm text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-700 text-xs text-sm text-sm text-sm text-sm text-sm text-sm text-sm">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Confirm Reset Dividend Modal -->
    <div id="dividend-reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2 text-sm text-sm text-sm text-sm text-sm">รีเซ็ตสถานะปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm text-sm">Reset</span> เพื่อรีเซ็ตการรับปันผล</p>
            <input type="text" id="confirm-div-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold text-sm text-sm text-sm text-sm text-sm" placeholder="พิมพ์ Reset">
            <div class="flex gap-4 text-sm">
                <button onclick="window.app.closeDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs">ยกเลิก</button>
                <button onclick="window.app.confirmResetDividendData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold text-xs text-sm">รีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Dividend Modal -->
    <div id="dividend-delete-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2 text-red-600 text-sm text-sm text-sm text-sm text-sm">ลบฐานปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm text-sm text-sm text-sm">Delete</span> เพื่อลบข้อมูลปันผลถาวร</p>
            <input type="text" id="confirm-div-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold text-sm text-sm text-sm text-sm text-sm text-sm text-sm text-sm">
            <div class="flex gap-4 text-sm text-sm">
                <button onclick="window.app.closeDeleteAllDividendModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllDividendData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold text-xs">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Single Dividend Reset Modal -->
    <div id="dividend-single-reset-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="alert-triangle" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2">ล้างข้อมูลเงินปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">คุณกำลังจะล้างสถานะการลงทะเบียนและการแจ้งเข้าร่วมของสมาชิกท่านนี้</p>
            <div class="flex gap-4">
                <button onclick="window.app.closeSingleDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmSingleDividendReset()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition text-sm">ยืนยันการล้างข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="member-search-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center text-sm text-sm">
            <div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="user" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-4">ข้อมูลพนักงาน</h3>
            <div id="search-member-details" class="text-left bg-slate-50 p-6 rounded-2xl mb-8 space-y-2 text-sm border italic text-sm text-sm text-sm"></div>
            <div class="flex flex-col gap-3 text-sm">
                <div class="flex gap-2">
                    <button onclick="window.app.closeMemberSearchModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                    <button id="btn-confirm-regis" onclick="window.app.confirmRegistrationViaSearch(false)" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition text-sm">ลงทะเบียน</button>
                </div>
                <button id="btn-confirm-regis-card" onclick="window.app.confirmRegistrationViaSearch(true)" class="w-full py-4 rounded-xl bg-emerald-600 text-white font-bold hover:bg-emerald-700 transition text-sm shadow-lg flex items-center justify-center gap-2">
                    <i data-lucide="check-square" width="18"></i> ยืนยันการรับบัตรเลือกตั้ง
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK Logic -->
    <script type="module">
const _0x4e1024=_0x3f6a;(function(_0x2cd6b2,_0x4d85aa){const _0x575b18=_0x3f6a,_0x3adc83=_0x2cd6b2();while(!![]){try{const _0xa4c241=-parseInt(_0x575b18(0x2af))/0x1*(-parseInt(_0x575b18(0x199))/0x2)+parseInt(_0x575b18(0x2ba))/0x3*(-parseInt(_0x575b18(0x281))/0x4)+parseInt(_0x575b18(0x24a))/0x5+parseInt(_0x575b18(0x254))/0x6*(-parseInt(_0x575b18(0x19c))/0x7)+-parseInt(_0x575b18(0x2ec))/0x8*(parseInt(_0x575b18(0x201))/0x9)+parseInt(_0x575b18(0x263))/0xa*(-parseInt(_0x575b18(0x228))/0xb)+parseInt(_0x575b18(0x2c7))/0xc*(parseInt(_0x575b18(0x2cd))/0xd);if(_0xa4c241===_0x4d85aa)break;else _0x3adc83['push'](_0x3adc83['shift']());}catch(_0x4029e0){_0x3adc83['push'](_0x3adc83['shift']());}}}(_0x3ab8,0x57198));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const firebaseConfig={'apiKey':_0x4e1024(0x1f1),'authDomain':'ttb-register.firebaseapp.com','databaseURL':_0x4e1024(0x1d6),'projectId':'ttb-register','storageBucket':_0x4e1024(0x28b),'messagingSenderId':_0x4e1024(0x218),'appId':'1:1070273157855:web:5c8120e1df27e233d8676a','measurementId':'G-9DJLWJ5LQ1'},finalCollectionPath=_0x4e1024(0x2b6),prizesCollectionPath=_0x4e1024(0x20e),dividendCollectionPath=_0x4e1024(0x1a9),app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'dividendUsers':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0,'votingCards':0x0,'dividendTotal':0x0,'divRegistered':0x0,'divJoin':0x0,'divNoJoin':0x0,'totalPrizesQuota':0x0,'totalPrizesDrawn':0x0},'isDrawing':![],'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x4e1024(0x1b5),'sortOrder':_0x4e1024(0x1f3),'searchTerm':'','divRowsPerPage':0x32,'divCurrentPage':0x1,'divSearchTerm':'','divSortBy':'DateLogin','divSortOrder':_0x4e1024(0x1f3),'fileToImport':null,'dividendFileToImport':null,'searchCandidate':null,'resultsSortBy':_0x4e1024(0x1ad),'resultsSortOrder':'asc','dividendIdToReset':null};async function sha256(_0x5b57ce){const _0x224dfb=_0x4e1024,_0x14e03e=new TextEncoder()[_0x224dfb(0x26c)](_0x5b57ce),_0x56d757=await crypto['subtle'][_0x224dfb(0x232)](_0x224dfb(0x1a8),_0x14e03e),_0x245311=Array[_0x224dfb(0x2ed)](new Uint8Array(_0x56d757));return _0x245311[_0x224dfb(0x238)](_0x2636e8=>_0x2636e8['toString'](0x10)[_0x224dfb(0x278)](0x2,'0'))[_0x224dfb(0x1ff)]('');}window['app']=window[_0x4e1024(0x2b2)]||{},window['app'][_0x4e1024(0x2b9)]=(_0x17c04f,_0x4ce283=_0x4e1024(0x1f2))=>{const _0x539cce=_0x4e1024,_0x2f4bb1=document['getElementById']('toast-container'),_0x39bc64=document[_0x539cce(0x1cf)]('div');let _0x263de9=_0x4ce283===_0x539cce(0x1f2)?_0x539cce(0x248):'border-red-500\x20text-red-700',_0x4d04d2=_0x4ce283===_0x539cce(0x1f2)?'check-circle':_0x539cce(0x225);_0x39bc64[_0x539cce(0x1cb)]=_0x539cce(0x193)+_0x263de9+'\x20p-4\x20rounded-lg\x20shadow-xl\x20flex\x20items-center\x20gap-3\x20toast-enter\x20pointer-events-auto',_0x39bc64[_0x539cce(0x1ba)]=_0x539cce(0x2e7)+_0x4d04d2+_0x539cce(0x2fb)+_0x17c04f+_0x539cce(0x196),_0x2f4bb1[_0x539cce(0x1a0)](_0x39bc64),lucide['createIcons'](),setTimeout(()=>{const _0x9ac06b=_0x539cce;_0x39bc64[_0x9ac06b(0x1a5)][_0x9ac06b(0x2cc)]('opacity-0',_0x9ac06b(0x241)),setTimeout(()=>_0x39bc64[_0x9ac06b(0x249)](),0x12c);},0xbb8);},window[_0x4e1024(0x2b2)]['switchTab']=_0x45968d=>{const _0x3c7dc4=_0x4e1024;document[_0x3c7dc4(0x275)](_0x3c7dc4(0x180))[_0x3c7dc4(0x277)](_0x3e9e83=>_0x3e9e83[_0x3c7dc4(0x1a5)]['add'](_0x3c7dc4(0x291)));const _0x3ad2b2=document[_0x3c7dc4(0x2b4)](_0x3c7dc4(0x2ae)+_0x45968d);if(_0x3ad2b2)_0x3ad2b2[_0x3c7dc4(0x1a5)]['remove'](_0x3c7dc4(0x291));document[_0x3c7dc4(0x275)]('.nav-item')['forEach'](_0x35ad7f=>{const _0x40a0d5=_0x3c7dc4;_0x35ad7f[_0x40a0d5(0x1a5)]['remove'](_0x40a0d5(0x25c),_0x40a0d5(0x2f1)),_0x35ad7f[_0x40a0d5(0x1a5)]['add']('text-slate-400');});const _0xb29884=document[_0x3c7dc4(0x2b4)](_0x3c7dc4(0x229)+_0x45968d);_0xb29884&&(_0xb29884[_0x3c7dc4(0x1a5)][_0x3c7dc4(0x249)](_0x3c7dc4(0x2e9)),_0xb29884['classList']['add'](_0x3c7dc4(0x25c),_0x3c7dc4(0x2f1)));let _0x56f2c5={'dashboard':_0x3c7dc4(0x2e1),'prizes':_0x3c7dc4(0x27c),'randomizer':_0x3c7dc4(0x19a),'results':'ประกาศผลรางวัล','data':_0x3c7dc4(0x1c9),'dividend-info':'ข้อมูลเงินปันผล','import':_0x3c7dc4(0x1ac),'dividend':_0x3c7dc4(0x2f9),'qrcode-in':_0x3c7dc4(0x2df),'qrcode-out':_0x3c7dc4(0x2c2)};document[_0x3c7dc4(0x2b4)]('page-title')[_0x3c7dc4(0x217)]=_0x56f2c5[_0x45968d]||_0x45968d;if(_0x45968d==='data')renderTable(state['users']);if(_0x45968d===_0x3c7dc4(0x1ab))renderDividendTable(state[_0x3c7dc4(0x1f7)]);if(_0x45968d===_0x3c7dc4(0x1da))window[_0x3c7dc4(0x2b2)]['onPrizeSelect']();if(_0x45968d===_0x3c7dc4(0x1a7))window[_0x3c7dc4(0x2b2)][_0x3c7dc4(0x300)]();lucide['createIcons']();};function _0x3f6a(_0x1a9e34,_0x2d511b){_0x1a9e34=_0x1a9e34-0x17f;const _0x3ab86d=_0x3ab8();let _0x3f6a9b=_0x3ab86d[_0x1a9e34];return _0x3f6a9b;}function processSnapshot(_0x4f38b8){const _0x309c57=_0x4e1024,_0x373ce3=[],_0x3038a3={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':_0x4f38b8['size'],'notYetDrawn':0x0,'votingCards':0x0,'totalPrizesDrawn':0x0},_0x5d5112={};_0x4f38b8[_0x309c57(0x277)](_0x28cb23=>{const _0x3df555=_0x309c57,_0xa35b08=_0x28cb23[_0x3df555(0x1e6)](),_0x3efd4d={'id':_0x28cb23['id'],..._0xa35b08};_0x373ce3[_0x3df555(0x1c7)](_0x3efd4d);if(_0xa35b08[_0x3df555(0x1b5)]){_0x3038a3['checkin']++;const _0x197b8f=(_0xa35b08[_0x3df555(0x1b5)][_0x3df555(0x1d4)]?.()||new Date(_0xa35b08[_0x3df555(0x1b5)]))[_0x3df555(0x1c0)]();_0x5d5112[_0x197b8f]=(_0x5d5112[_0x197b8f]||0x0)+0x1;}_0xa35b08[_0x3df555(0x223)]&&_0x3038a3['checkout']++;if(_0xa35b08[_0x3df555(0x2d4)]==='รับบัตรเลือกตั้ง')_0x3038a3[_0x3df555(0x2b7)]++;if(_0xa35b08[_0x3df555(0x1ad)]){if(_0xa35b08[_0x3df555(0x1ad)]===_0x3df555(0x1a4))_0x3038a3[_0x3df555(0x1aa)]++;else _0x3038a3['rewarded']++,_0x3038a3[_0x3df555(0x240)]++;}if(_0xa35b08[_0x3df555(0x1bb)])_0x3038a3[_0x3df555(0x2d0)]++;if(_0xa35b08[_0x3df555(0x2b1)]==='Active'){_0x3038a3[_0x3df555(0x2da)]++;if(!_0xa35b08['reward'])_0x3038a3[_0x3df555(0x2a1)]++;}}),state[_0x309c57(0x2d2)]=_0x373ce3,state[_0x309c57(0x1ed)]={...state[_0x309c57(0x1ed)],..._0x3038a3},updateDashboardUI(state[_0x309c57(0x1ed)]),updateCharts(_0x5d5112),renderActivityFeed(_0x373ce3),renderTable(_0x373ce3),window['app'][_0x309c57(0x300)]();}function updateDashboardUI(_0x3ba5ab){const _0x3b65f6=_0x4e1024,_0x4634af=[_0x3b65f6(0x18c),_0x3b65f6(0x1c8),_0x3b65f6(0x274),_0x3b65f6(0x19e),_0x3b65f6(0x20f),_0x3b65f6(0x302),'rand-stat-eligible-view','rand-stat-noreward',_0x3b65f6(0x2ce),_0x3b65f6(0x20b),_0x3b65f6(0x1a2),_0x3b65f6(0x22f),_0x3b65f6(0x2e0),_0x3b65f6(0x2a7),_0x3b65f6(0x2d6),'div-summary-total',_0x3b65f6(0x295),_0x3b65f6(0x1f9),_0x3b65f6(0x283),_0x3b65f6(0x2b0),_0x3b65f6(0x17f),'dash-stat-total',_0x3b65f6(0x1a1),'dash-stat-voting',_0x3b65f6(0x239),_0x3b65f6(0x2ea),_0x3b65f6(0x20c),'dash-stat-div-join'],_0x54bc1b={'stat-checkin':_0x3ba5ab['checkin'],'stat-checkout':_0x3ba5ab['checkout'],'stat-noreward':_0x3ba5ab[_0x3b65f6(0x1aa)],'stat-rewarded':_0x3ba5ab[_0x3b65f6(0x269)],'stat-claimed':_0x3ba5ab[_0x3b65f6(0x2d0)],'rand-stat-total':_0x3ba5ab['totalDocs'],'rand-stat-eligible-view':_0x3ba5ab[_0x3b65f6(0x2da)],'rand-stat-noreward':_0x3ba5ab[_0x3b65f6(0x2a1)],'rand-stat-drawn-no':_0x3ba5ab[_0x3b65f6(0x1aa)],'rand-stat-drawn-win':_0x3ba5ab[_0x3b65f6(0x269)],'manage-total-docs':_0x3ba5ab[_0x3b65f6(0x2cb)],'reg-stat-total':_0x3ba5ab[_0x3b65f6(0x2cb)],'reg-stat-registered':_0x3ba5ab['checkin'],'reg-stat-voting':_0x3ba5ab[_0x3b65f6(0x2b7)],'reg-stat-rewarded':_0x3ba5ab[_0x3b65f6(0x269)],'div-summary-total':_0x3ba5ab[_0x3b65f6(0x1bf)],'div-summary-registered':_0x3ba5ab[_0x3b65f6(0x1af)],'div-summary-join':_0x3ba5ab[_0x3b65f6(0x294)],'div-summary-nojoin':_0x3ba5ab[_0x3b65f6(0x1db)],'res-stat-total-drawn':_0x3ba5ab[_0x3b65f6(0x240)],'manage-dividend-total':_0x3ba5ab[_0x3b65f6(0x1bf)],'dash-stat-total':_0x3ba5ab[_0x3b65f6(0x2cb)],'dash-stat-checkin':_0x3ba5ab[_0x3b65f6(0x29b)],'dash-stat-voting':_0x3ba5ab[_0x3b65f6(0x2b7)],'dash-stat-noreward':_0x3ba5ab['notRewarded'],'dash-stat-rewarded':_0x3ba5ab['rewarded'],'dash-stat-div-reg':_0x3ba5ab['divRegistered'],'dash-stat-div-join':_0x3ba5ab[_0x3b65f6(0x294)]};_0x4634af['forEach'](_0x18ea76=>{const _0x29956f=_0x3b65f6;if(document[_0x29956f(0x2b4)](_0x18ea76))document['getElementById'](_0x18ea76)[_0x29956f(0x217)]=_0x54bc1b[_0x18ea76]||0x0;});const _0x1eea44=document[_0x3b65f6(0x2b4)](_0x3b65f6(0x21f));if(_0x1eea44)_0x1eea44['style'][_0x3b65f6(0x2f2)]=_0x3ba5ab[_0x3b65f6(0x29b)]>0x0?_0x3ba5ab['checkout']/_0x3ba5ab[_0x3b65f6(0x29b)]*0x64+'%':'0%';}window[_0x4e1024(0x2b2)][_0x4e1024(0x300)]=()=>{const _0x451f0e=_0x4e1024,_0x154f6b=document['getElementById'](_0x451f0e(0x246))?.[_0x451f0e(0x1f6)]||'all_winners',_0x3dde29=state['users'][_0x451f0e(0x2fc)](_0x3a7008=>_0x3a7008[_0x451f0e(0x1ad)]&&_0x3a7008['reward']!==_0x451f0e(0x1a4))[_0x451f0e(0x29f)],_0x318d4f=state[_0x451f0e(0x2d2)][_0x451f0e(0x2fc)](_0x5f33b1=>_0x5f33b1[_0x451f0e(0x1bb)])[_0x451f0e(0x29f)],_0x19bc11=_0x3dde29-_0x318d4f,_0x34814c=document[_0x451f0e(0x2b4)](_0x451f0e(0x1f4));if(_0x34814c)_0x34814c[_0x451f0e(0x217)]=state['stats']['totalPrizesQuota']||0x0;const _0x49082a=document[_0x451f0e(0x2b4)](_0x451f0e(0x2b0));if(_0x49082a)_0x49082a[_0x451f0e(0x217)]=state[_0x451f0e(0x1ed)][_0x451f0e(0x240)]||0x0;const _0x193760=document[_0x451f0e(0x2b4)](_0x451f0e(0x24d));if(_0x193760)_0x193760['innerText']=_0x3dde29;const _0x3b721f=document[_0x451f0e(0x2b4)]('res-stat-claimed');if(_0x3b721f)_0x3b721f['innerText']=_0x318d4f;const _0x43ab4a=document['getElementById'](_0x451f0e(0x2e4));if(_0x43ab4a)_0x43ab4a[_0x451f0e(0x217)]=_0x19bc11;let _0x45ee29=state[_0x451f0e(0x2d2)][_0x451f0e(0x2fc)](_0x8cd3f8=>_0x8cd3f8[_0x451f0e(0x1ad)]);if(_0x154f6b==='unclaimed')_0x45ee29=_0x45ee29[_0x451f0e(0x2fc)](_0x30c1f9=>!_0x30c1f9[_0x451f0e(0x1bb)]);if(_0x154f6b===_0x451f0e(0x2d0))_0x45ee29=_0x45ee29[_0x451f0e(0x2fc)](_0x1b3e18=>_0x1b3e18[_0x451f0e(0x1bb)]);_0x45ee29['sort']((_0x664c1,_0x58671d)=>{const _0x812aa2=_0x451f0e;let _0x35d4b1=_0x664c1[state[_0x812aa2(0x18d)]],_0x1eb892=_0x58671d[state['resultsSortBy']];if(state[_0x812aa2(0x18d)]==='rewardTime'||state[_0x812aa2(0x18d)]==='ConfirmReward'){_0x35d4b1=_0x35d4b1?.[_0x812aa2(0x1d4)]?.()||(_0x35d4b1?new Date(_0x35d4b1):null),_0x1eb892=_0x1eb892?.['toDate']?.()||(_0x1eb892?new Date(_0x1eb892):null);if(!_0x35d4b1)return 0x1;if(!_0x1eb892)return-0x1;return state['resultsSortOrder']==='asc'?_0x35d4b1-_0x1eb892:_0x1eb892-_0x35d4b1;}return _0x35d4b1=String(_0x35d4b1||'')[_0x812aa2(0x1eb)](),_0x1eb892=String(_0x1eb892||'')[_0x812aa2(0x1eb)](),state['resultsSortOrder']==='asc'?_0x35d4b1['localeCompare'](_0x1eb892):_0x1eb892[_0x812aa2(0x292)](_0x35d4b1);});const _0x483d52=[_0x451f0e(0x181),_0x451f0e(0x1ad),_0x451f0e(0x27f),_0x451f0e(0x1bb)];_0x483d52['forEach'](_0x36f0dc=>{const _0x1e82e3=_0x451f0e,_0x622338=document[_0x1e82e3(0x2b4)](_0x1e82e3(0x2c1)+_0x36f0dc);_0x622338&&(state[_0x1e82e3(0x18d)]===_0x36f0dc?_0x622338[_0x1e82e3(0x1ba)]=state[_0x1e82e3(0x256)]===_0x1e82e3(0x282)?_0x1e82e3(0x1f0):'<i\x20data-lucide=\x22chevron-down\x22></i>':_0x622338['innerHTML']=_0x1e82e3(0x1b4));});const _0x1a5a9d=document[_0x451f0e(0x2b4)](_0x451f0e(0x205));if(!_0x1a5a9d)return;if(_0x45ee29[_0x451f0e(0x29f)]===0x0){_0x1a5a9d['innerHTML']=_0x451f0e(0x200);return;}_0x1a5a9d[_0x451f0e(0x1ba)]=_0x45ee29['map']((_0x5c3580,_0x30edd7)=>{const _0xed3e1e=_0x451f0e,_0x2897e5=_0x5c3580[_0xed3e1e(0x27f)]?(_0x5c3580[_0xed3e1e(0x27f)][_0xed3e1e(0x1d4)]?.()||new Date(_0x5c3580[_0xed3e1e(0x27f)]))[_0xed3e1e(0x276)](_0xed3e1e(0x191)):'-';let _0x696d38='-';if(_0x5c3580['ConfirmReward'])_0x696d38='<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x20text-xs\x22>รับแล้ว</span>';else _0x5c3580[_0xed3e1e(0x1ad)]&&_0x5c3580[_0xed3e1e(0x1ad)]!==_0xed3e1e(0x1a4)&&(_0x696d38=_0xed3e1e(0x258)+_0x5c3580['id']+_0xed3e1e(0x18f));return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20font-mono\x20text-slate-500\x20text-xs\x22>'+(_0x30edd7+0x1)+_0xed3e1e(0x2f7)+(_0x5c3580[_0xed3e1e(0x181)]||'-')+_0xed3e1e(0x27e)+_0x5c3580[_0xed3e1e(0x1ad)]+_0xed3e1e(0x2d7)+_0x2897e5+_0xed3e1e(0x289)+_0x696d38+_0xed3e1e(0x1df)+_0x5c3580['id']+_0xed3e1e(0x27d);})[_0x451f0e(0x1ff)](''),lucide['createIcons']();},window[_0x4e1024(0x2b2)]['changeResSort']=_0x4fa73c=>{const _0x17bd10=_0x4e1024;state['resultsSortBy']===_0x4fa73c?state[_0x17bd10(0x2fa)]=state[_0x17bd10(0x2fa)]===_0x17bd10(0x282)?_0x17bd10(0x1f3):_0x17bd10(0x282):(state[_0x17bd10(0x18d)]=_0x4fa73c,state[_0x17bd10(0x2fa)]=_0x17bd10(0x282)),window['app'][_0x17bd10(0x300)]();};function _0x3ab8(){const _0x4af224=['</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','confirm-delete-input','QR\x20Code\x20ลงทะเบียน','reg-stat-registered','ภาพรวม','trim','download','res-stat-unclaimed','netpayment','import-bar','<i\x20data-lucide=\x22','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20font-bold\x20text-emerald-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','text-slate-400','dash-stat-rewarded','divSearchTerm','216WFsTVr','from','</p></div><span\x20class=\x22text-xs\x20font-bold\x20bg-indigo-100\x20text-indigo-700\x20px-3\x20py-1\x20rounded-lg\x20uppercase\x20text-sm\x22>','ลำดับ','toString','text-white','width','split','dividend-file-upload','Page\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>สถานะเช็คอิน:</b>\x20<span\x20class=\x22text-sm\x20text-sm\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','ยังไม่ได้รับ','Upload\x20ข้อมูลปันผล','resultsSortOrder','\x22\x20width=\x2220\x22></i><div\x20class=\x22flex-1\x20text-sm\x20font-bold\x20text-xs\x20text-xs\x20text-xs\x22>','filter','page-indicator','current-time','toLocaleString','renderResults','Reset','rand-stat-total','\x20px-2\x20py-0.5\x20rounded\x20text-sm\x22>','ไม่เข้าร่วม','</option>','manage-dividend-total','.view-section','EmpName','ลงทะเบียน','getContext','<span\x20class=\x22text-slate-400\x20text-[10px]\x20italic\x20text-sm\x22>ไม่ได้รับ</span>','Online\x20(Connected)','parse','rowsPerPage','searchCandidate','includes','changePage','visibility','stat-checkin','resultsSortBy','div','\x27)\x22\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x20hover:bg-red-200\x20transition\x20text-xs\x22>ยังไม่รับ</button>','target','th-TH','\x27)\x22\x20class=\x22text-slate-300\x20hover:text-red-500\x20transition\x20text-xs\x20text-xs\x20text-xs\x22\x20title=\x22ล้างข้อมูล\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','bg-white\x20border-l-4\x20','ชื่อ-นามสกุล','handleDividendFileSelect','</div>','isDrawing','resetSingleDividendData','2ayCPLU','ระบบสุ่มรางวัล','changeDivSort','3082751oxjLgP','text','stat-rewarded','deletePrize','appendChild','dash-stat-checkin','manage-total-docs','empname','ไม่ได้รับรางวัล','classList','files','results','SHA-256','tmb_coop_dividend','notRewarded','dividend-info','Upload\x20ข้อมูลสมาชิก','reward','processImport','divRegistered','พิมพ์\x20Reset\x20เพื่อยืนยัน','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รับบัตรเลือกตั้ง:</b>\x20<span\x20class=\x22text-sm\x20text-sm\x20text-sm\x22>','changeSort','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-2\x20gap-y-3\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>ชื่อ-นามสกุล:</b>\x20<span\x20class=\x22font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x22>','<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22opacity-30\x22></i>','CheckIN','total','<span\x20class=\x22text-emerald-600\x20font-bold\x22>รับแล้ว</span>','Delete','body','innerHTML','ConfirmReward','citizenID','</span>','<div\x20class=\x22text-[10px]\x20text-slate-500\x20font-normal\x20mt-0.5\x20text-xs\x20text-xs\x20text-xs\x22>เข้าระบบตรวจสอบเงินปันผล</div>','dividendTotal','getHours','dividendIdToReset','divSortOrder','ยืนยันว่าพนักงานได้รับรางวัลแล้ว?','delete-all-confirm-modal','disabled','บันทึกรางวัลสำเร็จ','push','stat-checkout','ข้อมูลลงทะเบียน','dividend-single-reset-modal','className','qtyPerDraw','totalQty','label-eligible-count','createElement','</p><p\x20class=\x22text-xs\x20text-slate-400\x20font-mono\x20text-sm\x22>NO:\x20','searchTerm','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-blue-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','ล้างข้อมูลสมาชิกปันผลสำเร็จ','toDate','validateMemberSearch','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','<div\x20class=\x22flex\x20items-center\x20gap-3\x20p-3\x20bg-slate-50\x20rounded-xl\x20text-sm\x20border-l-4\x20border-indigo-500\x20shadow-sm\x20font-medium\x22><span\x20class=\x22font-bold\x20text-indigo-700\x20text-sm\x22>','search-member-details','general-modal','randomizer','divNoJoin','แจ้งเข้าร่วม','closeMemberSearchModal','error','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><button\x20onclick=\x22window.app.resetWinnerStatus(\x27','</td><td\x20class=\x22text-right\x20px-4\x20text-sm\x22><button\x20onclick=\x22window.app.deletePrize(\x27','dividend-import-progress','member-search-btn','ref','\x27)\x22\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x20hover:bg-red-200\x20transition\x20text-sm\x22>ยังไม่รับ</button>','line','data',':00','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x20text-slate-500\x20text-sm\x22>','Download\x20CSV\x20สำเร็จ','btn-dividend-import','toLowerCase','DateLogin','stats','reset-confirm-modal','confirmDeleteAllData','<i\x20data-lucide=\x22chevron-up\x22></i>','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','success','desc','res-stat-total-prizes','manualConfirmReward','value','dividendUsers','ConfirmVotingCard','div-summary-join','screen-display-area','createIcons','dividend','แสดงผล\x20','\x22\x20data-qty=\x22','join','<tr><td\x20colspan=\x226\x22\x20class=\x22text-center\x20py-8\x20text-slate-400\x20text-xs\x20text-xs\x22>ไม่พบข้อมูล</td></tr>','216963QZvGhS','removeChild','moneyback','resetWinnerStatus','results-table-body','regChartInst','citizenId','dividend_report_','Active','slice','rand-stat-drawn-win','dash-stat-div-reg','options','coop_gift','stat-claimed','<span\x20class=\x22text-xs\x20font-normal\x20text-white\x20','.csv','file-name','<tr><td>','validateRandomizerInput','prizes','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','innerText','1070273157855','ปันผล','\x20จากทั้งหมด\x20','closeResetModal','import-progress','endsWith','style','bar-checkout','เกิดข้อผิดพลาด','dividendFileToImport','replace','CheckOUT','btn-next','alert-circle','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','confirmSingleDividendReset','4902799eCECzz','nav-','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20transition\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td></tr>','dividend-delete-confirm-modal','ลบรางวัลนี้ออกจากระบบ?','closeDeleteAllDividendModal','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับแล้ว</span>','reg-stat-total','text/csv;charset=utf-8;','switchTab','digest','<span\x20class=\x22text-green-600\x20font-bold\x22>เช็คอินแล้ว</span>','RegisMeeting','dataset','</span></div>','status-text','map','dash-stat-noreward','confirm-div-delete-input','พิมพ์\x20Delete\x20เพื่อยืนยัน','openDividendResetModal','dividend-file-name','currentPage','delete','totalPrizesDrawn','translate-x-full','เงินเฉลี่ยคืน','\x20of\x20','gratuity','div-table-info','filter-results-status','รับบัตรเลือกตั้ง','border-green-500\x20text-green-700','remove','2458950qDrJAv','sort-','EmpMember','res-stat-winners','dividend-import-bar','confirmDeleteAllDividendData','#4f46e5','bg-green-500','</span>\x20<span\x20class=\x22flex-1\x20text-sm\x22>','ลบพนักงานทั้งหมดแล้ว','6YkcdDD','closeDeleteAllModal','sortOrder','bg-red-500','<button\x20onclick=\x22window.app.manualConfirmReward(\x27','prize-form','ลบฐานข้อมูลเงินปันผลแล้ว','recent-activity-list','bg-slate-700','size','</td><td\x20class=\x22text-center\x20font-bold\x20text-blue-600\x20text-sm\x22>','เกิดข้อผิดพลาดในการบันทึก','qty-warning','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-700\x20text-sm\x22>','ลงทะเบียนพนักงานสำเร็จ','10WYNvee','TimeLogin','view-dividend-info','เข้าร่วม','openDeleteAllModal','นำเข้าข้อมูลปันผลสำเร็จ','rewarded','clearFileSelection','random','encode','commit','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','\x20พร้อมยืนยันรับบัตร','startRandomizer','member-search-modal','DateMeeting','closeSingleDividendResetModal','stat-noreward','querySelectorAll','toLocaleTimeString','forEach','padStart','prize-qty','sortBy','rgba(79,\x2070,\x20229,\x200.1)','จัดการของรางวัล','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20transition\x20text-xs\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','rewardTime','registrationChart','4YWaiio','asc','div-summary-nojoin','fileToImport','member-search-input','dividend-table-body','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','divSortBy','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','นำเข้าข้อมูลรายชื่อสำเร็จ','ttb-register.firebasestorage.app','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รหัสสมาชิก:</b>\x20<span\x20class=\x22font-mono\x20text-sm\x20text-sm\x20text-sm\x22>','handleFileSelect','cursor-not-allowed','confirmResetData','confirmRegistrationViaSearch','hidden','localeCompare','select-prize','divJoin','div-summary-registered','\x22\x20data-total=\x22','clearDividendFileSelection','<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x20text-xs\x22></i>','toLocaleDateString','file-info','checkin','screen-overlay-controls','name','ล้างข้อมูลสำเร็จ','length','เงินสมนาคุณ','notYetDrawn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20MODIFIED:\x20Count\x20Column\x20only\x20shows\x20TimeLogin\x20now\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20font-bold\x20text-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<option\x20value=\x22\x22>--\x20เลือกของรางวัล\x20--</option>','click','sort','label-stock-count','reg-stat-voting','confirm-reset-input','dividend-reset-confirm-modal','handlePrizeSubmit','handleDividendSearch','update','input-draw-qty','view-','176198DidXsG','res-stat-total-drawn','status','app','handleSearch','getElementById','closeDividendResetModal','tmb_coop','votingCards','preventDefault','showToast','544668tswljQ','confirm-div-reset-input','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','closeGeneralModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','dashboard','btn-import','rsort-','QR\x20Code\x20เช็คปันผล','href','createObjectURL','set','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.deleteSingleData(\x27','12hJopgU','\x20รายการ','toggle','<i\x20data-lucide=\x22chevron-up\x22\x20class=\x22inline\x20w-3\x22></i>','totalDocs','add','18295147VeHDZs','rand-stat-drawn-no','<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22inline\x20w-3\x20opacity-30\x22></i>','claimed','setAttribute','users','table-body','CardPoll','ล้างข้อมูลสถานะของพนักงานคนนี้ทั้งหมด?\x20(ล้างข้อมูลรางวัลและการลงทะเบียน)','reg-stat-rewarded','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20text-slate-500\x20font-mono\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','btn-start-random','onPrizeSelect','eligible','totalPrizesQuota','dividend-file-info'];_0x3ab8=function(){return _0x4af224;};return _0x3ab8();}function renderTable(_0x23d268){const _0x45e8c4=_0x4e1024,_0x280ff0=document[_0x45e8c4(0x2b4)](_0x45e8c4(0x2d3));if(!_0x280ff0)return;let _0x10379e=[..._0x23d268];state[_0x45e8c4(0x1d1)]&&(_0x10379e=_0x10379e['filter'](_0x52bd0d=>(_0x52bd0d['EmpName']||'')[_0x45e8c4(0x1eb)]()[_0x45e8c4(0x189)](state['searchTerm'])||(_0x52bd0d[_0x45e8c4(0x24c)]||'')[_0x45e8c4(0x2f0)]()[_0x45e8c4(0x189)](state[_0x45e8c4(0x1d1)])));_0x10379e[_0x45e8c4(0x2a5)]((_0x5d97d6,_0x5a6b9c)=>{const _0x57d8cb=_0x45e8c4;let _0x3b5d89=_0x5d97d6[state[_0x57d8cb(0x27a)]],_0x5a28ac=_0x5a6b9c[state['sortBy']];if([_0x57d8cb(0x1b5),_0x57d8cb(0x1f8),_0x57d8cb(0x1bb)][_0x57d8cb(0x189)](state[_0x57d8cb(0x27a)])){_0x3b5d89=_0x3b5d89?.['toDate']?.()||(_0x3b5d89?new Date(_0x3b5d89):null),_0x5a28ac=_0x5a28ac?.[_0x57d8cb(0x1d4)]?.()||(_0x5a28ac?new Date(_0x5a28ac):null);if(!_0x3b5d89)return 0x1;if(!_0x5a28ac)return-0x1;return state[_0x57d8cb(0x256)]==='asc'?_0x3b5d89-_0x5a28ac:_0x5a28ac-_0x3b5d89;}if(state[_0x57d8cb(0x27a)]===_0x57d8cb(0x24c))return state[_0x57d8cb(0x256)]===_0x57d8cb(0x282)?(parseInt(_0x3b5d89)||0x0)-(parseInt(_0x5a28ac)||0x0):(parseInt(_0x5a28ac)||0x0)-(parseInt(_0x3b5d89)||0x0);return _0x3b5d89=String(_0x3b5d89||'')[_0x57d8cb(0x1eb)](),_0x5a28ac=String(_0x5a28ac||'')[_0x57d8cb(0x1eb)](),state[_0x57d8cb(0x256)]===_0x57d8cb(0x282)?_0x3b5d89[_0x57d8cb(0x292)](_0x5a28ac):_0x5a28ac[_0x57d8cb(0x292)](_0x3b5d89);});const _0x1e1207=[_0x45e8c4(0x24c),_0x45e8c4(0x181),_0x45e8c4(0x1b5),_0x45e8c4(0x2d4),'ConfirmVotingCard',_0x45e8c4(0x1ad),_0x45e8c4(0x1bb)];_0x1e1207[_0x45e8c4(0x277)](_0x3c05e8=>{const _0x56da00=_0x45e8c4,_0x218ed2=document[_0x56da00(0x2b4)](_0x56da00(0x24b)+_0x3c05e8);_0x218ed2&&(state['sortBy']===_0x3c05e8?_0x218ed2[_0x56da00(0x1ba)]=state[_0x56da00(0x256)]===_0x56da00(0x282)?_0x56da00(0x2ca):'<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x22></i>':_0x218ed2['innerHTML']=_0x56da00(0x2cf));});const _0x2d5014=state[_0x45e8c4(0x187)],_0x19fbc2=Math['ceil'](_0x10379e[_0x45e8c4(0x29f)]/_0x2d5014)||0x1,_0x26ecbb=_0x10379e[_0x45e8c4(0x20a)]((state[_0x45e8c4(0x23e)]-0x1)*_0x2d5014,state[_0x45e8c4(0x23e)]*_0x2d5014);if(document[_0x45e8c4(0x2b4)]('page-indicator'))document[_0x45e8c4(0x2b4)](_0x45e8c4(0x2fd))[_0x45e8c4(0x217)]=_0x45e8c4(0x2f5)+state[_0x45e8c4(0x23e)]+_0x45e8c4(0x243)+_0x19fbc2;if(document[_0x45e8c4(0x2b4)]('btn-prev'))document[_0x45e8c4(0x2b4)]('btn-prev')[_0x45e8c4(0x1c5)]=state['currentPage']<=0x1;if(document[_0x45e8c4(0x2b4)]('btn-next'))document[_0x45e8c4(0x2b4)](_0x45e8c4(0x224))['disabled']=state[_0x45e8c4(0x23e)]>=_0x19fbc2;_0x280ff0[_0x45e8c4(0x1ba)]=_0x26ecbb[_0x45e8c4(0x238)](_0x31e436=>{const _0x1d6d92=_0x45e8c4,_0xe40983=_0x31e436[_0x1d6d92(0x1b5)]?(_0x31e436[_0x1d6d92(0x1b5)][_0x1d6d92(0x1d4)]?.()||new Date(_0x31e436[_0x1d6d92(0x1b5)]))['toLocaleTimeString'](_0x1d6d92(0x191)):'-',_0x46c8a5=_0x31e436['ConfirmVotingCard']?(_0x31e436[_0x1d6d92(0x1f8)]['toDate']?.()||new Date(_0x31e436['ConfirmVotingCard']))['toLocaleString'](_0x1d6d92(0x191)):'-',_0x130d47=_0x31e436[_0x1d6d92(0x1bb)]?(_0x31e436['ConfirmReward']['toDate']?.()||new Date(_0x31e436['ConfirmReward']))[_0x1d6d92(0x2ff)](_0x1d6d92(0x191)):'-';let _0x44bfa5='-';if(_0x31e436[_0x1d6d92(0x1bb)])_0x44bfa5=_0x1d6d92(0x22e);else{if(_0x31e436['reward']&&_0x31e436[_0x1d6d92(0x1ad)]!==_0x1d6d92(0x1a4))_0x44bfa5=_0x1d6d92(0x258)+_0x31e436['id']+_0x1d6d92(0x1e4);else _0x31e436[_0x1d6d92(0x1ad)]===_0x1d6d92(0x1a4)&&(_0x44bfa5=_0x1d6d92(0x184));}return _0x1d6d92(0x1e8)+(_0x31e436[_0x1d6d92(0x24c)]||'-')+_0x1d6d92(0x261)+(_0x31e436[_0x1d6d92(0x181)]||'-')+_0x1d6d92(0x2a2)+(_0x31e436[_0x1d6d92(0x264)]||'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-medium\x20text-slate-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+_0xe40983+_0x1d6d92(0x1d2)+(_0x31e436[_0x1d6d92(0x2d4)]||'-')+_0x1d6d92(0x2bc)+_0x46c8a5+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-indigo-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+(_0x31e436[_0x1d6d92(0x1ad)]||'-')+_0x1d6d92(0x226)+_0x130d47+_0x1d6d92(0x2be)+_0x44bfa5+_0x1d6d92(0x2c6)+_0x31e436['id']+_0x1d6d92(0x192);})[_0x45e8c4(0x1ff)](''),lucide[_0x45e8c4(0x1fb)]();}function renderDividendTable(_0xe719cf){const _0xa613b=_0x4e1024,_0x1fc3a3=document[_0xa613b(0x2b4)](_0xa613b(0x286));if(!_0x1fc3a3)return;let _0x4fae40=[..._0xe719cf];state['divSearchTerm']&&(_0x4fae40=_0x4fae40['filter'](_0x708e2e=>(_0x708e2e[_0xa613b(0x1a3)]||'')[_0xa613b(0x1eb)]()[_0xa613b(0x189)](state[_0xa613b(0x2eb)])||(_0x708e2e['no']||'')[_0xa613b(0x2f0)]()[_0xa613b(0x189)](state[_0xa613b(0x2eb)])));_0x4fae40[_0xa613b(0x2a5)]((_0x239c64,_0x21339b)=>{const _0x515675=_0xa613b;let _0x2fb06c=_0x239c64[state[_0x515675(0x288)]],_0x4bb991=_0x21339b[state[_0x515675(0x288)]];if(state[_0x515675(0x288)]==='DateLogin'){_0x2fb06c=_0x2fb06c?.['toDate']?.()||(_0x2fb06c?new Date(_0x2fb06c):null),_0x4bb991=_0x4bb991?.['toDate']?.()||(_0x4bb991?new Date(_0x4bb991):null);if(!_0x2fb06c)return 0x1;if(!_0x4bb991)return-0x1;return state[_0x515675(0x1c2)]===_0x515675(0x282)?_0x2fb06c-_0x4bb991:_0x4bb991-_0x2fb06c;}if([_0x515675(0x1fc),_0x515675(0x203),_0x515675(0x244),_0x515675(0x2e5),'no']['includes'](state[_0x515675(0x288)]))return state['divSortOrder']===_0x515675(0x282)?(parseFloat(_0x2fb06c)||0x0)-(parseFloat(_0x4bb991)||0x0):(parseFloat(_0x4bb991)||0x0)-(parseFloat(_0x2fb06c)||0x0);return _0x2fb06c=String(_0x2fb06c||'')[_0x515675(0x1eb)](),_0x4bb991=String(_0x4bb991||'')[_0x515675(0x1eb)](),state[_0x515675(0x1c2)]===_0x515675(0x282)?_0x2fb06c['localeCompare'](_0x4bb991):_0x4bb991[_0x515675(0x292)](_0x2fb06c);});const _0x5ad56b=['no',_0xa613b(0x1a3),_0xa613b(0x1fc),_0xa613b(0x203),_0xa613b(0x244),_0xa613b(0x2e5),_0xa613b(0x1ec),_0xa613b(0x234)];_0x5ad56b['forEach'](_0xa600fa=>{const _0x1df547=_0xa613b,_0x2570ac=document[_0x1df547(0x2b4)]('dsort-'+_0xa600fa);_0x2570ac&&(state[_0x1df547(0x288)]===_0xa600fa?_0x2570ac[_0x1df547(0x1ba)]=state[_0x1df547(0x1c2)]==='asc'?_0x1df547(0x2ca):_0x1df547(0x298):_0x2570ac[_0x1df547(0x1ba)]=_0x1df547(0x2cf));});const _0x318cee=_0x4fae40[_0xa613b(0x20a)](0x0,0x64),_0x4f66c2=document[_0xa613b(0x2b4)](_0xa613b(0x245));if(_0x4f66c2)_0x4f66c2[_0xa613b(0x217)]=_0xa613b(0x1fd)+_0x318cee[_0xa613b(0x29f)]+_0xa613b(0x21a)+_0x4fae40['length']+_0xa613b(0x2c8);_0x1fc3a3['innerHTML']=_0x318cee['map'](_0xfefc3a=>{const _0x2a85a5=_0xa613b;let _0x646b9='-';if(_0xfefc3a[_0x2a85a5(0x272)]&&_0xfefc3a['DateMeeting']!==''){const _0x11540f=_0xfefc3a[_0x2a85a5(0x234)]===_0x2a85a5(0x304)?_0x2a85a5(0x257):_0x2a85a5(0x251);_0x646b9=_0x2a85a5(0x210)+_0x11540f+_0x2a85a5(0x303)+(_0xfefc3a[_0x2a85a5(0x234)]||'เข้าร่วม')+_0x2a85a5(0x1bd);}const _0x437219=_0xfefc3a['login']?_0x2a85a5(0x1be):'<div\x20class=\x22text-[10px]\x20text-slate-500\x20font-normal\x20mt-0.5\x20text-xs\x20text-xs\x20text-xs\x22>-</div>',_0x3e5632=_0xfefc3a[_0x2a85a5(0x1ec)]?(_0xfefc3a[_0x2a85a5(0x1ec)][_0x2a85a5(0x1d4)]?.()||new Date(_0xfefc3a[_0x2a85a5(0x1ec)]))[_0x2a85a5(0x2ff)](_0x2a85a5(0x191)):'-',_0x236b4d=_0xfefc3a['DateLogin']?'<div\x20class=\x22text-black-600\x20text-sm\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x3e5632+'</div>':'-';return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x20text-sm\x22>'+(_0xfefc3a['no']||'-')+_0x2a85a5(0x26e)+(_0xfefc3a[_0x2a85a5(0x1a3)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+parseFloat(_0xfefc3a['dividend']||0x0)[_0x2a85a5(0x2ff)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+parseFloat(_0xfefc3a[_0x2a85a5(0x203)]||0x0)[_0x2a85a5(0x2ff)]()+_0x2a85a5(0x287)+parseFloat(_0xfefc3a[_0x2a85a5(0x244)]||0x0)['toLocaleString']()+_0x2a85a5(0x2e8)+parseFloat(_0xfefc3a[_0x2a85a5(0x2e5)]||0x0)['toLocaleString']()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x236b4d+_0x2a85a5(0x2dd)+_0x646b9+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><button\x20onclick=\x22window.app.resetSingleDividendData(\x27'+_0xfefc3a['id']+'\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-500\x20transition\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';})[_0xa613b(0x1ff)](''),lucide[_0xa613b(0x1fb)]();}window['app'][_0x4e1024(0x19b)]=_0x3fe77d=>{const _0x62095e=_0x4e1024;state['divSortBy']===_0x3fe77d?state[_0x62095e(0x1c2)]=state[_0x62095e(0x1c2)]===_0x62095e(0x282)?_0x62095e(0x1f3):_0x62095e(0x282):(state[_0x62095e(0x288)]=_0x3fe77d,state[_0x62095e(0x1c2)]=_0x3fe77d===_0x62095e(0x1ec)?_0x62095e(0x1f3):_0x62095e(0x282)),renderDividendTable(state[_0x62095e(0x1f7)]);},window['app']['downloadDividendCSV']=()=>{const _0x30fe76=_0x4e1024,_0x14da96=state['dividendUsers'];let _0x452118=[..._0x14da96];state[_0x30fe76(0x2eb)]&&(_0x452118=_0x452118[_0x30fe76(0x2fc)](_0x2f029d=>(_0x2f029d[_0x30fe76(0x1a3)]||'')[_0x30fe76(0x1eb)]()[_0x30fe76(0x189)](state[_0x30fe76(0x2eb)])||(_0x2f029d['no']||'')[_0x30fe76(0x2f0)]()[_0x30fe76(0x189)](state[_0x30fe76(0x2eb)])));_0x452118[_0x30fe76(0x2a5)]((_0x59e97a,_0x5dd454)=>{const _0x34c936=_0x30fe76;let _0x7b5edc=_0x59e97a[state['divSortBy']],_0x5a2ad8=_0x5dd454[state[_0x34c936(0x288)]];if(state[_0x34c936(0x288)]==='DateLogin'){_0x7b5edc=_0x7b5edc?.[_0x34c936(0x1d4)]?.()||(_0x7b5edc?new Date(_0x7b5edc):null),_0x5a2ad8=_0x5a2ad8?.[_0x34c936(0x1d4)]?.()||(_0x5a2ad8?new Date(_0x5a2ad8):null);if(!_0x7b5edc)return 0x1;if(!_0x5a2ad8)return-0x1;return state[_0x34c936(0x1c2)]===_0x34c936(0x282)?_0x7b5edc-_0x5a2ad8:_0x5a2ad8-_0x7b5edc;}if([_0x34c936(0x1fc),_0x34c936(0x203),_0x34c936(0x244),_0x34c936(0x2e5),'no']['includes'](state[_0x34c936(0x288)]))return state[_0x34c936(0x1c2)]===_0x34c936(0x282)?(parseFloat(_0x7b5edc)||0x0)-(parseFloat(_0x5a2ad8)||0x0):(parseFloat(_0x5a2ad8)||0x0)-(parseFloat(_0x7b5edc)||0x0);return _0x7b5edc=String(_0x7b5edc||'')[_0x34c936(0x1eb)](),_0x5a2ad8=String(_0x5a2ad8||'')['toLowerCase'](),state[_0x34c936(0x1c2)]==='asc'?_0x7b5edc[_0x34c936(0x292)](_0x5a2ad8):_0x5a2ad8[_0x34c936(0x292)](_0x7b5edc);});const _0x1ddd94=[_0x30fe76(0x2ef),_0x30fe76(0x194),_0x30fe76(0x219),_0x30fe76(0x242),_0x30fe76(0x2a0),'รวมปันผล',_0x30fe76(0x182),_0x30fe76(0x1dc)],_0x8ad67e=[_0x1ddd94['join'](',')];_0x452118[_0x30fe76(0x277)](_0x2718b6=>{const _0x299df8=_0x30fe76,_0x473d13=_0x2718b6[_0x299df8(0x1ec)]?(_0x2718b6[_0x299df8(0x1ec)][_0x299df8(0x1d4)]?.()||new Date(_0x2718b6[_0x299df8(0x1ec)]))[_0x299df8(0x2ff)](_0x299df8(0x191)):'-',_0x2f2f3d=_0x2718b6[_0x299df8(0x272)]&&_0x2718b6['DateMeeting']!==''?_0x2718b6[_0x299df8(0x234)]||_0x299df8(0x266):'ไม่เข้าร่วม',_0x430aa6=[_0x2718b6['no']||'','\x22'+(_0x2718b6[_0x299df8(0x1a3)]||'')+'\x22',_0x2718b6['dividend']||0x0,_0x2718b6['moneyback']||0x0,_0x2718b6['gratuity']||0x0,_0x2718b6[_0x299df8(0x2e5)]||0x0,'\x22'+_0x473d13+'\x22','\x22'+_0x2f2f3d+'\x22'];_0x8ad67e[_0x299df8(0x1c7)](_0x430aa6['join'](','));});const _0x245ff2='\ufeff'+_0x8ad67e[_0x30fe76(0x1ff)]('\x0a'),_0x2c32b8=new Blob([_0x245ff2],{'type':_0x30fe76(0x230)}),_0x3830be=URL[_0x30fe76(0x2c4)](_0x2c32b8),_0x59f682=document['createElement']('a');_0x59f682[_0x30fe76(0x2d1)](_0x30fe76(0x2c3),_0x3830be),_0x59f682['setAttribute'](_0x30fe76(0x2e3),_0x30fe76(0x208)+new Date()[_0x30fe76(0x299)](_0x30fe76(0x191))+_0x30fe76(0x211)),_0x59f682[_0x30fe76(0x21e)][_0x30fe76(0x18b)]=_0x30fe76(0x291),document[_0x30fe76(0x1b9)]['appendChild'](_0x59f682),_0x59f682[_0x30fe76(0x2a4)](),document[_0x30fe76(0x1b9)][_0x30fe76(0x202)](_0x59f682),window[_0x30fe76(0x2b2)][_0x30fe76(0x2b9)](_0x30fe76(0x1e9),_0x30fe76(0x1f2));},window[_0x4e1024(0x2b2)][_0x4e1024(0x1b2)]=_0x3d6c56=>{const _0x5c6f57=_0x4e1024;state[_0x5c6f57(0x27a)]===_0x3d6c56?state[_0x5c6f57(0x256)]=state[_0x5c6f57(0x256)]==='asc'?_0x5c6f57(0x1f3):_0x5c6f57(0x282):(state[_0x5c6f57(0x27a)]=_0x3d6c56,state[_0x5c6f57(0x256)]=_0x3d6c56===_0x5c6f57(0x1b5)?_0x5c6f57(0x1f3):_0x5c6f57(0x282)),renderTable(state[_0x5c6f57(0x2d2)]);},window[_0x4e1024(0x2b2)][_0x4e1024(0x1d5)]=()=>{const _0x3bd5ef=_0x4e1024,_0x352cb1=document[_0x3bd5ef(0x2b4)]('member-search-input')[_0x3bd5ef(0x1f6)][_0x3bd5ef(0x2e2)]()[_0x3bd5ef(0x1eb)](),_0x1498a1=document[_0x3bd5ef(0x2b4)](_0x3bd5ef(0x1e2)),_0x2e1187=state['users']['find'](_0x5b18ff=>(_0x5b18ff[_0x3bd5ef(0x181)]||'')[_0x3bd5ef(0x1eb)]()[_0x3bd5ef(0x189)](_0x352cb1)||(_0x5b18ff[_0x3bd5ef(0x24c)]||'')['toString']()===_0x352cb1);state[_0x3bd5ef(0x188)]=_0x2e1187,_0x1498a1[_0x3bd5ef(0x1c5)]=!_0x2e1187,_0x1498a1[_0x3bd5ef(0x1a5)]['toggle']('opacity-50',!_0x2e1187),_0x1498a1[_0x3bd5ef(0x1a5)][_0x3bd5ef(0x2c9)](_0x3bd5ef(0x28e),!_0x2e1187);},window[_0x4e1024(0x2b2)]['openMemberSearchModal']=()=>{const _0x44ff32=_0x4e1024,_0x3f96fb=state[_0x44ff32(0x188)];if(!_0x3f96fb)return;document[_0x44ff32(0x2b4)](_0x44ff32(0x1d8))[_0x44ff32(0x1ba)]=_0x44ff32(0x1b3)+_0x3f96fb['EmpName']+_0x44ff32(0x28c)+_0x3f96fb[_0x44ff32(0x24c)]+_0x44ff32(0x2f6)+(_0x3f96fb['CheckIN']?_0x44ff32(0x233):'ยังไม่เช็คอิน')+_0x44ff32(0x1b1)+(_0x3f96fb['CardPoll']?_0x44ff32(0x1b7):_0x44ff32(0x2f8))+_0x44ff32(0x216),document[_0x44ff32(0x2b4)](_0x44ff32(0x271))[_0x44ff32(0x1a5)]['remove'](_0x44ff32(0x291)),lucide[_0x44ff32(0x1fb)]();},window[_0x4e1024(0x2b2)][_0x4e1024(0x290)]=async _0x2d5ef7=>{const _0x21bd6b=_0x4e1024,_0x7ed035=state['searchCandidate'];if(!_0x7ed035)return;const _0x2b0d88={'CheckIN':serverTimestamp(),'status':_0x21bd6b(0x209)};_0x2d5ef7&&(_0x2b0d88[_0x21bd6b(0x2d4)]=_0x21bd6b(0x247),_0x2b0d88[_0x21bd6b(0x1f8)]=serverTimestamp());try{await updateDoc(doc(db,finalCollectionPath,_0x7ed035['id']),_0x2b0d88),window[_0x21bd6b(0x2b2)][_0x21bd6b(0x2b9)](_0x21bd6b(0x262)+(_0x2d5ef7?_0x21bd6b(0x26f):'')),window['app'][_0x21bd6b(0x1dd)](),document[_0x21bd6b(0x2b4)](_0x21bd6b(0x285))[_0x21bd6b(0x1f6)]='',window[_0x21bd6b(0x2b2)][_0x21bd6b(0x1d5)]();}catch(_0x299163){console[_0x21bd6b(0x1de)](_0x299163),window[_0x21bd6b(0x2b2)][_0x21bd6b(0x2b9)](_0x21bd6b(0x25f),_0x21bd6b(0x1de));}},window['app'][_0x4e1024(0x1f5)]=async _0x1a0781=>{const _0x4e9aac=_0x4e1024;if(!confirm(_0x4e9aac(0x1c3)))return;try{await updateDoc(doc(db,finalCollectionPath,_0x1a0781),{'ConfirmReward':serverTimestamp()}),window[_0x4e9aac(0x2b2)][_0x4e9aac(0x2b9)]('เปลี่ยนสถานะรางวัลเป็น\x20รับแล้ว\x20สำเร็จ');}catch(_0xf20544){window['app'][_0x4e9aac(0x2b9)]('อัปเดตไม่สำเร็จ',_0x4e9aac(0x1de));}},window[_0x4e1024(0x2b2)]['deleteSingleData']=async _0xb4c210=>{const _0x9bd6fd=_0x4e1024;if(confirm(_0x9bd6fd(0x2d5)))try{await updateDoc(doc(db,finalCollectionPath,_0xb4c210),{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'status':deleteField(),'ConfirmReward':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField(),'TimeLogin':0x0}),window[_0x9bd6fd(0x2b2)][_0x9bd6fd(0x2b9)](_0x9bd6fd(0x29e));}catch(_0x66a53b){console[_0x9bd6fd(0x1de)](_0x66a53b),window[_0x9bd6fd(0x2b2)][_0x9bd6fd(0x2b9)](_0x9bd6fd(0x220),_0x9bd6fd(0x1de));}},window['app'][_0x4e1024(0x198)]=_0x3f1a1a=>{const _0x1626ef=_0x4e1024;state[_0x1626ef(0x1c1)]=_0x3f1a1a,document[_0x1626ef(0x2b4)]('dividend-single-reset-modal')[_0x1626ef(0x1a5)][_0x1626ef(0x249)](_0x1626ef(0x291));},window['app'][_0x4e1024(0x273)]=()=>{const _0x579d44=_0x4e1024;state['dividendIdToReset']=null,document['getElementById'](_0x579d44(0x1ca))[_0x579d44(0x1a5)]['add'](_0x579d44(0x291));},window[_0x4e1024(0x2b2)][_0x4e1024(0x227)]=async()=>{const _0x4d513e=_0x4e1024,_0x298afc=state[_0x4d513e(0x1c1)];if(!_0x298afc)return;try{await updateDoc(doc(db,dividendCollectionPath,_0x298afc),{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()}),window['app'][_0x4d513e(0x2b9)](_0x4d513e(0x1d3)),window[_0x4d513e(0x2b2)][_0x4d513e(0x273)]();}catch(_0x135348){console[_0x4d513e(0x1de)](_0x135348),window[_0x4d513e(0x2b2)][_0x4d513e(0x2b9)]('เกิดข้อผิดพลาดในการล้างข้อมูล',_0x4d513e(0x1de));}},window[_0x4e1024(0x2b2)][_0x4e1024(0x28d)]=_0x4f6ae8=>{const _0x13099f=_0x4e1024,_0x39f6f9=_0x4f6ae8[_0x13099f(0x190)][_0x13099f(0x1a6)][0x0];_0x39f6f9&&(state['fileToImport']=_0x39f6f9,document['getElementById'](_0x13099f(0x212))[_0x13099f(0x217)]=_0x39f6f9[_0x13099f(0x29d)],document[_0x13099f(0x2b4)](_0x13099f(0x29a))[_0x13099f(0x1a5)][_0x13099f(0x249)]('hidden'),document['getElementById']('btn-import')['disabled']=![]);},window['app'][_0x4e1024(0x26a)]=()=>{const _0x13ba25=_0x4e1024;state[_0x13ba25(0x284)]=null,document[_0x13ba25(0x2b4)]('file-info')[_0x13ba25(0x1a5)]['add']('hidden'),document[_0x13ba25(0x2b4)](_0x13ba25(0x2c0))[_0x13ba25(0x1c5)]=!![];},window['app'][_0x4e1024(0x195)]=_0x5823d7=>{const _0x51d096=_0x4e1024,_0xffeaa7=_0x5823d7['target'][_0x51d096(0x1a6)][0x0];_0xffeaa7&&(state[_0x51d096(0x221)]=_0xffeaa7,document[_0x51d096(0x2b4)](_0x51d096(0x23d))[_0x51d096(0x217)]=_0xffeaa7[_0x51d096(0x29d)],document[_0x51d096(0x2b4)](_0x51d096(0x2dc))[_0x51d096(0x1a5)][_0x51d096(0x249)](_0x51d096(0x291)),document[_0x51d096(0x2b4)](_0x51d096(0x1ea))['disabled']=![]);},window['app'][_0x4e1024(0x297)]=()=>{const _0xf3ce6c=_0x4e1024;state['dividendFileToImport']=null,document['getElementById'](_0xf3ce6c(0x2f4))['value']='',document['getElementById'](_0xf3ce6c(0x2dc))[_0xf3ce6c(0x1a5)][_0xf3ce6c(0x2cc)](_0xf3ce6c(0x291)),document[_0xf3ce6c(0x2b4)](_0xf3ce6c(0x1ea))['disabled']=!![];},window[_0x4e1024(0x2b2)][_0x4e1024(0x1ae)]=async()=>{const _0x30e0e9=_0x4e1024,_0x389b03=state['fileToImport'];if(!_0x389b03)return;const _0x2f2365=await _0x389b03['text']();let _0x340fc4=_0x389b03[_0x30e0e9(0x29d)][_0x30e0e9(0x21d)](_0x30e0e9(0x211))?csvToJson(_0x2f2365):JSON[_0x30e0e9(0x186)](_0x2f2365);document[_0x30e0e9(0x2b4)](_0x30e0e9(0x21c))['classList'][_0x30e0e9(0x249)](_0x30e0e9(0x291));const _0x3838a9=_0x340fc4[_0x30e0e9(0x29f)],_0x5775ed=0x12c;for(let _0x28709a=0x0;_0x28709a<_0x3838a9;_0x28709a+=_0x5775ed){const _0x1b5e28=_0x340fc4[_0x30e0e9(0x20a)](_0x28709a,_0x28709a+_0x5775ed),_0x243c69=writeBatch(db);for(const _0x5ada41 of _0x1b5e28){const _0x187831=_0x5ada41[_0x30e0e9(0x207)]||_0x5ada41[_0x30e0e9(0x1bc)]||'',_0xf68a9=await sha256(_0x187831[_0x30e0e9(0x2f0)]()['replace'](/-/g,'')['trim']()),_0x2fa083=doc(collection(db,finalCollectionPath));_0x243c69['set'](_0x2fa083,{..._0x5ada41,'citizenId':_0xf68a9,'importedAt':serverTimestamp()});}await _0x243c69[_0x30e0e9(0x26d)](),document['getElementById'](_0x30e0e9(0x2e6))[_0x30e0e9(0x21e)][_0x30e0e9(0x2f2)]=(_0x28709a+_0x1b5e28[_0x30e0e9(0x29f)])/_0x3838a9*0x64+'%';}window['app']['showToast'](_0x30e0e9(0x28a)),window['app']['clearFileSelection']();},window[_0x4e1024(0x2b2)]['processDividendImport']=async()=>{const _0x164b0b=_0x4e1024,_0x4ecc68=state[_0x164b0b(0x221)];if(!_0x4ecc68)return;const _0xc512df=await _0x4ecc68['text']();let _0x5ab26b=_0x4ecc68['name']['endsWith'](_0x164b0b(0x211))?csvToJson(_0xc512df):JSON['parse'](_0xc512df);document[_0x164b0b(0x2b4)](_0x164b0b(0x1e1))[_0x164b0b(0x1a5)]['remove'](_0x164b0b(0x291));const _0x481bb1=_0x5ab26b[_0x164b0b(0x29f)],_0x29827a=0x12c;for(let _0x1b2cc8=0x0;_0x1b2cc8<_0x481bb1;_0x1b2cc8+=_0x29827a){const _0x1b77a8=_0x5ab26b[_0x164b0b(0x20a)](_0x1b2cc8,_0x1b2cc8+_0x29827a),_0x5a9559=writeBatch(db);for(const _0x147829 of _0x1b77a8){const _0x136ff8=_0x147829['citizenId']||_0x147829[_0x164b0b(0x1bc)]||_0x147829['CitizenId']||'',_0x1a897a=_0x136ff8?await sha256(_0x136ff8[_0x164b0b(0x2f0)]()[_0x164b0b(0x222)](/-/g,'')[_0x164b0b(0x2e2)]()):'',_0x118194=doc(collection(db,dividendCollectionPath));_0x5a9559[_0x164b0b(0x2c5)](_0x118194,{..._0x147829,'citizenId':_0x1a897a,'membertype':'member','DateLogin':null,'importedAt':serverTimestamp()});}await _0x5a9559['commit'](),document[_0x164b0b(0x2b4)](_0x164b0b(0x24e))['style'][_0x164b0b(0x2f2)]=(_0x1b2cc8+_0x1b77a8[_0x164b0b(0x29f)])/_0x481bb1*0x64+'%';}window[_0x164b0b(0x2b2)][_0x164b0b(0x2b9)](_0x164b0b(0x268)),window[_0x164b0b(0x2b2)][_0x164b0b(0x297)]();},window[_0x4e1024(0x2b2)]['openResetModal']=()=>{const _0x47aaac=_0x4e1024;document[_0x47aaac(0x2b4)](_0x47aaac(0x2a8))[_0x47aaac(0x1f6)]='',document[_0x47aaac(0x2b4)](_0x47aaac(0x1ee))[_0x47aaac(0x1a5)][_0x47aaac(0x249)]('hidden');},window[_0x4e1024(0x2b2)][_0x4e1024(0x21b)]=()=>document['getElementById'](_0x4e1024(0x1ee))[_0x4e1024(0x1a5)][_0x4e1024(0x2cc)](_0x4e1024(0x291)),window[_0x4e1024(0x2b2)][_0x4e1024(0x267)]=()=>{const _0x4535f6=_0x4e1024;document[_0x4535f6(0x2b4)]('confirm-delete-input')[_0x4535f6(0x1f6)]='',document[_0x4535f6(0x2b4)](_0x4535f6(0x1c4))['classList'][_0x4535f6(0x249)]('hidden');},window[_0x4e1024(0x2b2)]['closeDeleteAllModal']=()=>document[_0x4e1024(0x2b4)](_0x4e1024(0x1c4))['classList'][_0x4e1024(0x2cc)](_0x4e1024(0x291)),window['app'][_0x4e1024(0x23c)]=()=>{const _0x3a680d=_0x4e1024;document['getElementById'](_0x3a680d(0x2bb))['value']='',document[_0x3a680d(0x2b4)](_0x3a680d(0x2a9))[_0x3a680d(0x1a5)]['remove'](_0x3a680d(0x291));},window[_0x4e1024(0x2b2)][_0x4e1024(0x2b5)]=()=>document[_0x4e1024(0x2b4)]('dividend-reset-confirm-modal')[_0x4e1024(0x1a5)][_0x4e1024(0x2cc)]('hidden'),window[_0x4e1024(0x2b2)]['openDeleteAllDividendModal']=()=>{const _0x1a2582=_0x4e1024;document[_0x1a2582(0x2b4)](_0x1a2582(0x23a))[_0x1a2582(0x1f6)]='',document[_0x1a2582(0x2b4)](_0x1a2582(0x22b))[_0x1a2582(0x1a5)][_0x1a2582(0x249)](_0x1a2582(0x291));},window[_0x4e1024(0x2b2)]['closeDeleteAllDividendModal']=()=>document[_0x4e1024(0x2b4)]('dividend-delete-confirm-modal')['classList'][_0x4e1024(0x2cc)]('hidden'),window[_0x4e1024(0x2b2)][_0x4e1024(0x1dd)]=()=>document[_0x4e1024(0x2b4)]('member-search-modal')['classList'][_0x4e1024(0x2cc)]('hidden'),window[_0x4e1024(0x2b2)][_0x4e1024(0x2bd)]=()=>document[_0x4e1024(0x2b4)](_0x4e1024(0x1d9))[_0x4e1024(0x1a5)][_0x4e1024(0x2cc)](_0x4e1024(0x291)),window[_0x4e1024(0x2b2)][_0x4e1024(0x28f)]=async()=>{const _0x1b6f43=_0x4e1024;if(document[_0x1b6f43(0x2b4)](_0x1b6f43(0x2a8))['value'][_0x1b6f43(0x2e2)]()!==_0x1b6f43(0x301))return window['app'][_0x1b6f43(0x2b9)](_0x1b6f43(0x1b0),_0x1b6f43(0x1de));window[_0x1b6f43(0x2b2)][_0x1b6f43(0x21b)]();const _0x5ccee5=await getDocs(query(collection(db,finalCollectionPath))),_0x551ef9=writeBatch(db);_0x5ccee5[_0x1b6f43(0x277)](_0x29f8ad=>_0x551ef9['update'](_0x29f8ad[_0x1b6f43(0x1e3)],{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField(),'status':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField()})),await _0x551ef9[_0x1b6f43(0x26d)](),window[_0x1b6f43(0x2b2)][_0x1b6f43(0x2b9)]('รีเซ็ตสถานะรายชื่อพนักงานสำเร็จ');},window[_0x4e1024(0x2b2)][_0x4e1024(0x1ef)]=async()=>{const _0x16d811=_0x4e1024;if(document[_0x16d811(0x2b4)](_0x16d811(0x2de))[_0x16d811(0x1f6)]['trim']()!=='Delete')return window[_0x16d811(0x2b2)]['showToast'](_0x16d811(0x23b),_0x16d811(0x1de));window[_0x16d811(0x2b2)][_0x16d811(0x255)]();const _0x16a80a=await getDocs(query(collection(db,finalCollectionPath))),_0x5aeeb2=writeBatch(db);_0x16a80a[_0x16d811(0x277)](_0x537773=>_0x5aeeb2[_0x16d811(0x23f)](_0x537773[_0x16d811(0x1e3)])),await _0x5aeeb2[_0x16d811(0x26d)](),window['app'][_0x16d811(0x2b9)](_0x16d811(0x253));},window[_0x4e1024(0x2b2)]['confirmResetDividendData']=async()=>{const _0x44dc27=_0x4e1024;if(document['getElementById']('confirm-div-reset-input')['value'][_0x44dc27(0x2e2)]()!==_0x44dc27(0x301))return window[_0x44dc27(0x2b2)]['showToast']('พิมพ์\x20Reset',_0x44dc27(0x1de));window[_0x44dc27(0x2b2)][_0x44dc27(0x2b5)]();const _0x43af93=await getDocs(query(collection(db,dividendCollectionPath))),_0x2acc75=writeBatch(db);_0x43af93['forEach'](_0x1b4ee1=>_0x2acc75[_0x44dc27(0x2ac)](_0x1b4ee1['ref'],{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()})),await _0x2acc75[_0x44dc27(0x26d)](),window[_0x44dc27(0x2b2)]['showToast']('รีเซ็ตสถานะปันผลแล้ว');},window['app'][_0x4e1024(0x24f)]=async()=>{const _0x11c490=_0x4e1024;if(document[_0x11c490(0x2b4)](_0x11c490(0x23a))[_0x11c490(0x1f6)]['trim']()!==_0x11c490(0x1b8))return window[_0x11c490(0x2b2)][_0x11c490(0x2b9)]('พิมพ์\x20Delete',_0x11c490(0x1de));window[_0x11c490(0x2b2)][_0x11c490(0x22d)]();const _0x1ba3f6=await getDocs(query(collection(db,dividendCollectionPath))),_0x5671b6=writeBatch(db);_0x1ba3f6[_0x11c490(0x277)](_0x262d7c=>_0x5671b6['delete'](_0x262d7c[_0x11c490(0x1e3)])),await _0x5671b6[_0x11c490(0x26d)](),window[_0x11c490(0x2b2)][_0x11c490(0x2b9)](_0x11c490(0x25a));},window[_0x4e1024(0x2b2)][_0x4e1024(0x2d9)]=()=>{const _0x3d5c73=_0x4e1024,_0x1cf0aa=document[_0x3d5c73(0x2b4)](_0x3d5c73(0x293)),_0x3837d4=_0x1cf0aa['options'][_0x1cf0aa['selectedIndex']];if(!_0x1cf0aa[_0x3d5c73(0x1f6)])return;const _0x4824e3=parseInt(_0x3837d4[_0x3d5c73(0x235)][_0x3d5c73(0x1b6)]),_0x515f9f=state[_0x3d5c73(0x2d2)]['filter'](_0xfce6be=>_0xfce6be[_0x3d5c73(0x1ad)]===_0x3837d4[_0x3d5c73(0x19d)])[_0x3d5c73(0x29f)],_0x1fcb8a=_0x4824e3-_0x515f9f;document['getElementById'](_0x3d5c73(0x2a6))[_0x3d5c73(0x217)]=_0x1fcb8a,document[_0x3d5c73(0x2b4)](_0x3d5c73(0x1ce))[_0x3d5c73(0x217)]=state['stats'][_0x3d5c73(0x2a1)],document[_0x3d5c73(0x2b4)](_0x3d5c73(0x2ad))[_0x3d5c73(0x1f6)]=_0x3837d4['dataset']['qty'],window['app'][_0x3d5c73(0x214)]();},window['app'][_0x4e1024(0x214)]=()=>{const _0xe3a87b=_0x4e1024,_0x4a5b41=document[_0xe3a87b(0x2b4)](_0xe3a87b(0x293)),_0x44761f=parseInt(document[_0xe3a87b(0x2b4)]('input-draw-qty')['value']),_0x2a3c04=parseInt(document[_0xe3a87b(0x2b4)](_0xe3a87b(0x2a6))['innerText']),_0x247f95=_0x44761f>0x0&&_0x44761f<=_0x2a3c04&&_0x4a5b41[_0xe3a87b(0x1f6)];document['getElementById'](_0xe3a87b(0x2d8))[_0xe3a87b(0x1c5)]=!_0x247f95,document[_0xe3a87b(0x2b4)](_0xe3a87b(0x260))[_0xe3a87b(0x1a5)]['toggle'](_0xe3a87b(0x291),_0x44761f<=_0x2a3c04);},window[_0x4e1024(0x2b2)][_0x4e1024(0x270)]=async()=>{const _0x5af3a6=_0x4e1024;if(state[_0x5af3a6(0x197)])return;const _0x168921=document[_0x5af3a6(0x2b4)](_0x5af3a6(0x293)),_0x29e0b4=_0x168921[_0x5af3a6(0x20d)][_0x168921['selectedIndex']]['text'],_0xc5c56e=parseInt(document[_0x5af3a6(0x2b4)](_0x5af3a6(0x2ad))[_0x5af3a6(0x1f6)]),_0x21fadb=state[_0x5af3a6(0x2d2)][_0x5af3a6(0x2fc)](_0x14a07a=>_0x14a07a[_0x5af3a6(0x2b1)]===_0x5af3a6(0x209)&&!_0x14a07a[_0x5af3a6(0x1ad)]);if(_0x21fadb[_0x5af3a6(0x29f)]<_0xc5c56e)return window[_0x5af3a6(0x2b2)]['showToast']('ผู้มีสิทธิ์ลุ้นไม่เพียงพอ','error');state[_0x5af3a6(0x197)]=!![],document[_0x5af3a6(0x2b4)]('btn-start-random')[_0x5af3a6(0x1c5)]=!![],document[_0x5af3a6(0x2b4)](_0x5af3a6(0x29c))[_0x5af3a6(0x1a5)]['remove'](_0x5af3a6(0x291)),await new Promise(_0x5470e5=>setTimeout(_0x5470e5,0x3e8)),document[_0x5af3a6(0x2b4)](_0x5af3a6(0x29c))['classList'][_0x5af3a6(0x2cc)](_0x5af3a6(0x291)),document['getElementById']('screen-display-area')[_0x5af3a6(0x1ba)]='';const _0x2fa25a=_0x21fadb[_0x5af3a6(0x2a5)](()=>0.5-Math[_0x5af3a6(0x26b)]())[_0x5af3a6(0x20a)](0x0,_0xc5c56e);for(let _0x4c3451=0x0;_0x4c3451<_0x2fa25a['length'];_0x4c3451++){const _0x4c4fb1=_0x2fa25a[_0x4c3451],_0x53b394=document[_0x5af3a6(0x1cf)](_0x5af3a6(0x18e));_0x53b394[_0x5af3a6(0x1cb)]='bg-white\x20p-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-400\x20flex\x20justify-between\x20items-center\x20fade-in-up\x20text-sm',_0x53b394[_0x5af3a6(0x1ba)]='<div><p\x20class=\x22font-bold\x20text-lg\x20text-slate-800\x20text-sm\x22>'+_0x4c4fb1[_0x5af3a6(0x181)]+_0x5af3a6(0x1d0)+_0x4c4fb1[_0x5af3a6(0x24c)]+_0x5af3a6(0x2ee)+_0x29e0b4+_0x5af3a6(0x1bd),document['getElementById'](_0x5af3a6(0x1fa))[_0x5af3a6(0x1a0)](_0x53b394),confetti({'particleCount':0x64,'spread':0x46,'origin':{'y':0.6}}),await updateDoc(doc(db,finalCollectionPath,_0x4c4fb1['id']),{'reward':_0x29e0b4,'rewardTime':serverTimestamp()});if(_0x4c3451<_0x2fa25a['length']-0x1)await new Promise(_0x1da901=>setTimeout(_0x1da901,0x7d0));}state[_0x5af3a6(0x197)]=![],window[_0x5af3a6(0x2b2)][_0x5af3a6(0x2d9)](),window[_0x5af3a6(0x2b2)][_0x5af3a6(0x2b9)]('สุ่มพนักงานผู้โชคดีสำเร็จ');};function updateCharts(_0x1856b7){const _0x58c601=_0x4e1024,_0x2b74c1=Array[_0x58c601(0x2ed)]({'length':0x18},(_0x168a25,_0x2ae2d4)=>_0x2ae2d4+_0x58c601(0x1e7)),_0x115bfd=document[_0x58c601(0x2b4)](_0x58c601(0x280))?.[_0x58c601(0x183)]('2d');if(!_0x115bfd)return;window[_0x58c601(0x206)]?(window[_0x58c601(0x206)][_0x58c601(0x1e6)]['datasets'][0x0][_0x58c601(0x1e6)]=_0x2b74c1[_0x58c601(0x238)]((_0x6f8972,_0x1ed72f)=>_0x1856b7[_0x1ed72f]||0x0),window['regChartInst'][_0x58c601(0x2ac)]()):window[_0x58c601(0x206)]=new Chart(_0x115bfd,{'type':_0x58c601(0x1e5),'data':{'labels':_0x2b74c1,'datasets':[{'label':'Check-IN','data':_0x2b74c1['map']((_0x1b85a6,_0x295397)=>_0x1856b7[_0x295397]||0x0),'borderColor':_0x58c601(0x250),'backgroundColor':_0x58c601(0x27b),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![]}});}function renderActivityFeed(_0x3d95f6){const _0x400f54=_0x4e1024,_0x7abbd3=document[_0x400f54(0x2b4)](_0x400f54(0x25b));if(!_0x7abbd3)return;const _0x470da7=[];_0x3d95f6[_0x400f54(0x277)](_0x24fa81=>{const _0x1604f9=_0x400f54;if(_0x24fa81['CheckIN'])_0x470da7[_0x1604f9(0x1c7)]({'t':'IN','d':_0x24fa81[_0x1604f9(0x1b5)][_0x1604f9(0x1d4)]?.()||new Date(_0x24fa81['CheckIN']),'n':_0x24fa81[_0x1604f9(0x181)]});}),_0x470da7[_0x400f54(0x2a5)]((_0x331a70,_0x52b137)=>_0x52b137['d']-_0x331a70['d']),_0x7abbd3['innerHTML']=_0x470da7[_0x400f54(0x20a)](0x0,0xf)['map'](_0x522cfe=>_0x400f54(0x1d7)+_0x522cfe['t']+_0x400f54(0x252)+_0x522cfe['n']+'</span>\x20<span\x20class=\x22text-[10px]\x20text-slate-400\x20font-mono\x20text-sm\x22>'+_0x522cfe['d']['toLocaleTimeString'](_0x400f54(0x191))+_0x400f54(0x236))['join']('');}const csvToJson=_0x50fc77=>{const _0x3a45f2=_0x4e1024,_0x52405b=_0x50fc77[_0x3a45f2(0x2f3)]('\x0a'),_0x2cbe92=_0x52405b[0x0]['split'](',')['map'](_0x164fe7=>_0x164fe7['trim']());return _0x52405b[_0x3a45f2(0x20a)](0x1)['map'](_0x1000ba=>{const _0x592337=_0x3a45f2,_0x30b6ec=_0x1000ba['split'](',');if(_0x30b6ec['length']<_0x2cbe92[_0x592337(0x29f)])return null;return _0x2cbe92['reduce']((_0x42b523,_0x4fa2da,_0x36f8b9)=>{const _0x15dda4=_0x592337;return _0x42b523[_0x4fa2da]=_0x30b6ec[_0x36f8b9]?_0x30b6ec[_0x36f8b9][_0x15dda4(0x2e2)]():'',_0x42b523;},{});})[_0x3a45f2(0x2fc)](_0x5f1d6c=>_0x5f1d6c);};setInterval(()=>{const _0x1d64cd=_0x4e1024;if(document[_0x1d64cd(0x2b4)](_0x1d64cd(0x2fe)))document[_0x1d64cd(0x2b4)]('current-time')[_0x1d64cd(0x217)]=new Date()[_0x1d64cd(0x276)](_0x1d64cd(0x191));},0x3e8),window['app'][_0x4e1024(0x2aa)]=async _0x4d44ea=>{const _0x7257e=_0x4e1024;_0x4d44ea[_0x7257e(0x2b8)]();const _0x4ba024=document[_0x7257e(0x2b4)]('prize-name')['value'],_0x5bc0aa=parseInt(document[_0x7257e(0x2b4)](_0x7257e(0x279))['value']),_0x5b7aa7=parseInt(document['getElementById']('prize-total')['value']);await addDoc(collection(db,prizesCollectionPath),{'name':_0x4ba024,'qtyPerDraw':_0x5bc0aa,'totalQty':_0x5b7aa7,'createdAt':serverTimestamp()}),document['getElementById'](_0x7257e(0x259))['reset'](),window[_0x7257e(0x2b2)][_0x7257e(0x2b9)](_0x7257e(0x1c6));},window[_0x4e1024(0x2b2)][_0x4e1024(0x19f)]=async _0x35e2f6=>{const _0x37afda=_0x4e1024;if(confirm(_0x37afda(0x22c)))await deleteDoc(doc(db,prizesCollectionPath,_0x35e2f6));},window['app'][_0x4e1024(0x204)]=async _0x51d62e=>{if(confirm('ล้างข้อมูลรางวัลพนักงานท่านนี้?'))await updateDoc(doc(db,finalCollectionPath,_0x51d62e),{'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField()});},window[_0x4e1024(0x2b2)][_0x4e1024(0x2b3)]=_0x55d463=>{const _0x2a5e6b=_0x4e1024;state['searchTerm']=_0x55d463[_0x2a5e6b(0x1eb)](),state['currentPage']=0x1,renderTable(state['users']);},window[_0x4e1024(0x2b2)][_0x4e1024(0x2ab)]=_0x311c93=>{const _0x2700bb=_0x4e1024;state[_0x2700bb(0x2eb)]=_0x311c93[_0x2700bb(0x1eb)](),renderDividendTable(state[_0x2700bb(0x1f7)]);},window[_0x4e1024(0x2b2)][_0x4e1024(0x18a)]=_0x230a05=>{const _0x1603b3=_0x4e1024;state[_0x1603b3(0x23e)]+=_0x230a05,renderTable(state['users']);};async function init(){const _0x2accbe=_0x4e1024;try{await signInAnonymously(auth),document[_0x2accbe(0x2b4)]('status-indicator')?.[_0x2accbe(0x1a5)][_0x2accbe(0x222)]('bg-red-500',_0x2accbe(0x251));if(document[_0x2accbe(0x2b4)](_0x2accbe(0x237)))document['getElementById'](_0x2accbe(0x237))['innerText']=_0x2accbe(0x185);onSnapshot(query(collection(db,finalCollectionPath)),_0xd8ab55=>processSnapshot(_0xd8ab55)),onSnapshot(query(collection(db,prizesCollectionPath)),_0x5e8ae5=>{const _0x300aa4=_0x2accbe,_0x5c3d59=[];let _0x57d124=0x0;_0x5e8ae5['forEach'](_0x4f9547=>{const _0xfb913d=_0x3f6a,_0x110d16=_0x4f9547[_0xfb913d(0x1e6)]();_0x5c3d59[_0xfb913d(0x1c7)]({'id':_0x4f9547['id'],..._0x110d16}),_0x57d124+=parseInt(_0x110d16[_0xfb913d(0x1cd)])||0x0;}),state[_0x300aa4(0x215)]=_0x5c3d59,state['stats'][_0x300aa4(0x2db)]=_0x57d124;const _0x19e3b2=document['getElementById'](_0x300aa4(0x293));if(_0x19e3b2)_0x19e3b2[_0x300aa4(0x1ba)]=_0x300aa4(0x2a3)+_0x5c3d59[_0x300aa4(0x238)](_0x5a3a15=>'<option\x20value=\x22'+_0x5a3a15['id']+_0x300aa4(0x1fe)+_0x5a3a15['qtyPerDraw']+_0x300aa4(0x296)+_0x5a3a15[_0x300aa4(0x1cd)]+'\x22>'+_0x5a3a15[_0x300aa4(0x29d)]+_0x300aa4(0x305))[_0x300aa4(0x1ff)]('');const _0x2669d1=document[_0x300aa4(0x2b4)]('prize-list-body');if(_0x2669d1)_0x2669d1[_0x300aa4(0x1ba)]=_0x5c3d59[_0x300aa4(0x238)](_0xcd4fcb=>_0x300aa4(0x213)+_0xcd4fcb[_0x300aa4(0x29d)]+'</td><td\x20class=\x22text-center\x20font-bold\x20text-sm\x22>'+_0xcd4fcb[_0x300aa4(0x1cc)]+_0x300aa4(0x25e)+_0xcd4fcb['totalQty']+_0x300aa4(0x1e0)+_0xcd4fcb['id']+_0x300aa4(0x22a))[_0x300aa4(0x1ff)]('');document[_0x300aa4(0x2b4)](_0x300aa4(0x1f4))&&(document[_0x300aa4(0x2b4)](_0x300aa4(0x1f4))[_0x300aa4(0x217)]=_0x57d124),lucide[_0x300aa4(0x1fb)]();}),onSnapshot(query(collection(db,dividendCollectionPath)),_0x36a69e=>{const _0x3c52de=_0x2accbe,_0x17b28d=[];let _0x8d634b=0x0,_0x1c2eda=0x0,_0x21ce42=0x0;_0x36a69e[_0x3c52de(0x277)](_0x35ed65=>{const _0x3ed1ce=_0x3c52de,_0x41f8f4=_0x35ed65[_0x3ed1ce(0x1e6)]();_0x17b28d[_0x3ed1ce(0x1c7)]({'id':_0x35ed65['id'],..._0x41f8f4});if(_0x41f8f4['DateLogin'])_0x8d634b++;if(_0x41f8f4[_0x3ed1ce(0x272)]&&_0x41f8f4[_0x3ed1ce(0x272)]!==''){if(_0x41f8f4['RegisMeeting']===_0x3ed1ce(0x304))_0x21ce42++;else _0x1c2eda++;}}),state['dividendUsers']=_0x17b28d,state[_0x3c52de(0x1ed)][_0x3c52de(0x1bf)]=_0x36a69e[_0x3c52de(0x25d)],state['stats'][_0x3c52de(0x1af)]=_0x8d634b,state[_0x3c52de(0x1ed)][_0x3c52de(0x294)]=_0x1c2eda,state[_0x3c52de(0x1ed)][_0x3c52de(0x1db)]=_0x21ce42,updateDashboardUI(state[_0x3c52de(0x1ed)]);if(!document['getElementById'](_0x3c52de(0x265))[_0x3c52de(0x1a5)]['contains'](_0x3c52de(0x291)))renderDividendTable(_0x17b28d);}),window['app'][_0x2accbe(0x231)](_0x2accbe(0x2bf));}catch(_0x105dbe){console[_0x2accbe(0x1de)](_0x105dbe);}}init(),lucide[_0x4e1024(0x1fb)]();
    </script>
</body>
</html>
