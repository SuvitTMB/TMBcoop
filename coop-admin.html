<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Lightbox/Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        /* Toast Animation */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        /* Table Styles: Height 32px, Zebra Striping, and text-sm */
        .table-compact thead tr {
            height: 32px;
        }
        .table-compact tbody tr {
            height: 32px;
            font-size: 0.875rem; /* text-sm */
        }
        .table-compact tbody tr:nth-child(even) {
            background-color: #f8fafc; /* Light Gray (slate-50) */
        }
        .table-compact tbody tr:nth-child(odd) {
            background-color: #ffffff; /* White */
        }
        .table-compact td, .table-compact th {
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            vertical-align: middle;
        }

        /* Custom Scroll for Dark Area */
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
        
        /* Winner Card Animation */
        @keyframes cardSlideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .winner-card-enter {
            animation: cardSlideIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        /* Sortable table headers */
        .sortable-header { cursor: pointer; user-select: none; }
        .sortable-header:hover { background-color: rgba(0,0,0,0.05); }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="play-circle" width="20"></i> จับรางวัล (Randomizer)
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('dividend-info')" id="nav-dividend-info" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="badge-dollar-sign" width="20"></i> ข้อมูลปันผล
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code ลงทะเบียน
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code เงินปันผล
                </button>
            </div>

            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold">Management Info</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
                </button>
                <button onclick="window.app.switchTab('dividend')" id="nav-dividend" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="wallet" width="20"></i> จัดการเงินปันผล
                </button>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Top Bar -->
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวม (Dashboard)</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">
                    A
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD OVERVIEW -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="users" width="60" height="60" class="text-blue-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนเข้า</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-green-500 text-xs mt-2 flex items-center gap-1"><i data-lucide="arrow-up" width="12"></i> Update Real-time</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="log-out" width="60" height="60" class="text-orange-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนออก</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <div class="w-full bg-orange-100 rounded-full h-1.5 mt-3">
                            <div id="bar-checkout" class="bg-orange-500 h-1.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="frown" width="60" height="60" class="text-slate-400"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ผู้ไม่ได้รางวัล</p>
                        <h3 id="stat-noreward" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-slate-400 text-xs mt-2">สุ่มแล้วไม่ได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="gift" width="60" height="60" class="text-purple-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ได้รับรางวัลแล้ว</p>
                        <h3 id="stat-rewarded" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p id="stat-eligible" class="text-slate-400 text-xs mt-2">สุ่มและได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="check-square" width="60" height="60" class="text-green-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ยืนยันรับรางวัลแล้ว</p>
                        <h3 id="stat-claimed" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียนเข้า (Check-IN)
                                </h3>
                                <span class="text-2xl font-bold text-indigo-600" id="chart-total-checkin">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="registrationChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-orange-500 rounded-full"></div> สถิติการลงทะเบียนออก (Check-OUT)
                                </h3>
                                <span class="text-2xl font-bold text-orange-600" id="chart-total-checkout">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="checkoutChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1">
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZE MANAGEMENT -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="plus-circle" width="20" class="text-indigo-600"></i> เพิ่ม/แก้ไข ของรางวัล
                        </h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                                    <input type="number" id="prize-qty" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition">บันทึกข้อมูล</button>
                        </form>
                    </div>

                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left table-compact">
                                <thead class="bg-slate-200 text-slate-700 font-bold">
                                    <tr>
                                        <th class="px-4 py-3 rounded-l-lg">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">รางวัลที่จะสุ่ม</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right rounded-r-lg">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y divide-slate-100">
                                    <tr><td colspan="4" class="text-center py-4 text-slate-400">กำลังโหลด...</td></tr>
                                </tbody>
                                <tfoot class="bg-slate-100 font-bold text-slate-700">
                                    <tr>
                                        <td class="px-4 py-3 text-right" colspan="2">รวมสิทธิ์ทั้งหมด:</td>
                                        <td class="px-4 py-3 text-center text-indigo-600" id="total-prize-quota">0</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER SYSTEM -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-blue-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-indigo-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้มีสิทธิ์สุ่มรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-slate-400">
                        <p class="text-slate-500 text-xs font-medium">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-red-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วไม่ได้รางวัล</p>
                        <h3 id="rand-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-green-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วได้รางวัล</p>
                        <h3 id="rand-stat-claimed" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                    <div class="lg:col-span-4 space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-100">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                                <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600"><i data-lucide="settings-2" width="20"></i></div>
                                ตั้งค่าการสุ่ม
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">เลือกของรางวัล</label>
                                    <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none bg-white text-sm">
                                        <option value="">-- กรุณาเลือก --</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนผู้โชคดี (คน)</label>
                                    <div class="flex items-center gap-4">
                                        <input type="number" id="input-draw-qty" value="1" min="1" max="50" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-center text-lg">
                                        <span class="text-slate-400 text-sm whitespace-nowrap">คน / รอบ</span>
                                    </div>
                                    <p class="text-xs text-orange-500 mt-1 hidden" id="qty-warning">จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ!</p>
                                </div>
                                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">คงเหลือในสต็อก</span>
                                        <span id="label-stock-count" class="font-bold text-orange-600 text-lg">0</span>
                                    </div>
                                     <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span>
                                        <span id="label-eligible-count" class="font-bold text-indigo-600 text-lg">0</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-1.5">
                                        <div class="bg-indigo-500 h-1.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-2">*เฉพาะผู้ที่สถานะไม่ว่างและยังไม่เคยได้รางวัล</p>
                                </div>
                                <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all transform active:scale-95 flex items-center justify-center gap-2 text-lg opacity-50 cursor-not-allowed">
                                    <i data-lucide="play" width="24" class="fill-current"></i> เริ่มสุ่มรางวัล
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-8">
                        <div class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 rounded-3xl h-[650px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700/50">
                            <div class="relative z-10 flex justify-between items-start mb-8 border-b border-white/10 pb-4">
                                <div>
                                    <h1 id="screen-prize-title" class="text-xg font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200 drop-shadow-md">
                                        ระบบสุ่มรางวัล
                                    </h1>
                                </div>
                            </div>
                            <div id="screen-display-area" class="relative z-10 flex-1 grid grid-cols-1 content-start gap-4 overflow-y-auto custom-scroll-dark px-2 pb-4">
                                <div class="text-center text-slate-500/50 flex flex-col items-center justify-center h-full">
                                    <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm">
                                        <i data-lucide="gift" width="40" height="40" class="text-white/20"></i>
                                    </div>
                                    <p class="text-white/40 font-light text-xm">พร้อมสำหรับการจับรางวัล</p>
                                </div>
                            </div>
                            <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/80 backdrop-blur-sm z-20 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                    <h2 class="text-2xl font-bold tracking-tight">กำลังประมวลผล...</h2>
                                    <p class="text-blue-300 mt-2">กรุณารอสักครู่</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: LIVE RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <div class="bg-gradient-to-br from-gray-600 to-gray-700 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-gray-200 text-xs">สมาชิกทั้งหมดในระบบ</p>
                        <h3 id="monitor-total-db" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-blue-100 text-xs">สมาชิกที่ลงทะเบียน (Active)</p>
                        <h3 id="monitor-registered" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-purple-100 text-xs">จำนวนรางวัลที่แจกแล้ว</p>
                        <h3 id="monitor-draws" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-green-100 text-xs">สมาชิกที่ได้รางวัลแล้ว</p>
                        <h3 id="monitor-rewarded" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                    <div class="bg-gradient-to-br from-slate-500 to-slate-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-slate-200 text-xs">สมาชิกที่ไม่ได้รางวัล</p>
                        <h3 id="monitor-noreward" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                </div>
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 bg-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-slate-800">รายการผู้โชคดี (Real-time)</h3>
                        <select id="filter-results-status" onchange="window.app.renderResults()" class="bg-white border border-slate-300 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                            <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                            <option value="unclaimed">ผู้ที่ยังไม่รับรางวัล</option>
                            <option value="claimed">ผู้ที่รับรางวัลแล้ว</option>
                            <option value="no_reward">ผู้ที่ไม่ได้รับรางวัล</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-6 py-4">ลำดับ</th>
                                    <th class="px-6 py-4">ชื่อ-นามสกุล</th>
                                    <th class="px-6 py-4">รางวัลที่ได้</th>
                                    <th class="px-6 py-4">เวลาที่สุ่มได้</th>
                                    <th class="px-6 py-4">สถานะการรับรางวัล</th>
                                    <th class="px-6 py-4 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE (REGISTRATION) -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                 
                 <!-- Search Member Row (New Added) -->
                 <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <label class="block text-sm font-medium text-slate-600 mb-2">ค้นหาชื่อสมาชิกเพื่อลงทะเบียน (Real-time)</label>
                    <div class="flex gap-4 w-full md:w-1/2">
                        <input type="text" id="member-search-input" oninput="window.app.validateMemberSearch()" placeholder="ใส่ชื่อหรือรหัสสมาชิก..." class="flex-1 p-2.5 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                        <button id="member-search-btn" onclick="window.app.openMemberSearchModal()" disabled class="px-6 py-2.5 bg-indigo-600 text-white rounded-xl font-bold opacity-50 cursor-not-allowed transition hover:bg-indigo-700 text-sm flex items-center gap-2">
                            <i data-lucide="search" width="16"></i> ค้นหา
                        </button>
                    </div>
                </div>

                 <!-- Summary Boxes Above Table -->
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex items-center gap-4">
                        <div class="p-3 bg-blue-100 text-blue-600 rounded-lg"><i data-lucide="users" width="20"></i></div>
                        <div>
                            <p class="text-xs text-slate-500 font-medium">จำนวนสมาชิก</p>
                            <h3 id="reg-summary-total" class="text-xl font-bold text-slate-800">0</h3>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex items-center gap-4">
                        <div class="p-3 bg-green-100 text-green-600 rounded-lg"><i data-lucide="check-circle" width="20"></i></div>
                        <div>
                            <p class="text-xs text-slate-500 font-medium">ลงทะเบียนแล้ว</p>
                            <h3 id="reg-summary-registered" class="text-xl font-bold text-green-600">0</h3>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex items-center gap-4">
                        <div class="p-3 bg-purple-100 text-purple-600 rounded-lg"><i data-lucide="gift" width="20"></i></div>
                        <div>
                            <p class="text-xs text-slate-500 font-medium">ผู้รับรางวัล</p>
                            <h3 id="reg-summary-rewarded" class="text-xl font-bold text-purple-600">0</h3>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-end">
                             <select id="sort-by" onchange="window.app.changeSort(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="EmpMember">เรียงตาม no</option>
                                <option value="EmpName">เรียงตามชื่อ-นามสกุล</option>
                                <option value="CheckIN">เรียงตาม Check-In</option>
                                <option value="reward">เรียงตามของรางวัล</option>
                             </select>
                             <select id="sort-order" onchange="window.app.changeSortOrder(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="desc">มาก -> น้อย (ล่าสุด/Z-A)</option>
                                <option value="asc">น้อย -> มาก (เก่าสุด/A-Z)</option>
                             </select>
                             <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="20">20 แถว</option>
                                <option value="50" selected>50 แถว</option>
                                <option value="100">100 แถว</option>
                                <option value="500">500 แถว</option>
                                <option value="99999">ทั้งหมด</option>
                             </select>
                             <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-6 py-2 text-center sortable-header" onclick="window.app.changeSort('EmpMember')">
                                        no <span id="reg-sort-EmpMember"></span>
                                    </th>
                                    <th class="px-6 py-2 sortable-header" onclick="window.app.changeSort('EmpName')">
                                        ชื่อ-นามสกุล (EmpName) <span id="reg-sort-EmpName"></span>
                                    </th>
                                    <th class="px-6 py-2 sortable-header" onclick="window.app.changeSort('CheckIN')">
                                        Check-In <span id="reg-sort-CheckIN"></span>
                                    </th>
                                    <th class="px-6 py-2 sortable-header" onclick="window.app.changeSort('reward')">
                                        ของรางวัล <span id="reg-sort-reward"></span>
                                    </th>
                                    <th class="px-6 py-2">สถานะรับรางวัล</th>
                                    <th class="px-6 py-2 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex flex-col sm:flex-row justify-between items-center gap-4">
                            <div class="flex items-center gap-4">
                                <p class="text-xs text-slate-400 font-medium" id="data-table-info">แสดงผล...</p>
                                <button onclick="window.app.downloadRegistrationCSV()" class="px-4 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold transition flex items-center gap-2 shadow-sm">
                                    <i data-lucide="download" width="14"></i> Download CSV File
                                </button>
                            </div>
                            <div class="flex gap-2" id="pagination-controls">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md hover:bg-slate-50 disabled:opacity-50 text-xs" id="btn-prev">Previous</button>
                                <span class="text-xs self-center font-bold text-slate-600" id="page-indicator">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md hover:bg-slate-50 disabled:opacity-50 text-xs" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 10: DIVIDEND INFO TABLE -->
            <div id="view-dividend-info" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="users" width="60" height="60" class="text-indigo-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">สมาชิกปันผลทั้งหมด</p>
                        <h3 id="div-stat-total" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="check-circle" width="60" height="60" class="text-green-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนแล้ว</p>
                        <h3 id="div-stat-registered" class="text-2xl font-bold text-green-600 mt-2">0</h3>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10">
                            <i data-lucide="presentation" width="60" height="60" class="text-blue-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">เข้าร่วมประชุมแล้ว</p>
                        <h3 id="div-stat-meeting" class="text-2xl font-bold text-blue-600 mt-2">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลสมาชิกปันผล</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-end">
                             <input type="text" id="search-dividend" oninput="window.app.handleDividendSearch(this.value)" placeholder="ค้นหารหัส หรือ ชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-indigo-100 w-full md:w-64">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-4 py-3 text-center sortable-header text-sm" onclick="window.app.changeDivSort('no')">
                                        ลำดับ <span id="sort-icon-no"></span>
                                    </th>
                                    <th class="px-4 py-3 sortable-header text-sm" onclick="window.app.changeDivSort('empname')">
                                        ชื่อ-นามสกุล <span id="sort-icon-empname"></span>
                                    </th>
                                    <th class="px-4 py-3 text-right sortable-header text-sm" onclick="window.app.changeDivSort('dividend')">
                                        ปันผล <span id="sort-icon-dividend"></span>
                                    </th>
                                    <th class="px-4 py-3 text-right sortable-header text-sm" onclick="window.app.changeDivSort('moneyback')">
                                        เงินเฉลี่ยคืน <span id="sort-icon-moneyback"></span>
                                    </th>
                                    <th class="px-4 py-3 text-right sortable-header text-sm" onclick="window.app.changeDivSort('gratuity')">
                                        ค่าของขวัญ <span id="sort-icon-gratuity"></span>
                                    </th>
                                    <th class="px-4 py-3 text-right sortable-header text-sm" onclick="window.app.changeDivSort('netpayment')">
                                        รับสุทธิ <span id="sort-icon-netpayment"></span>
                                    </th>
                                    <th class="px-4 py-3 sortable-header text-sm" onclick="window.app.changeDivSort('DateLogin')">
                                        ลงทะเบียน <span id="sort-icon-DateLogin"></span>
                                    </th>
                                    <th class="px-4 py-3 sortable-header text-sm" onclick="window.app.changeDivSort('RegisMeeting')">
                                        เข้าประชุม <span id="sort-icon-RegisMeeting"></span>
                                    </th>
                                    <th class="px-4 py-3 text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="dividend-table-body" class="divide-y divide-slate-100">
                                <tr><td colspan="9" class="text-center py-8 text-slate-400">กำลังรอข้อมูล...</td></tr>
                            </tbody>
                        </table>
                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex flex-col sm:flex-row justify-between items-center gap-4">
                            <div class="flex items-center gap-4">
                                <p class="text-xs text-slate-400 font-medium" id="div-table-info">แสดงผล...</p>
                                <button onclick="window.app.downloadDividendCSV()" class="px-4 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-xs font-bold transition flex items-center gap-2 shadow-sm">
                                    <i data-lucide="download" width="14"></i> Download CSV File
                                </button>
                            </div>
                            <div class="flex gap-2" id="div-pagination-controls">
                                <button onclick="window.app.changeDivPage(-1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md hover:bg-slate-50 disabled:opacity-50 text-xs" id="btn-div-prev">Previous</button>
                                <span class="self-center font-bold text-slate-600 text-xs" id="div-page-indicator">Page 1</span>
                                <button onclick="window.app.changeDivPage(1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md hover:bg-slate-50 disabled:opacity-50 text-xs" id="btn-div-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: IMPORT REGISTRATION DATA -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูลรายชื่อ (JSON/CSV)
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">
                            รองรับไฟล์ที่มึคีย์ <code>citizenId</code> เพื่อใช้ทำ Hashing ก่อนบันทึกเข้าตารางหลัก
                        </p>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:bg-slate-50 transition cursor-pointer" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                                <p class="text-sm font-medium text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากไฟล์มาวางที่นี่</p>
                                <p class="text-xs text-slate-400 mt-1">รองรับ .json, .csv</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700">
                                <span id="file-name">filename.json</span>
                                <button onclick="window.app.clearFileSelection()" class="text-blue-500 hover:text-blue-700"><i data-lucide="x" width="16"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                เริ่มนำเข้าข้อมูล
                            </button>
                            <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5">
                                <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="database" width="20" class="text-slate-600"></i> ข้อมูลระบบ
                        </h3>
                        <div class="bg-slate-50 p-4 rounded-xl mb-6 flex justify-between items-center">
                            <div>
                                <p class="text-sm text-slate-500">จำนวนข้อมูลรายชื่อทั้งหมด (Records)</p>
                                <h2 class="text-2xl font-bold text-slate-800 mt-1" id="manage-total-docs">0</h2>
                            </div>
                            <div class="bg-white p-3 rounded-full shadow-sm text-slate-400">
                                <i data-lucide="hard-drive" width="24"></i>
                            </div>
                        </div>
                        <div class="border-t border-slate-100 pt-6 space-y-4">
                            <h4 class="font-bold text-red-600 mb-2 flex items-center gap-2"><i data-lucide="alert-octagon" width="18"></i> Danger Zone</h4>
                             <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                <p class="text-sm font-bold text-orange-800 mb-1">รีเซ็ตการลงทะเบียน (Reset Status)</p>
                                <button onclick="window.app.openResetModal()" class="w-full border border-orange-300 text-orange-700 hover:bg-orange-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="rotate-ccw" width="16"></i> รีเซ็ตสถานะรายชื่อ
                                </button>
                            </div>
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                                <p class="text-sm font-bold text-red-800 mb-1">ลบข้อมูลทั้งหมด (Delete All)</p>
                                <button onclick="window.app.deleteAllData()" class="w-full border border-red-300 text-red-700 hover:bg-red-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="trash-2" width="16"></i> ลบฐานข้อมูลรายชื่อ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 9: MANAGE DIVIDEND (IMPORT) -->
            <div id="view-dividend" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Upload Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="wallet" width="20" class="text-emerald-600"></i> นำเข้าข้อมูลเงินปันผล (JSON/CSV)
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">
                            ระบบจะโหลดข้อมูลเข้าตาราง <code>tmb_coop_dividend</code> และกำหนดสถานะ <code>membertype: "member"</code> อัตโนมัติ
                        </p>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:bg-slate-50 transition cursor-pointer" onclick="document.getElementById('dividend-file-upload').click()">
                                <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                                <p class="text-sm font-medium text-slate-600">คลิกเพื่อเลือกไฟล์ปันผล</p>
                                <p class="text-xs text-slate-400 mt-1">รองรับ .json, .csv</p>
                                <input type="file" id="dividend-file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleDividendFileSelect(event)">
                            </div>
                            <div id="dividend-file-info" class="hidden bg-emerald-50 p-3 rounded-lg flex items-center justify-between text-sm text-emerald-700">
                                <span id="dividend-file-name">filename.json</span>
                                <button onclick="window.app.clearDividendFileSelection()" class="text-emerald-500 hover:text-emerald-700"><i data-lucide="x" width="16"></i></button>
                            </div>
                            <button onclick="window.app.processDividendImport()" id="btn-dividend-import" disabled class="w-full bg-emerald-600 text-white py-3 rounded-xl font-bold hover:bg-emerald-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                เริ่มนำเข้าข้อมูลปันผล
                            </button>
                            <div id="dividend-import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5">
                                <div id="dividend-import-bar" class="bg-emerald-600 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="database" width="20" class="text-slate-600"></i> ข้อมูลเงินปันผล
                        </h3>
                        <div class="bg-slate-50 p-4 rounded-xl mb-6 flex justify-between items-center">
                            <div>
                                <p class="text-sm text-slate-500">จำนวนข้อมูลปันผลทั้งหมด (Records)</p>
                                <h2 class="text-2xl font-bold text-slate-800 mt-1" id="manage-dividend-total">0</h2>
                            </div>
                            <div class="bg-white p-3 rounded-full shadow-sm text-emerald-400">
                                <i data-lucide="banknote" width="24"></i>
                            </div>
                        </div>
                        <div class="border-t border-slate-100 pt-6 space-y-4">
                            <h4 class="font-bold text-red-600 mb-2 flex items-center gap-2"><i data-lucide="alert-octagon" width="18"></i> Danger Zone</h4>
                             <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                <p class="text-sm font-bold text-orange-800 mb-1">รีเซ็ตสถานะปันผล</p>
                                <button onclick="window.app.openDividendResetModal()" class="w-full border border-orange-300 text-orange-700 hover:bg-orange-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="rotate-ccw" width="16"></i> รีเซ็ตการรับปันผลทั้งหมด
                                </button>
                            </div>
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                                <p class="text-sm font-bold text-red-800 mb-1">ลบข้อมูลปันผลทั้งหมด</p>
                                <button onclick="window.app.deleteAllDividendData()" class="w-full border border-red-300 text-red-700 hover:bg-red-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="trash-2" width="16"></i> ล้างฐานข้อมูลปันผล
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- VIEW 7: QR Code CheckIN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2">ลงทะเบียนเข้าประชุม</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนเข้าร่วมงาน</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/coop-register.png" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://suvittmb.github.io/TMBcoop/coop-register.html'" alt="Check-IN QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/coop-register.html</p>
                    <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

            <!-- VIEW 8: QR Code CheckOUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-orange-600 mb-2">ลงทะเบียนเช็คเงินปันผล</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนเช็คเงินปันผล</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/coop-dividend.png" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://suvittmb.github.io/TMBcoop/coop-dividend.html'" alt="Check-OUT QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/coop-dividend.html</p>
                     <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

        </div>
    </main>

    <!-- Lightbox for Member Search Result (New Added) -->
    <div id="member-search-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100 text-center">
            <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600">
                <i data-lucide="user" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ยืนยันข้อมูลสมาชิก</h3>
            <div id="search-member-details" class="text-left bg-slate-50 p-4 rounded-xl mb-6 space-y-2 text-sm">
                <!-- Data injected via JS -->
            </div>
            <div class="flex gap-3">
                <button onclick="window.app.closeMemberSearchModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition text-sm">ยกเลิก</button>
                <button id="btn-confirm-regis" onclick="window.app.confirmRegistrationViaSearch()" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition text-sm">ลงทะเบียนสมาชิก</button>
            </div>
        </div>
    </div>

    <!-- Modal: Edit Prize -->
    <div id="edit-prize-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4 border-b border-slate-100 pb-2">
                <h3 class="text-lg font-bold text-slate-800">แก้ไขของรางวัล</h3>
                <button onclick="window.app.closeEditPrizeModal()" class="text-slate-400 hover:text-slate-600">
                    <i data-lucide="x" width="24"></i>
                </button>
            </div>
            <form id="edit-prize-form" onsubmit="window.app.handlePrizeUpdate(event)" class="space-y-4">
                <input type="hidden" id="edit-prize-id">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                    <input type="text" id="edit-prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                        <input type="number" id="edit-prize-qty" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                        <input type="number" id="edit-prize-total" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none text-sm">
                    </div>
                </div>
                
                <div class="flex gap-3 pt-2">
                    <button type="button" onclick="window.app.closeEditPrizeModal()" class="flex-1 py-3 rounded-xl text-slate-600 bg-slate-100 hover:bg-slate-200 font-bold transition text-sm">ยกเลิก</button>
                    <button type="submit" class="flex-1 py-3 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 font-bold transition text-sm">บันทึก</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Dividend Reset Confirmation Modal -->
    <div id="dividend-reset-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600">
                <i data-lucide="rotate-ccw" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">รีเซ็ตข้อมูลเงินปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">ระบบจะล้างข้อมูล DateLogin, RegisMeeting, DateMeeting ทั้งหมดในตารางเงินปันผล</p>
            <div class="flex gap-3">
                <button onclick="window.app.closeDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmResetDividendData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition text-sm">ยืนยันรีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- General Modal -->
    <div id="general-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500">
                <i data-lucide="alert-circle" width="24"></i>
            </div>
            <h3 id="general-modal-title" class="text-lg font-bold text-slate-800 mb-2">แจ้งเตือน</h3>
            <p id="general-modal-message" class="text-slate-500 text-sm mb-6">ข้อความแจ้งเตือน</p>
            <button onclick="window.app.closeGeneralModal()" class="w-full py-2.5 rounded-xl bg-slate-800 text-white font-bold hover:bg-slate-900 transition text-sm">ตกลง</button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600">
                <i data-lucide="alert-triangle" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ยืนยันการรีเซ็ต?</h3>
            <p class="text-slate-500 text-sm mb-6">
                ระบบจะล้างข้อมูลการลงทะเบียน (Check-In/Out) และประวัติการรับรางวัลทั้งหมด <br>
                <span class="font-bold text-orange-600">แต่จะเก็บรายชื่อพนักงานไว้</span>
            </p>
            <div class="flex gap-3">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition text-sm">ยืนยันรีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
const _0x3deb21=_0x199d;function _0x29fe(){const _0x4eff6c=['QR\x20Code\x20CheckIN','text-orange-500','bg-slate-700','<div\x20class=\x22flex\x20items-center\x20gap-4\x22><div\x20class=\x22w-10\x20h-10\x20bg-yellow-400\x20rounded-full\x20flex\x20items-center\x20justify-center\x20font-bold\x22>','<tr><td\x20colspan=\x229\x22\x20class=\x22text-center\x20py-8\x20text-slate-400\x20font-medium\x22>ไม่พบข้อมูลสมาชิก</td></tr>','monitor-registered','onload','forEach','innerText','edit-prize-total','แสดงผล\x20','ระบบสุ่มรางวัล','parse','divSearchTerm','asc','visibility','dividend-table-body','createObjectURL','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x22>','ยังไม่รับ','type','map','randomizer','prizes','classList','changeSortOrder','ttb-register','disabled','ไม่มีผู้มีสิทธิ์เหลืออยู่','<span\x20class=\x22text-green-600\x20font-bold\x22>ลงทะเบียนแล้ว</span>','reset','closeDividendResetModal','\x20คน','screen-display-area','btn-import','member-search-input','dividendUsers','Active','member-search-modal','\x20รายการ','toString','eligible','\x27)\x22\x20class=\x22text-red-500\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td></tr>','opacity-50','/public/data/coop_registrations','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x22\x20title=\x22ล้างสถานะบุคคลนี้\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','rewarded',')\x22\x20class=\x22text-blue-500\x20mr-2\x22><i\x20data-lucide=\x22edit-3\x22\x20width=\x2216\x22></i></button><button\x20onclick=\x22window.app.deletePrize(\x27','22995FDpnYJ','handlePrizeSubmit','รีเซ็ตเงินปันผลสำเร็จ','จัดการเงินปันผล\x20(Import)','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-slate-500\x22>','push','screen-overlay-controls','closeMemberSearchModal','removeChild','\x20p-4\x20rounded-lg\x20shadow-lg\x20flex\x20items-start\x20gap-3\x20toast-enter\x20pointer-events-auto\x20transform\x20transition-all\x20duration-300','netpayment','confirmResetData','success','status','data-total','ลบไม่สำเร็จ','dividend','chartOutInstance','toLocaleString','17316rGJoEP','data-qty','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-slate-400\x22>สถานะ:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22col-span-2\x22>','ต้องการล้างข้อมูลรางวัลของผู้โชคดีท่านนี้?','openDividendResetModal','notRewarded','ConfirmReward','inline-block\x20ml-1\x20text-blue-600\x20font-bold','ล้างสถานะไม่สำเร็จ','รีเซ็ตสถานะสำเร็จ','</td><td\x20class=\x22px-4\x20py-3\x20text-right\x20text-sm\x22><button\x20onclick=\x22window.app.openEditPrizeModal(\x27','th-TH','searchTerm','nav-','btn-start-random','G-9DJLWJ5LQ1','handleDividendFileSelect','dividend_report_','\x22\x20width=\x2216\x22></i></div><div><p\x20class=\x22font-medium\x22>','notYetDrawn','CONFIRM','citizenId','scrollTop','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','rand-stat-eligible-view','slice','drawnWon','ceil','<option\x20value=\x22','trim','closeGeneralModal','totalQty','sortOrder','อัปเดตรางวัลแล้ว','chart-total-checkout','data','bg-green-500','reg-summary-registered','text','tmb_coop_dividend','innerHTML','import-bar','clearDividendFileSelection','ลบรางวัลนี้?','dividend-import-bar','ttb-register.firebaseapp.com','moneyback','CheckIN','page-indicator','result','screen-prize-title','ส่งออกไฟล์\x20CSV\x20เรียบร้อยแล้ว','registered','monitor-noreward','desc','<button\x20onclick=\x22window.app.resetWinnerStatus(\x27','btn-dividend-import','hidden','closeResetModal','ปันผล','sort-icon-','toLocaleTimeString','divSortBy','clearFileSelection','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x22>รับแล้ว</span>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','นำเข้าข้อมูลสำเร็จ\x20','</div><button\x20onclick=\x22this.parentElement.remove()\x22\x20class=\x22text-slate-400\x20hover:text-slate-600\x22><i\x20data-lucide=\x22x\x22\x20width=\x2216\x22></i></button>','เกิดข้อผิดพลาด','digest','total-prize-quota','className','changeDivSort','view-dividend-info','1017wPHeaV','split','</h3></div><span\x20class=\x22px-3\x20py-1\x20bg-blue-600\x20text-white\x20rounded-lg\x20text-sm\x22>','119786LchZWn','inline-block\x20ml-1\x20text-slate-300','ออก','text-blue-500','รีเซ็ตปันผลล้มเหลว','rowsPerPage','select-prize','edit-prize-qty','changeDivPage','text-slate-400','citizenID',')</span></p><p\x20class=\x22text-[10px]\x20text-slate-400\x22>','SHA-256','member','checkoutChart','import-progress','div-page-indicator','add','</div><h3\x20class=\x22text-lg\x20font-bold\x22>','join','options','bg-white\x20border-l-4\x20border-blue-500\x20text-slate-700','deleteSingleData','\x22\x20data-total=\x22','5507840pzTIeI','stat-rewarded','padStart','stat-noreward','artifacts/','status-text','ล้างข้อมูลรางวัลสำเร็จ','createElement','CitizenId','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20font-medium\x20text-slate-700\x20text-sm\x22>','EmpMember','value','พิมพ์\x20\x27DELETE\x27\x20เพื่อลบทั้งหมด','dividend-info','.csv','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-right\x22>','find','opacity-0','ล้างสถานะเรียบร้อย','error','general-modal-message','div','toLocaleDateString','เกิดข้อผิดพลาดในการลงทะเบียน','div-stat-total','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-sm\x20font-medium\x20text-slate-700\x22>','reduce','/public/data/coop_gift','length','sortBy','click','drawnNoReward','downloadDividendCSV','showModal','random','<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x22>ไม่ได้รางวัล</span>','validateMemberSearch','\x20จากทั้งหมด\x20','ลำดับ(no)','stat-checkout','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-right\x22>','bg-red-500','searchCandidate','commit','พิมพ์\x20\x27CONFIRM\x27\x20เพื่อลบเงินปันผล','dividendTotal','date','getAttribute','เข้า','results','setAttribute','app','users','checkin','all_winners','164YSAlvP','download','width','switchTab','includes','rand-stat-total','getElementById','fileToImport','sort','ไม่ได้รับรางวัล','changeSort','getTime','deleteAllDividendData','deleteAllData','878466KCZJNQ','view-','page-title','ref','getHours','reg-summary-rewarded','prize-name','นำเข้าล้มเหลว','cursor-not-allowed','<span\x20class=\x22text-slate-400\x20text-xs\x22>ID:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20font-medium\x20text-indigo-600\x20text-sm\x22>','rand-stat-claimed','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-right\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.resetSingleDividendData(\x27','อัปเดตไม่สำเร็จ','monitor-draws','current-time','replace','bar-checkout','search-member-details','</span>','readAsText','validateRandomizerInput','EmpName','divSortOrder','ลบรางวัลสำเร็จ','rand-stat-rewarded','divCurrentPage','ต้องการล้างสถานะท่านนี้?\x20(Check-In,\x20ของรางวัล,\x20สถานะรับรางวัล)','#f97316','href','DateLogin','body','handleFileSelect','target','\x20<span\x20class=\x22text-slate-400\x20font-normal\x22>(','style','edit-prize-name','dividend-reset-confirm-modal','text-white','3Bujqhb','reg-summary-total','CheckOUT','</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-sm\x22>','empname','stats','getContext','stat-checkin','<option\x20value=\x22\x22>--\x20กรุณาเลือก\x20--</option>','file-info','undefined','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20font-medium\x20text-slate-800\x22>','file-upload','update','bg-white\x20border-l-4\x20border-green-500\x20text-slate-700','1:1070273157855:web:5c8120e1df27e233d8676a','openEditPrizeModal','member-search-btn','reset-confirm-modal','qtyPerDraw','remove','label-stock-count','contains','1442903XeJjhA','renderResults','filter','winner-card-enter\x20bg-white\x20h-[65px]\x20px-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-500\x20flex\x20items-center\x20justify-between\x20mb-2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-3\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-slate-400\x22>ชื่อ-นามสกุล:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22col-span-2\x20font-bold\x20text-slate-800\x22>','div-table-info','ต้องการล้างสถานะลงทะเบียนปันผลของสมาชิกท่านนี้?','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-slate-600\x20text-sm\x22>','rewardTime','createIcons','จากผู้มีสิทธิ์ลุ้น\x20','totalDocs','chartInInstance','claimed','จัดการของรางวัล','<span\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x22>ยังไม่รับ</span>','rgba(249,\x20115,\x2022,\x200.1)','bg-white\x20border-l-4\x20border-red-500\x20text-slate-700','translate-x-full','<tr\x20class=\x22hover:bg-indigo-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-center\x20font-mono\x20text-slate-500\x20text-sm\x22>','Unknown','openMemberSearchModal','substring','currentPage','<span\x20class=\x22text-green-600\x20font-bold\x22>','ลบข้อมูลปันผลทั้งหมดแล้ว','reward','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-right\x20font-bold\x20text-indigo-600\x22>','<div\x20class=\x22text-red-500\x22><i\x20data-lucide=\x22alert-circle\x22\x20width=\x2220\x22></i></div>','querySelectorAll','ค่าของขวัญ','ttb-register.firebasestorage.app','import','name','DELETE','datasets','user-plus','files','from','checkout','tmb_coop','toDate','coop_gift','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closeEditPrizeModal','qrcode-out','unclaimed','confirmRegistrationViaSearch','รับแล้ว','ไม่ได้รางวัล','chart-total-checkin','isDrawing','registrationChart','บันทึกไม่สำเร็จ','divRowsPerPage','monitor-rewarded','selectedIndex','toLowerCase','div-stat-meeting','ลงทะเบียนคุณ\x20','\x20of\x20','results-table-body','reg-sort-','ล้างสถานะสมาชิกสำเร็จ','ของรางวัล','\x27,\x20','btn-div-prev','\x22><i\x20data-lucide=\x22','<div\x20class=\x22text-center\x20text-slate-400\x20text-sm\x20py-8\x22>ยังไม่มีกิจกรรม</div>','แจ้งเตือน','showToast','รับสุทธิ','toast-container','นำเข้าปันผลล้มเหลว','<tr\x20class=\x22hover:bg-slate-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-center\x20font-mono\x20text-slate-500\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-slate-400\x22>รหัสสมาชิก\x20(no):</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22col-span-2\x20font-mono\x22>','\x20title=\x22ล้างรายการรางวัล\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i></button>','\x27)\x22\x20class=\x22p-1.5\x20text-slate-400\x20hover:text-red-600\x20transition\x22\x20title=\x22ล้างสถานะการลงทะเบียนปันผล\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','lucide','N/A','openResetModal','btn-next','gratuity','text/csv;charset=utf-8;','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20disabled:opacity-30\x20disabled:cursor-not-allowed\x20transition\x22\x20','changeRowsLimit','registration_report_','endsWith','ประกาศผลรางวัล','out','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x22>','stat-claimed','label-eligible-count','handleSearch','set','qrcode-in','file-name','\x27,\x20\x27','general-modal','onPrizeSelect','qty-warning','\x20/\x20','RegisMeeting','Check-In','scrollHeight','dividend-file-info','dividendFileToImport','dashboard','นำเข้าเงินปันผลสำเร็จ\x20','line','input-draw-qty','26504zsiLeN','dividend-import-progress','processImport','view-randomizer','stat-eligible','edit-prize-id','size','edit-prize-modal','จัดการข้อมูล\x20(Import)','บันทึกรางวัลแล้ว','appendChild','prize-form','<div\x20class=\x22flex\x20items-start\x20gap-3\x20text-sm\x20p-2\x20rounded-lg\x20bg-slate-50\x22><div\x20class=\x22','#4f46e5'];_0x29fe=function(){return _0x4eff6c;};return _0x29fe();}(function(_0x387b60,_0x50332d){const _0x30469c=_0x199d,_0x242f51=_0x387b60();while(!![]){try{const _0x132d9f=-parseInt(_0x30469c(0x1e4))/0x1*(parseInt(_0x30469c(0x160))/0x2)+-parseInt(_0x30469c(0x2bb))/0x3+-parseInt(_0x30469c(0x1af))/0x4*(-parseInt(_0x30469c(0x2a8))/0x5)+-parseInt(_0x30469c(0x1bd))/0x6+parseInt(_0x30469c(0x1fb))/0x7+parseInt(_0x30469c(0x26a))/0x8*(-parseInt(_0x30469c(0x15d))/0x9)+parseInt(_0x30469c(0x178))/0xa;if(_0x132d9f===_0x50332d)break;else _0x242f51['push'](_0x242f51['shift']());}catch(_0x37bdf6){_0x242f51['push'](_0x242f51['shift']());}}}(_0x29fe,0x3a689));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const appId=typeof __app_id!==_0x3deb21(0x1ee)?__app_id:'default-app-id',isSandboxEnv=typeof __firebase_config!==_0x3deb21(0x1ee);let firebaseConfig,finalCollectionPath,prizesCollectionPath,dividendCollectionPath;isSandboxEnv?(firebaseConfig=JSON[_0x3deb21(0x284)](__firebase_config),finalCollectionPath=_0x3deb21(0x17c)+appId+_0x3deb21(0x2a4),prizesCollectionPath=_0x3deb21(0x17c)+appId+_0x3deb21(0x193),dividendCollectionPath=_0x3deb21(0x17c)+appId+'/public/data/tmb_coop_dividend'):(firebaseConfig={'apiKey':_0x3deb21(0x2d2),'authDomain':_0x3deb21(0x2e8),'databaseURL':'https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','projectId':_0x3deb21(0x292),'storageBucket':_0x3deb21(0x21a),'messagingSenderId':'1070273157855','appId':_0x3deb21(0x1f3),'measurementId':_0x3deb21(0x2ca)},finalCollectionPath=_0x3deb21(0x223),prizesCollectionPath=_0x3deb21(0x225),dividendCollectionPath=_0x3deb21(0x2e2));const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'dividendUsers':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notRewarded':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0,'dividendTotal':0x0},'isDrawing':![],'fileToImport':null,'dividendFileToImport':null,'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x3deb21(0x182),'sortOrder':'asc','searchTerm':'','divCurrentPage':0x1,'divRowsPerPage':0x32,'divSearchTerm':'','divSortBy':'no','divSortOrder':_0x3deb21(0x286),'searchCandidate':null};async function sha256(_0x35044d){const _0x34d65c=_0x3deb21,_0x220a59=new TextEncoder()['encode'](_0x35044d),_0x26e5d4=await crypto['subtle'][_0x34d65c(0x158)](_0x34d65c(0x16c),_0x220a59),_0x4d0938=Array[_0x34d65c(0x221)](new Uint8Array(_0x26e5d4));return _0x4d0938[_0x34d65c(0x28d)](_0xd6a5a=>_0xd6a5a[_0x34d65c(0x2a0)](0x10)[_0x34d65c(0x17a)](0x2,'0'))['join']('');}window[_0x3deb21(0x1ab)]=window[_0x3deb21(0x1ab)]||{},window[_0x3deb21(0x1ab)][_0x3deb21(0x241)]=(_0x3d7844,_0xd5adfd=_0x3deb21(0x2b4))=>{const _0x4803ad=_0x3deb21,_0x179152=document[_0x4803ad(0x1b5)](_0x4803ad(0x243)),_0x3e56c6=document[_0x4803ad(0x17f)](_0x4803ad(0x18d));let _0x404acc,_0xaf0a42;if(_0xd5adfd===_0x4803ad(0x2b4))_0x404acc=_0x4803ad(0x1f2),_0xaf0a42='<div\x20class=\x22text-green-500\x22><i\x20data-lucide=\x22check-circle\x22\x20width=\x2220\x22></i></div>';else _0xd5adfd===_0x4803ad(0x18b)?(_0x404acc=_0x4803ad(0x20c),_0xaf0a42=_0x4803ad(0x217)):(_0x404acc=_0x4803ad(0x175),_0xaf0a42='<div\x20class=\x22text-blue-500\x22><i\x20data-lucide=\x22info\x22\x20width=\x2220\x22></i></div>');_0x3e56c6[_0x4803ad(0x15a)]=_0x404acc+_0x4803ad(0x2b1),_0x3e56c6['innerHTML']=_0xaf0a42+'<div\x20class=\x22flex-1\x20text-sm\x20font-medium\x22>'+_0x3d7844+_0x4803ad(0x156);if(_0x179152)_0x179152['appendChild'](_0x3e56c6);if(window['lucide'])lucide[_0x4803ad(0x204)]();setTimeout(()=>{const _0x35f58a=_0x4803ad;_0x3e56c6[_0x35f58a(0x290)][_0x35f58a(0x171)](_0x35f58a(0x189),_0x35f58a(0x20d)),setTimeout(()=>_0x3e56c6['remove'](),0x12c);},0xbb8);},window[_0x3deb21(0x1ab)][_0x3deb21(0x199)]=(_0x31b01f,_0x27902f)=>{const _0x19ee37=_0x3deb21;document[_0x19ee37(0x1b5)]('general-modal-title')[_0x19ee37(0x280)]=_0x31b01f,document[_0x19ee37(0x1b5)](_0x19ee37(0x18c))[_0x19ee37(0x280)]=_0x27902f,document['getElementById'](_0x19ee37(0x25d))[_0x19ee37(0x290)][_0x19ee37(0x1f8)](_0x19ee37(0x14c));},window[_0x3deb21(0x1ab)][_0x3deb21(0x2d9)]=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x25d))['classList'][_0x3deb21(0x171)](_0x3deb21(0x14c)),window['app'][_0x3deb21(0x24b)]=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x1f6))[_0x3deb21(0x290)][_0x3deb21(0x1f8)](_0x3deb21(0x14c)),window[_0x3deb21(0x1ab)]['closeResetModal']=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x1f6))[_0x3deb21(0x290)]['add']('hidden'),window[_0x3deb21(0x1ab)][_0x3deb21(0x2bf)]=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x1e2))[_0x3deb21(0x290)][_0x3deb21(0x1f8)](_0x3deb21(0x14c)),window[_0x3deb21(0x1ab)]['closeDividendResetModal']=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x1e2))[_0x3deb21(0x290)][_0x3deb21(0x171)](_0x3deb21(0x14c)),window[_0x3deb21(0x1ab)][_0x3deb21(0x19c)]=()=>{const _0x183855=_0x3deb21,_0x54eaa7=document[_0x183855(0x1b5)](_0x183855(0x29b))[_0x183855(0x183)]['trim']()[_0x183855(0x234)](),_0x31b248=document[_0x183855(0x1b5)](_0x183855(0x1f5));if(!_0x54eaa7){_0x31b248['disabled']=!![],_0x31b248['classList'][_0x183855(0x171)](_0x183855(0x2a3),_0x183855(0x1c5)),state['searchCandidate']=null;return;}const _0x2d20b8=state[_0x183855(0x1ac)][_0x183855(0x188)](_0x4adf03=>(_0x4adf03[_0x183855(0x1d3)]||'')['toLowerCase']()[_0x183855(0x1b3)](_0x54eaa7)||(_0x4adf03[_0x183855(0x182)]||'')[_0x183855(0x2a0)]()[_0x183855(0x234)]()===_0x54eaa7);_0x2d20b8?(state[_0x183855(0x1a2)]=_0x2d20b8,_0x31b248[_0x183855(0x293)]=![],_0x31b248[_0x183855(0x290)]['remove']('opacity-50','cursor-not-allowed')):(state['searchCandidate']=null,_0x31b248[_0x183855(0x293)]=!![],_0x31b248[_0x183855(0x290)][_0x183855(0x171)]('opacity-50','cursor-not-allowed'));},window[_0x3deb21(0x1ab)][_0x3deb21(0x210)]=()=>{const _0x59ba28=_0x3deb21,_0x19465a=state[_0x59ba28(0x1a2)];if(!_0x19465a)return;const _0x246c0f=document[_0x59ba28(0x1b5)](_0x59ba28(0x1cf));_0x246c0f['innerHTML']=_0x59ba28(0x1ff)+(_0x19465a[_0x59ba28(0x1d3)]||'-')+_0x59ba28(0x246)+(_0x19465a['EmpMember']||'-')+_0x59ba28(0x2bd)+(_0x19465a[_0x59ba28(0x2ea)]?_0x59ba28(0x295):'<span\x20class=\x22text-orange-500\x22>ยังไม่ลงทะเบียน</span>')+_0x59ba28(0x226);const _0x3ad807=document['getElementById']('btn-confirm-regis');_0x19465a[_0x59ba28(0x2ea)]?(_0x3ad807['disabled']=!![],_0x3ad807[_0x59ba28(0x290)][_0x59ba28(0x171)](_0x59ba28(0x2a3),'cursor-not-allowed')):(_0x3ad807[_0x59ba28(0x293)]=![],_0x3ad807[_0x59ba28(0x290)]['remove'](_0x59ba28(0x2a3),_0x59ba28(0x1c5)));document['getElementById']('member-search-modal')['classList'][_0x59ba28(0x1f8)]('hidden');if(window[_0x59ba28(0x249)])lucide[_0x59ba28(0x204)]();},window[_0x3deb21(0x1ab)][_0x3deb21(0x2af)]=()=>{const _0x2eb4dd=_0x3deb21;document[_0x2eb4dd(0x1b5)](_0x2eb4dd(0x29e))[_0x2eb4dd(0x290)][_0x2eb4dd(0x171)](_0x2eb4dd(0x14c));},window['app'][_0x3deb21(0x22a)]=async()=>{const _0x2f0348=_0x3deb21,_0x363ae5=state[_0x2f0348(0x1a2)];if(!_0x363ae5||_0x363ae5[_0x2f0348(0x2ea)])return;try{const _0x2c5f5e=doc(db,finalCollectionPath,_0x363ae5['id']);await updateDoc(_0x2c5f5e,{'CheckIN':serverTimestamp(),'status':_0x2f0348(0x29d)}),window[_0x2f0348(0x1ab)][_0x2f0348(0x241)](_0x2f0348(0x236)+_0x363ae5[_0x2f0348(0x1d3)]+'\x20สำเร็จ','success'),window[_0x2f0348(0x1ab)][_0x2f0348(0x2af)](),document[_0x2f0348(0x1b5)](_0x2f0348(0x29b))[_0x2f0348(0x183)]='',window[_0x2f0348(0x1ab)][_0x2f0348(0x19c)]();}catch(_0x512888){console[_0x2f0348(0x18b)](_0x512888),window['app'][_0x2f0348(0x241)](_0x2f0348(0x18f),_0x2f0348(0x18b));}},window[_0x3deb21(0x1ab)][_0x3deb21(0x1b2)]=_0x360693=>{const _0x3f1f2d=_0x3deb21;document[_0x3f1f2d(0x218)]('.view-section')[_0x3f1f2d(0x27f)](_0x11f324=>_0x11f324[_0x3f1f2d(0x290)][_0x3f1f2d(0x171)](_0x3f1f2d(0x14c)));const _0x143596=document['getElementById'](_0x3f1f2d(0x1be)+_0x360693);if(_0x143596)_0x143596[_0x3f1f2d(0x290)][_0x3f1f2d(0x1f8)]('hidden');document[_0x3f1f2d(0x218)]('.nav-item')[_0x3f1f2d(0x27f)](_0x311587=>{const _0x2bbef2=_0x3f1f2d;_0x311587['classList'][_0x2bbef2(0x1f8)](_0x2bbef2(0x27a),_0x2bbef2(0x1e3)),_0x311587[_0x2bbef2(0x290)][_0x2bbef2(0x171)]('text-slate-400');});const _0x530478=document[_0x3f1f2d(0x1b5)](_0x3f1f2d(0x2c8)+_0x360693);_0x530478&&(_0x530478[_0x3f1f2d(0x290)]['remove'](_0x3f1f2d(0x169)),_0x530478['classList'][_0x3f1f2d(0x171)](_0x3f1f2d(0x27a),_0x3f1f2d(0x1e3)));let _0x5ad14a='ภาพรวมระบบ';switch(_0x360693){case _0x3f1f2d(0x28e):_0x5ad14a=_0x3f1f2d(0x283);break;case _0x3f1f2d(0x28f):_0x5ad14a=_0x3f1f2d(0x209);break;case _0x3f1f2d(0x1a9):_0x5ad14a=_0x3f1f2d(0x253);break;case _0x3f1f2d(0x2de):_0x5ad14a='ข้อมูลลงทะเบียน';break;case _0x3f1f2d(0x185):_0x5ad14a='ข้อมูลสมาชิกปันผล';break;case _0x3f1f2d(0x21b):_0x5ad14a=_0x3f1f2d(0x272);break;case _0x3f1f2d(0x2b8):_0x5ad14a=_0x3f1f2d(0x2ab);break;case _0x3f1f2d(0x25a):_0x5ad14a=_0x3f1f2d(0x278);break;case _0x3f1f2d(0x228):_0x5ad14a='QR\x20Code\x20CheckOUT';break;}document['getElementById'](_0x3f1f2d(0x1bf))['innerText']=_0x5ad14a;if(_0x360693===_0x3f1f2d(0x28e))window[_0x3f1f2d(0x1ab)][_0x3f1f2d(0x25e)]();if(_0x360693==='dividend-info')renderDividendTable(state[_0x3f1f2d(0x29c)]);if(_0x360693===_0x3f1f2d(0x2de))renderTable(state['users']);},window[_0x3deb21(0x1ab)][_0x3deb21(0x250)]=_0x547dc9=>{const _0xa8e6a2=_0x3deb21;state['rowsPerPage']=parseInt(_0x547dc9),state[_0xa8e6a2(0x212)]=0x1,renderTable(state['users']);},window[_0x3deb21(0x1ab)]['changePage']=_0x3d73ad=>{const _0x11ae0c=_0x3deb21;state[_0x11ae0c(0x212)]+=_0x3d73ad,renderTable(state[_0x11ae0c(0x1ac)]);},window[_0x3deb21(0x1ab)][_0x3deb21(0x1b9)]=_0x446eb5=>{const _0x3fe8aa=_0x3deb21;state[_0x3fe8aa(0x195)]===_0x446eb5?state[_0x3fe8aa(0x2db)]=state[_0x3fe8aa(0x2db)]==='asc'?'desc':'asc':(state[_0x3fe8aa(0x195)]=_0x446eb5,state[_0x3fe8aa(0x2db)]='asc'),state[_0x3fe8aa(0x212)]=0x1,renderTable(state['users']);},window[_0x3deb21(0x1ab)][_0x3deb21(0x291)]=_0x2eb336=>{const _0x3a0328=_0x3deb21;state['sortOrder']=_0x2eb336,state[_0x3a0328(0x212)]=0x1,renderTable(state[_0x3a0328(0x1ac)]);},window[_0x3deb21(0x1ab)][_0x3deb21(0x258)]=_0x402158=>{const _0x13197b=_0x3deb21;state[_0x13197b(0x2c7)]=_0x402158[_0x13197b(0x2d8)]()[_0x13197b(0x234)](),state['currentPage']=0x1,renderTable(state['users']);};function _0x199d(_0x1e9fa2,_0xdefdbd){_0x1e9fa2=_0x1e9fa2-0x144;const _0x29fe7f=_0x29fe();let _0x199dc0=_0x29fe7f[_0x1e9fa2];return _0x199dc0;}function renderTable(_0x2f2c4d){const _0xf74524=_0x3deb21,_0x17381e=document[_0xf74524(0x1b5)]('table-body');if(!_0x17381e)return;const _0x2e5b20=document[_0xf74524(0x1b5)]('data-table-info');let _0x4505c7=[..._0x2f2c4d];state['searchTerm']&&(_0x4505c7=_0x2f2c4d['filter'](_0xcb5daa=>(_0xcb5daa[_0xf74524(0x1d3)]||'')[_0xf74524(0x234)]()[_0xf74524(0x1b3)](state[_0xf74524(0x2c7)])||(_0xcb5daa['EmpMember']||'')[_0xf74524(0x2a0)]()['toLowerCase']()[_0xf74524(0x1b3)](state[_0xf74524(0x2c7)])));const _0x4c0025=[..._0x4505c7][_0xf74524(0x1b7)]((_0x521d20,_0x598f73)=>{const _0x4e96d9=_0xf74524,_0x37bc85=state['sortBy']||_0x4e96d9(0x182);let _0x51689d=_0x521d20[_0x37bc85],_0x129aa4=_0x598f73[_0x37bc85];if(_0x51689d===null||_0x51689d===undefined)_0x51689d='';if(_0x129aa4===null||_0x129aa4===undefined)_0x129aa4='';if(_0x37bc85===_0x4e96d9(0x2ea)){const _0xc1f95a=_0x51689d?_0x51689d[_0x4e96d9(0x224)]?_0x51689d[_0x4e96d9(0x224)]()[_0x4e96d9(0x1ba)]():new Date(_0x51689d)[_0x4e96d9(0x1ba)]():0x0,_0x475db4=_0x129aa4?_0x129aa4[_0x4e96d9(0x224)]?_0x129aa4[_0x4e96d9(0x224)]()[_0x4e96d9(0x1ba)]():new Date(_0x129aa4)[_0x4e96d9(0x1ba)]():0x0;return state[_0x4e96d9(0x2db)]===_0x4e96d9(0x286)?_0xc1f95a-_0x475db4:_0x475db4-_0xc1f95a;}if(_0x37bc85==='EmpMember'){const _0x112d22=parseInt(_0x51689d)||0x0,_0x3ffb53=parseInt(_0x129aa4)||0x0;return state[_0x4e96d9(0x2db)]===_0x4e96d9(0x286)?_0x112d22-_0x3ffb53:_0x3ffb53-_0x112d22;}_0x51689d=_0x51689d[_0x4e96d9(0x2a0)]()[_0x4e96d9(0x234)](),_0x129aa4=_0x129aa4[_0x4e96d9(0x2a0)]()[_0x4e96d9(0x234)]();if(_0x51689d<_0x129aa4)return state[_0x4e96d9(0x2db)]==='asc'?-0x1:0x1;if(_0x51689d>_0x129aa4)return state['sortOrder']===_0x4e96d9(0x286)?0x1:-0x1;return 0x0;}),_0x3c4300=[_0xf74524(0x182),_0xf74524(0x1d3),_0xf74524(0x2ea),_0xf74524(0x215)];_0x3c4300[_0xf74524(0x27f)](_0x2033e5=>{const _0x57775a=_0xf74524,_0x41def8=document[_0x57775a(0x1b5)](_0x57775a(0x239)+_0x2033e5);_0x41def8&&(state[_0x57775a(0x195)]===_0x2033e5?(_0x41def8['innerHTML']=state[_0x57775a(0x2db)]==='asc'?'↑':'↓',_0x41def8[_0x57775a(0x15a)]=_0x57775a(0x2c2)):(_0x41def8[_0x57775a(0x2e3)]='⇅',_0x41def8[_0x57775a(0x15a)]=_0x57775a(0x161)));});const _0x434870=state[_0xf74524(0x165)]===0x1869f?_0x4c0025[_0xf74524(0x194)]:state[_0xf74524(0x165)],_0xc56bf6=Math[_0xf74524(0x2d6)](_0x4c0025[_0xf74524(0x194)]/_0x434870)||0x1;if(state[_0xf74524(0x212)]>_0xc56bf6)state[_0xf74524(0x212)]=_0xc56bf6;const _0x1383ad=(state[_0xf74524(0x212)]-0x1)*_0x434870,_0x1d7018=_0x4c0025[_0xf74524(0x2d4)](_0x1383ad,_0x1383ad+_0x434870),_0x41892c=document['getElementById'](_0xf74524(0x2eb));if(_0x41892c)_0x41892c['innerText']='Page\x20'+state['currentPage']+_0xf74524(0x237)+_0xc56bf6;const _0x143ce0=document['getElementById']('btn-prev');if(_0x143ce0)_0x143ce0['disabled']=state[_0xf74524(0x212)]<=0x1;const _0x527f75=document[_0xf74524(0x1b5)](_0xf74524(0x24c));if(_0x527f75)_0x527f75[_0xf74524(0x293)]=state[_0xf74524(0x212)]>=_0xc56bf6;if(_0x2e5b20)_0x2e5b20[_0xf74524(0x280)]=_0xf74524(0x282)+_0x1d7018['length']+_0xf74524(0x19d)+_0x2f2c4d[_0xf74524(0x194)]+_0xf74524(0x29f);_0x17381e['innerHTML']=_0x1d7018['map']((_0x18926e,_0x2aa949)=>{const _0x18e28a=_0xf74524,_0x53f4d2=_0x18926e['CheckIN']?(_0x18926e[_0x18e28a(0x2ea)]['toDate']?_0x18926e['CheckIN']['toDate']():new Date(_0x18926e[_0x18e28a(0x2ea)]))[_0x18e28a(0x2ba)]('th-TH'):'-',_0x1bcb22=_0x18926e[_0x18e28a(0x215)]||'<span\x20class=\x22text-slate-300\x22>-</span>';let _0x172d70='-';if(_0x18926e[_0x18e28a(0x2c1)])_0x172d70=_0x18e28a(0x153);else{if(_0x18926e[_0x18e28a(0x215)]&&_0x18926e['reward']!==_0x18e28a(0x1b8))_0x172d70=_0x18e28a(0x20a);else _0x18926e[_0x18e28a(0x215)]===_0x18e28a(0x1b8)&&(_0x172d70=_0x18e28a(0x19b));}const _0x32a535=_0x18926e['EmpName']||_0x18e28a(0x1c6)+(_0x18926e[_0x18e28a(0x2d0)]?_0x18926e[_0x18e28a(0x2d0)][_0x18e28a(0x211)](0x0,0x6):_0x18e28a(0x24a))+'...</span>';return _0x18e28a(0x20e)+(_0x18926e[_0x18e28a(0x182)]||'-')+_0x18e28a(0x181)+_0x32a535+_0x18e28a(0x202)+_0x53f4d2+_0x18e28a(0x1c7)+_0x1bcb22+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-sm\x22>'+_0x172d70+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-right\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.deleteSingleData(\x27'+_0x18926e['id']+_0x18e28a(0x2a5);})['join']('');if(window[_0xf74524(0x249)])lucide[_0xf74524(0x204)]();}window[_0x3deb21(0x1ab)]['downloadRegistrationCSV']=()=>{const _0x486add=_0x3deb21,_0xb62465=state[_0x486add(0x1ac)];let _0x1e06f8=[..._0xb62465];state[_0x486add(0x2c7)]&&(_0x1e06f8=_0x1e06f8['filter'](_0xd01a71=>(_0xd01a71['EmpName']||'')[_0x486add(0x234)]()[_0x486add(0x1b3)](state[_0x486add(0x2c7)])||(_0xd01a71[_0x486add(0x182)]||'')['toString']()[_0x486add(0x234)]()[_0x486add(0x1b3)](state['searchTerm'])));_0x1e06f8[_0x486add(0x1b7)]((_0x57d96c,_0x86deb9)=>{const _0xaf3527=_0x486add,_0x48b14a=state['sortBy'];let _0x51b665=_0x57d96c[_0x48b14a],_0x485c70=_0x86deb9[_0x48b14a];if(_0x51b665===null||_0x51b665===undefined)_0x51b665='';if(_0x485c70===null||_0x485c70===undefined)_0x485c70='';if(_0x48b14a===_0xaf3527(0x2ea)){const _0xbc95f=_0x51b665?_0x51b665[_0xaf3527(0x224)]?_0x51b665[_0xaf3527(0x224)]()[_0xaf3527(0x1ba)]():new Date(_0x51b665)[_0xaf3527(0x1ba)]():0x0,_0x2c492=_0x485c70?_0x485c70['toDate']?_0x485c70['toDate']()[_0xaf3527(0x1ba)]():new Date(_0x485c70)[_0xaf3527(0x1ba)]():0x0;return state[_0xaf3527(0x2db)]===_0xaf3527(0x286)?_0xbc95f-_0x2c492:_0x2c492-_0xbc95f;}if(_0x48b14a===_0xaf3527(0x182)){const _0x4edbd7=parseInt(_0x51b665)||0x0,_0x2ab2c1=parseInt(_0x485c70)||0x0;return state['sortOrder']===_0xaf3527(0x286)?_0x4edbd7-_0x2ab2c1:_0x2ab2c1-_0x4edbd7;}_0x51b665=_0x51b665[_0xaf3527(0x2a0)]()[_0xaf3527(0x234)](),_0x485c70=_0x485c70['toString']()[_0xaf3527(0x234)]();if(_0x51b665<_0x485c70)return state[_0xaf3527(0x2db)]===_0xaf3527(0x286)?-0x1:0x1;if(_0x51b665>_0x485c70)return state['sortOrder']===_0xaf3527(0x286)?0x1:-0x1;return 0x0;});const _0x31ad82=['no','ชื่อ-นามสกุล',_0x486add(0x262),_0x486add(0x23b),'สถานะรับรางวัล'],_0x59b4d1=[_0x31ad82[_0x486add(0x173)](',')];_0x1e06f8[_0x486add(0x27f)](_0x3e58ce=>{const _0x499727=_0x486add,_0xe4b2ad=_0x3e58ce['CheckIN']?_0x3e58ce[_0x499727(0x2ea)][_0x499727(0x224)]?_0x3e58ce[_0x499727(0x2ea)][_0x499727(0x224)]()[_0x499727(0x2ba)](_0x499727(0x2c6)):_0x3e58ce[_0x499727(0x2ea)]:'-';let _0x597e7e='-';if(_0x3e58ce[_0x499727(0x2c1)])_0x597e7e=_0x499727(0x22b);else{if(_0x3e58ce[_0x499727(0x215)]&&_0x3e58ce[_0x499727(0x215)]!==_0x499727(0x1b8))_0x597e7e=_0x499727(0x28b);else{if(_0x3e58ce['reward']===_0x499727(0x1b8))_0x597e7e=_0x499727(0x22c);}}const _0x26f76c=[_0x3e58ce[_0x499727(0x182)]||'','\x22'+(_0x3e58ce[_0x499727(0x1d3)]||'')+'\x22','\x22'+_0xe4b2ad+'\x22','\x22'+(_0x3e58ce[_0x499727(0x215)]||'')+'\x22','\x22'+_0x597e7e+'\x22'];_0x59b4d1[_0x499727(0x2ad)](_0x26f76c[_0x499727(0x173)](','));});const _0x33eaf9='\ufeff'+_0x59b4d1[_0x486add(0x173)]('\x0a'),_0x3fb195=new Blob([_0x33eaf9],{'type':_0x486add(0x24e)}),_0x2238d0=URL[_0x486add(0x289)](_0x3fb195),_0x5e700f=document[_0x486add(0x17f)]('a');_0x5e700f[_0x486add(0x1aa)](_0x486add(0x1da),_0x2238d0),_0x5e700f[_0x486add(0x1aa)](_0x486add(0x1b0),_0x486add(0x251)+new Date()['toLocaleDateString']('th-TH')+_0x486add(0x186)),_0x5e700f[_0x486add(0x1e0)][_0x486add(0x287)]=_0x486add(0x14c),document['body'][_0x486add(0x274)](_0x5e700f),_0x5e700f[_0x486add(0x196)](),document[_0x486add(0x1dc)][_0x486add(0x2b0)](_0x5e700f),window['app']['showToast']('ส่งออกไฟล์\x20CSV\x20เรียบร้อยแล้ว',_0x486add(0x2b4));},window['app']['handleDividendSearch']=_0x133a9b=>{const _0x5544e1=_0x3deb21;state[_0x5544e1(0x285)]=_0x133a9b[_0x5544e1(0x2d8)]()[_0x5544e1(0x234)](),state[_0x5544e1(0x1d7)]=0x1,renderDividendTable(state[_0x5544e1(0x29c)]);},window[_0x3deb21(0x1ab)][_0x3deb21(0x168)]=_0x5b136e=>{const _0x2defe3=_0x3deb21;state[_0x2defe3(0x1d7)]+=_0x5b136e,renderDividendTable(state['dividendUsers']);},window[_0x3deb21(0x1ab)][_0x3deb21(0x15b)]=_0x560fb6=>{const _0x15d23e=_0x3deb21;state[_0x15d23e(0x151)]===_0x560fb6?state[_0x15d23e(0x1d4)]=state[_0x15d23e(0x1d4)]==='asc'?_0x15d23e(0x149):_0x15d23e(0x286):(state[_0x15d23e(0x151)]=_0x560fb6,state[_0x15d23e(0x1d4)]='asc'),renderDividendTable(state[_0x15d23e(0x29c)]);};function renderDividendTable(_0x54e0a4){const _0x4c1fd7=_0x3deb21,_0x341ef8=document[_0x4c1fd7(0x1b5)](_0x4c1fd7(0x288));if(!_0x341ef8)return;let _0x432158=[..._0x54e0a4];state[_0x4c1fd7(0x285)]&&(_0x432158=_0x432158[_0x4c1fd7(0x1fd)](_0x2e3aeb=>(_0x2e3aeb[_0x4c1fd7(0x1e8)]||'')[_0x4c1fd7(0x234)]()[_0x4c1fd7(0x1b3)](state['divSearchTerm'])||(_0x2e3aeb['no']||'')[_0x4c1fd7(0x2a0)]()[_0x4c1fd7(0x234)]()[_0x4c1fd7(0x1b3)](state['divSearchTerm'])));_0x432158['sort']((_0xef81eb,_0x12a3a6)=>{const _0x1367b5=_0x4c1fd7,_0x326557=state[_0x1367b5(0x151)];let _0x3bc8c5=_0xef81eb[_0x326557],_0x104d67=_0x12a3a6[_0x326557];if(_0x3bc8c5===null||_0x3bc8c5===undefined)_0x3bc8c5='';if(_0x104d67===null||_0x104d67===undefined)_0x104d67='';if(_0x326557===_0x1367b5(0x2b8)||_0x326557==='moneyback'||_0x326557==='gratuity'||_0x326557===_0x1367b5(0x2b2)||_0x326557==='no'){const _0x4638d0=parseFloat(_0x3bc8c5)||0x0,_0x337b91=parseFloat(_0x104d67)||0x0;return state['divSortOrder']===_0x1367b5(0x286)?_0x4638d0-_0x337b91:_0x337b91-_0x4638d0;}if(_0x326557===_0x1367b5(0x1db)){const _0x1080b9=_0x3bc8c5?_0x3bc8c5['toDate']?_0x3bc8c5[_0x1367b5(0x224)]()[_0x1367b5(0x1ba)]():new Date(_0x3bc8c5)[_0x1367b5(0x1ba)]():0x0,_0x2773e8=_0x104d67?_0x104d67['toDate']?_0x104d67[_0x1367b5(0x224)]()[_0x1367b5(0x1ba)]():new Date(_0x104d67)['getTime']():0x0;return state[_0x1367b5(0x1d4)]===_0x1367b5(0x286)?_0x1080b9-_0x2773e8:_0x2773e8-_0x1080b9;}_0x3bc8c5=_0x3bc8c5[_0x1367b5(0x2a0)]()[_0x1367b5(0x234)](),_0x104d67=_0x104d67[_0x1367b5(0x2a0)]()['toLowerCase']();if(_0x3bc8c5<_0x104d67)return state['divSortOrder']==='asc'?-0x1:0x1;if(_0x3bc8c5>_0x104d67)return state[_0x1367b5(0x2db)]===_0x1367b5(0x286)?0x1:-0x1;return 0x0;});const _0x59956c=_0x54e0a4[_0x4c1fd7(0x194)],_0x454bb4=_0x54e0a4[_0x4c1fd7(0x1fd)](_0x514451=>_0x514451['DateLogin'])[_0x4c1fd7(0x194)],_0x4257b0=_0x54e0a4[_0x4c1fd7(0x1fd)](_0x200cd8=>_0x200cd8[_0x4c1fd7(0x261)])[_0x4c1fd7(0x194)],_0x59c4ad=document[_0x4c1fd7(0x1b5)](_0x4c1fd7(0x190));if(_0x59c4ad)_0x59c4ad[_0x4c1fd7(0x280)]=_0x59956c[_0x4c1fd7(0x2ba)]();const _0x287296=document[_0x4c1fd7(0x1b5)]('div-stat-registered');if(_0x287296)_0x287296[_0x4c1fd7(0x280)]=_0x454bb4[_0x4c1fd7(0x2ba)]();const _0x2906ea=document[_0x4c1fd7(0x1b5)](_0x4c1fd7(0x235));if(_0x2906ea)_0x2906ea['innerText']=_0x4257b0[_0x4c1fd7(0x2ba)]();const _0xbefdac=['no',_0x4c1fd7(0x1e8),_0x4c1fd7(0x2b8),_0x4c1fd7(0x2e9),_0x4c1fd7(0x24d),_0x4c1fd7(0x2b2),'DateLogin',_0x4c1fd7(0x261)];_0xbefdac[_0x4c1fd7(0x27f)](_0x3ec072=>{const _0x432eb7=_0x4c1fd7,_0x3f0b27=document[_0x432eb7(0x1b5)](_0x432eb7(0x14f)+_0x3ec072);_0x3f0b27&&(state[_0x432eb7(0x151)]===_0x3ec072?(_0x3f0b27[_0x432eb7(0x2e3)]=state[_0x432eb7(0x1d4)]===_0x432eb7(0x286)?'↑':'↓',_0x3f0b27[_0x432eb7(0x15a)]=_0x432eb7(0x2c2)):(_0x3f0b27[_0x432eb7(0x2e3)]='⇅',_0x3f0b27[_0x432eb7(0x15a)]=_0x432eb7(0x161)));});const _0x1b97f3=state[_0x4c1fd7(0x231)],_0xdf4169=Math[_0x4c1fd7(0x2d6)](_0x432158[_0x4c1fd7(0x194)]/_0x1b97f3)||0x1;if(state[_0x4c1fd7(0x1d7)]>_0xdf4169)state[_0x4c1fd7(0x1d7)]=_0xdf4169;const _0x3635ab=(state[_0x4c1fd7(0x1d7)]-0x1)*_0x1b97f3,_0x3e0523=_0x432158['slice'](_0x3635ab,_0x3635ab+_0x1b97f3),_0x5befda=document[_0x4c1fd7(0x1b5)](_0x4c1fd7(0x170));if(_0x5befda)_0x5befda['innerText']='Page\x20'+state[_0x4c1fd7(0x1d7)]+_0x4c1fd7(0x237)+_0xdf4169;const _0x2923b6=document['getElementById'](_0x4c1fd7(0x23d));if(_0x2923b6)_0x2923b6[_0x4c1fd7(0x293)]=state[_0x4c1fd7(0x1d7)]<=0x1;const _0x4d5d44=document[_0x4c1fd7(0x1b5)]('btn-div-next');if(_0x4d5d44)_0x4d5d44[_0x4c1fd7(0x293)]=state[_0x4c1fd7(0x1d7)]>=_0xdf4169;const _0x377559=document[_0x4c1fd7(0x1b5)](_0x4c1fd7(0x200));if(_0x377559)_0x377559[_0x4c1fd7(0x280)]='แสดงผล\x20'+_0x3e0523[_0x4c1fd7(0x194)]+_0x4c1fd7(0x19d)+_0x432158[_0x4c1fd7(0x194)]+_0x4c1fd7(0x29f);if(_0x3e0523['length']===0x0){_0x341ef8[_0x4c1fd7(0x2e3)]=_0x4c1fd7(0x27c);return;}_0x341ef8[_0x4c1fd7(0x2e3)]=_0x3e0523[_0x4c1fd7(0x28d)](_0x20e6ad=>{const _0x180167=_0x4c1fd7,_0x41f46b=parseFloat(_0x20e6ad[_0x180167(0x2b8)]||0x0)[_0x180167(0x2ba)](undefined,{'minimumFractionDigits':0x2}),_0x4e8114=parseFloat(_0x20e6ad[_0x180167(0x2e9)]||0x0)['toLocaleString'](undefined,{'minimumFractionDigits':0x2}),_0x5034eb=parseFloat(_0x20e6ad[_0x180167(0x24d)]||0x0)[_0x180167(0x2ba)](undefined,{'minimumFractionDigits':0x2}),_0x4bb930=parseFloat(_0x20e6ad[_0x180167(0x2b2)]||0x0)[_0x180167(0x2ba)](undefined,{'minimumFractionDigits':0x2}),_0x258886=_0x20e6ad[_0x180167(0x1db)]?_0x20e6ad[_0x180167(0x1db)][_0x180167(0x224)]?_0x20e6ad['DateLogin']['toDate']()['toLocaleString'](_0x180167(0x2c6)):_0x20e6ad[_0x180167(0x1db)]:'-',_0x1c73d5=_0x20e6ad[_0x180167(0x261)]?_0x180167(0x213)+_0x20e6ad[_0x180167(0x261)]+_0x180167(0x1d0):'-',_0x4e1160=_0x20e6ad['no']||'-';return _0x180167(0x245)+_0x4e1160+_0x180167(0x1ef)+(_0x20e6ad[_0x180167(0x1e8)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-right\x22>'+_0x41f46b+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20text-right\x22>'+_0x4e8114+_0x180167(0x1a0)+_0x5034eb+_0x180167(0x216)+_0x4bb930+_0x180167(0x2ac)+_0x258886+_0x180167(0x28a)+_0x1c73d5+_0x180167(0x1c9)+_0x20e6ad['id']+_0x180167(0x248);})[_0x4c1fd7(0x173)]('');if(window[_0x4c1fd7(0x249)])lucide['createIcons']();}window[_0x3deb21(0x1ab)][_0x3deb21(0x198)]=()=>{const _0x1eaf52=_0x3deb21,_0x485ea4=state['dividendUsers'];let _0x19b487=[..._0x485ea4];state[_0x1eaf52(0x285)]&&(_0x19b487=_0x19b487[_0x1eaf52(0x1fd)](_0x950b99=>(_0x950b99[_0x1eaf52(0x1e8)]||'')[_0x1eaf52(0x234)]()[_0x1eaf52(0x1b3)](state[_0x1eaf52(0x285)])||(_0x950b99['no']||'')[_0x1eaf52(0x2a0)]()[_0x1eaf52(0x234)]()[_0x1eaf52(0x1b3)](state['divSearchTerm'])));_0x19b487[_0x1eaf52(0x1b7)]((_0xa004b2,_0x3effb3)=>{const _0x25c024=_0x1eaf52,_0xd3aa43=state['divSortBy'];let _0x71e9b=_0xa004b2[_0xd3aa43],_0x598da5=_0x3effb3[_0xd3aa43];if(_0x71e9b===null||_0x71e9b===undefined)_0x71e9b='';if(_0x598da5===null||_0x598da5===undefined)_0x598da5='';if(_0xd3aa43===_0x25c024(0x2b8)||_0xd3aa43===_0x25c024(0x2e9)||_0xd3aa43==='gratuity'||_0xd3aa43===_0x25c024(0x2b2)||_0xd3aa43==='no'){const _0x3a0775=parseFloat(_0x71e9b)||0x0,_0xfe2f71=parseFloat(_0x598da5)||0x0;return state[_0x25c024(0x1d4)]===_0x25c024(0x286)?_0x3a0775-_0xfe2f71:_0xfe2f71-_0x3a0775;}_0x71e9b=_0x71e9b[_0x25c024(0x2a0)]()[_0x25c024(0x234)](),_0x598da5=_0x598da5[_0x25c024(0x2a0)]()[_0x25c024(0x234)]();if(_0x71e9b<_0x598da5)return state[_0x25c024(0x1d4)]===_0x25c024(0x286)?-0x1:0x1;if(_0x71e9b>_0x598da5)return state[_0x25c024(0x2db)]==='asc'?0x1:-0x1;return 0x0;});const _0x2bb14d=[_0x1eaf52(0x19e),'ชื่อ-นามสกุล(empname)',_0x1eaf52(0x14e),'เงินเฉลี่ยคืน',_0x1eaf52(0x219),_0x1eaf52(0x242),'ลงทะเบียน','เข้าประชุม'],_0x6f653b=[_0x2bb14d[_0x1eaf52(0x173)](',')];_0x19b487[_0x1eaf52(0x27f)](_0x36cfcc=>{const _0x158217=_0x1eaf52,_0x28e093=_0x36cfcc[_0x158217(0x1db)]?_0x36cfcc[_0x158217(0x1db)][_0x158217(0x224)]?_0x36cfcc[_0x158217(0x1db)][_0x158217(0x224)]()[_0x158217(0x2ba)](_0x158217(0x2c6)):_0x36cfcc[_0x158217(0x1db)]:'-',_0x5d5528=[_0x36cfcc['no']||'','\x22'+(_0x36cfcc[_0x158217(0x1e8)]||'')+'\x22',_0x36cfcc['dividend']||0x0,_0x36cfcc[_0x158217(0x2e9)]||0x0,_0x36cfcc[_0x158217(0x24d)]||0x0,_0x36cfcc[_0x158217(0x2b2)]||0x0,'\x22'+_0x28e093+'\x22','\x22'+(_0x36cfcc[_0x158217(0x261)]||'')+'\x22'];_0x6f653b[_0x158217(0x2ad)](_0x5d5528[_0x158217(0x173)](','));});const _0x42c3e3='\ufeff'+_0x6f653b['join']('\x0a'),_0x328aef=new Blob([_0x42c3e3],{'type':_0x1eaf52(0x24e)}),_0x4486a1=URL[_0x1eaf52(0x289)](_0x328aef),_0x446db9=document['createElement']('a');_0x446db9['setAttribute'](_0x1eaf52(0x1da),_0x4486a1),_0x446db9[_0x1eaf52(0x1aa)]('download',_0x1eaf52(0x2cc)+new Date()[_0x1eaf52(0x18e)](_0x1eaf52(0x2c6))+_0x1eaf52(0x186)),_0x446db9['style'][_0x1eaf52(0x287)]=_0x1eaf52(0x14c),document[_0x1eaf52(0x1dc)][_0x1eaf52(0x274)](_0x446db9),_0x446db9[_0x1eaf52(0x196)](),document[_0x1eaf52(0x1dc)][_0x1eaf52(0x2b0)](_0x446db9),window['app']['showToast'](_0x1eaf52(0x146),'success');},window[_0x3deb21(0x1ab)]['resetSingleDividendData']=async _0xb4d8e0=>{const _0x532a87=_0x3deb21;if(!confirm(_0x532a87(0x201)))return;try{const _0x160795=doc(db,dividendCollectionPath,_0xb4d8e0);await updateDoc(_0x160795,{'DateLogin':null,'RegisMeeting':null,'DateMeeting':null}),window[_0x532a87(0x1ab)][_0x532a87(0x241)](_0x532a87(0x23a),'success');}catch(_0x4bd3bf){console[_0x532a87(0x18b)](_0x4bd3bf),window['app']['showToast'](_0x532a87(0x2c3),_0x532a87(0x18b));}},window[_0x3deb21(0x1ab)]['resetWinnerStatus']=async _0x5f006d=>{const _0x5aaf76=_0x3deb21;if(!confirm(_0x5aaf76(0x2be)))return;try{const _0x197779=doc(db,finalCollectionPath,_0x5f006d);await updateDoc(_0x197779,{'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField()}),window['app'][_0x5aaf76(0x241)](_0x5aaf76(0x17e),_0x5aaf76(0x2b4));}catch(_0x2b6a4b){console[_0x5aaf76(0x18b)](_0x2b6a4b),window['app'][_0x5aaf76(0x241)]('ล้างข้อมูลไม่สำเร็จ','error');}},window['app']['renderResults']=()=>{const _0xe117a9=_0x3deb21,_0x57ac71=state[_0xe117a9(0x1e9)],_0x34f0ff=document[_0xe117a9(0x1b5)]('monitor-total-db');if(_0x34f0ff)_0x34f0ff[_0xe117a9(0x280)]=_0x57ac71['totalDocs'];const _0xcaa028=document[_0xe117a9(0x1b5)](_0xe117a9(0x27d));if(_0xcaa028)_0xcaa028[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x147)];const _0x25b072=document[_0xe117a9(0x1b5)](_0xe117a9(0x1cb));if(_0x25b072)_0x25b072[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x2a6)];const _0x4a472d=document[_0xe117a9(0x1b5)](_0xe117a9(0x232));if(_0x4a472d)_0x4a472d[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x2a6)];const _0x478a44=document[_0xe117a9(0x1b5)](_0xe117a9(0x148));if(_0x478a44)_0x478a44['innerText']=_0x57ac71[_0xe117a9(0x2c0)];const _0x4d5a7c=document[_0xe117a9(0x1b5)](_0xe117a9(0x1b4));if(_0x4d5a7c)_0x4d5a7c[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x206)];const _0x4d56e1=document[_0xe117a9(0x1b5)]('rand-stat-noreward');if(_0x4d56e1)_0x4d56e1['innerText']=_0x57ac71[_0xe117a9(0x2ce)];const _0x46d2bc=document['getElementById'](_0xe117a9(0x1d6));if(_0x46d2bc)_0x46d2bc[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x197)];const _0x3b2793=document[_0xe117a9(0x1b5)](_0xe117a9(0x1c8));if(_0x3b2793)_0x3b2793[_0xe117a9(0x280)]=_0x57ac71[_0xe117a9(0x2d5)];const _0x59a457=document['getElementById'](_0xe117a9(0x2d3));if(_0x59a457)_0x59a457[_0xe117a9(0x280)]=_0x57ac71['eligible'];const _0xd205e0=document[_0xe117a9(0x1b5)]('filter-results-status'),_0x568a4d=_0xd205e0?_0xd205e0[_0xe117a9(0x183)]:_0xe117a9(0x1ae);let _0x3b35a1=state['users']['filter'](_0x1ed0bc=>_0x1ed0bc[_0xe117a9(0x215)]);if(_0x568a4d==='no_reward')_0x3b35a1=state[_0xe117a9(0x1ac)]['filter'](_0xa2b9ab=>_0xa2b9ab[_0xe117a9(0x215)]===_0xe117a9(0x1b8));else{_0x3b35a1=_0x3b35a1['filter'](_0x1526fa=>_0x1526fa['reward']!==_0xe117a9(0x1b8));if(_0x568a4d==='claimed')_0x3b35a1=_0x3b35a1[_0xe117a9(0x1fd)](_0x2119a1=>_0x2119a1[_0xe117a9(0x2c1)]);else{if(_0x568a4d===_0xe117a9(0x229))_0x3b35a1=_0x3b35a1[_0xe117a9(0x1fd)](_0x24288b=>!_0x24288b[_0xe117a9(0x2c1)]);}}_0x3b35a1[_0xe117a9(0x1b7)]((_0xa76e85,_0x340779)=>(_0x340779[_0xe117a9(0x203)]?.[_0xe117a9(0x224)]?.()||new Date(0x0))-(_0xa76e85[_0xe117a9(0x203)]?.[_0xe117a9(0x224)]?.()||new Date(0x0)));const _0x32c1b8=document[_0xe117a9(0x1b5)](_0xe117a9(0x238));if(!_0x32c1b8)return;if(_0x3b35a1[_0xe117a9(0x194)]===0x0){_0x32c1b8['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22px-6\x20py-8\x20text-center\x20text-slate-400\x20text-sm\x22>ไม่พบข้อมูล</td></tr>';return;}_0x32c1b8[_0xe117a9(0x2e3)]=_0x3b35a1[_0xe117a9(0x28d)]((_0xee3bdc,_0x24193f)=>{const _0x565878=_0xe117a9,_0x2bd7a7=_0xee3bdc[_0x565878(0x203)]?_0xee3bdc[_0x565878(0x203)][_0x565878(0x224)]?_0xee3bdc[_0x565878(0x203)][_0x565878(0x224)]():new Date(_0xee3bdc['rewardTime']):new Date(),_0x3ff800=_0xee3bdc[_0x565878(0x2c1)]?_0x565878(0x153):_0xee3bdc['reward']===_0x565878(0x1b8)?'<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x22>ไม่ได้รางวัล</span>':_0x565878(0x20a),_0x3c335d=_0x565878(0x14a)+_0xee3bdc['id']+_0x565878(0x24f)+(!_0xee3bdc['reward']||_0xee3bdc['reward']===_0x565878(0x1b8)?'disabled':'')+_0x565878(0x247);return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-sm\x22>'+(_0x24193f+0x1)+_0x565878(0x191)+(_0xee3bdc[_0x565878(0x1d3)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-indigo-600\x20font-bold\x22>'+(_0xee3bdc[_0x565878(0x215)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20text-slate-500\x20font-mono\x20text-xs\x22>'+_0x2bd7a7[_0x565878(0x150)](_0x565878(0x2c6))+_0x565878(0x255)+_0x3ff800+_0x565878(0x187)+_0x3c335d+_0x565878(0x154);})[_0xe117a9(0x173)]('');if(window[_0xe117a9(0x249)])lucide[_0xe117a9(0x204)]();};function renderActivityFeed(_0x2f365a){const _0x3d3dbf=_0x3deb21,_0x46c550=document[_0x3d3dbf(0x1b5)]('recent-activity-list');if(!_0x46c550)return;let _0x113842=[];_0x2f365a[_0x3d3dbf(0x27f)](_0x45150a=>{const _0x3d09db=_0x3d3dbf,_0x48447f=_0x45150a['EmpName']||_0x3d09db(0x20f);if(_0x45150a['CheckIN'])_0x113842[_0x3d09db(0x2ad)]({'type':'in','date':_0x45150a[_0x3d09db(0x2ea)]['toDate']?_0x45150a['CheckIN'][_0x3d09db(0x224)]():new Date(_0x45150a['CheckIN']),'name':_0x48447f});if(_0x45150a[_0x3d09db(0x1e6)])_0x113842['push']({'type':_0x3d09db(0x254),'date':_0x45150a[_0x3d09db(0x1e6)][_0x3d09db(0x224)]?_0x45150a[_0x3d09db(0x1e6)][_0x3d09db(0x224)]():new Date(_0x45150a[_0x3d09db(0x1e6)]),'name':_0x48447f});}),_0x113842[_0x3d3dbf(0x1b7)]((_0x2055c6,_0x1d3118)=>_0x1d3118[_0x3d3dbf(0x1a6)]-_0x2055c6[_0x3d3dbf(0x1a6)]);const _0x20d803=_0x113842['slice'](0x0,0x32);if(_0x20d803[_0x3d3dbf(0x194)]===0x0){_0x46c550['innerHTML']=_0x3d3dbf(0x23f);return;}_0x46c550[_0x3d3dbf(0x2e3)]=_0x20d803[_0x3d3dbf(0x28d)](_0x457c54=>_0x3d3dbf(0x276)+(_0x457c54[_0x3d3dbf(0x28c)]==='in'?_0x3d3dbf(0x163):_0x3d3dbf(0x279))+_0x3d3dbf(0x23e)+(_0x457c54[_0x3d3dbf(0x28c)]==='in'?_0x3d3dbf(0x21f):'log-out')+_0x3d3dbf(0x2cd)+_0x457c54[_0x3d3dbf(0x21c)]+_0x3d3dbf(0x1df)+(_0x457c54['type']==='in'?_0x3d3dbf(0x1a8):_0x3d3dbf(0x162))+_0x3d3dbf(0x16b)+_0x457c54['date'][_0x3d3dbf(0x150)](_0x3d3dbf(0x2c6))+'</p></div></div>')[_0x3d3dbf(0x173)]('');if(window[_0x3d3dbf(0x249)])lucide[_0x3d3dbf(0x204)]();}function updateCharts(_0x237d32,_0x5a9cb0){const _0x4c3b40=_0x3deb21,_0x341957=Array[_0x4c3b40(0x221)]({'length':0x18},(_0x48a3d0,_0x2e46e6)=>_0x2e46e6+':00'),_0x238889=_0x341957[_0x4c3b40(0x28d)]((_0x16f64e,_0xdf98f9)=>_0x237d32[_0xdf98f9]||0x0),_0x1698d1=_0x341957[_0x4c3b40(0x28d)]((_0x5da00e,_0x2f47b3)=>_0x5a9cb0[_0x2f47b3]||0x0),_0x42f13f=document[_0x4c3b40(0x1b5)](_0x4c3b40(0x22f));if(_0x42f13f){if(window[_0x4c3b40(0x207)])window[_0x4c3b40(0x207)][_0x4c3b40(0x2de)][_0x4c3b40(0x21e)][0x0]['data']=_0x238889,window[_0x4c3b40(0x207)]['update']();else{const _0x15757a=_0x42f13f[_0x4c3b40(0x1ea)]('2d');window[_0x4c3b40(0x207)]=new Chart(_0x15757a,{'type':_0x4c3b40(0x268),'data':{'labels':_0x341957,'datasets':[{'label':'Check-IN','data':_0x238889,'borderColor':_0x4c3b40(0x277),'backgroundColor':'rgba(79,\x2070,\x20229,\x200.1)','fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}}const _0x10306b=document['getElementById'](_0x4c3b40(0x16e));if(_0x10306b){if(window[_0x4c3b40(0x2b9)])window['chartOutInstance'][_0x4c3b40(0x2de)][_0x4c3b40(0x21e)][0x0][_0x4c3b40(0x2de)]=_0x1698d1,window['chartOutInstance'][_0x4c3b40(0x1f1)]();else{const _0x5547e2=_0x10306b[_0x4c3b40(0x1ea)]('2d');window[_0x4c3b40(0x2b9)]=new Chart(_0x5547e2,{'type':_0x4c3b40(0x268),'data':{'labels':_0x341957,'datasets':[{'label':'Check-OUT','data':_0x1698d1,'borderColor':_0x4c3b40(0x1d9),'backgroundColor':_0x4c3b40(0x20b),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}}}function processSnapshot(_0x34f593){const _0x3db9c3=_0x3deb21,_0x487b86=[],_0x926948={...state[_0x3db9c3(0x1e9)],'totalDocs':_0x34f593[_0x3db9c3(0x270)],'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'registered':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0},_0x58f5ba={},_0x2072d5={};_0x34f593['forEach'](_0x2d2d49=>{const _0x20ee2b=_0x3db9c3,_0x1e1eee=_0x2d2d49[_0x20ee2b(0x2de)](),_0x4ff9b0={'id':_0x2d2d49['id'],..._0x1e1eee};_0x487b86[_0x20ee2b(0x2ad)](_0x4ff9b0);if(_0x1e1eee[_0x20ee2b(0x2ea)]){_0x926948[_0x20ee2b(0x1ad)]++;const _0x21c3f1=(_0x1e1eee[_0x20ee2b(0x2ea)][_0x20ee2b(0x224)]?_0x1e1eee['CheckIN'][_0x20ee2b(0x224)]():new Date(_0x1e1eee['CheckIN']))[_0x20ee2b(0x1c1)]();_0x58f5ba[_0x21c3f1]=(_0x58f5ba[_0x21c3f1]||0x0)+0x1;}if(_0x1e1eee[_0x20ee2b(0x1e6)]){_0x926948[_0x20ee2b(0x222)]++;const _0x4f2726=(_0x1e1eee[_0x20ee2b(0x1e6)][_0x20ee2b(0x224)]?_0x1e1eee['CheckOUT'][_0x20ee2b(0x224)]():new Date(_0x1e1eee[_0x20ee2b(0x1e6)]))[_0x20ee2b(0x1c1)]();_0x2072d5[_0x4f2726]=(_0x2072d5[_0x4f2726]||0x0)+0x1;}if(_0x1e1eee[_0x20ee2b(0x215)]){if(_0x1e1eee[_0x20ee2b(0x215)]===_0x20ee2b(0x1b8))_0x926948[_0x20ee2b(0x2c0)]++;else _0x926948[_0x20ee2b(0x2a6)]++;}if(_0x1e1eee[_0x20ee2b(0x2c1)])_0x926948['claimed']++;if(_0x1e1eee[_0x20ee2b(0x2b5)]&&_0x1e1eee[_0x20ee2b(0x2b5)][_0x20ee2b(0x2d8)]()!==''){_0x926948[_0x20ee2b(0x147)]++,_0x926948[_0x20ee2b(0x2a1)]++;if(!_0x1e1eee[_0x20ee2b(0x215)])_0x926948[_0x20ee2b(0x2ce)]++;else{if(_0x1e1eee['reward']===_0x20ee2b(0x22c))_0x926948[_0x20ee2b(0x197)]++;else _0x926948[_0x20ee2b(0x2d5)]++;}}}),state[_0x3db9c3(0x1ac)]=_0x487b86,state['stats']=_0x926948,updateDashboardUI(_0x926948),updateCharts(_0x58f5ba,_0x2072d5),renderActivityFeed(_0x487b86),renderTable(_0x487b86),window[_0x3db9c3(0x1ab)][_0x3db9c3(0x1fc)]();if(!document[_0x3db9c3(0x1b5)](_0x3db9c3(0x26d))[_0x3db9c3(0x290)][_0x3db9c3(0x1fa)](_0x3db9c3(0x14c)))window[_0x3db9c3(0x1ab)][_0x3db9c3(0x25e)]();}function updateDashboardUI(_0x4ae661){const _0x44d4a1=_0x3deb21,_0x1d29d5=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x1eb));if(_0x1d29d5)_0x1d29d5[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x1ad)];const _0x5e80d0=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x19f));if(_0x5e80d0)_0x5e80d0['innerText']=_0x4ae661[_0x44d4a1(0x222)];const _0x22846a=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x179));if(_0x22846a)_0x22846a['innerText']=_0x4ae661[_0x44d4a1(0x2a6)];const _0xdc305f=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x256));if(_0xdc305f)_0xdc305f[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x208)];const _0x50f743=document['getElementById'](_0x44d4a1(0x26e));if(_0x50f743)_0x50f743[_0x44d4a1(0x280)]=_0x44d4a1(0x205)+_0x4ae661[_0x44d4a1(0x2a1)]+_0x44d4a1(0x298);const _0x28b3c4=document['getElementById'](_0x44d4a1(0x17b));if(_0x28b3c4)_0x28b3c4[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x2c0)];const _0x219a59=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x22d));if(_0x219a59)_0x219a59[_0x44d4a1(0x280)]=_0x4ae661['checkin'];const _0x5c95a4=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x2dd));if(_0x5c95a4)_0x5c95a4['innerText']=_0x4ae661[_0x44d4a1(0x222)];const _0x2151ed=document['getElementById'](_0x44d4a1(0x257));if(_0x2151ed)_0x2151ed[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x2a1)];const _0x5670ab=document[_0x44d4a1(0x1b5)]('manage-total-docs');if(_0x5670ab)_0x5670ab[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x206)];const _0x55942b=document['getElementById']('manage-dividend-total');if(_0x55942b)_0x55942b[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x1a5)];const _0x28c9bd=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x1e5));if(_0x28c9bd)_0x28c9bd[_0x44d4a1(0x280)]=_0x4ae661['totalDocs'];const _0x9c7c9a=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x2e0));if(_0x9c7c9a)_0x9c7c9a[_0x44d4a1(0x280)]=_0x4ae661['checkin'];const _0xc97a55=document['getElementById'](_0x44d4a1(0x1c2));if(_0xc97a55)_0xc97a55[_0x44d4a1(0x280)]=_0x4ae661[_0x44d4a1(0x2a6)];const _0x1b58c3=document[_0x44d4a1(0x1b5)](_0x44d4a1(0x1ce));if(_0x1b58c3){const _0x3e8e28=_0x4ae661[_0x44d4a1(0x1ad)]>0x0?_0x4ae661[_0x44d4a1(0x222)]/_0x4ae661[_0x44d4a1(0x1ad)]*0x64:0x0;_0x1b58c3[_0x44d4a1(0x1e0)][_0x44d4a1(0x1b1)]=_0x3e8e28+'%';}}window[_0x3deb21(0x1ab)][_0x3deb21(0x1dd)]=_0x2b0cea=>{const _0x2f5b28=_0x3deb21,_0x862e99=_0x2b0cea[_0x2f5b28(0x1de)][_0x2f5b28(0x220)][0x0];_0x862e99&&(state[_0x2f5b28(0x1b6)]=_0x862e99,document['getElementById'](_0x2f5b28(0x25b))[_0x2f5b28(0x280)]=_0x862e99['name'],document[_0x2f5b28(0x1b5)]('file-info')[_0x2f5b28(0x290)][_0x2f5b28(0x1f8)](_0x2f5b28(0x14c)),document['getElementById']('btn-import')[_0x2f5b28(0x293)]=![]);},window['app'][_0x3deb21(0x152)]=()=>{const _0x4c750c=_0x3deb21;state[_0x4c750c(0x1b6)]=null,document['getElementById'](_0x4c750c(0x1f0))[_0x4c750c(0x183)]='',document[_0x4c750c(0x1b5)](_0x4c750c(0x1ed))[_0x4c750c(0x290)]['add']('hidden'),document[_0x4c750c(0x1b5)](_0x4c750c(0x29a))[_0x4c750c(0x293)]=!![];},window[_0x3deb21(0x1ab)][_0x3deb21(0x2cb)]=_0x282721=>{const _0x37b587=_0x3deb21,_0x4916f2=_0x282721[_0x37b587(0x1de)][_0x37b587(0x220)][0x0];_0x4916f2&&(state[_0x37b587(0x265)]=_0x4916f2,document[_0x37b587(0x1b5)]('dividend-file-name')['innerText']=_0x4916f2[_0x37b587(0x21c)],document['getElementById'](_0x37b587(0x264))['classList'][_0x37b587(0x1f8)]('hidden'),document[_0x37b587(0x1b5)](_0x37b587(0x14b))[_0x37b587(0x293)]=![]);},window[_0x3deb21(0x1ab)]['clearDividendFileSelection']=()=>{const _0x209825=_0x3deb21;state[_0x209825(0x265)]=null,document[_0x209825(0x1b5)]('dividend-file-upload')['value']='',document[_0x209825(0x1b5)](_0x209825(0x264))[_0x209825(0x290)][_0x209825(0x171)](_0x209825(0x14c)),document[_0x209825(0x1b5)](_0x209825(0x14b))[_0x209825(0x293)]=!![];},window['app'][_0x3deb21(0x26c)]=()=>{const _0x11b0fe=_0x3deb21;if(!state[_0x11b0fe(0x1b6)])return;const _0x5a28fd=state[_0x11b0fe(0x1b6)],_0x378d7d=new FileReader();document[_0x11b0fe(0x1b5)](_0x11b0fe(0x29a))[_0x11b0fe(0x293)]=!![],document[_0x11b0fe(0x1b5)](_0x11b0fe(0x16f))[_0x11b0fe(0x290)][_0x11b0fe(0x1f8)](_0x11b0fe(0x14c)),_0x378d7d['onload']=async _0x41f0c1=>{const _0x1b3b3b=_0x11b0fe;try{let _0x2d7c89=[];const _0x1a9e3f=_0x41f0c1[_0x1b3b3b(0x1de)][_0x1b3b3b(0x144)];_0x5a28fd[_0x1b3b3b(0x21c)][_0x1b3b3b(0x252)](_0x1b3b3b(0x186))?_0x2d7c89=csvToJson(_0x1a9e3f):_0x2d7c89=JSON[_0x1b3b3b(0x284)](_0x1a9e3f);const _0x2a244f=_0x2d7c89['length'];let _0x22365f=0x0;const _0x32cbf6=0x190;for(let _0x598e37=0x0;_0x598e37<_0x2a244f;_0x598e37+=_0x32cbf6){const _0x5ca85a=_0x2d7c89[_0x1b3b3b(0x2d4)](_0x598e37,_0x598e37+_0x32cbf6),_0x547482=writeBatch(db);for(const _0x34eb0c of _0x5ca85a){let _0x12d2e9=_0x34eb0c[_0x1b3b3b(0x2d0)]||_0x34eb0c[_0x1b3b3b(0x16a)]||_0x34eb0c[_0x1b3b3b(0x180)];if(_0x12d2e9){const _0x17a209=await sha256(_0x12d2e9['toString']()[_0x1b3b3b(0x1cd)](/-/g,'')['trim']()),_0x34b522={..._0x34eb0c};delete _0x34b522[_0x1b3b3b(0x2d0)],delete _0x34b522['citizenID'],delete _0x34b522[_0x1b3b3b(0x180)];const _0x325c10=doc(collection(db,finalCollectionPath));_0x547482[_0x1b3b3b(0x259)](_0x325c10,{..._0x34b522,'citizenId':_0x17a209,'importedAt':serverTimestamp()});}}await _0x547482[_0x1b3b3b(0x1a3)](),_0x22365f+=_0x5ca85a['length'],document[_0x1b3b3b(0x1b5)](_0x1b3b3b(0x2e4))[_0x1b3b3b(0x1e0)]['width']=_0x22365f/_0x2a244f*0x64+'%';}window[_0x1b3b3b(0x1ab)][_0x1b3b3b(0x241)](_0x1b3b3b(0x155)+_0x2a244f+_0x1b3b3b(0x29f),_0x1b3b3b(0x2b4)),window[_0x1b3b3b(0x1ab)][_0x1b3b3b(0x152)]();}catch(_0x45dcee){console[_0x1b3b3b(0x18b)](_0x45dcee),window['app']['showToast'](_0x1b3b3b(0x1c4),_0x1b3b3b(0x18b));}finally{document[_0x1b3b3b(0x1b5)]('btn-import')[_0x1b3b3b(0x293)]=![],document[_0x1b3b3b(0x1b5)](_0x1b3b3b(0x16f))[_0x1b3b3b(0x290)][_0x1b3b3b(0x171)](_0x1b3b3b(0x14c));}},_0x378d7d[_0x11b0fe(0x1d1)](_0x5a28fd);},window['app']['processDividendImport']=()=>{const _0x430d61=_0x3deb21;if(!state[_0x430d61(0x265)])return;const _0x53e8ac=state[_0x430d61(0x265)],_0x5a3e6b=new FileReader();document['getElementById'](_0x430d61(0x14b))[_0x430d61(0x293)]=!![],document[_0x430d61(0x1b5)](_0x430d61(0x26b))['classList']['remove']('hidden'),_0x5a3e6b[_0x430d61(0x27e)]=async _0x42e190=>{const _0x1630d6=_0x430d61;try{let _0xc52e5d=[];const _0x11221c=_0x42e190[_0x1630d6(0x1de)]['result'];_0x53e8ac[_0x1630d6(0x21c)][_0x1630d6(0x252)]('.csv')?_0xc52e5d=csvToJson(_0x11221c):_0xc52e5d=JSON['parse'](_0x11221c);const _0x10542f=_0xc52e5d['length'];let _0x3d16b1=0x0;const _0x3a260b=0x190;for(let _0x430238=0x0;_0x430238<_0x10542f;_0x430238+=_0x3a260b){const _0x284b09=_0xc52e5d[_0x1630d6(0x2d4)](_0x430238,_0x430238+_0x3a260b),_0x1f2bff=writeBatch(db);for(const _0x25d904 of _0x284b09){let _0x41c0d1=_0x25d904[_0x1630d6(0x2d0)]||_0x25d904[_0x1630d6(0x16a)]||_0x25d904[_0x1630d6(0x180)];const _0x238d93={..._0x25d904};delete _0x238d93['citizenId'],delete _0x238d93[_0x1630d6(0x16a)],delete _0x238d93[_0x1630d6(0x180)];const _0x277f87=_0x41c0d1?await sha256(_0x41c0d1['toString']()[_0x1630d6(0x1cd)](/-/g,'')[_0x1630d6(0x2d8)]()):null,_0x39d08f=doc(collection(db,dividendCollectionPath));_0x1f2bff[_0x1630d6(0x259)](_0x39d08f,{..._0x238d93,'citizenId':_0x277f87,'membertype':_0x1630d6(0x16d),'DateLogin':null,'RegisMeeting':null,'DateMeeting':null,'importedAt':serverTimestamp()});}await _0x1f2bff[_0x1630d6(0x1a3)](),_0x3d16b1+=_0x284b09[_0x1630d6(0x194)],document['getElementById'](_0x1630d6(0x2e7))[_0x1630d6(0x1e0)]['width']=_0x3d16b1/_0x10542f*0x64+'%';}window[_0x1630d6(0x1ab)]['showToast'](_0x1630d6(0x267)+_0x10542f+_0x1630d6(0x29f),'success'),window['app'][_0x1630d6(0x2e5)]();}catch(_0x244235){console[_0x1630d6(0x18b)](_0x244235),window[_0x1630d6(0x1ab)]['showToast'](_0x1630d6(0x244),_0x1630d6(0x18b));}finally{document[_0x1630d6(0x1b5)](_0x1630d6(0x14b))[_0x1630d6(0x293)]=![],document[_0x1630d6(0x1b5)](_0x1630d6(0x26b))['classList'][_0x1630d6(0x171)](_0x1630d6(0x14c));}},_0x5a3e6b[_0x430d61(0x1d1)](_0x53e8ac);},window['app'][_0x3deb21(0x2b3)]=async()=>{const _0x325b8a=_0x3deb21;window[_0x325b8a(0x1ab)][_0x325b8a(0x14d)]();try{const _0x2f85a9=await getDocs(query(collection(db,finalCollectionPath))),_0x4c33c5=[];let _0x67f7ae=[];_0x2f85a9[_0x325b8a(0x27f)](_0x2f3625=>{const _0x335c67=_0x325b8a;_0x67f7ae['push'](_0x2f3625),_0x67f7ae[_0x335c67(0x194)]>=0x190&&(_0x4c33c5[_0x335c67(0x2ad)](_0x67f7ae),_0x67f7ae=[]);});if(_0x67f7ae['length']>0x0)_0x4c33c5[_0x325b8a(0x2ad)](_0x67f7ae);for(const _0x239143 of _0x4c33c5){const _0x5631af=writeBatch(db);_0x239143[_0x325b8a(0x27f)](_0x5039d9=>_0x5631af[_0x325b8a(0x1f1)](_0x5039d9[_0x325b8a(0x1c0)],{'CheckIN':deleteField(),'CheckOUT':deleteField(),'status':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'rewardClaimTime':deleteField(),'ConfirmReward':deleteField()})),await _0x5631af[_0x325b8a(0x1a3)]();}window[_0x325b8a(0x1ab)][_0x325b8a(0x241)](_0x325b8a(0x2c4),_0x325b8a(0x2b4));}catch(_0x59b0f3){window[_0x325b8a(0x1ab)][_0x325b8a(0x241)]('รีเซ็ตล้มเหลว',_0x325b8a(0x18b));}},window[_0x3deb21(0x1ab)]['confirmResetDividendData']=async()=>{const _0xdd60eb=_0x3deb21;window[_0xdd60eb(0x1ab)][_0xdd60eb(0x297)]();try{const _0x4a416b=await getDocs(query(collection(db,dividendCollectionPath))),_0x26dddd=[];let _0x2f4b84=[];_0x4a416b['forEach'](_0x3954d2=>{const _0x468487=_0xdd60eb;_0x2f4b84[_0x468487(0x2ad)](_0x3954d2),_0x2f4b84[_0x468487(0x194)]>=0x190&&(_0x26dddd[_0x468487(0x2ad)](_0x2f4b84),_0x2f4b84=[]);});if(_0x2f4b84[_0xdd60eb(0x194)]>0x0)_0x26dddd[_0xdd60eb(0x2ad)](_0x2f4b84);for(const _0x5683b0 of _0x26dddd){const _0x1f549f=writeBatch(db);_0x5683b0[_0xdd60eb(0x27f)](_0x4d5f10=>_0x1f549f['update'](_0x4d5f10[_0xdd60eb(0x1c0)],{'DateLogin':null,'RegisMeeting':null,'DateMeeting':null})),await _0x1f549f[_0xdd60eb(0x1a3)]();}window[_0xdd60eb(0x1ab)][_0xdd60eb(0x241)](_0xdd60eb(0x2aa),_0xdd60eb(0x2b4));}catch(_0x5d4e91){window[_0xdd60eb(0x1ab)]['showToast'](_0xdd60eb(0x164),_0xdd60eb(0x18b));}},window[_0x3deb21(0x1ab)][_0x3deb21(0x1bc)]=async()=>{const _0x14b754=_0x3deb21;if(prompt(_0x14b754(0x184))!==_0x14b754(0x21d))return;try{const _0x302ee4=await getDocs(query(collection(db,finalCollectionPath))),_0xfecbef=[];let _0x518c45=[];_0x302ee4[_0x14b754(0x27f)](_0x1d9b7a=>{const _0x4d184e=_0x14b754;_0x518c45[_0x4d184e(0x2ad)](_0x1d9b7a),_0x518c45['length']>=0x190&&(_0xfecbef[_0x4d184e(0x2ad)](_0x518c45),_0x518c45=[]);});if(_0x518c45['length']>0x0)_0xfecbef[_0x14b754(0x2ad)](_0x518c45);for(const _0x198d94 of _0xfecbef){const _0x59e4ac=writeBatch(db);_0x198d94[_0x14b754(0x27f)](_0x1367a4=>_0x59e4ac['delete'](_0x1367a4[_0x14b754(0x1c0)])),await _0x59e4ac[_0x14b754(0x1a3)]();}window[_0x14b754(0x1ab)]['showToast']('ลบข้อมูลทั้งหมดแล้ว',_0x14b754(0x2b4));}catch(_0x21d6bc){window[_0x14b754(0x1ab)]['showToast'](_0x14b754(0x2b7),_0x14b754(0x18b));}},window[_0x3deb21(0x1ab)][_0x3deb21(0x1bb)]=async()=>{const _0x5c9715=_0x3deb21;if(prompt(_0x5c9715(0x1a4))!==_0x5c9715(0x2cf))return;try{const _0x126b95=await getDocs(query(collection(db,dividendCollectionPath))),_0x45c725=[];let _0x30b2d1=[];_0x126b95[_0x5c9715(0x27f)](_0x24c198=>{const _0x4f4b6a=_0x5c9715;_0x30b2d1['push'](_0x24c198),_0x30b2d1[_0x4f4b6a(0x194)]>=0x190&&(_0x45c725[_0x4f4b6a(0x2ad)](_0x30b2d1),_0x30b2d1=[]);});if(_0x30b2d1[_0x5c9715(0x194)]>0x0)_0x45c725[_0x5c9715(0x2ad)](_0x30b2d1);for(const _0x3f11c5 of _0x45c725){const _0x4bce68=writeBatch(db);_0x3f11c5[_0x5c9715(0x27f)](_0x14d40b=>_0x4bce68['delete'](_0x14d40b[_0x5c9715(0x1c0)])),await _0x4bce68[_0x5c9715(0x1a3)]();}window[_0x5c9715(0x1ab)][_0x5c9715(0x241)](_0x5c9715(0x214),'success');}catch(_0x4f5619){window[_0x5c9715(0x1ab)][_0x5c9715(0x241)](_0x5c9715(0x2b7),_0x5c9715(0x18b));}},window['app'][_0x3deb21(0x176)]=async _0x46b26b=>{const _0x59287d=_0x3deb21;if(!confirm(_0x59287d(0x1d8)))return;try{const _0xa688b9=doc(db,finalCollectionPath,_0x46b26b);await updateDoc(_0xa688b9,{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'status':deleteField(),'ConfirmReward':deleteField()}),window['app'][_0x59287d(0x241)](_0x59287d(0x18a),_0x59287d(0x2b4));}catch(_0x43ff8f){window['app'][_0x59287d(0x241)](_0x59287d(0x157),'error');}},window[_0x3deb21(0x1ab)][_0x3deb21(0x2a9)]=async _0x4d99af=>{const _0x17a820=_0x3deb21;_0x4d99af['preventDefault']();const _0xcf83a7=document[_0x17a820(0x1b5)](_0x17a820(0x1c3))[_0x17a820(0x183)]['trim'](),_0x566fe3=parseInt(document['getElementById']('prize-qty')['value']),_0xfc5784=parseInt(document[_0x17a820(0x1b5)]('prize-total')['value']);if(!_0xcf83a7||_0x566fe3<0x1)return;try{await addDoc(collection(db,prizesCollectionPath),{'name':_0xcf83a7,'qtyPerDraw':_0x566fe3,'totalQty':_0xfc5784,'createdAt':serverTimestamp()}),document[_0x17a820(0x1b5)](_0x17a820(0x275))[_0x17a820(0x296)](),window[_0x17a820(0x1ab)]['showToast'](_0x17a820(0x273),_0x17a820(0x2b4));}catch(_0x34c7e1){window[_0x17a820(0x1ab)][_0x17a820(0x241)](_0x17a820(0x230),_0x17a820(0x18b));}},window['app']['deletePrize']=async _0xb02dac=>{const _0x5d43bc=_0x3deb21;if(!confirm(_0x5d43bc(0x2e6)))return;await deleteDoc(doc(db,prizesCollectionPath,_0xb02dac)),window['app'][_0x5d43bc(0x241)](_0x5d43bc(0x1d5),_0x5d43bc(0x2b4));},window[_0x3deb21(0x1ab)][_0x3deb21(0x1f4)]=(_0x2b5a2e,_0x334c92,_0x396710,_0x7edce7)=>{const _0x2b4df3=_0x3deb21;document[_0x2b4df3(0x1b5)](_0x2b4df3(0x26f))[_0x2b4df3(0x183)]=_0x2b5a2e,document[_0x2b4df3(0x1b5)](_0x2b4df3(0x1e1))[_0x2b4df3(0x183)]=_0x334c92,document[_0x2b4df3(0x1b5)](_0x2b4df3(0x167))[_0x2b4df3(0x183)]=_0x396710,document[_0x2b4df3(0x1b5)](_0x2b4df3(0x281))[_0x2b4df3(0x183)]=_0x7edce7,document[_0x2b4df3(0x1b5)]('edit-prize-modal')[_0x2b4df3(0x290)]['remove'](_0x2b4df3(0x14c));},window[_0x3deb21(0x1ab)]['closeEditPrizeModal']=()=>document[_0x3deb21(0x1b5)](_0x3deb21(0x271))[_0x3deb21(0x290)][_0x3deb21(0x171)](_0x3deb21(0x14c)),window[_0x3deb21(0x1ab)]['handlePrizeUpdate']=async _0x3b534c=>{const _0x27afb4=_0x3deb21;_0x3b534c['preventDefault']();const _0x3bc407=document['getElementById'](_0x27afb4(0x26f))[_0x27afb4(0x183)],_0x21b86a=document[_0x27afb4(0x1b5)](_0x27afb4(0x1e1))[_0x27afb4(0x183)][_0x27afb4(0x2d8)](),_0xf30d08=parseInt(document[_0x27afb4(0x1b5)](_0x27afb4(0x167))[_0x27afb4(0x183)]),_0x3e63fa=parseInt(document[_0x27afb4(0x1b5)](_0x27afb4(0x281))[_0x27afb4(0x183)]);try{await updateDoc(doc(db,prizesCollectionPath,_0x3bc407),{'name':_0x21b86a,'qtyPerDraw':_0xf30d08,'totalQty':_0x3e63fa}),window[_0x27afb4(0x1ab)][_0x27afb4(0x227)](),window[_0x27afb4(0x1ab)][_0x27afb4(0x241)](_0x27afb4(0x2dc),_0x27afb4(0x2b4));}catch(_0x549582){window[_0x27afb4(0x1ab)][_0x27afb4(0x241)](_0x27afb4(0x1ca),_0x27afb4(0x18b));}},window[_0x3deb21(0x1ab)][_0x3deb21(0x25e)]=()=>{const _0x4e4e95=_0x3deb21,_0x5c80cf=document[_0x4e4e95(0x1b5)](_0x4e4e95(0x166));if(!_0x5c80cf)return;const _0x192a5c=_0x5c80cf[_0x4e4e95(0x174)][_0x5c80cf[_0x4e4e95(0x233)]];if(!_0x5c80cf[_0x4e4e95(0x183)]){const _0x10cdbf=document[_0x4e4e95(0x1b5)](_0x4e4e95(0x2c9));if(_0x10cdbf)_0x10cdbf[_0x4e4e95(0x293)]=!![];return;}const _0x5f2fc5=parseInt(_0x192a5c['getAttribute']('data-total')||0x0),_0x2b449d=state['users'][_0x4e4e95(0x1fd)](_0x97df9f=>_0x97df9f[_0x4e4e95(0x215)]===_0x192a5c[_0x4e4e95(0x2e1)])[_0x4e4e95(0x194)],_0x553ece=_0x5f2fc5-_0x2b449d,_0x12e2d3=document[_0x4e4e95(0x1b5)](_0x4e4e95(0x269));if(_0x12e2d3)_0x12e2d3['value']=_0x192a5c[_0x4e4e95(0x1a7)](_0x4e4e95(0x2bc));const _0x33a48a=document['getElementById'](_0x4e4e95(0x1f9));if(_0x33a48a)_0x33a48a[_0x4e4e95(0x280)]=_0x553ece+_0x4e4e95(0x260)+_0x5f2fc5;window[_0x4e4e95(0x1ab)][_0x4e4e95(0x1d2)]();},window['app'][_0x3deb21(0x1d2)]=()=>{const _0x28b074=_0x3deb21,_0x45eef1=document[_0x28b074(0x1b5)]('select-prize');if(!_0x45eef1)return;const _0x269b40=_0x45eef1[_0x28b074(0x174)][_0x45eef1['selectedIndex']],_0x39fbfb=document[_0x28b074(0x1b5)](_0x28b074(0x269));if(!_0x39fbfb)return;const _0x4b6d59=parseInt(_0x39fbfb[_0x28b074(0x183)]);if(!_0x45eef1[_0x28b074(0x183)])return;const _0x801222=parseInt(_0x269b40['getAttribute'](_0x28b074(0x2b6)))-state[_0x28b074(0x1ac)]['filter'](_0x3cbdfe=>_0x3cbdfe[_0x28b074(0x215)]===_0x269b40['text'])['length'],_0xb93cc0=document[_0x28b074(0x1b5)](_0x28b074(0x2c9));if(_0x4b6d59>0x0&&_0x4b6d59<=_0x801222){_0xb93cc0&&(_0xb93cc0['disabled']=![],_0xb93cc0[_0x28b074(0x290)][_0x28b074(0x1f8)](_0x28b074(0x2a3),_0x28b074(0x1c5)));const _0x43f9e3=document['getElementById'](_0x28b074(0x25f));if(_0x43f9e3)_0x43f9e3[_0x28b074(0x290)][_0x28b074(0x171)](_0x28b074(0x14c));}else{_0xb93cc0&&(_0xb93cc0[_0x28b074(0x293)]=!![],_0xb93cc0[_0x28b074(0x290)][_0x28b074(0x171)](_0x28b074(0x2a3),_0x28b074(0x1c5)));const _0xe4871d=document[_0x28b074(0x1b5)](_0x28b074(0x25f));if(_0xe4871d)_0xe4871d['classList'][_0x28b074(0x1f8)](_0x28b074(0x14c));}},window[_0x3deb21(0x1ab)]['startRandomizer']=async()=>{const _0x15693a=_0x3deb21;if(state[_0x15693a(0x22e)])return;const _0x13e662=document[_0x15693a(0x1b5)](_0x15693a(0x166));if(!_0x13e662)return;const _0x33c7d6=_0x13e662['options'][_0x13e662[_0x15693a(0x233)]]['text'],_0x54d474=document['getElementById'](_0x15693a(0x269));if(!_0x54d474)return;const _0x51bf1a=parseInt(_0x54d474[_0x15693a(0x183)]),_0x26cd69=state[_0x15693a(0x1ac)][_0x15693a(0x1fd)](_0x220d11=>_0x220d11[_0x15693a(0x2b5)]&&!_0x220d11[_0x15693a(0x215)]);if(_0x26cd69[_0x15693a(0x194)]===0x0)return window[_0x15693a(0x1ab)][_0x15693a(0x199)](_0x15693a(0x240),_0x15693a(0x294));state[_0x15693a(0x22e)]=!![];const _0x4f3882=document[_0x15693a(0x1b5)](_0x15693a(0x2c9));if(_0x4f3882)_0x4f3882[_0x15693a(0x293)]=!![];const _0x95d3d3=document[_0x15693a(0x1b5)](_0x15693a(0x145));if(_0x95d3d3)_0x95d3d3[_0x15693a(0x280)]=_0x33c7d6;const _0x19ab45=document['getElementById'](_0x15693a(0x299));if(_0x19ab45)_0x19ab45[_0x15693a(0x2e3)]='';const _0x2f16e6=document[_0x15693a(0x1b5)](_0x15693a(0x2ae));if(_0x2f16e6)_0x2f16e6[_0x15693a(0x290)][_0x15693a(0x1f8)](_0x15693a(0x14c));await new Promise(_0x52403b=>setTimeout(_0x52403b,0x3e8));if(_0x2f16e6)_0x2f16e6[_0x15693a(0x290)][_0x15693a(0x171)](_0x15693a(0x14c));const _0x2b20b6=_0x26cd69[_0x15693a(0x1b7)](()=>0.5-Math[_0x15693a(0x19a)]())[_0x15693a(0x2d4)](0x0,_0x51bf1a);for(let _0x5647bb=0x0;_0x5647bb<_0x2b20b6[_0x15693a(0x194)];_0x5647bb++){const _0x45993c=_0x2b20b6[_0x5647bb],_0x48b963=document['createElement'](_0x15693a(0x18d));_0x48b963[_0x15693a(0x15a)]=_0x15693a(0x1fe),_0x48b963['innerHTML']=_0x15693a(0x27b)+(_0x5647bb+0x1)+_0x15693a(0x172)+(_0x45993c['EmpName']||'Unknown')+_0x15693a(0x15f)+_0x33c7d6+'</span>';_0x19ab45&&(_0x19ab45['appendChild'](_0x48b963),_0x19ab45[_0x15693a(0x2d1)]=_0x19ab45[_0x15693a(0x263)]);confetti({'particleCount':0x64,'spread':0x46,'origin':{'y':0.6}}),await updateDoc(doc(db,finalCollectionPath,_0x45993c['id']),{'reward':_0x33c7d6,'rewardTime':serverTimestamp()});if(window['lucide'])lucide[_0x15693a(0x204)]();if(_0x5647bb<_0x2b20b6[_0x15693a(0x194)]-0x1)await new Promise(_0x4da36f=>setTimeout(_0x4da36f,0x7d0));}state['isDrawing']=![],window['app'][_0x15693a(0x25e)](),window[_0x15693a(0x1ab)][_0x15693a(0x241)]('สุ่มรางวัลสำเร็จ!',_0x15693a(0x2b4));};function csvToJson(_0x3b88a1){const _0x4a5689=_0x3deb21,_0x15a1dc=_0x3b88a1['split']('\x0a'),_0x28a646=_0x15a1dc[0x0][_0x4a5689(0x15e)](',')[_0x4a5689(0x28d)](_0x3bf135=>_0x3bf135[_0x4a5689(0x2d8)]());return _0x15a1dc['slice'](0x1)[_0x4a5689(0x28d)](_0x44c7d8=>{const _0x3fcb6e=_0x4a5689,_0x5a41ac=_0x44c7d8[_0x3fcb6e(0x15e)](',');if(_0x5a41ac[_0x3fcb6e(0x194)]<_0x28a646[_0x3fcb6e(0x194)])return null;return _0x28a646['reduce']((_0x3a251a,_0xf9d96e,_0x17e78c)=>{const _0x21f769=_0x3fcb6e;return _0x3a251a[_0xf9d96e]=_0x5a41ac[_0x17e78c]?_0x5a41ac[_0x17e78c][_0x21f769(0x2d8)]():'',_0x3a251a;},{});})['filter'](_0x1b7c5c=>_0x1b7c5c);}setInterval(()=>{const _0x1d987b=_0x3deb21,_0x3d8748=document['getElementById'](_0x1d987b(0x1cc));if(_0x3d8748)_0x3d8748['innerText']=new Date()[_0x1d987b(0x150)](_0x1d987b(0x2c6));},0x3e8);async function init(){const _0x54e4c1=_0x3deb21;try{if(typeof __initial_auth_token!==_0x54e4c1(0x1ee)&&__initial_auth_token)await signInWithCustomToken(auth,__initial_auth_token);else await signInAnonymously(auth);const _0x3f390f=document[_0x54e4c1(0x1b5)]('status-indicator');if(_0x3f390f)_0x3f390f['classList'][_0x54e4c1(0x1cd)](_0x54e4c1(0x1a1),_0x54e4c1(0x2df));const _0x340bc3=document[_0x54e4c1(0x1b5)](_0x54e4c1(0x17d));if(_0x340bc3)_0x340bc3[_0x54e4c1(0x280)]='Online';onSnapshot(query(collection(db,finalCollectionPath)),_0x3ec13d=>processSnapshot(_0x3ec13d)),onSnapshot(query(collection(db,prizesCollectionPath)),_0x26b7b8=>{const _0xa2ff2b=_0x54e4c1,_0x4c259d=[];_0x26b7b8['forEach'](_0x519b2=>_0x4c259d[_0xa2ff2b(0x2ad)]({'id':_0x519b2['id'],..._0x519b2[_0xa2ff2b(0x2de)]()})),state[_0xa2ff2b(0x28f)]=_0x4c259d;const _0x1af92c=document[_0xa2ff2b(0x1b5)]('prize-list-body');if(_0x1af92c){const _0x17389d=_0x4c259d[_0xa2ff2b(0x192)]((_0x4b583e,_0x572674)=>_0x4b583e+(parseInt(_0x572674['totalQty'])||0x0),0x0),_0x22e360=document['getElementById'](_0xa2ff2b(0x159));if(_0x22e360)_0x22e360[_0xa2ff2b(0x280)]=_0x17389d[_0xa2ff2b(0x2ba)]();_0x1af92c['innerHTML']=_0x4c259d[_0xa2ff2b(0x28d)](_0x4ce077=>'<tr><td\x20class=\x22px-4\x20py-3\x20text-sm\x22>'+_0x4ce077['name']+_0xa2ff2b(0x1e7)+_0x4ce077[_0xa2ff2b(0x1f7)]+_0xa2ff2b(0x1e7)+_0x4ce077[_0xa2ff2b(0x2da)]+_0xa2ff2b(0x2c5)+_0x4ce077['id']+_0xa2ff2b(0x25c)+_0x4ce077['name']+_0xa2ff2b(0x23c)+_0x4ce077[_0xa2ff2b(0x1f7)]+',\x20'+_0x4ce077[_0xa2ff2b(0x2da)]+_0xa2ff2b(0x2a7)+_0x4ce077['id']+_0xa2ff2b(0x2a2))[_0xa2ff2b(0x173)]('');}const _0x5a6b8f=document[_0xa2ff2b(0x1b5)](_0xa2ff2b(0x166));if(_0x5a6b8f){const _0x12ef05=_0x5a6b8f[_0xa2ff2b(0x183)];_0x5a6b8f[_0xa2ff2b(0x2e3)]=_0xa2ff2b(0x1ec)+_0x4c259d[_0xa2ff2b(0x28d)](_0x7e04c5=>_0xa2ff2b(0x2d7)+_0x7e04c5['id']+'\x22\x20data-qty=\x22'+_0x7e04c5[_0xa2ff2b(0x1f7)]+_0xa2ff2b(0x177)+_0x7e04c5[_0xa2ff2b(0x2da)]+'\x22>'+_0x7e04c5['name']+'</option>')[_0xa2ff2b(0x173)](''),_0x5a6b8f[_0xa2ff2b(0x183)]=_0x12ef05;}if(!document[_0xa2ff2b(0x1b5)](_0xa2ff2b(0x26d))[_0xa2ff2b(0x290)][_0xa2ff2b(0x1fa)](_0xa2ff2b(0x14c)))window[_0xa2ff2b(0x1ab)][_0xa2ff2b(0x25e)]();if(window['lucide'])lucide['createIcons']();}),onSnapshot(query(collection(db,dividendCollectionPath)),_0xe0741a=>{const _0x35a0b1=_0x54e4c1,_0x4e28e2=[];_0xe0741a[_0x35a0b1(0x27f)](_0x2b8fdb=>_0x4e28e2['push']({'id':_0x2b8fdb['id'],..._0x2b8fdb[_0x35a0b1(0x2de)]()})),state['dividendUsers']=_0x4e28e2,state[_0x35a0b1(0x1e9)][_0x35a0b1(0x1a5)]=_0xe0741a[_0x35a0b1(0x270)],updateDashboardUI(state['stats']),!document[_0x35a0b1(0x1b5)](_0x35a0b1(0x15c))[_0x35a0b1(0x290)][_0x35a0b1(0x1fa)](_0x35a0b1(0x14c))&&renderDividendTable(_0x4e28e2);}),window[_0x54e4c1(0x1ab)][_0x54e4c1(0x1b2)](_0x54e4c1(0x266));}catch(_0x16d3fe){console[_0x54e4c1(0x18b)](_0x16d3fe);}}init();if(window[_0x3deb21(0x249)])lucide[_0x3deb21(0x204)]();
    </script>
</body>

</html>

