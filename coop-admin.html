<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Table Compact styling */
        .table-compact thead tr { height: 50px; }
        .table-compact tbody tr { height: 45px; font-size: 0.95rem; }
        .table-compact tbody tr:nth-child(even) { background-color: #f8fafc; }
        .table-compact td, .table-compact th { vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem; }

        /* Specific height for live results table as requested (40px) */
        .table-results tbody tr { height: 40px !important; }
        .table-results tbody td { 
            height: 40px !important; 
            padding-top: 0 !important; 
            padding-bottom: 0 !important; 
            font-size: 0.85rem; 
            line-height: 1.2;
        }

        .sortable-header { cursor: pointer; user-select: none; transition: background 0.2s; }
        .sortable-header:hover { background-color: rgba(0,0,0,0.05); }

        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-[100] flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="play-circle" width="20"></i> ระบบสุ่มรางวัล
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            <button onclick="window.app.switchTab('dividend-info')" id="nav-dividend-info" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                <i data-lucide="badge-dollar-sign" width="20"></i> ข้อมูลเงินปันผล
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="qr-code" width="20"></i> QR Code ลงทะเบียน
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="qr-code" width="20"></i> QR Code เช็คปันผล
                </button>
            </div>

            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold uppercase tracking-wider">System Info</p>
                <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="database" width="20"></i> Upload ข้อมูลสมาชิก
                </button>
                <button onclick="window.app.switchTab('dividend')" id="nav-dividend" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all text-sm">
                    <i data-lucide="wallet" width="20"></i> Upload ข้อมูลปันผล
                </button>
            </div>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวม (Dashboard)</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">A</div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-slate-600"><i data-lucide="database" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">จำนวนสมาชิกทั้งหมด</p>
                        <h3 id="dash-stat-total" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-blue-600"><i data-lucide="users" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเข้า</p>
                        <h3 id="dash-stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-emerald-600"><i data-lucide="check-square" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">สมาชิกรับบัตรเลือกตั้ง</p>
                        <h3 id="dash-stat-voting" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-indigo-600"><i data-lucide="log-in" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">ลงทะเบียนเงินปันผล</p>
                        <h3 id="dash-stat-div-reg" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                    <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 text-green-600"><i data-lucide="user-check" width="60" height="60"></i></div>
                        <p class="text-slate-600 text-sm font-bold">สมาชิกยืนยันเข้าร่วมประชุม</p>
                        <h3 id="dash-stat-div-join" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียน (Real-time)</h3>
                            <div class="h-64"><canvas id="registrationChart"></canvas></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full"> 
                        <h3 class="font-bold text-lg mb-4 text-slate-700">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1 max-h-[400px]">
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZES -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 h-fit">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2"><i data-lucide="plus-circle" class="text-indigo-600"></i> เพิ่มของรางวัล</h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-indigo-100 outline-none text-sm">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">สุ่มต่อรอบ</label>
                                    <input type="number" id="prize-qty" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1 text-xs">รวมทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" class="w-full p-3 border rounded-xl outline-none text-sm">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition text-sm">บันทึกของรางวัล</button>
                        </form>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg mb-4 text-slate-800">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left table-compact">
                                <thead class="bg-slate-200 font-bold">
                                    <tr>
                                        <th class="px-4 py-3">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">สุ่ม/รอบ</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-blue-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-indigo-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้มีสิทธิ์ลุ้นรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-slate-400">
                        <p class="text-slate-600 text-xs font-bold uppercase">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-red-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มไม่ได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-no" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 border-l-4 border-green-500">
                        <p class="text-slate-600 text-xs font-bold uppercase">สุ่มได้รับรางวัล</p>
                        <h3 id="rand-stat-drawn-win" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    <div class="lg:col-span-4 bg-white p-6 rounded-2xl shadow-md border">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-slate-800"><i data-lucide="settings-2"></i> ตั้งค่าการสุ่ม</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">เลือกของรางวัล</label>
                                <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border rounded-xl outline-none bg-white text-sm">
                                    <option value="">-- เลือกของรางวัล --</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm text-slate-600 mb-1 font-medium">จำนวนสุ่มต่อรอบ (คน)</label>
                                <input type="number" id="input-draw-qty" value="1" min="1" max="100" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border rounded-xl text-center text-lg font-bold outline-none text-sm">
                                <p id="qty-warning" class="text-xs text-red-500 mt-1 hidden font-bold">สุ่มเกินสต็อกคงเหลือ!</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-xl border space-y-2">
                                <div class="flex justify-between text-sm"><span class="text-slate-500">คงเหลือในสต็อก</span><span id="label-stock-count" class="font-bold text-orange-600 text-lg text-sm">0</span></div>
                                <div class="flex justify-between text-sm"><span class="text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span><span id="label-eligible-count" class="font-bold text-indigo-600 text-lg text-sm">0</span></div>
                            </div>
                            <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-40 active:scale-95 transition-all flex items-center justify-center gap-2 text-lg text-sm">
                                <i data-lucide="play" width="24" class="fill-current"></i> เริ่มการสุ่มรางวัล
                            </button>
                        </div>
                    </div>
                    <div class="lg:col-span-8 bg-slate-900 rounded-3xl h-[600px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700">
                        <div class="text-center mb-6 relative z-10 border-b border-white/10 pb-4">
                            <h1 id="screen-prize-title" class="text-2xl font-bold text-yellow-400 tracking-widest uppercase italic text-sm">LUCKY DRAW SYSTEM</h1>
                        </div>
                        <div id="screen-display-area" class="flex-1 overflow-y-auto custom-scroll-dark pr-2 space-y-4 relative z-10">
                            <div class="flex flex-col items-center justify-center h-full opacity-20 text-white">
                                <i data-lucide="gift" width="64" height="64" class="mb-4"></i>
                                <p class="text-lg font-bold">READY TO SPIN</p>
                            </div>
                        </div>
                        <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/90 backdrop-blur-sm z-20 flex items-center justify-center">
                            <div class="text-white text-center">
                                <div class="w-20 h-20 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                <h2 class="text-2xl font-bold uppercase tracking-widest">Randomizing...</h2>
                                <p class="text-indigo-400 mt-2 text-sm">กรุณารอสักครู่ ระบบกำลังสุ่มรายชื่อ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนรางวัลทั้งหมด</p>
                        <h3 id="res-stat-total-prizes" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">รางวัลที่ได้สุ่มแล้ว</p>
                        <h3 id="res-stat-total-drawn" class="text-2xl font-bold text-blue-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนผู้ได้รับรางวัล</p>
                        <h3 id="res-stat-winners" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัลแล้ว</p>
                        <h3 id="res-stat-claimed" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 ">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้ที่ยังไม่มารับรางวัล</p>
                        <h3 id="res-stat-unclaimed" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b flex justify-between items-center bg-slate-200">
                        <h3 class="font-bold text-lg text-slate-800">รายชื่อผู้โชคดี (เรียลไทม์)</h3>
                        <div class="flex items-center gap-4">
                            <select id="filter-results-status" onchange="window.app.renderResults()" class="border p-2 text-sm rounded-lg outline-none bg-white">
                                <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                                <option value="unclaimed">ยังไม่ยืนยันสิทธิ์</option>
                                <option value="claimed">ยืนยันรับรางวัลแล้ว</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left table-compact table-results">
                            <thead class="bg-slate-200 font-bold border-b text-slate-700">
                                <tr>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('index')">
                                        ลำดับ <span id="rsort-index"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="rsort-EmpName"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-xs" onclick="window.app.changeResSort('reward')">
                                        รางวัลที่ได้ <span id="rsort-reward"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('rewardTime')">
                                        เวลาที่สุ่มได้ <span id="rsort-rewardTime"></span>
                                    </th>
                                    <th class="sortable-header px-6 py-4 text-center text-xs" onclick="window.app.changeResSort('ConfirmReward')">
                                        สถานะการรับรางวัล <span id="rsort-ConfirmReward"></span>
                                    </th>
                                    <th class="px-6 py-4 text-right text-xs">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE (REGISTRATION) -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                <div class="bg-white p-6 rounded-2xl shadow-sm border flex flex-col md:flex-row gap-4 items-end">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-slate-600 mb-2">ค้นหาสมาชิกเพื่อลงทะเบียน (รหัส/ชื่อ)</label>
                        <input type="text" id="member-search-input" oninput="window.app.validateMemberSearch()" placeholder="ใส่รหัสสมาชิก หรือ ชื่อ..." class="w-full p-3 border rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 text-sm">
                    </div>
                    <button id="member-search-btn" onclick="window.app.openMemberSearchModal()" disabled class="px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold opacity-50 cursor-not-allowed hover:bg-indigo-700 transition flex items-center gap-2 text-sm">
                        <i data-lucide="search" width="20"></i> ค้นหารายชื่อ
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิก</p>
                        <h3 id="reg-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">ลงทะเบียนแล้ว</p>
                        <h3 id="reg-stat-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">รับบัตรเลือกตั้งแล้ว</p>
                        <h3 id="reg-stat-voting" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300 text-sm">
                        <p class="text-slate-600 text-xs font-bold uppercase">ผู้รับรางวัล</p>
                        <h3 id="reg-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-4 border-b flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4 text-slate-800">
                        <h3 class="font-bold text-lg">ข้อมูลพนักงานลงทะเบียนทั้งหมด</h3>
                        <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="กรองในตาราง..." class="p-2 border rounded-lg text-sm outline-none bg-white w-full md:w-64 text-sm">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-300 font-bold border-b text-slate-700 sticky top-0 z-10">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeSort('EmpMember')">
                                        no <span id="sort-EmpMember"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('EmpName')">
                                        ชื่อ-นามสกุล <span id="sort-EmpName"></span>
                                    </th>
                                    <th class="text-sm text-center">จำนวน</th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CheckIN')">
                                        Check-In <span id="sort-CheckIN"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('CardPoll')">
                                        รับบัตร <span id="sort-CardPoll"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmVotingCard')">
                                        วันที่รับบัตร <span id="sort-ConfirmVotingCard"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('reward')">
                                        รางวัล <span id="sort-reward"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeSort('ConfirmReward')">
                                        วันที่รับรางวัล <span id="sort-ConfirmReward"></span>
                                    </th>
                                    <th class="text-center text-sm">สถานะรางวัล</th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <p id="data-table-info" class="text-slate-400 font-medium">กำลังดึงข้อมูล...</p>
                            <div class="flex gap-2">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100 text-xs" id="btn-prev">Prev</button>
                                <span id="page-indicator" class="font-bold self-center px-4 text-sm">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border rounded disabled:opacity-50 hover:bg-slate-100 text-xs" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 10: DIVIDEND INFO -->
            <div id="view-dividend-info" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนสมาชิกรวม</p>
                        <h3 id="div-summary-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">จำนวนลงทะเบียน</p>
                        <h3 id="div-summary-registered" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งเข้าร่วม</p>
                        <h3 id="div-summary-join" class="text-2xl font-bold text-green-600 mt-1">0</h3>
                    </div>
                    <div class="bg-slate-200 p-4 rounded-xl shadow-sm border border-slate-300">
                        <p class="text-slate-600 text-xs font-bold uppercase">แจ้งไม่เข้าร่วม</p>
                        <h3 id="div-summary-nojoin" class="text-2xl font-bold text-red-600 mt-1">0</h3>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border overflow-hidden">
                    <div class="p-6 border-b bg-slate-200 flex justify-between items-center text-sm">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลเงินปันผล (Dividend)</h3>
                        <input type="text" id="search-dividend" oninput="window.app.handleDividendSearch(this.value)" placeholder="ค้นหารหัส/ชื่อ..." class="p-2 border rounded-lg text-sm outline-none w-64 bg-white">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 font-bold">
                                <tr>
                                    <th class="sortable-header py-4 text-center text-sm" onclick="window.app.changeDivSort('no')">
                                        ลำดับ <span id="dsort-no"></span>
                                    </th>
                                    <th class="sortable-header text-sm" onclick="window.app.changeDivSort('empname')">
                                        ชื่อ-นามสกุล <span id="dsort-empname"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('dividend')">
                                        ปันผล <span id="dsort-dividend"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('moneyback')">
                                        เงินเฉลี่ยคืน <span id="dsort-moneyback"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('gratuity')">
                                        เงินสมนาคุณ <span id="dsort-gratuity"></span>
                                    </th>
                                    <th class="sortable-header text-right text-sm" onclick="window.app.changeDivSort('netpayment')">
                                        รวมปันผล <span id="dsort-netpayment"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('DateLogin')">
                                        ลงทะเบียน <span id="dsort-DateLogin"></span>
                                    </th>
                                    <th class="sortable-header text-center text-sm" onclick="window.app.changeDivSort('RegisMeeting')">
                                        แจ้งเข้าร่วม <span id="dsort-RegisMeeting"></span>
                                    </th>
                                    <th class="text-right text-sm">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="dividend-table-body" class="divide-y"></tbody>
                        </table>
                        <div class="p-4 bg-slate-50 flex justify-between items-center text-xs">
                            <div class="flex items-center gap-4">
                                <p id="div-table-info" class="text-slate-400 font-medium text-xs">แสดงผล...</p>
                                <button onclick="window.app.downloadDividendCSV()" class="px-4 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-xs font-bold transition flex items-center gap-2 shadow-sm">
                                    <i data-lucide="download" width="14"></i> Download CSV File
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: IMPORT & DIVIDEND MANAGE -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center text-sm">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนรายชื่อพนักงานทั้งหมดในระบบ</p>
                        <h3 id="manage-total-docs" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-blue-100 p-3 rounded-full text-blue-600 text-sm">
                        <i data-lucide="users" width="32"></i>
                    </div>
                </div>
                
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit text-sm">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-blue-600"><i data-lucide="upload-cloud"></i> Upload ข้อมูลสมาชิก</h3>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium text-xs">ลากไฟล์มาวางที่นี่ หรือ คลิกเพื่อเลือกไฟล์ (.json, .csv)</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-4 rounded-xl flex justify-between items-center text-sm text-blue-700">
                                <span id="file-name" class="font-bold"></span>
                                <button onclick="window.app.clearFileSelection()" class="hover:text-red-500 transition text-sm text-sm"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-blue-700 text-sm text-sm">เริ่มประมวลผลนำเข้าข้อมูลพนักงาน</button>
                            <div id="import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="import-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit text-sm">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4">
                            <button onclick="window.app.openResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-sm text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะการลงทะเบียนพนักงาน
                            </button>
                            <button onclick="window.app.openDeleteAllModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-sm text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลพนักงานทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: DIVIDEND MANAGE (IMPORT) -->
            <div id="view-dividend" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-slate-200 p-6 rounded-2xl shadow-sm border border-slate-300 flex justify-between items-center">
                    <div>
                        <p class="text-slate-600 text-sm font-bold uppercase">จำนวนสมาชิกปันผลทั้งหมดในระบบ</p>
                        <h3 id="manage-dividend-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <div class="bg-emerald-100 p-3 rounded-full text-emerald-600 text-2xl">
                        <i data-lucide="wallet" width="32"></i>
                    </div>
                </div>

                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border h-fit text-sm">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 text-emerald-600"><i data-lucide="wallet"></i> Upload ข้อมูลปันผล</h3>
                        <div class="space-y-4 text-sm">
                            <div class="border-2 border-dashed rounded-xl p-10 text-center cursor-pointer hover:bg-slate-50 transition" onclick="document.getElementById('dividend-file-upload').click()">
                                <i data-lucide="file-up" class="mx-auto mb-3 text-slate-300" width="48"></i>
                                <p class="text-sm text-slate-500 font-medium text-xs text-sm">เลือกไฟล์ข้อมูลเงินปันผล (.json, .csv)</p>
                                <input type="file" id="dividend-file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleDividendFileSelect(event)">
                            </div>
                            <div id="dividend-file-info" class="hidden bg-emerald-50 p-4 rounded-xl flex justify-between items-center text-sm text-emerald-700 text-sm">
                                <span id="dividend-file-name" class="font-bold text-sm text-sm"></span>
                                <button onclick="window.app.clearDividendFileSelection()" class="hover:text-red-500 transition text-sm text-sm"><i data-lucide="trash-2" width="18"></i></button>
                            </div>
                            <button onclick="window.app.processDividendImport()" id="btn-dividend-import" disabled class="w-full bg-emerald-600 text-white py-4 rounded-xl font-bold disabled:opacity-40 transition-all hover:bg-emerald-700 text-sm text-sm">เริ่มประมวลผลนำเข้าข้อมูลเงินปันผล</button>
                            <div id="dividend-import-progress" class="hidden w-full bg-slate-100 rounded-full h-3 mt-4"><div id="dividend-import-bar" class="bg-emerald-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-red-100 h-fit text-sm text-sm text-sm">
                         <h4 class="font-bold text-red-600 mb-6 flex items-center gap-2 uppercase tracking-widest text-sm text-sm text-sm"><i data-lucide="alert-octagon" width="20"></i> Danger Zone</h4>
                         <div class="space-y-4 text-sm">
                            <button onclick="window.app.openDividendResetModal()" class="w-full border border-orange-200 text-orange-700 py-3 rounded-xl font-bold hover:bg-orange-50 transition flex items-center justify-center gap-3 text-xs text-sm text-sm">
                                <i data-lucide="rotate-ccw" width="18"></i> รีเซ็ตสถานะปันผลทั้งหมด
                            </button>
                            <button onclick="window.app.openDeleteAllDividendModal()" class="w-full border border-red-200 text-red-700 py-3 rounded-xl font-bold hover:bg-red-50 transition flex items-center justify-center gap-3 text-xs text-sm text-sm">
                                <i data-lucide="trash-2" width="18"></i> ลบฐานข้อมูลเงินปันผลทั้งหมด
                            </button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: QR Code IN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-blue-800 mb-6 tracking-widest text-center">QR Code ลงทะเบียน</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-register.png" alt="Check-IN QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
            <!-- VIEW: QR Code OUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border flex flex-col items-center justify-center min-h-[60vh]">
                    <h2 class="text-xl font-normal text-orange-600 mb-6 tracking-widest text-center">QR Code เช็คปันผล</h2>
                    <div class="bg-white p-6 border-4 border-slate-100 rounded-2xl shadow-inner mb-8">
                        <img src="./images/coop-dividend.png" alt="Check-OUT QR" class="w-80 h-80">
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- LIGHTBOX MODALS -->
    
    <!-- Confirm Reset Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2">รีเซ็ตสถานะ?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm">Reset</span> เพื่อยืนยันการล้างข้อมูล Check-IN/OUT</p>
            <input type="text" id="confirm-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold text-sm text-sm" placeholder="พิมพ์ Reset">
            <div class="flex gap-4">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-sm text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 text-sm text-sm text-sm text-sm">รีเซ็ตข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Modal -->
    <div id="delete-all-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-2 text-red-600 text-sm text-sm text-sm">ลบข้อมูลทั้งหมด?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm">Delete</span> เพื่อยืนยันการลบข้อมูลพนักงาน</p>
            <input type="text" id="confirm-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold text-sm text-sm text-sm text-sm text-sm" placeholder="พิมพ์ Delete">
            <div class="flex gap-4">
                <button onclick="window.app.closeDeleteAllModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs text-sm text-sm text-sm text-sm text-sm text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-700 text-xs text-sm text-sm text-sm text-sm text-sm text-sm text-sm">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Confirm Reset Dividend Modal -->
    <div id="dividend-reset-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="rotate-ccw" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2 text-sm text-sm text-sm text-sm text-sm">รีเซ็ตสถานะปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm text-sm">Reset</span> เพื่อรีเซ็ตการรับปันผล</p>
            <input type="text" id="confirm-div-reset-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-orange-100 font-bold text-sm text-sm text-sm text-sm text-sm" placeholder="พิมพ์ Reset">
            <div class="flex gap-4 text-sm">
                <button onclick="window.app.closeDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs">ยกเลิก</button>
                <button onclick="window.app.confirmResetDividendData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold text-xs text-sm">รีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete All Dividend Modal -->
    <div id="dividend-delete-confirm-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop text-sm text-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm text-sm text-sm text-sm text-sm">
            <div class="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-6"><i data-lucide="trash-2" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2 text-red-600 text-sm text-sm text-sm text-sm text-sm">ลบฐานปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6 text-sm text-sm text-sm text-sm text-sm text-sm">พิมพ์คำว่า <span class="font-bold text-slate-800 tracking-widest text-sm text-sm text-sm text-sm text-sm">Delete</span> เพื่อลบข้อมูลปันผลถาวร</p>
            <input type="text" id="confirm-div-delete-input" class="w-full p-3 border rounded-xl mb-6 text-center outline-none focus:ring-2 focus:ring-red-100 font-bold text-sm text-sm text-sm text-sm text-sm text-sm text-sm text-sm">
            <div class="flex gap-4 text-sm text-sm">
                <button onclick="window.app.closeDeleteAllDividendModal()" class="flex-1 py-3 rounded-xl bg-slate-100 font-bold text-xs">ยกเลิก</button>
                <button onclick="window.app.confirmDeleteAllDividendData()" class="flex-1 py-3 rounded-xl bg-red-600 text-white font-bold text-xs">ลบทั้งหมด</button>
            </div>
        </div>
    </div>

    <!-- Single Dividend Reset Modal -->
    <div id="dividend-single-reset-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-[40%] p-8 text-center text-sm">
            <div class="w-16 h-16 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="alert-triangle" width="32"></i></div>
            <h3 class="text-xl font-bold mb-2">ล้างข้อมูลเงินปันผล?</h3>
            <p class="text-slate-500 text-sm mb-6">คุณกำลังจะล้างสถานะการลงทะเบียนและการแจ้งเข้าร่วมของสมาชิกท่านนี้</p>
            <div class="flex gap-4">
                <button onclick="window.app.closeSingleDividendResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                <button onclick="window.app.confirmSingleDividendReset()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition text-sm">ยืนยันการล้างข้อมูล</button>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="member-search-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center text-sm text-sm">
            <div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="user" width="32"></i></div>
            <h3 class="text-2xl font-bold mb-4">ข้อมูลพนักงาน</h3>
            <div id="search-member-details" class="text-left bg-slate-50 p-6 rounded-2xl mb-8 space-y-2 text-sm border italic text-sm text-sm text-sm"></div>
            <div class="flex flex-col gap-3 text-sm">
                <div class="flex gap-2">
                    <button onclick="window.app.closeMemberSearchModal()" class="flex-1 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition font-bold text-sm">ยกเลิก</button>
                    <button id="btn-confirm-regis" onclick="window.app.confirmRegistrationViaSearch(false)" class="flex-1 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition text-sm">ลงทะเบียน</button>
                </div>
                <button id="btn-confirm-regis-card" onclick="window.app.confirmRegistrationViaSearch(true)" class="w-full py-4 rounded-xl bg-emerald-600 text-white font-bold hover:bg-emerald-700 transition text-sm shadow-lg flex items-center justify-center gap-2">
                    <i data-lucide="check-square" width="18"></i> ยืนยันการรับบัตรเลือกตั้ง
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK Logic -->
    <script type="module">
const _0x2f59fd=_0x2f35;(function(_0x3f194c,_0x3b6799){const _0x411658=_0x2f35,_0x53f960=_0x3f194c();while(!![]){try{const _0x49c25e=parseInt(_0x411658(0x254))/0x1*(parseInt(_0x411658(0x2d6))/0x2)+-parseInt(_0x411658(0x266))/0x3+-parseInt(_0x411658(0x2f3))/0x4*(parseInt(_0x411658(0x20c))/0x5)+parseInt(_0x411658(0x299))/0x6+-parseInt(_0x411658(0x30b))/0x7*(parseInt(_0x411658(0x25f))/0x8)+-parseInt(_0x411658(0x200))/0x9+parseInt(_0x411658(0x314))/0xa*(parseInt(_0x411658(0x245))/0xb);if(_0x49c25e===_0x3b6799)break;else _0x53f960['push'](_0x53f960['shift']());}catch(_0x1c3af6){_0x53f960['push'](_0x53f960['shift']());}}}(_0x3596,0xa1f77));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';function _0x2f35(_0x341497,_0x39076b){_0x341497=_0x341497-0x1ba;const _0x359622=_0x3596();let _0x2f3510=_0x359622[_0x341497];return _0x2f3510;}import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const firebaseConfig={'apiKey':'AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','authDomain':_0x2f59fd(0x1e7),'databaseURL':'https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','projectId':_0x2f59fd(0x2e7),'storageBucket':_0x2f59fd(0x20a),'messagingSenderId':_0x2f59fd(0x252),'appId':_0x2f59fd(0x323),'measurementId':_0x2f59fd(0x1d6)},finalCollectionPath=_0x2f59fd(0x20b),prizesCollectionPath=_0x2f59fd(0x31e),dividendCollectionPath=_0x2f59fd(0x1db),app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'dividendUsers':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0,'votingCards':0x0,'dividendTotal':0x0,'divRegistered':0x0,'divJoin':0x0,'divNoJoin':0x0,'totalPrizesQuota':0x0,'totalPrizesDrawn':0x0},'isDrawing':![],'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x2f59fd(0x2ff),'sortOrder':_0x2f59fd(0x201),'searchTerm':'','divRowsPerPage':0x32,'divCurrentPage':0x1,'divSearchTerm':'','divSortBy':_0x2f59fd(0x281),'divSortOrder':_0x2f59fd(0x201),'fileToImport':null,'dividendFileToImport':null,'searchCandidate':null,'resultsSortBy':_0x2f59fd(0x2f2),'resultsSortOrder':'asc','dividendIdToReset':null};async function sha256(_0x3d0f73){const _0x4af75a=_0x2f59fd,_0x58a194=new TextEncoder()['encode'](_0x3d0f73),_0x9498e7=await crypto['subtle'][_0x4af75a(0x293)](_0x4af75a(0x319),_0x58a194),_0x23df69=Array[_0x4af75a(0x210)](new Uint8Array(_0x9498e7));return _0x23df69['map'](_0x3184da=>_0x3184da[_0x4af75a(0x265)](0x10)[_0x4af75a(0x328)](0x2,'0'))[_0x4af75a(0x287)]('');}window[_0x2f59fd(0x30c)]=window[_0x2f59fd(0x30c)]||{},window[_0x2f59fd(0x30c)][_0x2f59fd(0x30a)]=(_0x3ef3dc,_0x27ac8c='success')=>{const _0x1fbbff=_0x2f59fd,_0x573028=document[_0x1fbbff(0x2ac)](_0x1fbbff(0x2f0)),_0x5499de=document[_0x1fbbff(0x278)](_0x1fbbff(0x2d3));let _0x244751=_0x27ac8c===_0x1fbbff(0x24b)?_0x1fbbff(0x207):_0x1fbbff(0x229),_0x4a30e0=_0x27ac8c===_0x1fbbff(0x24b)?_0x1fbbff(0x2ca):_0x1fbbff(0x1f2);_0x5499de['className']=_0x1fbbff(0x310)+_0x244751+'\x20p-4\x20rounded-lg\x20shadow-xl\x20flex\x20items-center\x20gap-3\x20toast-enter\x20pointer-events-auto',_0x5499de[_0x1fbbff(0x286)]=_0x1fbbff(0x258)+_0x4a30e0+_0x1fbbff(0x205)+_0x3ef3dc+_0x1fbbff(0x29f),_0x573028[_0x1fbbff(0x22c)](_0x5499de),lucide[_0x1fbbff(0x273)](),setTimeout(()=>{const _0x565c6a=_0x1fbbff;_0x5499de[_0x565c6a(0x23a)][_0x565c6a(0x23d)](_0x565c6a(0x267),_0x565c6a(0x297)),setTimeout(()=>_0x5499de[_0x565c6a(0x317)](),0x12c);},0xbb8);},window['app']['switchTab']=_0x1487f5=>{const _0x3461bd=_0x2f59fd;document[_0x3461bd(0x339)](_0x3461bd(0x1d8))[_0x3461bd(0x2ee)](_0x341ea1=>_0x341ea1[_0x3461bd(0x23a)]['add'](_0x3461bd(0x211)));const _0x482d50=document[_0x3461bd(0x2ac)](_0x3461bd(0x2dc)+_0x1487f5);if(_0x482d50)_0x482d50[_0x3461bd(0x23a)][_0x3461bd(0x317)](_0x3461bd(0x211));document[_0x3461bd(0x339)]('.nav-item')['forEach'](_0x34afb8=>{const _0x331c77=_0x3461bd;_0x34afb8[_0x331c77(0x23a)]['remove'](_0x331c77(0x272),'text-white'),_0x34afb8[_0x331c77(0x23a)][_0x331c77(0x23d)](_0x331c77(0x23e));});const _0x169fb9=document['getElementById']('nav-'+_0x1487f5);_0x169fb9&&(_0x169fb9['classList']['remove'](_0x3461bd(0x23e)),_0x169fb9[_0x3461bd(0x23a)][_0x3461bd(0x23d)](_0x3461bd(0x272),'text-white'));let _0x46b59a={'dashboard':'ภาพรวม','prizes':_0x3461bd(0x2bd),'randomizer':_0x3461bd(0x1e8),'results':_0x3461bd(0x26f),'data':_0x3461bd(0x263),'dividend-info':'ข้อมูลเงินปันผล','import':'Upload\x20ข้อมูลสมาชิก','dividend':'Upload\x20ข้อมูลปันผล','qrcode-in':_0x3461bd(0x223),'qrcode-out':'QR\x20Code\x20เช็คปันผล'};document[_0x3461bd(0x2ac)](_0x3461bd(0x2e2))[_0x3461bd(0x1d9)]=_0x46b59a[_0x1487f5]||_0x1487f5;if(_0x1487f5==='data')renderTable(state[_0x3461bd(0x26b)]);if(_0x1487f5==='dividend-info')renderDividendTable(state[_0x3461bd(0x1dd)]);if(_0x1487f5==='randomizer')window[_0x3461bd(0x30c)][_0x3461bd(0x1fd)]();if(_0x1487f5==='results')window[_0x3461bd(0x30c)][_0x3461bd(0x242)]();lucide[_0x3461bd(0x273)]();};function processSnapshot(_0x2665a2){const _0x5bf44d=_0x2f59fd,_0xb327e3=[],_0x96d33e={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':_0x2665a2[_0x5bf44d(0x27e)],'notYetDrawn':0x0,'votingCards':0x0,'totalPrizesDrawn':0x0},_0x311d43={};_0x2665a2[_0x5bf44d(0x2ee)](_0x4cb130=>{const _0x49729c=_0x5bf44d,_0x50ddec=_0x4cb130[_0x49729c(0x298)](),_0x5ce19b={'id':_0x4cb130['id'],..._0x50ddec};_0xb327e3[_0x49729c(0x1f1)](_0x5ce19b);if(_0x50ddec[_0x49729c(0x2ff)]){_0x96d33e[_0x49729c(0x316)]++;const _0x49e5d1=(_0x50ddec[_0x49729c(0x2ff)][_0x49729c(0x2b0)]?.()||new Date(_0x50ddec[_0x49729c(0x2ff)]))[_0x49729c(0x2c6)]();_0x311d43[_0x49e5d1]=(_0x311d43[_0x49e5d1]||0x0)+0x1;}_0x50ddec['CheckOUT']&&_0x96d33e['checkout']++;if(_0x50ddec[_0x49729c(0x1f0)]===_0x49729c(0x230))_0x96d33e[_0x49729c(0x2d1)]++;if(_0x50ddec[_0x49729c(0x2f2)]){if(_0x50ddec[_0x49729c(0x2f2)]===_0x49729c(0x2d4))_0x96d33e[_0x49729c(0x233)]++;else _0x96d33e[_0x49729c(0x1ef)]++,_0x96d33e[_0x49729c(0x249)]++;}if(_0x50ddec[_0x49729c(0x315)])_0x96d33e[_0x49729c(0x26c)]++;if(_0x50ddec['status']===_0x49729c(0x222)){_0x96d33e['eligible']++;if(!_0x50ddec[_0x49729c(0x2f2)])_0x96d33e[_0x49729c(0x232)]++;}}),state[_0x5bf44d(0x26b)]=_0xb327e3,state[_0x5bf44d(0x308)]={...state[_0x5bf44d(0x308)],..._0x96d33e},updateDashboardUI(state[_0x5bf44d(0x308)]),updateCharts(_0x311d43),renderActivityFeed(_0xb327e3),renderTable(_0xb327e3),window[_0x5bf44d(0x30c)][_0x5bf44d(0x242)]();}function updateDashboardUI(_0x4a3877){const _0x490eda=_0x2f59fd,_0x5cacf0=[_0x490eda(0x300),_0x490eda(0x1cf),_0x490eda(0x27a),_0x490eda(0x2fd),'stat-claimed',_0x490eda(0x2f5),_0x490eda(0x1f8),'rand-stat-noreward',_0x490eda(0x1c4),_0x490eda(0x1bd),_0x490eda(0x32a),_0x490eda(0x1d1),_0x490eda(0x2de),_0x490eda(0x1d2),_0x490eda(0x257),'div-summary-total',_0x490eda(0x2e0),_0x490eda(0x2db),'div-summary-nojoin',_0x490eda(0x2ae),_0x490eda(0x2b8),'dash-stat-total',_0x490eda(0x231),_0x490eda(0x2af),_0x490eda(0x29b),_0x490eda(0x304),_0x490eda(0x2dd),_0x490eda(0x1c9)],_0x324d04={'stat-checkin':_0x4a3877[_0x490eda(0x316)],'stat-checkout':_0x4a3877[_0x490eda(0x224)],'stat-noreward':_0x4a3877['notRewarded'],'stat-rewarded':_0x4a3877[_0x490eda(0x1ef)],'stat-claimed':_0x4a3877[_0x490eda(0x26c)],'rand-stat-total':_0x4a3877[_0x490eda(0x2f6)],'rand-stat-eligible-view':_0x4a3877[_0x490eda(0x285)],'rand-stat-noreward':_0x4a3877[_0x490eda(0x232)],'rand-stat-drawn-no':_0x4a3877[_0x490eda(0x233)],'rand-stat-drawn-win':_0x4a3877['rewarded'],'manage-total-docs':_0x4a3877[_0x490eda(0x2f6)],'reg-stat-total':_0x4a3877[_0x490eda(0x2f6)],'reg-stat-registered':_0x4a3877['checkin'],'reg-stat-voting':_0x4a3877[_0x490eda(0x2d1)],'reg-stat-rewarded':_0x4a3877['rewarded'],'div-summary-total':_0x4a3877[_0x490eda(0x1f5)],'div-summary-registered':_0x4a3877[_0x490eda(0x2e9)],'div-summary-join':_0x4a3877[_0x490eda(0x2e6)],'div-summary-nojoin':_0x4a3877[_0x490eda(0x22d)],'res-stat-total-drawn':_0x4a3877[_0x490eda(0x249)],'manage-dividend-total':_0x4a3877[_0x490eda(0x1f5)],'dash-stat-total':_0x4a3877[_0x490eda(0x2f6)],'dash-stat-checkin':_0x4a3877[_0x490eda(0x316)],'dash-stat-voting':_0x4a3877[_0x490eda(0x2d1)],'dash-stat-noreward':_0x4a3877[_0x490eda(0x233)],'dash-stat-rewarded':_0x4a3877[_0x490eda(0x1ef)],'dash-stat-div-reg':_0x4a3877[_0x490eda(0x2e9)],'dash-stat-div-join':_0x4a3877[_0x490eda(0x2e6)]};_0x5cacf0[_0x490eda(0x2ee)](_0x20d0c7=>{const _0xe42646=_0x490eda;if(document[_0xe42646(0x2ac)](_0x20d0c7))document[_0xe42646(0x2ac)](_0x20d0c7)[_0xe42646(0x1d9)]=_0x324d04[_0x20d0c7]||0x0;});const _0x2be69a=document[_0x490eda(0x2ac)](_0x490eda(0x1d4));if(_0x2be69a)_0x2be69a[_0x490eda(0x264)]['width']=_0x4a3877[_0x490eda(0x316)]>0x0?_0x4a3877['checkout']/_0x4a3877[_0x490eda(0x316)]*0x64+'%':'0%';}window[_0x2f59fd(0x30c)]['renderResults']=()=>{const _0x8c0f4e=_0x2f59fd,_0x4ee530=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x2b4))?.[_0x8c0f4e(0x206)]||'all_winners',_0x19ac25=state[_0x8c0f4e(0x26b)][_0x8c0f4e(0x2a1)](_0x282522=>_0x282522['reward']&&_0x282522[_0x8c0f4e(0x2f2)]!==_0x8c0f4e(0x2d4))[_0x8c0f4e(0x228)],_0x2a18ea=state['users'][_0x8c0f4e(0x2a1)](_0xa75911=>_0xa75911[_0x8c0f4e(0x315)])[_0x8c0f4e(0x228)],_0x1404c0=_0x19ac25-_0x2a18ea,_0x54c6f0=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x244));if(_0x54c6f0)_0x54c6f0['innerText']=state[_0x8c0f4e(0x308)][_0x8c0f4e(0x22e)]||0x0;const _0x4cd20b=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x2ae));if(_0x4cd20b)_0x4cd20b['innerText']=state[_0x8c0f4e(0x308)][_0x8c0f4e(0x249)]||0x0;const _0x34bf72=document['getElementById']('res-stat-winners');if(_0x34bf72)_0x34bf72['innerText']=_0x19ac25;const _0x1578d4=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x28d));if(_0x1578d4)_0x1578d4[_0x8c0f4e(0x1d9)]=_0x2a18ea;const _0x123d54=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x2ec));if(_0x123d54)_0x123d54[_0x8c0f4e(0x1d9)]=_0x1404c0;let _0x1275b4=state[_0x8c0f4e(0x26b)][_0x8c0f4e(0x2a1)](_0x45365f=>_0x45365f[_0x8c0f4e(0x2f2)]);if(_0x4ee530==='unclaimed')_0x1275b4=_0x1275b4['filter'](_0x2e0c88=>!_0x2e0c88[_0x8c0f4e(0x315)]);if(_0x4ee530===_0x8c0f4e(0x26c))_0x1275b4=_0x1275b4[_0x8c0f4e(0x2a1)](_0x465282=>_0x465282[_0x8c0f4e(0x315)]);_0x1275b4[_0x8c0f4e(0x1cb)]((_0x1b242f,_0x1d5bc6)=>{const _0x93b855=_0x8c0f4e;let _0x451c62=_0x1b242f[state[_0x93b855(0x239)]],_0x30b7ae=_0x1d5bc6[state[_0x93b855(0x239)]];if(state[_0x93b855(0x239)]==='rewardTime'||state[_0x93b855(0x239)]===_0x93b855(0x315)){_0x451c62=_0x451c62?.[_0x93b855(0x2b0)]?.()||(_0x451c62?new Date(_0x451c62):null),_0x30b7ae=_0x30b7ae?.[_0x93b855(0x2b0)]?.()||(_0x30b7ae?new Date(_0x30b7ae):null);if(!_0x451c62)return 0x1;if(!_0x30b7ae)return-0x1;return state[_0x93b855(0x2d2)]===_0x93b855(0x311)?_0x451c62-_0x30b7ae:_0x30b7ae-_0x451c62;}return _0x451c62=String(_0x451c62||'')[_0x93b855(0x2c3)](),_0x30b7ae=String(_0x30b7ae||'')['toLowerCase'](),state[_0x93b855(0x2d2)]===_0x93b855(0x311)?_0x451c62[_0x93b855(0x1f7)](_0x30b7ae):_0x30b7ae['localeCompare'](_0x451c62);});const _0x2e107c=[_0x8c0f4e(0x2cf),_0x8c0f4e(0x2f2),_0x8c0f4e(0x2c7),'ConfirmReward'];_0x2e107c[_0x8c0f4e(0x2ee)](_0x118c67=>{const _0x2c2937=_0x8c0f4e,_0x383fa2=document['getElementById'](_0x2c2937(0x2a8)+_0x118c67);_0x383fa2&&(state[_0x2c2937(0x239)]===_0x118c67?_0x383fa2['innerHTML']=state[_0x2c2937(0x259)]===_0x2c2937(0x311)?'<i\x20data-lucide=\x22chevron-up\x22></i>':'<i\x20data-lucide=\x22chevron-down\x22></i>':_0x383fa2['innerHTML']=_0x2c2937(0x2d7));});const _0x532936=document[_0x8c0f4e(0x2ac)](_0x8c0f4e(0x1c7));if(!_0x532936)return;if(_0x1275b4['length']===0x0){_0x532936[_0x8c0f4e(0x286)]='<tr><td\x20colspan=\x226\x22\x20class=\x22text-center\x20py-8\x20text-slate-400\x20text-xs\x20text-xs\x22>ไม่พบข้อมูล</td></tr>';return;}_0x532936[_0x8c0f4e(0x286)]=_0x1275b4[_0x8c0f4e(0x251)]((_0x22e586,_0x38e141)=>{const _0x4382ae=_0x8c0f4e,_0x3fd3bf=_0x22e586['rewardTime']?(_0x22e586[_0x4382ae(0x2c7)]['toDate']?.()||new Date(_0x22e586[_0x4382ae(0x2c7)]))[_0x4382ae(0x1e3)]('th-TH'):'-';let _0x3b01a9='-';if(_0x22e586[_0x4382ae(0x315)])_0x3b01a9=_0x4382ae(0x31a);else _0x22e586[_0x4382ae(0x2f2)]&&_0x22e586[_0x4382ae(0x2f2)]!==_0x4382ae(0x2d4)&&(_0x3b01a9=_0x4382ae(0x1d3)+_0x22e586['id']+_0x4382ae(0x32f));return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20font-mono\x20text-slate-500\x20text-xs\x22>'+(_0x38e141+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+(_0x22e586[_0x4382ae(0x2cf)]||'-')+_0x4382ae(0x2ea)+_0x22e586[_0x4382ae(0x2f2)]+_0x4382ae(0x2f1)+_0x3fd3bf+_0x4382ae(0x2e5)+_0x3b01a9+_0x4382ae(0x1fe)+_0x22e586['id']+'\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20transition\x20text-xs\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';})['join'](''),lucide[_0x8c0f4e(0x273)]();},window[_0x2f59fd(0x30c)]['changeResSort']=_0x556dd7=>{const _0x4ded58=_0x2f59fd;state[_0x4ded58(0x239)]===_0x556dd7?state[_0x4ded58(0x2d2)]=state['resultsSortOrder']==='asc'?'desc':'asc':(state[_0x4ded58(0x239)]=_0x556dd7,state[_0x4ded58(0x2d2)]=_0x4ded58(0x311)),window['app']['renderResults']();};function renderTable(_0x8cf8d1){const _0x233a06=_0x2f59fd,_0x32fb9e=document[_0x233a06(0x2ac)](_0x233a06(0x313));if(!_0x32fb9e)return;let _0x2bdf31=[..._0x8cf8d1];state[_0x233a06(0x203)]&&(_0x2bdf31=_0x2bdf31[_0x233a06(0x2a1)](_0x59df1c=>(_0x59df1c[_0x233a06(0x2cf)]||'')[_0x233a06(0x2c3)]()[_0x233a06(0x2b9)](state[_0x233a06(0x203)])||(_0x59df1c[_0x233a06(0x2d8)]||'')[_0x233a06(0x265)]()[_0x233a06(0x2b9)](state[_0x233a06(0x203)])));_0x2bdf31[_0x233a06(0x1cb)]((_0x50d820,_0xc4d347)=>{const _0x123b55=_0x233a06;let _0x22eac2=_0x50d820[state[_0x123b55(0x202)]],_0x51c0a8=_0xc4d347[state[_0x123b55(0x202)]];if(['CheckIN',_0x123b55(0x2c2),'ConfirmReward'][_0x123b55(0x2b9)](state[_0x123b55(0x202)])){_0x22eac2=_0x22eac2?.[_0x123b55(0x2b0)]?.()||(_0x22eac2?new Date(_0x22eac2):null),_0x51c0a8=_0x51c0a8?.[_0x123b55(0x2b0)]?.()||(_0x51c0a8?new Date(_0x51c0a8):null);if(!_0x22eac2)return 0x1;if(!_0x51c0a8)return-0x1;return state[_0x123b55(0x259)]===_0x123b55(0x311)?_0x22eac2-_0x51c0a8:_0x51c0a8-_0x22eac2;}if(state[_0x123b55(0x202)]===_0x123b55(0x2d8))return state[_0x123b55(0x259)]===_0x123b55(0x311)?(parseInt(_0x22eac2)||0x0)-(parseInt(_0x51c0a8)||0x0):(parseInt(_0x51c0a8)||0x0)-(parseInt(_0x22eac2)||0x0);return _0x22eac2=String(_0x22eac2||'')[_0x123b55(0x2c3)](),_0x51c0a8=String(_0x51c0a8||'')[_0x123b55(0x2c3)](),state['sortOrder']==='asc'?_0x22eac2[_0x123b55(0x1f7)](_0x51c0a8):_0x51c0a8[_0x123b55(0x1f7)](_0x22eac2);});const _0x32ac89=['EmpMember',_0x233a06(0x2cf),_0x233a06(0x2ff),_0x233a06(0x1f0),'ConfirmVotingCard',_0x233a06(0x2f2),'ConfirmReward'];_0x32ac89['forEach'](_0x5de221=>{const _0x2cbfbd=_0x233a06,_0x375181=document['getElementById']('sort-'+_0x5de221);_0x375181&&(state[_0x2cbfbd(0x202)]===_0x5de221?_0x375181[_0x2cbfbd(0x286)]=state[_0x2cbfbd(0x259)]===_0x2cbfbd(0x311)?_0x2cbfbd(0x2ef):_0x2cbfbd(0x29c):_0x375181[_0x2cbfbd(0x286)]=_0x2cbfbd(0x1e6));});const _0xc8e01=state[_0x233a06(0x324)],_0x576c62=Math[_0x233a06(0x1bc)](_0x2bdf31[_0x233a06(0x228)]/_0xc8e01)||0x1,_0x29402a=_0x2bdf31[_0x233a06(0x336)]((state[_0x233a06(0x22f)]-0x1)*_0xc8e01,state[_0x233a06(0x22f)]*_0xc8e01);if(document[_0x233a06(0x2ac)](_0x233a06(0x243)))document['getElementById'](_0x233a06(0x243))[_0x233a06(0x1d9)]=_0x233a06(0x2cb)+state[_0x233a06(0x22f)]+_0x233a06(0x2c9)+_0x576c62;if(document[_0x233a06(0x2ac)](_0x233a06(0x215)))document[_0x233a06(0x2ac)](_0x233a06(0x215))[_0x233a06(0x330)]=state[_0x233a06(0x22f)]<=0x1;if(document[_0x233a06(0x2ac)]('btn-next'))document[_0x233a06(0x2ac)](_0x233a06(0x2d5))['disabled']=state['currentPage']>=_0x576c62;_0x32fb9e[_0x233a06(0x286)]=_0x29402a[_0x233a06(0x251)](_0x17c537=>{const _0x1b19c8=_0x233a06,_0x58afa7=_0x17c537['CheckIN']?(_0x17c537['CheckIN'][_0x1b19c8(0x2b0)]?.()||new Date(_0x17c537[_0x1b19c8(0x2ff)]))[_0x1b19c8(0x1e3)](_0x1b19c8(0x334)):'-',_0x321d34=_0x17c537[_0x1b19c8(0x2c2)]?(_0x17c537['ConfirmVotingCard'][_0x1b19c8(0x2b0)]?.()||new Date(_0x17c537['ConfirmVotingCard']))[_0x1b19c8(0x1e9)](_0x1b19c8(0x334)):'-',_0x115287=_0x17c537[_0x1b19c8(0x315)]?(_0x17c537[_0x1b19c8(0x315)]['toDate']?.()||new Date(_0x17c537[_0x1b19c8(0x315)]))[_0x1b19c8(0x1e9)]('th-TH'):'-';let _0x1df1a4='-';if(_0x17c537[_0x1b19c8(0x315)])_0x1df1a4=_0x1b19c8(0x32b);else{if(_0x17c537['reward']&&_0x17c537[_0x1b19c8(0x2f2)]!=='ไม่ได้รับรางวัล')_0x1df1a4=_0x1b19c8(0x1d3)+_0x17c537['id']+_0x1b19c8(0x332);else _0x17c537['reward']===_0x1b19c8(0x2d4)&&(_0x1df1a4=_0x1b19c8(0x295));}return _0x1b19c8(0x1fa)+(_0x17c537[_0x1b19c8(0x2d8)]||'-')+_0x1b19c8(0x276)+(_0x17c537[_0x1b19c8(0x2cf)]||'-')+_0x1b19c8(0x24c)+(_0x17c537['TimeLogin']||'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-medium\x20text-slate-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x58afa7+_0x1b19c8(0x1bf)+(_0x17c537[_0x1b19c8(0x1f0)]||'-')+_0x1b19c8(0x27b)+_0x321d34+_0x1b19c8(0x329)+(_0x17c537[_0x1b19c8(0x2f2)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x115287+_0x1b19c8(0x2ce)+_0x1df1a4+_0x1b19c8(0x2cd)+_0x17c537['id']+_0x1b19c8(0x1ba);})[_0x233a06(0x287)](''),lucide[_0x233a06(0x273)]();}function renderDividendTable(_0x2bc7bc){const _0x24fd29=_0x2f59fd,_0x315c45=document[_0x24fd29(0x2ac)](_0x24fd29(0x296));if(!_0x315c45)return;let _0xf57277=[..._0x2bc7bc];state[_0x24fd29(0x1e4)]&&(_0xf57277=_0xf57277[_0x24fd29(0x2a1)](_0x53e58d=>(_0x53e58d[_0x24fd29(0x1ed)]||'')[_0x24fd29(0x2c3)]()['includes'](state['divSearchTerm'])||(_0x53e58d['no']||'')[_0x24fd29(0x265)]()[_0x24fd29(0x2b9)](state[_0x24fd29(0x1e4)])));_0xf57277[_0x24fd29(0x1cb)]((_0x40f60d,_0x21bd3b)=>{const _0x39bc40=_0x24fd29;let _0x1eaf0e=_0x40f60d[state[_0x39bc40(0x26e)]],_0x57fd3a=_0x21bd3b[state['divSortBy']];if(state[_0x39bc40(0x26e)]===_0x39bc40(0x281)){_0x1eaf0e=_0x1eaf0e?.[_0x39bc40(0x2b0)]?.()||(_0x1eaf0e?new Date(_0x1eaf0e):null),_0x57fd3a=_0x57fd3a?.[_0x39bc40(0x2b0)]?.()||(_0x57fd3a?new Date(_0x57fd3a):null);if(!_0x1eaf0e)return 0x1;if(!_0x57fd3a)return-0x1;return state[_0x39bc40(0x2a0)]===_0x39bc40(0x311)?_0x1eaf0e-_0x57fd3a:_0x57fd3a-_0x1eaf0e;}if(['dividend',_0x39bc40(0x2b5),_0x39bc40(0x1e5),_0x39bc40(0x1c0),'no'][_0x39bc40(0x2b9)](state[_0x39bc40(0x26e)]))return state['divSortOrder']===_0x39bc40(0x311)?(parseFloat(_0x1eaf0e)||0x0)-(parseFloat(_0x57fd3a)||0x0):(parseFloat(_0x57fd3a)||0x0)-(parseFloat(_0x1eaf0e)||0x0);return _0x1eaf0e=String(_0x1eaf0e||'')['toLowerCase'](),_0x57fd3a=String(_0x57fd3a||'')[_0x39bc40(0x2c3)](),state[_0x39bc40(0x2a0)]==='asc'?_0x1eaf0e[_0x39bc40(0x1f7)](_0x57fd3a):_0x57fd3a['localeCompare'](_0x1eaf0e);});const _0x19f5dd=['no',_0x24fd29(0x1ed),'dividend',_0x24fd29(0x2b5),'gratuity','netpayment','DateLogin',_0x24fd29(0x256)];_0x19f5dd[_0x24fd29(0x2ee)](_0x4dff0d=>{const _0x36158d=_0x24fd29,_0x4177ba=document['getElementById'](_0x36158d(0x1f9)+_0x4dff0d);_0x4177ba&&(state[_0x36158d(0x26e)]===_0x4dff0d?_0x4177ba[_0x36158d(0x286)]=state[_0x36158d(0x2a0)]===_0x36158d(0x311)?_0x36158d(0x2ef):'<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x20text-xs\x22></i>':_0x4177ba[_0x36158d(0x286)]='<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22inline\x20w-3\x20opacity-30\x22></i>');});const _0x6d959f=_0xf57277[_0x24fd29(0x336)](0x0,0x64),_0x1cf78f=document[_0x24fd29(0x2ac)](_0x24fd29(0x1ec));if(_0x1cf78f)_0x1cf78f[_0x24fd29(0x1d9)]='แสดงผล\x20'+_0x6d959f['length']+_0x24fd29(0x2c8)+_0xf57277[_0x24fd29(0x228)]+_0x24fd29(0x1e2);_0x315c45[_0x24fd29(0x286)]=_0x6d959f[_0x24fd29(0x251)](_0x775010=>{const _0x4ea25b=_0x24fd29;let _0x1df767='-';if(_0x775010[_0x4ea25b(0x2a6)]&&_0x775010['DateMeeting']!==''){const _0xea9ad2=_0x775010['RegisMeeting']==='ไม่เข้าร่วม'?_0x4ea25b(0x2e4):'bg-green-500';_0x1df767=_0x4ea25b(0x1c8)+_0xea9ad2+_0x4ea25b(0x331)+(_0x775010[_0x4ea25b(0x256)]||_0x4ea25b(0x213))+_0x4ea25b(0x31c);}const _0x3511a7=_0x775010[_0x4ea25b(0x236)]?'<div\x20class=\x22text-[10px]\x20text-slate-500\x20font-normal\x20mt-0.5\x20text-xs\x20text-xs\x20text-xs\x22>เข้าระบบตรวจสอบเงินปันผล</div>':_0x4ea25b(0x22b),_0x5dc523=_0x775010[_0x4ea25b(0x281)]?(_0x775010[_0x4ea25b(0x281)][_0x4ea25b(0x2b0)]?.()||new Date(_0x775010[_0x4ea25b(0x281)]))['toLocaleString']('th-TH'):'-',_0x2f0df6=_0x775010[_0x4ea25b(0x281)]?_0x4ea25b(0x2e8)+_0x5dc523+_0x4ea25b(0x29f):'-';return'<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x20text-sm\x22>'+(_0x775010['no']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+(_0x775010[_0x4ea25b(0x1ed)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+parseFloat(_0x775010[_0x4ea25b(0x25a)]||0x0)[_0x4ea25b(0x1e9)]()+_0x4ea25b(0x1fc)+parseFloat(_0x775010[_0x4ea25b(0x2b5)]||0x0)[_0x4ea25b(0x1e9)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+parseFloat(_0x775010[_0x4ea25b(0x1e5)]||0x0)[_0x4ea25b(0x1e9)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20font-bold\x20text-emerald-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+parseFloat(_0x775010['netpayment']||0x0)[_0x4ea25b(0x1e9)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x2f0df6+_0x4ea25b(0x321)+_0x1df767+_0x4ea25b(0x1c5)+_0x775010['id']+_0x4ea25b(0x248);})[_0x24fd29(0x287)](''),lucide[_0x24fd29(0x273)]();}window[_0x2f59fd(0x30c)][_0x2f59fd(0x29d)]=_0x1a1816=>{const _0x3f1187=_0x2f59fd;state['divSortBy']===_0x1a1816?state['divSortOrder']=state[_0x3f1187(0x2a0)]===_0x3f1187(0x311)?_0x3f1187(0x201):'asc':(state[_0x3f1187(0x26e)]=_0x1a1816,state[_0x3f1187(0x2a0)]=_0x1a1816===_0x3f1187(0x281)?_0x3f1187(0x201):_0x3f1187(0x311)),renderDividendTable(state['dividendUsers']);},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2b7)]=()=>{const _0x4bf6f9=_0x2f59fd,_0x4f6f19=state[_0x4bf6f9(0x1dd)];let _0x5979db=[..._0x4f6f19];state['divSearchTerm']&&(_0x5979db=_0x5979db['filter'](_0x9bdc72=>(_0x9bdc72[_0x4bf6f9(0x1ed)]||'')[_0x4bf6f9(0x2c3)]()['includes'](state[_0x4bf6f9(0x1e4)])||(_0x9bdc72['no']||'')['toString']()[_0x4bf6f9(0x2b9)](state[_0x4bf6f9(0x1e4)])));_0x5979db[_0x4bf6f9(0x1cb)]((_0x468eaf,_0x4ab47f)=>{const _0x40d0cf=_0x4bf6f9;let _0x144204=_0x468eaf[state[_0x40d0cf(0x26e)]],_0x9be17c=_0x4ab47f[state[_0x40d0cf(0x26e)]];if(state[_0x40d0cf(0x26e)]===_0x40d0cf(0x281)){_0x144204=_0x144204?.[_0x40d0cf(0x2b0)]?.()||(_0x144204?new Date(_0x144204):null),_0x9be17c=_0x9be17c?.['toDate']?.()||(_0x9be17c?new Date(_0x9be17c):null);if(!_0x144204)return 0x1;if(!_0x9be17c)return-0x1;return state['divSortOrder']===_0x40d0cf(0x311)?_0x144204-_0x9be17c:_0x9be17c-_0x144204;}if([_0x40d0cf(0x25a),_0x40d0cf(0x2b5),_0x40d0cf(0x1e5),_0x40d0cf(0x1c0),'no'][_0x40d0cf(0x2b9)](state['divSortBy']))return state[_0x40d0cf(0x2a0)]===_0x40d0cf(0x311)?(parseFloat(_0x144204)||0x0)-(parseFloat(_0x9be17c)||0x0):(parseFloat(_0x9be17c)||0x0)-(parseFloat(_0x144204)||0x0);return _0x144204=String(_0x144204||'')['toLowerCase'](),_0x9be17c=String(_0x9be17c||'')[_0x40d0cf(0x2c3)](),state[_0x40d0cf(0x2a0)]==='asc'?_0x144204[_0x40d0cf(0x1f7)](_0x9be17c):_0x9be17c[_0x40d0cf(0x1f7)](_0x144204);});const _0x169e21=['ลำดับ',_0x4bf6f9(0x1df),_0x4bf6f9(0x27d),_0x4bf6f9(0x1c2),_0x4bf6f9(0x318),_0x4bf6f9(0x238),_0x4bf6f9(0x216),'แจ้งเข้าร่วม'],_0x8ae903=[_0x169e21['join'](',')];_0x5979db[_0x4bf6f9(0x2ee)](_0xf84849=>{const _0x4728a3=_0x4bf6f9,_0x4183c0=_0xf84849[_0x4728a3(0x281)]?(_0xf84849['DateLogin']['toDate']?.()||new Date(_0xf84849[_0x4728a3(0x281)]))['toLocaleString'](_0x4728a3(0x334)):'-',_0x48af19=_0xf84849[_0x4728a3(0x2a6)]&&_0xf84849[_0x4728a3(0x2a6)]!==''?_0xf84849[_0x4728a3(0x256)]||'เข้าร่วม':_0x4728a3(0x327),_0x460a85=[_0xf84849['no']||'','\x22'+(_0xf84849[_0x4728a3(0x1ed)]||'')+'\x22',_0xf84849[_0x4728a3(0x25a)]||0x0,_0xf84849[_0x4728a3(0x2b5)]||0x0,_0xf84849[_0x4728a3(0x1e5)]||0x0,_0xf84849['netpayment']||0x0,'\x22'+_0x4183c0+'\x22','\x22'+_0x48af19+'\x22'];_0x8ae903[_0x4728a3(0x1f1)](_0x460a85[_0x4728a3(0x287)](','));});const _0x314402='\ufeff'+_0x8ae903[_0x4bf6f9(0x287)]('\x0a'),_0x43adf4=new Blob([_0x314402],{'type':'text/csv;charset=utf-8;'}),_0x1dbe30=URL[_0x4bf6f9(0x2cc)](_0x43adf4),_0x2fa242=document['createElement']('a');_0x2fa242['setAttribute'](_0x4bf6f9(0x1e1),_0x1dbe30),_0x2fa242['setAttribute'](_0x4bf6f9(0x274),'dividend_report_'+new Date()['toLocaleDateString']('th-TH')+'.csv'),_0x2fa242['style'][_0x4bf6f9(0x2d9)]=_0x4bf6f9(0x211),document[_0x4bf6f9(0x320)][_0x4bf6f9(0x22c)](_0x2fa242),_0x2fa242[_0x4bf6f9(0x25d)](),document['body'][_0x4bf6f9(0x261)](_0x2fa242),window[_0x4bf6f9(0x30c)][_0x4bf6f9(0x30a)]('Download\x20CSV\x20สำเร็จ',_0x4bf6f9(0x24b));},window[_0x2f59fd(0x30c)]['changeSort']=_0x5dbcb6=>{const _0x2f0a58=_0x2f59fd;state[_0x2f0a58(0x202)]===_0x5dbcb6?state[_0x2f0a58(0x259)]=state['sortOrder']===_0x2f0a58(0x311)?_0x2f0a58(0x201):_0x2f0a58(0x311):(state[_0x2f0a58(0x202)]=_0x5dbcb6,state['sortOrder']=_0x5dbcb6===_0x2f0a58(0x2ff)?_0x2f0a58(0x201):_0x2f0a58(0x311)),renderTable(state[_0x2f0a58(0x26b)]);},window[_0x2f59fd(0x30c)][_0x2f59fd(0x20f)]=()=>{const _0x19f3f2=_0x2f59fd,_0x5d1f41=document['getElementById'](_0x19f3f2(0x23c))[_0x19f3f2(0x206)][_0x19f3f2(0x280)]()[_0x19f3f2(0x2c3)](),_0x5c85ed=document[_0x19f3f2(0x2ac)](_0x19f3f2(0x1ea)),_0x1d2256=state['users']['find'](_0x4b964d=>(_0x4b964d[_0x19f3f2(0x2cf)]||'')[_0x19f3f2(0x2c3)]()[_0x19f3f2(0x2b9)](_0x5d1f41)||(_0x4b964d[_0x19f3f2(0x2d8)]||'')[_0x19f3f2(0x265)]()===_0x5d1f41);state[_0x19f3f2(0x283)]=_0x1d2256,_0x5c85ed[_0x19f3f2(0x330)]=!_0x1d2256,_0x5c85ed['classList'][_0x19f3f2(0x24d)](_0x19f3f2(0x21f),!_0x1d2256),_0x5c85ed[_0x19f3f2(0x23a)][_0x19f3f2(0x24d)](_0x19f3f2(0x2fa),!_0x1d2256);},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2c4)]=()=>{const _0x2002d3=_0x2f59fd,_0x379614=state[_0x2002d3(0x283)];if(!_0x379614)return;document[_0x2002d3(0x2ac)](_0x2002d3(0x28f))[_0x2002d3(0x286)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid\x20grid-cols-2\x20gap-y-3\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>ชื่อ-นามสกุล:</b>\x20<span\x20class=\x22font-bold\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x379614[_0x2002d3(0x2cf)]+_0x2002d3(0x234)+_0x379614[_0x2002d3(0x2d8)]+_0x2002d3(0x250)+(_0x379614[_0x2002d3(0x2ff)]?_0x2002d3(0x302):_0x2002d3(0x292))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รับบัตรเลือกตั้ง:</b>\x20<span\x20class=\x22text-sm\x20text-sm\x20text-sm\x22>'+(_0x379614[_0x2002d3(0x1f0)]?_0x2002d3(0x2bb):'ยังไม่ได้รับ')+_0x2002d3(0x2b1),document['getElementById'](_0x2002d3(0x269))[_0x2002d3(0x23a)][_0x2002d3(0x317)](_0x2002d3(0x211)),lucide['createIcons']();},window['app'][_0x2f59fd(0x24e)]=async _0x9b896=>{const _0x4563bb=_0x2f59fd,_0x167624=state[_0x4563bb(0x283)];if(!_0x167624)return;const _0x1a2bd5={'CheckIN':serverTimestamp(),'status':_0x4563bb(0x222)};_0x9b896&&(_0x1a2bd5[_0x4563bb(0x1f0)]=_0x4563bb(0x230),_0x1a2bd5[_0x4563bb(0x2c2)]=serverTimestamp());try{await updateDoc(doc(db,finalCollectionPath,_0x167624['id']),_0x1a2bd5),window[_0x4563bb(0x30c)][_0x4563bb(0x30a)](_0x4563bb(0x1c3)+(_0x9b896?_0x4563bb(0x1bb):'')),window[_0x4563bb(0x30c)][_0x4563bb(0x240)](),document[_0x4563bb(0x2ac)](_0x4563bb(0x23c))['value']='',window[_0x4563bb(0x30c)][_0x4563bb(0x20f)]();}catch(_0xec9e94){console[_0x4563bb(0x284)](_0xec9e94),window['app'][_0x4563bb(0x30a)]('เกิดข้อผิดพลาดในการบันทึก',_0x4563bb(0x284));}},window['app'][_0x2f59fd(0x1ce)]=async _0x157bfd=>{const _0x141eaa=_0x2f59fd;if(!confirm(_0x141eaa(0x21e)))return;try{await updateDoc(doc(db,finalCollectionPath,_0x157bfd),{'ConfirmReward':serverTimestamp()}),window[_0x141eaa(0x30c)]['showToast'](_0x141eaa(0x2a2));}catch(_0xe0d476){window['app'][_0x141eaa(0x30a)](_0x141eaa(0x2a4),_0x141eaa(0x284));}},window[_0x2f59fd(0x30c)]['deleteSingleData']=async _0x39e72e=>{const _0x4c524d=_0x2f59fd;if(confirm(_0x4c524d(0x2b3)))try{await updateDoc(doc(db,finalCollectionPath,_0x39e72e),{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'status':deleteField(),'ConfirmReward':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField(),'TimeLogin':0x0}),window['app'][_0x4c524d(0x30a)](_0x4c524d(0x209));}catch(_0x4602e9){console['error'](_0x4602e9),window[_0x4c524d(0x30c)][_0x4c524d(0x30a)]('เกิดข้อผิดพลาด',_0x4c524d(0x284));}},window[_0x2f59fd(0x30c)][_0x2f59fd(0x1e0)]=_0x2167dc=>{const _0x53ec8f=_0x2f59fd;state[_0x53ec8f(0x333)]=_0x2167dc,document[_0x53ec8f(0x2ac)](_0x53ec8f(0x2c1))[_0x53ec8f(0x23a)]['remove'](_0x53ec8f(0x211));},window['app']['closeSingleDividendResetModal']=()=>{const _0x354d41=_0x2f59fd;state[_0x354d41(0x333)]=null,document[_0x354d41(0x2ac)](_0x354d41(0x2c1))[_0x354d41(0x23a)][_0x354d41(0x23d)]('hidden');},window['app'][_0x2f59fd(0x1de)]=async()=>{const _0x527ff4=_0x2f59fd,_0x4fadfd=state['dividendIdToReset'];if(!_0x4fadfd)return;try{await updateDoc(doc(db,dividendCollectionPath,_0x4fadfd),{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()}),window['app'][_0x527ff4(0x30a)](_0x527ff4(0x221)),window[_0x527ff4(0x30c)][_0x527ff4(0x306)]();}catch(_0x50f646){console[_0x527ff4(0x284)](_0x50f646),window[_0x527ff4(0x30c)]['showToast'](_0x527ff4(0x1f6),_0x527ff4(0x284));}},window['app'][_0x2f59fd(0x338)]=_0x1943b4=>{const _0x440349=_0x2f59fd,_0x5423f2=_0x1943b4[_0x440349(0x30f)][_0x440349(0x255)][0x0];_0x5423f2&&(state[_0x440349(0x253)]=_0x5423f2,document['getElementById'](_0x440349(0x31b))[_0x440349(0x1d9)]=_0x5423f2['name'],document[_0x440349(0x2ac)](_0x440349(0x32d))[_0x440349(0x23a)][_0x440349(0x317)](_0x440349(0x211)),document[_0x440349(0x2ac)](_0x440349(0x32e))['disabled']=![]);},window[_0x2f59fd(0x30c)]['clearFileSelection']=()=>{const _0x1e5ae7=_0x2f59fd;state['fileToImport']=null,document['getElementById'](_0x1e5ae7(0x32d))[_0x1e5ae7(0x23a)][_0x1e5ae7(0x23d)](_0x1e5ae7(0x211)),document[_0x1e5ae7(0x2ac)](_0x1e5ae7(0x32e))['disabled']=!![];},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2fb)]=_0x327f05=>{const _0x5a2fc1=_0x2f59fd,_0x4a6292=_0x327f05[_0x5a2fc1(0x30f)][_0x5a2fc1(0x255)][0x0];_0x4a6292&&(state[_0x5a2fc1(0x31d)]=_0x4a6292,document[_0x5a2fc1(0x2ac)](_0x5a2fc1(0x227))[_0x5a2fc1(0x1d9)]=_0x4a6292[_0x5a2fc1(0x212)],document[_0x5a2fc1(0x2ac)](_0x5a2fc1(0x1d0))[_0x5a2fc1(0x23a)]['remove'](_0x5a2fc1(0x211)),document[_0x5a2fc1(0x2ac)](_0x5a2fc1(0x27c))[_0x5a2fc1(0x330)]=![]);},window['app'][_0x2f59fd(0x289)]=()=>{const _0x52c2c8=_0x2f59fd;state[_0x52c2c8(0x31d)]=null,document['getElementById'](_0x52c2c8(0x2f8))['value']='',document[_0x52c2c8(0x2ac)]('dividend-file-info')['classList'][_0x52c2c8(0x23d)](_0x52c2c8(0x211)),document[_0x52c2c8(0x2ac)]('btn-dividend-import')['disabled']=!![];},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2ed)]=async()=>{const _0x3fe421=_0x2f59fd,_0x32f9a9=state[_0x3fe421(0x253)];if(!_0x32f9a9)return;const _0x18706e=await _0x32f9a9[_0x3fe421(0x322)]();let _0xffa49b=_0x32f9a9[_0x3fe421(0x212)][_0x3fe421(0x2fe)](_0x3fe421(0x28e))?csvToJson(_0x18706e):JSON['parse'](_0x18706e);document['getElementById']('import-progress')[_0x3fe421(0x23a)][_0x3fe421(0x317)](_0x3fe421(0x211));const _0x2c44f2=_0xffa49b[_0x3fe421(0x228)],_0xbe91=0x12c;for(let _0x2df95c=0x0;_0x2df95c<_0x2c44f2;_0x2df95c+=_0xbe91){const _0x2d81ae=_0xffa49b[_0x3fe421(0x336)](_0x2df95c,_0x2df95c+_0xbe91),_0x233957=writeBatch(db);for(const _0x47b51f of _0x2d81ae){const _0x53699=_0x47b51f[_0x3fe421(0x23b)]||_0x47b51f[_0x3fe421(0x2e3)]||'',_0x3bceeb=await sha256(_0x53699[_0x3fe421(0x265)]()[_0x3fe421(0x218)](/-/g,'')['trim']()),_0x2f2e53=doc(collection(db,finalCollectionPath));_0x233957[_0x3fe421(0x2d0)](_0x2f2e53,{..._0x47b51f,'citizenId':_0x3bceeb,'importedAt':serverTimestamp()});}await _0x233957['commit'](),document[_0x3fe421(0x2ac)](_0x3fe421(0x2be))[_0x3fe421(0x264)][_0x3fe421(0x1c6)]=(_0x2df95c+_0x2d81ae[_0x3fe421(0x228)])/_0x2c44f2*0x64+'%';}window[_0x3fe421(0x30c)]['showToast']('นำเข้าข้อมูลรายชื่อสำเร็จ'),window[_0x3fe421(0x30c)][_0x3fe421(0x25e)]();},window['app'][_0x2f59fd(0x335)]=async()=>{const _0x467f9f=_0x2f59fd,_0x30a75f=state[_0x467f9f(0x31d)];if(!_0x30a75f)return;const _0x46f2a2=await _0x30a75f[_0x467f9f(0x322)]();let _0x367cd9=_0x30a75f[_0x467f9f(0x212)]['endsWith'](_0x467f9f(0x28e))?csvToJson(_0x46f2a2):JSON['parse'](_0x46f2a2);document['getElementById'](_0x467f9f(0x2f7))[_0x467f9f(0x23a)]['remove'](_0x467f9f(0x211));const _0x15407a=_0x367cd9[_0x467f9f(0x228)],_0x35d2d4=0x12c;for(let _0x3f6cea=0x0;_0x3f6cea<_0x15407a;_0x3f6cea+=_0x35d2d4){const _0x4d3abe=_0x367cd9[_0x467f9f(0x336)](_0x3f6cea,_0x3f6cea+_0x35d2d4),_0x2ad853=writeBatch(db);for(const _0x36e2fb of _0x4d3abe){const _0x22d079=_0x36e2fb['citizenId']||_0x36e2fb[_0x467f9f(0x2e3)]||_0x36e2fb[_0x467f9f(0x2a3)]||'',_0x7dfc43=_0x22d079?await sha256(_0x22d079[_0x467f9f(0x265)]()['replace'](/-/g,'')[_0x467f9f(0x280)]()):'',_0x4fa6eb=doc(collection(db,dividendCollectionPath));_0x2ad853[_0x467f9f(0x2d0)](_0x4fa6eb,{..._0x36e2fb,'citizenId':_0x7dfc43,'membertype':_0x467f9f(0x294),'DateLogin':null,'importedAt':serverTimestamp()});}await _0x2ad853[_0x467f9f(0x1c1)](),document[_0x467f9f(0x2ac)](_0x467f9f(0x226))[_0x467f9f(0x264)][_0x467f9f(0x1c6)]=(_0x3f6cea+_0x4d3abe[_0x467f9f(0x228)])/_0x15407a*0x64+'%';}window[_0x467f9f(0x30c)][_0x467f9f(0x30a)](_0x467f9f(0x1cc)),window[_0x467f9f(0x30c)][_0x467f9f(0x289)]();},window[_0x2f59fd(0x30c)][_0x2f59fd(0x303)]=()=>{const _0x5c60f4=_0x2f59fd;document[_0x5c60f4(0x2ac)](_0x5c60f4(0x30e))['value']='',document[_0x5c60f4(0x2ac)](_0x5c60f4(0x2ab))[_0x5c60f4(0x23a)][_0x5c60f4(0x317)](_0x5c60f4(0x211));},window[_0x2f59fd(0x30c)]['closeResetModal']=()=>document['getElementById'](_0x2f59fd(0x2ab))[_0x2f59fd(0x23a)][_0x2f59fd(0x23d)](_0x2f59fd(0x211)),window[_0x2f59fd(0x30c)]['openDeleteAllModal']=()=>{const _0x89cafd=_0x2f59fd;document[_0x89cafd(0x2ac)]('confirm-delete-input')[_0x89cafd(0x206)]='',document[_0x89cafd(0x2ac)]('delete-all-confirm-modal')[_0x89cafd(0x23a)]['remove'](_0x89cafd(0x211));},window['app']['closeDeleteAllModal']=()=>document[_0x2f59fd(0x2ac)]('delete-all-confirm-modal')[_0x2f59fd(0x23a)][_0x2f59fd(0x23d)](_0x2f59fd(0x211)),window[_0x2f59fd(0x30c)][_0x2f59fd(0x204)]=()=>{const _0x5e39b5=_0x2f59fd;document[_0x5e39b5(0x2ac)](_0x5e39b5(0x219))[_0x5e39b5(0x206)]='',document['getElementById']('dividend-reset-confirm-modal')[_0x5e39b5(0x23a)][_0x5e39b5(0x317)]('hidden');},window[_0x2f59fd(0x30c)][_0x2f59fd(0x31f)]=()=>document['getElementById']('dividend-reset-confirm-modal')['classList']['add']('hidden'),window[_0x2f59fd(0x30c)][_0x2f59fd(0x21d)]=()=>{const _0x2a9121=_0x2f59fd;document['getElementById'](_0x2a9121(0x241))['value']='',document[_0x2a9121(0x2ac)](_0x2a9121(0x2eb))[_0x2a9121(0x23a)]['remove']('hidden');},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2b6)]=()=>document['getElementById'](_0x2f59fd(0x2eb))[_0x2f59fd(0x23a)][_0x2f59fd(0x23d)]('hidden'),window[_0x2f59fd(0x30c)][_0x2f59fd(0x240)]=()=>document[_0x2f59fd(0x2ac)]('member-search-modal')[_0x2f59fd(0x23a)][_0x2f59fd(0x23d)]('hidden'),window[_0x2f59fd(0x30c)][_0x2f59fd(0x24f)]=()=>document[_0x2f59fd(0x2ac)](_0x2f59fd(0x337))['classList'][_0x2f59fd(0x23d)]('hidden'),window[_0x2f59fd(0x30c)][_0x2f59fd(0x277)]=async()=>{const _0x5dcf2b=_0x2f59fd;if(document[_0x5dcf2b(0x2ac)]('confirm-reset-input')[_0x5dcf2b(0x206)][_0x5dcf2b(0x280)]()!==_0x5dcf2b(0x1fb))return window['app'][_0x5dcf2b(0x30a)](_0x5dcf2b(0x282),_0x5dcf2b(0x284));window['app'][_0x5dcf2b(0x25b)]();const _0x3eb93b=await getDocs(query(collection(db,finalCollectionPath))),_0x12fcff=writeBatch(db);_0x3eb93b[_0x5dcf2b(0x2ee)](_0x14edd8=>_0x12fcff['update'](_0x14edd8['ref'],{'CheckIN':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField(),'status':deleteField(),'CardPoll':deleteField(),'ConfirmVotingCard':deleteField()})),await _0x12fcff[_0x5dcf2b(0x1c1)](),window['app']['showToast'](_0x5dcf2b(0x2c5));},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2aa)]=async()=>{const _0x3e4241=_0x2f59fd;if(document[_0x3e4241(0x2ac)](_0x3e4241(0x2ba))['value']['trim']()!==_0x3e4241(0x2fc))return window[_0x3e4241(0x30c)]['showToast'](_0x3e4241(0x237),_0x3e4241(0x284));window[_0x3e4241(0x30c)][_0x3e4241(0x214)]();const _0x2d79c7=await getDocs(query(collection(db,finalCollectionPath))),_0x5689fb=writeBatch(db);_0x2d79c7[_0x3e4241(0x2ee)](_0x5881c7=>_0x5689fb[_0x3e4241(0x1f3)](_0x5881c7['ref'])),await _0x5689fb[_0x3e4241(0x1c1)](),window['app'][_0x3e4241(0x30a)]('ลบพนักงานทั้งหมดแล้ว');},window[_0x2f59fd(0x30c)][_0x2f59fd(0x28b)]=async()=>{const _0x118095=_0x2f59fd;if(document[_0x118095(0x2ac)]('confirm-div-reset-input')[_0x118095(0x206)]['trim']()!==_0x118095(0x1fb))return window[_0x118095(0x30c)][_0x118095(0x30a)](_0x118095(0x309),_0x118095(0x284));window[_0x118095(0x30c)][_0x118095(0x31f)]();const _0x26444f=await getDocs(query(collection(db,dividendCollectionPath))),_0x42dd5a=writeBatch(db);_0x26444f['forEach'](_0x453714=>_0x42dd5a[_0x118095(0x1ff)](_0x453714[_0x118095(0x21a)],{'DateLogin':deleteField(),'DateMeeting':deleteField(),'RegisMeeting':deleteField(),'login':deleteField()})),await _0x42dd5a['commit'](),window['app']['showToast'](_0x118095(0x1d5));},window[_0x2f59fd(0x30c)][_0x2f59fd(0x2a5)]=async()=>{const _0x1481a0=_0x2f59fd;if(document[_0x1481a0(0x2ac)](_0x1481a0(0x241))[_0x1481a0(0x206)][_0x1481a0(0x280)]()!=='Delete')return window[_0x1481a0(0x30c)][_0x1481a0(0x30a)](_0x1481a0(0x1da),_0x1481a0(0x284));window['app'][_0x1481a0(0x2b6)]();const _0x4be4fe=await getDocs(query(collection(db,dividendCollectionPath))),_0x4c5392=writeBatch(db);_0x4be4fe[_0x1481a0(0x2ee)](_0x14fedb=>_0x4c5392[_0x1481a0(0x1f3)](_0x14fedb[_0x1481a0(0x21a)])),await _0x4c5392[_0x1481a0(0x1c1)](),window['app'][_0x1481a0(0x30a)]('ลบฐานข้อมูลเงินปันผลแล้ว');},window[_0x2f59fd(0x30c)][_0x2f59fd(0x1fd)]=()=>{const _0x36f87e=_0x2f59fd,_0x145f4e=document[_0x36f87e(0x2ac)]('select-prize'),_0x3dda08=_0x145f4e[_0x36f87e(0x30d)][_0x145f4e[_0x36f87e(0x2b2)]];if(!_0x145f4e[_0x36f87e(0x206)])return;const _0x120e63=parseInt(_0x3dda08[_0x36f87e(0x29e)][_0x36f87e(0x208)]),_0x5a0d47=state[_0x36f87e(0x26b)]['filter'](_0x10eaab=>_0x10eaab[_0x36f87e(0x2f2)]===_0x3dda08['text'])[_0x36f87e(0x228)],_0x5bd89a=_0x120e63-_0x5a0d47;document[_0x36f87e(0x2ac)](_0x36f87e(0x220))[_0x36f87e(0x1d9)]=_0x5bd89a,document[_0x36f87e(0x2ac)](_0x36f87e(0x268))[_0x36f87e(0x1d9)]=state[_0x36f87e(0x308)][_0x36f87e(0x232)],document['getElementById']('input-draw-qty')['value']=_0x3dda08[_0x36f87e(0x29e)][_0x36f87e(0x290)],window[_0x36f87e(0x30c)][_0x36f87e(0x275)]();},window[_0x2f59fd(0x30c)][_0x2f59fd(0x275)]=()=>{const _0x248b23=_0x2f59fd,_0x593c42=document[_0x248b23(0x2ac)](_0x248b23(0x1f4)),_0x5e2f64=parseInt(document[_0x248b23(0x2ac)](_0x248b23(0x1d7))['value']),_0x5288b6=parseInt(document[_0x248b23(0x2ac)](_0x248b23(0x220))[_0x248b23(0x1d9)]),_0x1b8aba=_0x5e2f64>0x0&&_0x5e2f64<=_0x5288b6&&_0x593c42[_0x248b23(0x206)];document[_0x248b23(0x2ac)]('btn-start-random')['disabled']=!_0x1b8aba,document[_0x248b23(0x2ac)](_0x248b23(0x305))[_0x248b23(0x23a)][_0x248b23(0x24d)]('hidden',_0x5e2f64<=_0x5288b6);},window[_0x2f59fd(0x30c)]['startRandomizer']=async()=>{const _0x2f983a=_0x2f59fd;if(state[_0x2f983a(0x2c0)])return;const _0x4699c1=document[_0x2f983a(0x2ac)](_0x2f983a(0x1f4)),_0x5d14b3=_0x4699c1[_0x2f983a(0x30d)][_0x4699c1[_0x2f983a(0x2b2)]][_0x2f983a(0x322)],_0x113451=parseInt(document[_0x2f983a(0x2ac)](_0x2f983a(0x1d7))[_0x2f983a(0x206)]),_0x1936c2=state[_0x2f983a(0x26b)]['filter'](_0x3cc359=>_0x3cc359[_0x2f983a(0x312)]==='Active'&&!_0x3cc359[_0x2f983a(0x2f2)]);if(_0x1936c2[_0x2f983a(0x228)]<_0x113451)return window[_0x2f983a(0x30c)][_0x2f983a(0x30a)](_0x2f983a(0x288),_0x2f983a(0x284));state[_0x2f983a(0x2c0)]=!![],document[_0x2f983a(0x2ac)](_0x2f983a(0x28a))[_0x2f983a(0x330)]=!![],document[_0x2f983a(0x2ac)]('screen-overlay-controls')[_0x2f983a(0x23a)][_0x2f983a(0x317)](_0x2f983a(0x211)),await new Promise(_0x54b11d=>setTimeout(_0x54b11d,0x3e8)),document[_0x2f983a(0x2ac)](_0x2f983a(0x2a7))[_0x2f983a(0x23a)][_0x2f983a(0x23d)]('hidden'),document[_0x2f983a(0x2ac)](_0x2f983a(0x225))[_0x2f983a(0x286)]='';const _0x2d5fd2=_0x1936c2[_0x2f983a(0x1cb)](()=>0.5-Math[_0x2f983a(0x29a)]())[_0x2f983a(0x336)](0x0,_0x113451);for(let _0x3f8932=0x0;_0x3f8932<_0x2d5fd2[_0x2f983a(0x228)];_0x3f8932++){const _0x2b41e9=_0x2d5fd2[_0x3f8932],_0x343dac=document[_0x2f983a(0x278)](_0x2f983a(0x2d3));_0x343dac[_0x2f983a(0x325)]='bg-white\x20p-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-400\x20flex\x20justify-between\x20items-center\x20fade-in-up\x20text-sm',_0x343dac[_0x2f983a(0x286)]='<div><p\x20class=\x22font-bold\x20text-lg\x20text-slate-800\x20text-sm\x22>'+_0x2b41e9[_0x2f983a(0x2cf)]+_0x2f983a(0x21b)+_0x2b41e9[_0x2f983a(0x2d8)]+_0x2f983a(0x2ad)+_0x5d14b3+_0x2f983a(0x31c),document[_0x2f983a(0x2ac)](_0x2f983a(0x225))[_0x2f983a(0x22c)](_0x343dac),confetti({'particleCount':0x64,'spread':0x46,'origin':{'y':0.6}}),await updateDoc(doc(db,finalCollectionPath,_0x2b41e9['id']),{'reward':_0x5d14b3,'rewardTime':serverTimestamp()});if(_0x3f8932<_0x2d5fd2[_0x2f983a(0x228)]-0x1)await new Promise(_0x290629=>setTimeout(_0x290629,0x7d0));}state['isDrawing']=![],window[_0x2f983a(0x30c)]['onPrizeSelect'](),window[_0x2f983a(0x30c)][_0x2f983a(0x30a)](_0x2f983a(0x24a));};function updateCharts(_0x3eff78){const _0xa09878=_0x2f59fd,_0x1f4dfe=Array['from']({'length':0x18},(_0x399006,_0x32ae64)=>_0x32ae64+_0xa09878(0x270)),_0x3f3e13=document[_0xa09878(0x2ac)](_0xa09878(0x26d))?.['getContext']('2d');if(!_0x3f3e13)return;window[_0xa09878(0x246)]?(window[_0xa09878(0x246)][_0xa09878(0x298)][_0xa09878(0x23f)][0x0][_0xa09878(0x298)]=_0x1f4dfe[_0xa09878(0x251)]((_0x3e579d,_0x2815b0)=>_0x3eff78[_0x2815b0]||0x0),window[_0xa09878(0x246)][_0xa09878(0x1ff)]()):window['regChartInst']=new Chart(_0x3f3e13,{'type':'line','data':{'labels':_0x1f4dfe,'datasets':[{'label':_0xa09878(0x22a),'data':_0x1f4dfe['map']((_0x4c6177,_0x42bb8b)=>_0x3eff78[_0x42bb8b]||0x0),'borderColor':_0xa09878(0x1be),'backgroundColor':_0xa09878(0x2f4),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![]}});}function renderActivityFeed(_0x13405d){const _0x1eb042=_0x2f59fd,_0x3cbd7a=document[_0x1eb042(0x2ac)](_0x1eb042(0x20e));if(!_0x3cbd7a)return;const _0x1aa47f=[];_0x13405d['forEach'](_0x29927b=>{const _0x27a94c=_0x1eb042;if(_0x29927b[_0x27a94c(0x2ff)])_0x1aa47f[_0x27a94c(0x1f1)]({'t':'IN','d':_0x29927b[_0x27a94c(0x2ff)][_0x27a94c(0x2b0)]?.()||new Date(_0x29927b[_0x27a94c(0x2ff)]),'n':_0x29927b[_0x27a94c(0x2cf)]});}),_0x1aa47f[_0x1eb042(0x1cb)]((_0x2bdc7b,_0x3c1f97)=>_0x3c1f97['d']-_0x2bdc7b['d']),_0x3cbd7a[_0x1eb042(0x286)]=_0x1aa47f[_0x1eb042(0x336)](0x0,0xf)[_0x1eb042(0x251)](_0x8e255e=>'<div\x20class=\x22flex\x20items-center\x20gap-3\x20p-3\x20bg-slate-50\x20rounded-xl\x20text-sm\x20border-l-4\x20border-indigo-500\x20shadow-sm\x20font-medium\x22><span\x20class=\x22font-bold\x20text-indigo-700\x20text-sm\x22>'+_0x8e255e['t']+_0x1eb042(0x301)+_0x8e255e['n']+_0x1eb042(0x235)+_0x8e255e['d'][_0x1eb042(0x1e3)]('th-TH')+_0x1eb042(0x27f))[_0x1eb042(0x287)]('');}const csvToJson=_0x106faf=>{const _0x18f7c0=_0x2f59fd,_0x4dfad9=_0x106faf[_0x18f7c0(0x262)]('\x0a'),_0x3b8866=_0x4dfad9[0x0]['split'](',')[_0x18f7c0(0x251)](_0x130ce0=>_0x130ce0['trim']());return _0x4dfad9[_0x18f7c0(0x336)](0x1)[_0x18f7c0(0x251)](_0x30ec20=>{const _0x56b477=_0x18f7c0,_0x5f44bb=_0x30ec20[_0x56b477(0x262)](',');if(_0x5f44bb[_0x56b477(0x228)]<_0x3b8866[_0x56b477(0x228)])return null;return _0x3b8866[_0x56b477(0x2bf)]((_0x1b607f,_0x832a38,_0x2634fb)=>{const _0x55b7d2=_0x56b477;return _0x1b607f[_0x832a38]=_0x5f44bb[_0x2634fb]?_0x5f44bb[_0x2634fb][_0x55b7d2(0x280)]():'',_0x1b607f;},{});})[_0x18f7c0(0x2a1)](_0xfdceb9=>_0xfdceb9);};setInterval(()=>{const _0x725d83=_0x2f59fd;if(document[_0x725d83(0x2ac)](_0x725d83(0x2bc)))document[_0x725d83(0x2ac)](_0x725d83(0x2bc))[_0x725d83(0x1d9)]=new Date()[_0x725d83(0x1e3)](_0x725d83(0x334));},0x3e8),window[_0x2f59fd(0x30c)]['handlePrizeSubmit']=async _0xb07952=>{const _0x349b0c=_0x2f59fd;_0xb07952[_0x349b0c(0x2e1)]();const _0x2dcd7d=document[_0x349b0c(0x2ac)](_0x349b0c(0x1cd))['value'],_0x4a8a3e=parseInt(document[_0x349b0c(0x2ac)](_0x349b0c(0x26a))['value']),_0x23ee0d=parseInt(document['getElementById']('prize-total')[_0x349b0c(0x206)]);await addDoc(collection(db,prizesCollectionPath),{'name':_0x2dcd7d,'qtyPerDraw':_0x4a8a3e,'totalQty':_0x23ee0d,'createdAt':serverTimestamp()}),document['getElementById'](_0x349b0c(0x2da))[_0x349b0c(0x326)](),window['app'][_0x349b0c(0x30a)]('บันทึกรางวัลสำเร็จ');},window[_0x2f59fd(0x30c)][_0x2f59fd(0x260)]=async _0x172d28=>{const _0x5c02e0=_0x2f59fd;if(confirm(_0x5c02e0(0x1ca)))await deleteDoc(doc(db,prizesCollectionPath,_0x172d28));},window[_0x2f59fd(0x30c)][_0x2f59fd(0x291)]=async _0x561f58=>{const _0x358233=_0x2f59fd;if(confirm(_0x358233(0x32c)))await updateDoc(doc(db,finalCollectionPath,_0x561f58),{'reward':deleteField(),'rewardTime':deleteField(),'ConfirmReward':deleteField()});},window[_0x2f59fd(0x30c)][_0x2f59fd(0x25c)]=_0x3f04e8=>{const _0x5191b1=_0x2f59fd;state[_0x5191b1(0x203)]=_0x3f04e8['toLowerCase'](),state['currentPage']=0x1,renderTable(state[_0x5191b1(0x26b)]);},window['app'][_0x2f59fd(0x2df)]=_0x363049=>{const _0xc1fed2=_0x2f59fd;state['divSearchTerm']=_0x363049[_0xc1fed2(0x2c3)](),renderDividendTable(state[_0xc1fed2(0x1dd)]);},window['app']['changePage']=_0x267e32=>{state['currentPage']+=_0x267e32,renderTable(state['users']);};async function init(){const _0x581abe=_0x2f59fd;try{await signInAnonymously(auth),document[_0x581abe(0x2ac)](_0x581abe(0x247))?.[_0x581abe(0x23a)][_0x581abe(0x218)](_0x581abe(0x2e4),_0x581abe(0x307));if(document[_0x581abe(0x2ac)](_0x581abe(0x1ee)))document[_0x581abe(0x2ac)]('status-text')[_0x581abe(0x1d9)]='Online\x20(Connected)';onSnapshot(query(collection(db,finalCollectionPath)),_0x461673=>processSnapshot(_0x461673)),onSnapshot(query(collection(db,prizesCollectionPath)),_0x376891=>{const _0x23460c=_0x581abe,_0x547aed=[];let _0x44a39e=0x0;_0x376891[_0x23460c(0x2ee)](_0x595bea=>{const _0x5202a8=_0x23460c,_0x3bda77=_0x595bea['data']();_0x547aed[_0x5202a8(0x1f1)]({'id':_0x595bea['id'],..._0x3bda77}),_0x44a39e+=parseInt(_0x3bda77['totalQty'])||0x0;}),state[_0x23460c(0x28c)]=_0x547aed,state[_0x23460c(0x308)][_0x23460c(0x22e)]=_0x44a39e;const _0xd396d7=document[_0x23460c(0x2ac)](_0x23460c(0x1f4));if(_0xd396d7)_0xd396d7[_0x23460c(0x286)]='<option\x20value=\x22\x22>--\x20เลือกของรางวัล\x20--</option>'+_0x547aed[_0x23460c(0x251)](_0x4d8534=>'<option\x20value=\x22'+_0x4d8534['id']+'\x22\x20data-qty=\x22'+_0x4d8534[_0x23460c(0x271)]+'\x22\x20data-total=\x22'+_0x4d8534['totalQty']+'\x22>'+_0x4d8534[_0x23460c(0x212)]+'</option>')[_0x23460c(0x287)]('');const _0x575047=document[_0x23460c(0x2ac)]('prize-list-body');if(_0x575047)_0x575047[_0x23460c(0x286)]=_0x547aed[_0x23460c(0x251)](_0x33812d=>_0x23460c(0x1eb)+_0x33812d[_0x23460c(0x212)]+_0x23460c(0x1dc)+_0x33812d[_0x23460c(0x271)]+_0x23460c(0x2a9)+_0x33812d[_0x23460c(0x21c)]+_0x23460c(0x279)+_0x33812d['id']+'\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20transition\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td></tr>')[_0x23460c(0x287)]('');document[_0x23460c(0x2ac)]('res-stat-total-prizes')&&(document[_0x23460c(0x2ac)]('res-stat-total-prizes')[_0x23460c(0x1d9)]=_0x44a39e),lucide[_0x23460c(0x273)]();}),onSnapshot(query(collection(db,dividendCollectionPath)),_0xb97b5b=>{const _0x13952c=_0x581abe,_0x269679=[];let _0x45c56d=0x0,_0x479117=0x0,_0x2d5b9c=0x0;_0xb97b5b[_0x13952c(0x2ee)](_0x2d52e6=>{const _0xe30841=_0x13952c,_0x282056=_0x2d52e6[_0xe30841(0x298)]();_0x269679[_0xe30841(0x1f1)]({'id':_0x2d52e6['id'],..._0x282056});if(_0x282056[_0xe30841(0x281)])_0x45c56d++;if(_0x282056[_0xe30841(0x2a6)]&&_0x282056[_0xe30841(0x2a6)]!==''){if(_0x282056['RegisMeeting']===_0xe30841(0x327))_0x2d5b9c++;else _0x479117++;}}),state['dividendUsers']=_0x269679,state[_0x13952c(0x308)][_0x13952c(0x1f5)]=_0xb97b5b[_0x13952c(0x27e)],state[_0x13952c(0x308)][_0x13952c(0x2e9)]=_0x45c56d,state[_0x13952c(0x308)][_0x13952c(0x2e6)]=_0x479117,state[_0x13952c(0x308)][_0x13952c(0x22d)]=_0x2d5b9c,updateDashboardUI(state['stats']);if(!document[_0x13952c(0x2ac)](_0x13952c(0x20d))['classList'][_0x13952c(0x217)](_0x13952c(0x211)))renderDividendTable(_0x269679);}),window['app']['switchTab'](_0x581abe(0x2f9));}catch(_0x417a30){console[_0x581abe(0x284)](_0x417a30);}}init(),lucide[_0x2f59fd(0x273)]();function _0x3596(){const _0x180dcc=['sortBy','searchTerm','openDividendResetModal','\x22\x20width=\x2220\x22></i><div\x20class=\x22flex-1\x20text-sm\x20font-bold\x20text-xs\x20text-xs\x20text-xs\x22>','value','border-green-500\x20text-green-700','total','ล้างข้อมูลสำเร็จ','ttb-register.firebasestorage.app','tmb_coop','505130UIWlJc','view-dividend-info','recent-activity-list','validateMemberSearch','from','hidden','name','เข้าร่วม','closeDeleteAllModal','btn-prev','ลงทะเบียน','contains','replace','confirm-div-reset-input','ref','</p><p\x20class=\x22text-xs\x20text-slate-400\x20font-mono\x20text-sm\x22>NO:\x20','totalQty','openDeleteAllDividendModal','ยืนยันว่าพนักงานได้รับรางวัลแล้ว?','opacity-50','label-stock-count','ล้างข้อมูลสมาชิกปันผลสำเร็จ','Active','QR\x20Code\x20ลงทะเบียน','checkout','screen-display-area','dividend-import-bar','dividend-file-name','length','border-red-500\x20text-red-700','Check-IN','<div\x20class=\x22text-[10px]\x20text-slate-500\x20font-normal\x20mt-0.5\x20text-xs\x20text-xs\x20text-xs\x22>-</div>','appendChild','divNoJoin','totalPrizesQuota','currentPage','รับบัตรเลือกตั้ง','dash-stat-checkin','notYetDrawn','notRewarded','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>รหัสสมาชิก:</b>\x20<span\x20class=\x22font-mono\x20text-sm\x20text-sm\x20text-sm\x22>','</span>\x20<span\x20class=\x22text-[10px]\x20text-slate-400\x20font-mono\x20text-sm\x22>','login','พิมพ์\x20Delete\x20เพื่อยืนยัน','รวมปันผล','resultsSortBy','classList','citizenId','member-search-input','add','text-slate-400','datasets','closeMemberSearchModal','confirm-div-delete-input','renderResults','page-indicator','res-stat-total-prizes','11JLTMIB','regChartInst','status-indicator','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-500\x20transition\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i></button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','totalPrizesDrawn','สุ่มพนักงานผู้โชคดีสำเร็จ','success','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20MODIFIED:\x20Count\x20Column\x20only\x20shows\x20TimeLogin\x20now\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20font-bold\x20text-slate-700\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toggle','confirmRegistrationViaSearch','closeGeneralModal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<b\x20class=\x22text-slate-400\x22>สถานะเช็คอิน:</b>\x20<span\x20class=\x22text-sm\x20text-sm\x20text-sm\x22>','map','1070273157855','fileToImport','899EhJjKY','files','RegisMeeting','reg-stat-rewarded','<i\x20data-lucide=\x22','sortOrder','dividend','closeResetModal','handleSearch','click','clearFileSelection','8jgFcOe','deletePrize','removeChild','split','ข้อมูลลงทะเบียน','style','toString','2289615FwhNFn','opacity-0','label-eligible-count','member-search-modal','prize-qty','users','claimed','registrationChart','divSortBy','ประกาศผลรางวัล',':00','qtyPerDraw','bg-slate-700','createIcons','download','validateRandomizerInput','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-slate-700\x20text-sm\x22>','confirmResetData','createElement','</td><td\x20class=\x22text-right\x20px-4\x20text-sm\x22><button\x20onclick=\x22window.app.deletePrize(\x27','stat-noreward','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-xs\x20text-slate-500\x20font-mono\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','btn-dividend-import','ปันผล','size','</span></div>','trim','DateLogin','พิมพ์\x20Reset\x20เพื่อยืนยัน','searchCandidate','error','eligible','innerHTML','join','ผู้มีสิทธิ์ลุ้นไม่เพียงพอ','clearDividendFileSelection','btn-start-random','confirmResetDividendData','prizes','res-stat-claimed','.csv','search-member-details','qty','resetWinnerStatus','ยังไม่เช็คอิน','digest','member','<span\x20class=\x22text-slate-400\x20text-[10px]\x20italic\x20text-sm\x22>ไม่ได้รับ</span>','dividend-table-body','translate-x-full','data','7842636zmGkDo','random','dash-stat-noreward','<i\x20data-lucide=\x22chevron-down\x22\x20class=\x22inline\x20w-3\x22></i>','changeDivSort','dataset','</div>','divSortOrder','filter','เปลี่ยนสถานะรางวัลเป็น\x20รับแล้ว\x20สำเร็จ','CitizenId','อัปเดตไม่สำเร็จ','confirmDeleteAllDividendData','DateMeeting','screen-overlay-controls','rsort-','</td><td\x20class=\x22text-center\x20font-bold\x20text-blue-600\x20text-sm\x22>','confirmDeleteAllData','reset-confirm-modal','getElementById','</p></div><span\x20class=\x22text-xs\x20font-bold\x20bg-indigo-100\x20text-indigo-700\x20px-3\x20py-1\x20rounded-lg\x20uppercase\x20text-sm\x22>','res-stat-total-drawn','dash-stat-voting','toDate','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','selectedIndex','ล้างข้อมูลสถานะของพนักงานคนนี้ทั้งหมด?\x20(ล้างข้อมูลรางวัลและการลงทะเบียน)','filter-results-status','moneyback','closeDeleteAllDividendModal','downloadDividendCSV','manage-dividend-total','includes','confirm-delete-input','<span\x20class=\x22text-emerald-600\x20font-bold\x22>รับแล้ว</span>','current-time','จัดการของรางวัล','import-bar','reduce','isDrawing','dividend-single-reset-modal','ConfirmVotingCard','toLowerCase','openMemberSearchModal','รีเซ็ตสถานะรายชื่อพนักงานสำเร็จ','getHours','rewardTime','\x20จากทั้งหมด\x20','\x20of\x20','check-circle','Page\x20','createObjectURL','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22window.app.deleteSingleData(\x27','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','EmpName','set','votingCards','resultsSortOrder','div','ไม่ได้รับรางวัล','btn-next','746stWQtS','<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22opacity-30\x22></i>','EmpMember','visibility','prize-form','div-summary-join','view-','dash-stat-div-reg','reg-stat-registered','handleDividendSearch','div-summary-registered','preventDefault','page-title','citizenID','bg-red-500','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','divJoin','ttb-register','<div\x20class=\x22text-black-600\x20text-sm\x20text-slate-800\x20text-sm\x20text-sm\x20text-sm\x22>','divRegistered','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-indigo-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','dividend-delete-confirm-modal','res-stat-unclaimed','processImport','forEach','<i\x20data-lucide=\x22chevron-up\x22\x20class=\x22inline\x20w-3\x22></i>','toast-container','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-xs\x20text-slate-500\x20font-mono\x20text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','reward','44rIiZer','rgba(79,\x2070,\x20229,\x200.1)','rand-stat-total','totalDocs','dividend-import-progress','dividend-file-upload','dashboard','cursor-not-allowed','handleDividendFileSelect','Delete','stat-rewarded','endsWith','CheckIN','stat-checkin','</span>\x20<span\x20class=\x22flex-1\x20text-sm\x22>','<span\x20class=\x22text-green-600\x20font-bold\x22>เช็คอินแล้ว</span>','openResetModal','dash-stat-rewarded','qty-warning','closeSingleDividendResetModal','bg-green-500','stats','พิมพ์\x20Reset','showToast','5293603OVCNVh','app','options','confirm-reset-input','target','bg-white\x20border-l-4\x20','asc','status','table-body','23298140wXwzQQ','ConfirmReward','checkin','remove','เงินสมนาคุณ','SHA-256','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x20text-xs\x22>รับแล้ว</span>','file-name','</span>','dividendFileToImport','coop_gift','closeDividendResetModal','body','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','text','1:1070273157855:web:5c8120e1df27e233d8676a','rowsPerPage','className','reset','ไม่เข้าร่วม','padStart','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-indigo-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','manage-total-docs','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับแล้ว</span>','ล้างข้อมูลรางวัลพนักงานท่านนี้?','file-info','btn-import','\x27)\x22\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x20hover:bg-red-200\x20transition\x20text-xs\x22>ยังไม่รับ</button>','disabled','\x20px-2\x20py-0.5\x20rounded\x20text-sm\x22>','\x27)\x22\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x20hover:bg-red-200\x20transition\x20text-sm\x22>ยังไม่รับ</button>','dividendIdToReset','th-TH','processDividendImport','slice','general-modal','handleFileSelect','querySelectorAll','\x27)\x22\x20class=\x22text-slate-300\x20hover:text-red-500\x20transition\x20text-xs\x20text-xs\x20text-xs\x22\x20title=\x22ล้างข้อมูล\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','\x20พร้อมยืนยันรับบัตร','ceil','rand-stat-drawn-win','#4f46e5','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22font-bold\x20text-blue-600\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','netpayment','commit','เงินเฉลี่ยคืน','ลงทะเบียนพนักงานสำเร็จ','rand-stat-drawn-no','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><button\x20onclick=\x22window.app.resetSingleDividendData(\x27','width','results-table-body','<span\x20class=\x22text-xs\x20font-normal\x20text-white\x20','dash-stat-div-join','ลบรางวัลนี้ออกจากระบบ?','sort','นำเข้าข้อมูลปันผลสำเร็จ','prize-name','manualConfirmReward','stat-checkout','dividend-file-info','reg-stat-total','reg-stat-voting','<button\x20onclick=\x22window.app.manualConfirmReward(\x27','bar-checkout','รีเซ็ตสถานะปันผลแล้ว','G-9DJLWJ5LQ1','input-draw-qty','.view-section','innerText','พิมพ์\x20Delete','tmb_coop_dividend','</td><td\x20class=\x22text-center\x20font-bold\x20text-sm\x22>','dividendUsers','confirmSingleDividendReset','ชื่อ-นามสกุล','resetSingleDividendData','href','\x20รายการ','toLocaleTimeString','divSearchTerm','gratuity','<i\x20data-lucide=\x22chevrons-up-down\x22\x20class=\x22inline\x20w-3\x20opacity-30\x22></i>','ttb-register.firebaseapp.com','ระบบสุ่มรางวัล','toLocaleString','member-search-btn','<tr><td>','div-table-info','empname','status-text','rewarded','CardPoll','push','alert-circle','delete','select-prize','dividendTotal','เกิดข้อผิดพลาดในการล้างข้อมูล','localeCompare','rand-stat-eligible-view','dsort-','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-center\x20font-mono\x20text-slate-500\x20text-sm\x22>','Reset','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22>','onPrizeSelect','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-right\x20text-sm\x20text-sm\x20text-sm\x20text-sm\x22><button\x20onclick=\x22window.app.resetWinnerStatus(\x27','update','6103008cEBZkl','desc'];_0x3596=function(){return _0x180dcc;};return _0x3596();}
    </script>
</body>
</html>
