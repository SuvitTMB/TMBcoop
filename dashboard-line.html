<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Lightbox/Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        /* Toast Animation */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        /* Compact Table Rows */
        .table-compact td {
            padding-top: 4px;
            padding-bottom: 4px;
            height: 24px;
        }

        /* Custom Scroll for Dark Area */
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
        
        /* Winner Card Animation */
        @keyframes cardSlideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .winner-card-enter {
            animation: cardSlideIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-700 text-white transition-all hover:bg-slate-700">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="play-circle" width="20"></i> จับรางวัล (Randomizer)
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckIN
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckOUT
                </button>
            </div>

            <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all border-t border-slate-700 mt-2 pt-4">
                <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
            </button>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Top Bar -->
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวมระบบ</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">
                    A
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD OVERVIEW -->
            <div id="view-dashboard" class="view-section space-y-6 fade-in-up">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="users" width="60" height="60" class="text-blue-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนเข้า</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-green-500 text-xs mt-2 flex items-center gap-1"><i data-lucide="arrow-up" width="12"></i> Update Real-time</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="log-out" width="60" height="60" class="text-orange-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนออก</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <div class="w-full bg-orange-100 rounded-full h-1.5 mt-3">
                            <div id="bar-checkout" class="bg-orange-500 h-1.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- NEW: Not Rewarded Box -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="frown" width="60" height="60" class="text-slate-400"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ผู้ไม่ได้รางวัล</p>
                        <h3 id="stat-noreward" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-slate-400 text-xs mt-2">สุ่มแล้วไม่ได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="gift" width="60" height="60" class="text-purple-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ได้รับรางวัลแล้ว</p>
                        <h3 id="stat-rewarded" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p id="stat-eligible" class="text-slate-400 text-xs mt-2">สุ่มและได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="check-square" width="60" height="60" class="text-green-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ยืนยันรับรางวัลแล้ว</p>
                        <h3 id="stat-claimed" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <!-- Charts & Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <!-- Left Column: Two Charts Stacked -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Chart Check-IN -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียนเข้า (Check-IN)
                                </h3>
                                <span class="text-2xl font-bold text-indigo-600" id="chart-total-checkin">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="registrationChart"></canvas>
                            </div>
                        </div>
                        <!-- Chart Check-OUT -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-orange-500 rounded-full"></div> สถิติการลงทะเบียนออก (Check-OUT)
                                </h3>
                                <span class="text-2xl font-bold text-orange-600" id="chart-total-checkout">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="checkoutChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Recent Activity (Full Height) -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1">
                            <!-- Activity Items injected here -->
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZE MANAGEMENT -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Form -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="plus-circle" width="20" class="text-indigo-600"></i> เพิ่ม/แก้ไข ของรางวัล
                        </h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                                    <input type="number" id="prize-qty" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition">บันทึกข้อมูล</button>
                        </form>
                    </div>

                    <!-- List -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-200 text-slate-700 font-bold">
                                    <tr>
                                        <th class="px-4 py-3 rounded-l-lg">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">รางวัลที่จะสุ่ม</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right rounded-r-lg">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y divide-slate-100">
                                    <tr><td colspan="4" class="text-center py-4 text-slate-400">กำลังโหลด...</td></tr>
                                </tbody>
                                <tfoot class="bg-slate-100 font-bold text-slate-700">
                                    <tr>
                                        <td class="px-4 py-3 text-right" colspan="2">รวมสิทธิ์ทั้งหมด:</td>
                                        <td class="px-4 py-3 text-center text-indigo-600" id="total-prize-quota">0</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER SYSTEM -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <!-- Box 1 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-blue-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 2 (Eligible/Total Status Valid) -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-indigo-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้มีสิทธิ์สุ่มรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 3 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-slate-400">
                        <p class="text-slate-500 text-xs font-medium">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 4 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-red-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วไม่ได้รางวัล</p>
                        <h3 id="rand-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 5 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-green-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วได้รางวัล</p>
                        <h3 id="rand-stat-claimed" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                    <!-- Left: Control Panel -->
                    <div class="lg:col-span-4 space-y-6">
                        <!-- Setup Card -->
                        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-100">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                                <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600"><i data-lucide="settings-2" width="20"></i></div>
                                ตั้งค่าการสุ่ม
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">เลือกของรางวัล</label>
                                    <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none bg-white">
                                        <option value="">-- กรุณาเลือก --</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนผู้โชคดี (คน)</label>
                                    <div class="flex items-center gap-4">
                                        <input type="number" id="input-draw-qty" value="1" min="1" max="50" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-center text-lg">
                                        <span class="text-slate-400 text-sm whitespace-nowrap">คน / รอบ</span>
                                    </div>
                                    <p class="text-xs text-orange-500 mt-1 hidden" id="qty-warning">จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ!</p>
                                </div>
                                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">คงเหลือในสต็อก</span>
                                        <span id="label-stock-count" class="font-bold text-orange-600 text-lg">0</span>
                                    </div>
                                     <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span>
                                        <span id="label-eligible-count" class="font-bold text-indigo-600 text-lg">0</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-1.5">
                                        <div class="bg-indigo-500 h-1.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-2">*เฉพาะผู้ที่สถานะไม่ว่างและยังไม่เคยได้รางวัล</p>
                                </div>
                                <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all transform active:scale-95 flex items-center justify-center gap-2 text-lg opacity-50 cursor-not-allowed">
                                    <i data-lucide="play" width="24" class="fill-current"></i> เริ่มสุ่มรางวัล
                                </button>
                            </div>
                        </div>
                        
                        <!-- History Log Box REMOVED as requested -->
                        
                    </div>
                    <!-- Right: Big Screen Display Area -->
                    <div class="lg:col-span-8">
                        <div class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 rounded-3xl h-[650px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700/50">
                             <!-- Header inside screen -->
                            <div class="relative z-10 flex justify-between items-start mb-8 border-b border-white/10 pb-4">
                                <div>
                                    <h1 id="screen-prize-title" class="text-xg font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200 drop-shadow-md">
                                        ระบบสุ่มรางวัล
                                    </h1>
                                </div>
                                <!-- Status removed as requested -->
                            </div>
                            <!-- Display Grid -->
                            <div id="screen-display-area" class="relative z-10 flex-1 grid grid-cols-1 content-start gap-4 overflow-y-auto custom-scroll-dark px-2 pb-4">
                                <div class="text-center text-slate-500/50 flex flex-col items-center justify-center h-full">
                                    <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm">
                                        <i data-lucide="gift" width="40" height="40" class="text-white/20"></i>
                                    </div>
                                    <p class="text-white/40 font-light text-xm">พร้อมสำหรับการจับรางวัล</p>
                                </div>
                            </div>
                            <!-- Controls overlay -->
                            <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/80 backdrop-blur-sm z-20 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                    <h2 class="text-xl font-bold tracking-tight">กำลังประมวลผล...</h2>
                                    <p class="text-blue-300 mt-2">กรุณารอสักครู่</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: LIVE RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- 1. Total DB -->
                    <div class="bg-gradient-to-br from-gray-600 to-gray-700 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-gray-200 text-xs">สมาชิกทั้งหมดในระบบ</p>
                        <h3 id="monitor-total-db" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 2. Registered (Status valid) -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-blue-100 text-xs">สมาชิกที่ลงทะเบียน (Active)</p>
                        <h3 id="monitor-registered" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 3. Draws -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-purple-100 text-xs">จำนวนรางวัลที่แจกแล้ว</p>
                        <h3 id="monitor-draws" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 4. Rewarded -->
                    <div class="bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-green-100 text-xs">สมาชิกที่ได้รางวัลแล้ว</p>
                        <h3 id="monitor-rewarded" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 5. No Reward -->
                    <div class="bg-gradient-to-br from-slate-500 to-slate-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-slate-200 text-xs">สมาชิกที่ไม่ได้รางวัล</p>
                        <h3 id="monitor-noreward" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                </div>
                <!-- Table -->
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 bg-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-slate-800">รายการผู้โชคดี (Real-time)</h3>
                        <select id="filter-results-status" onchange="window.app.renderResults()" class="bg-white border border-slate-300 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                            <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                            <option value="unclaimed">ผู้ที่ยังไม่รับรางวัล</option>
                            <option value="claimed">ผู้ที่รับรางวัลแล้ว</option>
                            <option value="no_reward">ผู้ที่ไม่ได้รับรางวัล</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-6 py-4">ลำดับ</th>
                                    <th class="px-6 py-4">ชื่อ-นามสกุล</th>
                                    <th class="px-6 py-4">รางวัลที่ได้</th>
                                    <th class="px-6 py-4">เวลาที่สุ่มได้</th>
                                    <th class="px-6 py-4">สถานะการรับรางวัล</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-end">
                             <select id="sort-by" onchange="window.app.changeSort(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="CheckIN">เรียงตาม Check-In</option>
                                <option value="CheckOUT">เรียงตาม Check-Out</option>
                                <option value="reward">เรียงตามของรางวัล</option>
                                <option value="EmpName">เรียงตามชื่อ-นามสกุล</option>
                             </select>
                             <select id="sort-order" onchange="window.app.changeSortOrder(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="desc">มาก -> น้อย (ล่าสุด/Z-A)</option>
                                <option value="asc">น้อย -> มาก (เก่าสุด/A-Z)</option>
                             </select>
                             <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="20">20 แถว</option>
                                <option value="50" selected>50 แถว</option>
                                <option value="100">100 แถว</option>
                                <option value="500">500 แถว</option>
                                <option value="99999">ทั้งหมด</option>
                             </select>
                             <input type="text" id="search-data" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100 text-sm">
                                <tr>
                                    <th class="px-6 py-2">#</th>
                                    <th class="px-6 py-2">ชื่อ-นามสกุล (EmpName)</th>
                                    <th class="px-6 py-2">Check-In</th>
                                    <th class="px-6 py-2">Check-Out</th>
                                    <th class="px-6 py-2">ของรางวัล</th>
                                    <th class="px-6 py-2">สถานะรับรางวัล</th>
                                    <th class="px-6 py-2 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100 text-sm"></tbody>
                        </table>
                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex justify-between items-center">
                            <p class="text-xs text-slate-400" id="data-table-info">แสดงผล...</p>
                            <div class="flex gap-2" id="pagination-controls">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-prev">Previous</button>
                                <span class="text-xs self-center font-bold text-slate-600" id="page-indicator">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: IMPORT / MANAGE DATA -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Import Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูล (JSON/CSV)
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">
                            รองรับไฟล์ JSON ที่มีฟิวด์ <code>citizenId</code> ระบบจะทำการแปลง Citizen ID เป็นรหัส Hash (SHA-256) โดยอัตโนมัติก่อนบันทึก
                        </p>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:bg-slate-50 transition cursor-pointer" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                                <p class="text-sm font-medium text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากไฟล์มาวางที่นี่</p>
                                <p class="text-xs text-slate-400 mt-1">รองรับ .json, .csv</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700">
                                <span id="file-name">filename.json</span>
                                <button onclick="window.app.clearFileSelection()" class="text-blue-500 hover:text-blue-700"><i data-lucide="x" width="16"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                เริ่มนำเข้าข้อมูล
                            </button>
                            <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5">
                                <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Database Management Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="database" width="20" class="text-slate-600"></i> ข้อมูลระบบ
                        </h3>
                        
                        <div class="bg-slate-50 p-4 rounded-xl mb-6 flex justify-between items-center">
                            <div>
                                <p class="text-sm text-slate-500">จำนวนข้อมูลทั้งหมด (Records)</p>
                                <h2 class="text-2xl font-bold text-slate-800 mt-1" id="manage-total-docs">0</h2>
                            </div>
                            <div class="bg-white p-3 rounded-full shadow-sm text-slate-400">
                                <i data-lucide="hard-drive" width="24"></i>
                            </div>
                        </div>

                        <div class="border-t border-slate-100 pt-6 space-y-4">
                            <h4 class="font-bold text-red-600 mb-2 flex items-center gap-2"><i data-lucide="alert-octagon" width="18"></i> Danger Zone</h4>
                            
                            <!-- Reset Registration Status -->
                             <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                <p class="text-sm font-bold text-orange-800 mb-1">รีเซ็ตการลงทะเบียน (Reset Status)</p>
                                <p class="text-xs text-orange-600 mb-3">ล้างสถานะ Check-In, Check-Out และการรับรางวัลทั้งหมด แต่เก็บข้อมูลรายชื่อพนักงานไว้</p>
                                <button onclick="window.app.openResetModal()" class="w-full border border-orange-300 text-orange-700 hover:bg-orange-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="rotate-ccw" width="16"></i> รีเซ็ตสถานะ (Clear Transaction)
                                </button>
                            </div>

                            <!-- Delete All Data -->
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                                <p class="text-sm font-bold text-red-800 mb-1">ลบข้อมูลทั้งหมด (Delete All)</p>
                                <p class="text-xs text-red-600 mb-3">ลบข้อมูลพนักงานและการลงทะเบียนทั้งหมดออกจากระบบ ไม่สามารถกู้คืนได้</p>
                                <button onclick="window.app.deleteAllData()" class="w-full border border-red-300 text-red-700 hover:bg-red-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="trash-2" width="16"></i> ลบข้อมูลทั้งหมด (Clear DB)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- VIEW 7: QR Code CheckIN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2">ลงทะเบียนเข้าประชุม (Check-IN)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนเข้าร่วมงาน</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-login.png" alt="Check-IN QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmb-coop-line.html</p>
                    <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

            <!-- VIEW 8: QR Code CheckOUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-orange-600 mb-2">ลงทะเบียนออก (Check-OUT)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนออกและลุ้นรางวัล</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-out.png" alt="Check-OUT QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmbcoop-outrandom-line.html</p>
                     <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

        </div>
    </main>

    <!-- Modal: Edit Prize -->
    <div id="edit-prize-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4 border-b border-slate-100 pb-2">
                <h3 class="text-lg font-bold text-slate-800">แก้ไขของรางวัล</h3>
                <button onclick="window.app.closeEditPrizeModal()" class="text-slate-400 hover:text-slate-600">
                    <i data-lucide="x" width="24"></i>
                </button>
            </div>
            <form id="edit-prize-form" onsubmit="window.app.handlePrizeUpdate(event)" class="space-y-4">
                <input type="hidden" id="edit-prize-id">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                    <input type="text" id="edit-prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                        <input type="number" id="edit-prize-qty" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                        <input type="number" id="edit-prize-total" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                </div>
                
                <div class="flex gap-3 pt-2">
                    <button type="button" onclick="window.app.closeEditPrizeModal()" class="flex-1 py-3 rounded-xl text-slate-600 bg-slate-100 hover:bg-slate-200 font-bold transition">ยกเลิก</button>
                    <button type="submit" class="flex-1 py-3 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 font-bold transition">บันทึก</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- General Modal -->
    <div id="general-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500">
                <i data-lucide="alert-circle" width="24"></i>
            </div>
            <h3 id="general-modal-title" class="text-lg font-bold text-slate-800 mb-2">แจ้งเตือน</h3>
            <p id="general-modal-message" class="text-slate-500 text-sm mb-6">ข้อความแจ้งเตือน</p>
            <button onclick="window.app.closeGeneralModal()" class="w-full py-2.5 rounded-xl bg-slate-800 text-white font-bold hover:bg-slate-900 transition">ตกลง</button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600">
                <i data-lucide="alert-triangle" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ยืนยันการรีเซ็ต?</h3>
            <p class="text-slate-500 text-sm mb-6">
                ระบบจะล้างข้อมูลการลงทะเบียน (Check-In/Out) และประวัติการรับรางวัลทั้งหมด <br>
                <span class="font-bold text-orange-600">แต่จะเก็บรายชื่อพนักงานไว้</span>
            </p>
            <div class="flex gap-3">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition">ยืนยันรีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
const _0x4c92d7=_0x2180;(function(_0x3b9726,_0x3f1ae9){const _0x31c21a=_0x2180,_0x2d8248=_0x3b9726();while(!![]){try{const _0xa9c384=-parseInt(_0x31c21a(0x211))/0x1*(parseInt(_0x31c21a(0x184))/0x2)+-parseInt(_0x31c21a(0x214))/0x3+-parseInt(_0x31c21a(0x137))/0x4*(parseInt(_0x31c21a(0x20d))/0x5)+-parseInt(_0x31c21a(0x1fe))/0x6+-parseInt(_0x31c21a(0x1d6))/0x7*(parseInt(_0x31c21a(0x1f3))/0x8)+parseInt(_0x31c21a(0x1ed))/0x9+-parseInt(_0x31c21a(0x238))/0xa*(-parseInt(_0x31c21a(0x1d1))/0xb);if(_0xa9c384===_0x3f1ae9)break;else _0x2d8248['push'](_0x2d8248['shift']());}catch(_0x4ca3f9){_0x2d8248['push'](_0x2d8248['shift']());}}}(_0x12ff,0x4ab01));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';function _0x12ff(){const _0x5c9fa7=['encode','delete','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22z-10\x20pl-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22px-3\x20py-1\x20bg-gradient-to-r\x20from-blue-600\x20to-indigo-600\x20text-white\x20rounded-lg\x20text-sm\x20font-bold\x20shadow-sm\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22gift\x22\x20width=\x2214\x22></i>\x20','<div\x20class=\x22text-green-500\x22><i\x20data-lucide=\x22check-circle\x22\x20width=\x2220\x22></i></div>','showModal','sort','padStart','toLocaleString','renderResults','className','prize-qty','citizenId','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับรางวัลแล้ว</span>','Snapshot\x20error:','Delete\x20Prize\x20Error','checkin','<div\x20class=\x22flex\x20items-start\x20gap-3\x20text-sm\x20p-2\x20rounded-lg\x20bg-slate-50\x20hover:bg-slate-100\x20transition\x22><div\x20class=\x22','</td><td\x20class=\x22px-4\x20py-3\x20text-right\x22><button\x20onclick=\x22window.app.openEditPrizeModal(\x27','toast-container','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','<span\x20class=\x22px-2\x20py-1\x20bg-yellow-100\x20text-yellow-700\x20rounded-full\x20text-xs\x22>ยังไม่รับรางวัล</span>','text-white','prize-total','10UWUTzN','drawnWon','\x22\x20width=\x2216\x22></i></div><div\x20class=\x22text-slate-600\x22><p\x20class=\x22font-medium\x22>','reset-confirm-modal','fileToImport','endsWith','total-prize-quota','hasAttribute','Unknown','...</span>','qrcode-out','<option\x20value=\x22\x22>--\x20กรุณาเลือก\x20--</option>','บันทึกข้อมูลเรียบร้อย','getAttribute','Reset\x20Error','<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x20table-compact\x20text-sm\x22><td\x20class=\x22px-6\x20text-slate-500\x22>','length','chartInInstance','drawnNoReward','totalQty','ลงทะเบียนออก','substring','contains','asc','update','changeSort','startRandomizer','กำลังลบข้อมูล...','text','no_reward','div','set','screen-overlay-controls','name','info','data','\x20รายการ','filter-results-status','page-indicator','ลงทะเบียนเข้า','registered','qrcode-in','</div><button\x20onclick=\x22this.parentElement.remove()\x22\x20class=\x22text-slate-400\x20hover:text-slate-600\x22><i\x20data-lucide=\x22x\x22\x20width=\x2216\x22></i></button>','Check-IN','onPrizeSelect','file-name','cursor-not-allowed','trim','#FFA500','getContext','rewardTime','QR\x20Code\x20ลงทะเบียนออก','closeEditPrizeModal','text-green-400','rgba(249,\x20115,\x2022,\x200.1)','รีเซ็ตข้อมูลสำเร็จ\x20','Update\x20Error','monitor-total-db','เวลาเข้า','stat-noreward','<tr><td\x20colspan=\x224\x22\x20class=\x22text-center\x20py-4\x20text-slate-400\x22>ยังไม่มีข้อมูลของรางวัล</td></tr>','เกิดข้อผิดพลาดในการรีเซ็ต','filter','prize-list-body','push','rand-stat-rewarded','import','createIcons','split','querySelectorAll','toLocaleTimeString','reset','monitor-draws','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x22>',':00','rand-stat-eligible-view','from','#view-import\x20button[onclick*=\x22deleteAll\x22]','ttb-register','bar-checkout','text-orange-500','closeResetModal','Check-OUT','เกิดข้อผิดพลาดในการอัปเดต','4jCYrKn',')</span></p><p\x20class=\x22text-[10px]\x20text-slate-400\x22>','ชื่อ','users','classList','อัปเดตข้อมูลเรียบร้อย','innerHTML','page-title','results','จัดการข้อมูล\x20(Import)','แจ้งเตือน','<div\x20class=\x22text-red-500\x22><i\x20data-lucide=\x22alert-circle\x22\x20width=\x2220\x22></i></div>','btn-next','edit-prize-qty','confirmResetData','general-modal','rand-stat-claimed','prizes','ID:\x20','text-blue-500','</p></div></div>','เวลาออก','User\x20...','file-upload','Add\x20Prize\x20Error','UNKNOWN','data-qty','deletePrize','results-table-body','view-randomizer','random','btn-prev','line','sortOrder','<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x20font-bold\x22>ไม่ได้รางวัล</span>','view-','กรุณาระบุชื่อของรางวัล','<div\x20class=\x22text-center\x20text-slate-400\x20text-sm\x20py-8\x22>ยังไม่มีกิจกรรม</div>','table-body','scrollHeight','มีผู้มีสิทธิ์เพียง\x20','winner-card-enter\x20bg-white/95\x20backdrop-blur-sm\x20h-[65px]\x20px-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-500\x20flex\x20items-center\x20justify-between\x20relative\x20overflow-hidden\x20mb-2\x20transform\x20transition-all\x20hover:scale-[1.01]','</span>','artifacts/','<span\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x22>ยังไม่รับรางวัล</span>','randomizer','width','subtle','<span\x20class=\x22text-slate-300\x22>-</span>','CheckIN','hidden','map','ประกาศผลรางวัล','toString','validateRandomizerInput','reduce','stats','ref','G-9DJLWJ5LQ1','จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ\x20(','log-out','file-info','date','กำลังประมวลผล...','eligible','getTime','Online','lucide','scrollTop','app','getElementById','\x20<span\x20class=\x22text-slate-400\x20font-normal\x22>(','เกิดข้อผิดพลาด:\x20','<span\x20class=\x22text-slate-400\x20italic\x22>ไม่ได้รับรางวัล</span>','toDate','general-modal-title','qty-warning','1008772bfngGR','error','status-indicator','/public/data/coop_registrations','querySelector','changeRowsLimit','<tr><td\x20colspan=\x225\x22\x20class=\x22px-6\x20py-8\x20text-center\x20text-slate-400\x22>ไม่พบข้อมูลตามเงื่อนไขที่เลือก</td></tr>','ttb-register.firebasestorage.app','createElement','ลบข้อมูลสำเร็จ','checkout','claimed','ข้อมูลลงทะเบียน','</td><td\x20class=\x22px-6\x22>','manage-total-docs','status','changeSortOrder','DELETE','edit-prize-total','rowsPerPage','rand-stat-noreward','sortBy','chartOutInstance','size','style','edit-prize-id','data-total','#4B0082','rgba(79,\x2070,\x20229,\x200.1)','Update\x20Prize\x20Error','notYetDrawn','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','tmb_coop','parse','value','rewarded','bg-white\x20border-l-4\x20border-blue-500\x20text-slate-700','\x20รางวัล)','checkoutChart','target','commit','recent-activity-list','join','toLowerCase','rewardClaimTime','undefined','text-slate-400','isDrawing','CheckOUT','handlePrizeUpdate','ต้องการลบรายการนี้ใช่หรือไม่?','opacity-50','\x22\x20data-total=\x22','innerText','ttb-register.firebaseapp.com','bg-red-500','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','prize-name','select-prize','EmpName','\x20(น้อยไปมาก)','\x20p-4\x20rounded-lg\x20shadow-lg\x20flex\x20items-start\x20gap-3\x20toast-enter\x20pointer-events-auto\x20transform\x20transition-all\x20duration-300','\x20/\x20','reward','handleFileSelect','monitor-registered','monitor-noreward','<option\x20value=\x22','label-eligible-count','prize-form','ไม่ได้รับรางวัล','forEach','th-TH','<div\x20class=\x22text-blue-500\x22><i\x20data-lucide=\x22info\x22\x20width=\x2220\x22></i></div>','import-progress','/public/data/','result','8862722usdsUP','disabled','bg-white\x20border-l-4\x20border-green-500\x20text-slate-700','changePage','<span\x20class=\x22font-bold\x20text-indigo-600\x22>','14UqDQEG','registrationChart','remove','screen-display-area','coop_gift','selectedIndex','stat-rewarded','qtyPerDraw','screen-prize-title',')\x22\x20class=\x22text-blue-500\x20hover:text-blue-700\x20mr-2\x22><i\x20data-lucide=\x22edit-3\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button><button\x20onclick=\x22window.app.deletePrize(\x27','btn-import','Format\x20Invalid:\x20Root\x20must\x20be\x20an\x20array','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-medium\x20text-slate-700\x22>','\x20รายการ\x20(เรียงตาม\x20','import-bar','.nav-item','Delete\x20Error','ของรางวัล','label-stock-count','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','add','#FFD700','showToast','3923910uhtfxe','data-table-info','ไม่มีข้อมูลให้ลบ','totalDocs','out','<span\x20class=\x22text-slate-400\x20text-xs\x20italic\x22>ID:\x20','495760YLVKAi','type','btn-start-random','.csv','readAsText','...','string','options','ลบของรางวัลสำเร็จ','success','ต้องการลบของรางวัลนี้ใช่หรือไม่?','368214coDMoI','\x27,\x20','</td><td\x20class=\x22px-6\x20font-medium\x20text-indigo-600\x20text-xs\x22>','preventDefault','\x20mt-0.5\x22><i\x20data-lucide=\x22','ลบไม่สำเร็จ','#4f46e5','notRewarded','slice','bg-slate-700','\x20รายการ)','การสุ่มเสร็จสิ้น!','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button></td></tr>','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x22>รับแล้ว</span>','clearFileSelection','119305IVNrnh','monitor-rewarded','message','appendChild','1wqIpRF','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-400\x22>','SHA-256','666645eYcbeR','input-draw-qty','เกิดข้อผิดพลาดในการลบ','#view-import\x20button[onclick*=\x22openResetModal\x22]','stat-checkin','function','จากผู้มีสิทธิ์ลุ้น\x20','พิมพ์\x20\x27DELETE\x27\x20เพื่อยืนยันการลบข้อมูลทั้งหมด','edit-prize-name','\x20(มากไปน้อย)','\x20of\x20','clearHistoryLog','currentPage'];_0x12ff=function(){return _0x5c9fa7;};return _0x12ff();}const TARGET_COLLECTION_NAME=_0x4c92d7(0x1a4),PRIZES_COLLECTION_NAME=_0x4c92d7(0x1da),isSandboxEnv=typeof __firebase_config!==_0x4c92d7(0x1b1);let firebaseConfig,finalCollectionPath,prizesCollectionPath;if(isSandboxEnv){firebaseConfig=JSON[_0x4c92d7(0x1a5)](__firebase_config);const appId=typeof __app_id!==_0x4c92d7(0x1b1)?__app_id:'default-app-id';finalCollectionPath=_0x4c92d7(0x162)+appId+_0x4c92d7(0x187),prizesCollectionPath='artifacts/'+appId+_0x4c92d7(0x1cf)+PRIZES_COLLECTION_NAME;}else firebaseConfig={'apiKey':_0x4c92d7(0x1a3),'authDomain':_0x4c92d7(0x1ba),'databaseURL':_0x4c92d7(0x1e9),'projectId':_0x4c92d7(0x131),'storageBucket':_0x4c92d7(0x18b),'messagingSenderId':'1070273157855','appId':'1:1070273157855:web:5c8120e1df27e233d8676a','measurementId':_0x4c92d7(0x171)},finalCollectionPath=TARGET_COLLECTION_NAME,prizesCollectionPath=PRIZES_COLLECTION_NAME;const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notRewarded':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0},'isDrawing':![],'fileToImport':null,'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x4c92d7(0x168),'sortOrder':'desc'};async function sha256(_0x477b9e){const _0x2bc28c=_0x4c92d7,_0x2e1713=new TextEncoder()[_0x2bc28c(0x221)](_0x477b9e),_0x25a9c4=await crypto[_0x2bc28c(0x166)]['digest'](_0x2bc28c(0x213),_0x2e1713),_0x229f20=Array[_0x2bc28c(0x12f)](new Uint8Array(_0x25a9c4));return _0x229f20['map'](_0x235117=>_0x235117['toString'](0x10)[_0x2bc28c(0x227)](0x2,'0'))['join']('');}window[_0x4c92d7(0x17c)]=window[_0x4c92d7(0x17c)]||{},window['app'][_0x4c92d7(0x1ec)]=(_0x1caf8f,_0x3c250b=_0x4c92d7(0x1fc))=>{const _0x566d69=_0x4c92d7,_0x41316c=document['getElementById'](_0x566d69(0x233)),_0x1ac1ee=document[_0x566d69(0x18c)](_0x566d69(0x101));let _0x3a1c9a,_0x286bff;if(_0x3c250b===_0x566d69(0x1fc))_0x3a1c9a=_0x566d69(0x1d3),_0x286bff=_0x566d69(0x224);else _0x3c250b==='error'?(_0x3a1c9a='bg-white\x20border-l-4\x20border-red-500\x20text-slate-700',_0x286bff=_0x566d69(0x142)):(_0x3a1c9a=_0x566d69(0x1a8),_0x286bff=_0x566d69(0x1cd));_0x1ac1ee['className']=_0x3a1c9a+_0x566d69(0x1c1),_0x1ac1ee[_0x566d69(0x13d)]=_0x286bff+'<div\x20class=\x22flex-1\x20text-sm\x20font-medium\x22>'+_0x1caf8f+_0x566d69(0x10d),_0x41316c['appendChild'](_0x1ac1ee);if(window[_0x566d69(0x17a)])lucide['createIcons']();setTimeout(()=>{const _0x2032ad=_0x566d69;_0x1ac1ee[_0x2032ad(0x13b)]['add']('opacity-0','translate-x-full'),setTimeout(()=>_0x1ac1ee[_0x2032ad(0x1d8)](),0x12c);},0xbb8);},window[_0x4c92d7(0x17c)]['showModal']=(_0x37455d,_0x204bc5)=>{const _0x1adbab=_0x4c92d7;document[_0x1adbab(0x17d)](_0x1adbab(0x182))[_0x1adbab(0x1b9)]=_0x37455d,document[_0x1adbab(0x17d)]('general-modal-message')['innerText']=_0x204bc5,document[_0x1adbab(0x17d)](_0x1adbab(0x146))[_0x1adbab(0x13b)]['remove'](_0x1adbab(0x169));},window['app']['closeGeneralModal']=()=>document[_0x4c92d7(0x17d)](_0x4c92d7(0x146))[_0x4c92d7(0x13b)][_0x4c92d7(0x1ea)](_0x4c92d7(0x169)),window[_0x4c92d7(0x17c)]['openResetModal']=()=>document['getElementById'](_0x4c92d7(0x23b))['classList'][_0x4c92d7(0x1d8)](_0x4c92d7(0x169)),window[_0x4c92d7(0x17c)][_0x4c92d7(0x134)]=()=>document['getElementById'](_0x4c92d7(0x23b))[_0x4c92d7(0x13b)][_0x4c92d7(0x1ea)](_0x4c92d7(0x169)),window[_0x4c92d7(0x17c)]['switchTab']=_0x4a88df=>{const _0x185612=_0x4c92d7;document[_0x185612(0x128)]('.view-section')['forEach'](_0x7c6b86=>_0x7c6b86[_0x185612(0x13b)][_0x185612(0x1ea)](_0x185612(0x169))),document[_0x185612(0x17d)](_0x185612(0x15a)+_0x4a88df)['classList'][_0x185612(0x1d8)]('hidden'),document[_0x185612(0x128)](_0x185612(0x1e5))[_0x185612(0x1cb)](_0x15ad00=>{const _0xf56fb2=_0x185612;_0x15ad00[_0xf56fb2(0x13b)]['remove'](_0xf56fb2(0x207),_0xf56fb2(0x236)),_0x15ad00[_0xf56fb2(0x13b)]['add'](_0xf56fb2(0x1b2));});const _0x50aa7c=document['getElementById']('nav-'+_0x4a88df);_0x50aa7c[_0x185612(0x13b)]['remove'](_0x185612(0x1b2)),_0x50aa7c[_0x185612(0x13b)][_0x185612(0x1ea)](_0x185612(0x207),_0x185612(0x236));let _0x5c22fe='ภาพรวมระบบ';if(_0x4a88df===_0x185612(0x164))_0x5c22fe='ระบบสุ่มรางวัล';if(_0x4a88df===_0x185612(0x148))_0x5c22fe='จัดการของรางวัล';if(_0x4a88df===_0x185612(0x13f))_0x5c22fe=_0x185612(0x16b);if(_0x4a88df===_0x185612(0x106))_0x5c22fe=_0x185612(0x190);if(_0x4a88df===_0x185612(0x125))_0x5c22fe=_0x185612(0x140);if(_0x4a88df===_0x185612(0x10c))_0x5c22fe='QR\x20Code\x20ลงทะเบียนเข้า';if(_0x4a88df===_0x185612(0x242))_0x5c22fe=_0x185612(0x116);document['getElementById'](_0x185612(0x13e))['innerText']=_0x5c22fe,_0x4a88df===_0x185612(0x164)&&window['app'][_0x185612(0x10f)]();},window[_0x4c92d7(0x17c)][_0x4c92d7(0x189)]=_0xa6ad00=>{const _0xba1eae=_0x4c92d7;state[_0xba1eae(0x197)]=parseInt(_0xa6ad00),state[_0xba1eae(0x220)]=0x1,renderTable(state[_0xba1eae(0x13a)]);},window[_0x4c92d7(0x17c)][_0x4c92d7(0x1d4)]=_0x190ebb=>{const _0x316c70=_0x4c92d7;state[_0x316c70(0x220)]+=_0x190ebb,renderTable(state[_0x316c70(0x13a)]);},window[_0x4c92d7(0x17c)][_0x4c92d7(0xfc)]=_0x2fec1a=>{const _0x4658f4=_0x4c92d7;state['sortBy']=_0x2fec1a,state[_0x4658f4(0x220)]=0x1,renderTable(state['users']);},window[_0x4c92d7(0x17c)][_0x4c92d7(0x194)]=_0x353b9e=>{const _0x13bc7b=_0x4c92d7;state['sortOrder']=_0x353b9e,state[_0x13bc7b(0x220)]=0x1,renderTable(state['users']);},window[_0x4c92d7(0x17c)][_0x4c92d7(0x1c4)]=_0x39f5fa=>{const _0x2bbbf7=_0x4c92d7,_0x52d674=_0x39f5fa[_0x2bbbf7(0x1ab)]['files'][0x0];_0x52d674&&(state[_0x2bbbf7(0x23c)]=_0x52d674,document[_0x2bbbf7(0x17d)](_0x2bbbf7(0x110))[_0x2bbbf7(0x1b9)]=_0x52d674[_0x2bbbf7(0x104)],document['getElementById'](_0x2bbbf7(0x174))[_0x2bbbf7(0x13b)][_0x2bbbf7(0x1d8)](_0x2bbbf7(0x169)),document['getElementById'](_0x2bbbf7(0x1e0))['disabled']=![]);},window['app'][_0x4c92d7(0x20c)]=()=>{const _0x29be23=_0x4c92d7;state[_0x29be23(0x23c)]=null,document[_0x29be23(0x17d)](_0x29be23(0x14e))['value']='',document['getElementById'](_0x29be23(0x174))[_0x29be23(0x13b)][_0x29be23(0x1ea)](_0x29be23(0x169)),document[_0x29be23(0x17d)](_0x29be23(0x1e0))[_0x29be23(0x1d2)]=!![];},window[_0x4c92d7(0x17c)]['processImport']=()=>{const _0x1ce6ed=_0x4c92d7;if(!state['fileToImport'])return;const _0x678346=state[_0x1ce6ed(0x23c)],_0x18d594=new FileReader();document[_0x1ce6ed(0x17d)](_0x1ce6ed(0x1e0))['disabled']=!![],document[_0x1ce6ed(0x17d)](_0x1ce6ed(0x1e0))[_0x1ce6ed(0x1b9)]=_0x1ce6ed(0x176),document['getElementById']('import-progress')[_0x1ce6ed(0x13b)][_0x1ce6ed(0x1d8)](_0x1ce6ed(0x169)),_0x18d594['onload']=async _0x434c55=>{const _0x35fefb=_0x1ce6ed;try{let _0x294f7b=[];const _0x502a2e=_0x434c55[_0x35fefb(0x1ab)][_0x35fefb(0x1d0)];_0x678346[_0x35fefb(0x104)][_0x35fefb(0x23d)](_0x35fefb(0x1f6))?_0x294f7b=csvToJson(_0x502a2e):_0x294f7b=JSON[_0x35fefb(0x1a5)](_0x502a2e);if(!Array['isArray'](_0x294f7b))throw new Error(_0x35fefb(0x1e1));const _0x5b687f=_0x294f7b['length'];let _0x2f9305=0x0;const _0x1ea005=0x190;for(let _0x1fbb78=0x0;_0x1fbb78<_0x5b687f;_0x1fbb78+=_0x1ea005){const _0x2ae8e6=_0x294f7b[_0x35fefb(0x206)](_0x1fbb78,_0x1fbb78+_0x1ea005),_0x43f610=writeBatch(db);for(const _0x1edfac of _0x2ae8e6){if(_0x1edfac['citizenId']){const _0x31fa23=_0x1edfac[_0x35fefb(0x22c)][_0x35fefb(0x16c)]()['replace'](/-/g,'')['trim'](),_0xb6592=await sha256(_0x31fa23),_0x315977=doc(collection(db,finalCollectionPath));_0x43f610[_0x35fefb(0x102)](_0x315977,{..._0x1edfac,'citizenId':_0xb6592,'importedAt':serverTimestamp()});}}await _0x43f610[_0x35fefb(0x1ac)](),_0x2f9305+=_0x2ae8e6[_0x35fefb(0x248)];const _0x5a8153=_0x2f9305/_0x5b687f*0x64;document['getElementById'](_0x35fefb(0x1e4))['style'][_0x35fefb(0x165)]=_0x5a8153+'%';}window['app']['showToast']('นำเข้าข้อมูลสำเร็จ\x20'+_0x5b687f+_0x35fefb(0x107),_0x35fefb(0x1fc)),window[_0x35fefb(0x17c)][_0x35fefb(0x20c)]();}catch(_0x3d255c){console['error'](_0x3d255c),window[_0x35fefb(0x17c)]['showToast'](_0x35fefb(0x17f)+_0x3d255c[_0x35fefb(0x20f)],_0x35fefb(0x185));}finally{document['getElementById']('btn-import')['disabled']=![],document[_0x35fefb(0x17d)](_0x35fefb(0x1e0))[_0x35fefb(0x1b9)]='เริ่มนำเข้าข้อมูล',document[_0x35fefb(0x17d)](_0x35fefb(0x1ce))['classList'][_0x35fefb(0x1ea)](_0x35fefb(0x169));}},_0x18d594[_0x1ce6ed(0x1f7)](_0x678346);},window[_0x4c92d7(0x17c)]['deleteAllData']=async()=>{const _0x17a01e=_0x4c92d7,_0x4d6ed8=prompt(_0x17a01e(0x21b));if(_0x4d6ed8!==_0x17a01e(0x195))return;const _0x39ec2d=document[_0x17a01e(0x188)](_0x17a01e(0x130)),_0x32e1e0=_0x39ec2d[_0x17a01e(0x13d)];_0x39ec2d[_0x17a01e(0x1d2)]=!![],_0x39ec2d['innerText']=_0x17a01e(0xfe);try{const _0x546e2d=query(collection(db,finalCollectionPath)),_0x5ace34=await getDocs(_0x546e2d),_0x545fe6=_0x5ace34[_0x17a01e(0x19b)];if(_0x545fe6===0x0){window['app']['showToast'](_0x17a01e(0x1ef),_0x17a01e(0x105));return;}const _0x2c509a=0x190,_0xb14229=[];let _0x42e822=[];_0x5ace34[_0x17a01e(0x1cb)](_0x2f5926=>{const _0x3efcd2=_0x17a01e;_0x42e822[_0x3efcd2(0x123)](_0x2f5926),_0x42e822[_0x3efcd2(0x248)]>=_0x2c509a&&(_0xb14229[_0x3efcd2(0x123)](_0x42e822),_0x42e822=[]);});if(_0x42e822[_0x17a01e(0x248)]>0x0)_0xb14229[_0x17a01e(0x123)](_0x42e822);for(const _0x3fecf2 of _0xb14229){const _0x51e27b=writeBatch(db);_0x3fecf2['forEach'](_0x5e8a7a=>_0x51e27b[_0x17a01e(0x222)](_0x5e8a7a[_0x17a01e(0x170)])),await _0x51e27b[_0x17a01e(0x1ac)]();}window['app'][_0x17a01e(0x1ec)]('ลบข้อมูลทั้งหมดเรียบร้อย\x20('+_0x545fe6+_0x17a01e(0x208),_0x17a01e(0x1fc));}catch(_0x55d787){console[_0x17a01e(0x185)](_0x55d787),window[_0x17a01e(0x17c)][_0x17a01e(0x1ec)](_0x17a01e(0x216),_0x17a01e(0x185));}finally{_0x39ec2d['disabled']=![],_0x39ec2d['innerHTML']=_0x32e1e0;}},window['app'][_0x4c92d7(0x145)]=async()=>{const _0x4e0f1e=_0x4c92d7;window[_0x4e0f1e(0x17c)][_0x4e0f1e(0x134)]();const _0x58b94d=document[_0x4e0f1e(0x188)](_0x4e0f1e(0x217)),_0x484d1d=_0x58b94d[_0x4e0f1e(0x13d)];_0x58b94d[_0x4e0f1e(0x1d2)]=!![],_0x58b94d[_0x4e0f1e(0x1b9)]='กำลังประมวลผล...';try{const _0x3d44bf=0x190;let _0x1e28c0=0x0;const _0x189afa=query(collection(db,finalCollectionPath)),_0x3018aa=await getDocs(_0x189afa),_0x1f308d=[];let _0x9ff20c=[];_0x3018aa[_0x4e0f1e(0x1cb)](_0x3c3787=>{const _0x2f3fbe=_0x4e0f1e;_0x9ff20c[_0x2f3fbe(0x123)](_0x3c3787),_0x9ff20c['length']>=_0x3d44bf&&(_0x1f308d[_0x2f3fbe(0x123)](_0x9ff20c),_0x9ff20c=[]);});if(_0x9ff20c[_0x4e0f1e(0x248)]>0x0)_0x1f308d[_0x4e0f1e(0x123)](_0x9ff20c);for(const _0x3f4950 of _0x1f308d){const _0x5f2f02=writeBatch(db);_0x3f4950[_0x4e0f1e(0x1cb)](_0xa04b26=>{_0x5f2f02['update'](_0xa04b26['ref'],{'CheckIN':deleteField(),'CheckOUT':deleteField(),'status':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'rewardClaimTime':deleteField(),'deviceId':deleteField(),'deviceUserAgent':deleteField()});}),await _0x5f2f02[_0x4e0f1e(0x1ac)](),_0x1e28c0+=_0x3f4950[_0x4e0f1e(0x248)];}window[_0x4e0f1e(0x17c)][_0x4e0f1e(0x1ec)](_0x4e0f1e(0x11a)+_0x1e28c0+_0x4e0f1e(0x107),_0x4e0f1e(0x1fc));}catch(_0x1a436f){console[_0x4e0f1e(0x185)](_0x4e0f1e(0x246),_0x1a436f),window[_0x4e0f1e(0x17c)][_0x4e0f1e(0x1ec)](_0x4e0f1e(0x120),'error');}finally{_0x58b94d[_0x4e0f1e(0x1d2)]=![],_0x58b94d['innerHTML']=_0x484d1d;}},window[_0x4c92d7(0x17c)]['handlePrizeSubmit']=async _0x4cf154=>{const _0x1fe038=_0x4c92d7;_0x4cf154[_0x1fe038(0x201)]();const _0x348438=document[_0x1fe038(0x17d)](_0x1fe038(0x1bd))[_0x1fe038(0x1a6)][_0x1fe038(0x112)](),_0x10f99c=parseInt(document[_0x1fe038(0x17d)](_0x1fe038(0x22b))[_0x1fe038(0x1a6)]),_0x121dbf=parseInt(document[_0x1fe038(0x17d)](_0x1fe038(0x237))[_0x1fe038(0x1a6)]||0x1);if(!_0x348438||_0x10f99c<0x1)return;try{await addDoc(collection(db,prizesCollectionPath),{'name':_0x348438,'qtyPerDraw':_0x10f99c,'totalQty':_0x121dbf,'createdAt':serverTimestamp()}),document[_0x1fe038(0x17d)](_0x1fe038(0x1c9))[_0x1fe038(0x12a)](),window[_0x1fe038(0x17c)][_0x1fe038(0x1ec)](_0x1fe038(0x244),'success');}catch(_0x5bcdc7){console[_0x1fe038(0x185)](_0x1fe038(0x14f),_0x5bcdc7),window[_0x1fe038(0x17c)][_0x1fe038(0x1ec)]('เกิดข้อผิดพลาดในการบันทึก',_0x1fe038(0x185));}},window[_0x4c92d7(0x17c)][_0x4c92d7(0x152)]=async _0x219e18=>{const _0x385043=_0x4c92d7;if(!confirm(_0x385043(0x1fd)))return;try{await deleteDoc(doc(db,prizesCollectionPath,_0x219e18)),window[_0x385043(0x17c)][_0x385043(0x1ec)](_0x385043(0x1fb),_0x385043(0x1fc));}catch(_0x4c5fb7){console[_0x385043(0x185)](_0x385043(0x22f),_0x4c5fb7),window[_0x385043(0x17c)][_0x385043(0x1ec)]('ลบไม่สำเร็จ','error');}},window[_0x4c92d7(0x17c)]['openEditPrizeModal']=(_0x405059,_0x96c00a,_0x23e2ae,_0x1a7ad9)=>{const _0x3f00c0=_0x4c92d7;document['getElementById'](_0x3f00c0(0x19d))[_0x3f00c0(0x1a6)]=_0x405059,document[_0x3f00c0(0x17d)](_0x3f00c0(0x21c))[_0x3f00c0(0x1a6)]=_0x96c00a,document[_0x3f00c0(0x17d)]('edit-prize-qty')['value']=_0x23e2ae,document[_0x3f00c0(0x17d)](_0x3f00c0(0x196))['value']=_0x1a7ad9||0x1,document[_0x3f00c0(0x17d)]('edit-prize-modal')[_0x3f00c0(0x13b)]['remove'](_0x3f00c0(0x169));},window[_0x4c92d7(0x17c)][_0x4c92d7(0x117)]=()=>document['getElementById']('edit-prize-modal')[_0x4c92d7(0x13b)][_0x4c92d7(0x1ea)](_0x4c92d7(0x169)),window[_0x4c92d7(0x17c)][_0x4c92d7(0x1b5)]=async _0x4c9fe0=>{const _0x1117a9=_0x4c92d7;_0x4c9fe0[_0x1117a9(0x201)]();const _0xddaf3e=document[_0x1117a9(0x17d)](_0x1117a9(0x19d))[_0x1117a9(0x1a6)],_0x1e720d=document[_0x1117a9(0x17d)](_0x1117a9(0x21c))[_0x1117a9(0x1a6)][_0x1117a9(0x112)](),_0x425436=parseInt(document['getElementById'](_0x1117a9(0x144))[_0x1117a9(0x1a6)]),_0x566b48=parseInt(document[_0x1117a9(0x17d)](_0x1117a9(0x196))['value']);if(!_0xddaf3e||!_0x1e720d||_0x425436<0x1)return;try{await updateDoc(doc(db,prizesCollectionPath,_0xddaf3e),{'name':_0x1e720d,'qtyPerDraw':_0x425436,'totalQty':_0x566b48}),window[_0x1117a9(0x17c)]['closeEditPrizeModal'](),window[_0x1117a9(0x17c)][_0x1117a9(0x1ec)](_0x1117a9(0x13c),_0x1117a9(0x1fc));}catch(_0x247168){console[_0x1117a9(0x185)](_0x1117a9(0x1a1),_0x247168),window['app']['showToast'](_0x1117a9(0x136),_0x1117a9(0x185));}},window[_0x4c92d7(0x17c)]['deleteSingleData']=async _0x291634=>{const _0x4d36a3=_0x4c92d7;if(!confirm(_0x4d36a3(0x1b6)))return;try{await deleteDoc(doc(db,finalCollectionPath,_0x291634)),window[_0x4d36a3(0x17c)][_0x4d36a3(0x1ec)](_0x4d36a3(0x18d),_0x4d36a3(0x1fc));}catch(_0x1e05b4){console[_0x4d36a3(0x185)](_0x4d36a3(0x1e6),_0x1e05b4),window[_0x4d36a3(0x17c)][_0x4d36a3(0x1ec)](_0x4d36a3(0x203),_0x4d36a3(0x185));}};function updateCharts(_0x2e5471,_0x314a1a){const _0x4f0e09=_0x4c92d7,_0x36a003=document[_0x4f0e09(0x17d)](_0x4f0e09(0x1d7))['getContext']('2d'),_0x3b4785=Array['from']({'length':0x18},(_0x37a02e,_0x463efa)=>_0x463efa+_0x4f0e09(0x12d)),_0x2a2e27=_0x3b4785['map']((_0xa74648,_0x4af7ad)=>_0x2e5471[_0x4af7ad]||0x0);window[_0x4f0e09(0x249)]?(window[_0x4f0e09(0x249)][_0x4f0e09(0x106)]['datasets'][0x0][_0x4f0e09(0x106)]=_0x2a2e27,window[_0x4f0e09(0x249)]['update']()):window[_0x4f0e09(0x249)]=new Chart(_0x36a003,{'type':_0x4f0e09(0x157),'data':{'labels':_0x3b4785,'datasets':[{'label':_0x4f0e09(0x10e),'data':_0x2a2e27,'borderColor':_0x4f0e09(0x204),'backgroundColor':_0x4f0e09(0x1a0),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});const _0x23fd96=document[_0x4f0e09(0x17d)](_0x4f0e09(0x1aa))[_0x4f0e09(0x114)]('2d'),_0x5ce3e4=_0x3b4785['map']((_0x84fab9,_0x42c450)=>_0x314a1a[_0x42c450]||0x0);window['chartOutInstance']?(window[_0x4f0e09(0x19a)][_0x4f0e09(0x106)]['datasets'][0x0][_0x4f0e09(0x106)]=_0x5ce3e4,window[_0x4f0e09(0x19a)][_0x4f0e09(0xfb)]()):window[_0x4f0e09(0x19a)]=new Chart(_0x23fd96,{'type':_0x4f0e09(0x157),'data':{'labels':_0x3b4785,'datasets':[{'label':_0x4f0e09(0x135),'data':_0x5ce3e4,'borderColor':'#f97316','backgroundColor':_0x4f0e09(0x119),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function processSnapshot(_0x1ed526){const _0x49ef3c=_0x4c92d7,_0x24175f=[],_0x2e7495=[],_0x24d366={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0};_0x24d366[_0x49ef3c(0x1f0)]=_0x1ed526[_0x49ef3c(0x19b)];const _0x35acc4={},_0x162b3a={};_0x1ed526[_0x49ef3c(0x1cb)](_0x4a5e47=>{const _0x38f319=_0x49ef3c,_0x4cd7e3=_0x4a5e47[_0x38f319(0x106)](),_0x438f2c={'id':_0x4a5e47['id'],..._0x4cd7e3};_0x24175f[_0x38f319(0x123)](_0x438f2c);if(_0x4cd7e3[_0x38f319(0x168)]){_0x24d366[_0x38f319(0x230)]++;const _0x36bf98=_0x4cd7e3[_0x38f319(0x168)][_0x38f319(0x181)]?_0x4cd7e3[_0x38f319(0x168)][_0x38f319(0x181)]():new Date(_0x4cd7e3[_0x38f319(0x168)]),_0x2a9a3f=_0x36bf98['getHours']();_0x35acc4[_0x2a9a3f]=(_0x35acc4[_0x2a9a3f]||0x0)+0x1;}if(_0x4cd7e3['CheckOUT']){_0x24d366[_0x38f319(0x18e)]++;const _0x1541b4=_0x4cd7e3[_0x38f319(0x1b4)][_0x38f319(0x181)]?_0x4cd7e3[_0x38f319(0x1b4)][_0x38f319(0x181)]():new Date(_0x4cd7e3[_0x38f319(0x1b4)]),_0x50506e=_0x1541b4['getHours']();_0x162b3a[_0x50506e]=(_0x162b3a[_0x50506e]||0x0)+0x1;}_0x4cd7e3[_0x38f319(0x1c3)]&&(_0x4cd7e3[_0x38f319(0x1c3)]===_0x38f319(0x1ca)?_0x24d366[_0x38f319(0x205)]++:(_0x24d366[_0x38f319(0x1a7)]++,_0x2e7495[_0x38f319(0x123)](_0x438f2c)));if(_0x4cd7e3[_0x38f319(0x1b0)])_0x24d366[_0x38f319(0x18f)]++;if(_0x4cd7e3[_0x38f319(0x193)]&&_0x4cd7e3[_0x38f319(0x193)][_0x38f319(0x112)]()!==''){_0x24d366[_0x38f319(0x10b)]++,_0x24d366[_0x38f319(0x177)]++;if(!_0x4cd7e3[_0x38f319(0x1c3)])_0x24d366[_0x38f319(0x1a2)]++;else _0x4cd7e3[_0x38f319(0x1c3)]==='ไม่ได้รางวัล'?_0x24d366[_0x38f319(0x24a)]++:_0x24d366[_0x38f319(0x239)]++;}}),_0x24175f[_0x49ef3c(0x226)]((_0x2508ca,_0x573a87)=>{return 0x0;}),state[_0x49ef3c(0x13a)]=_0x24175f,state[_0x49ef3c(0x16f)]=_0x24d366,updateDashboardUI(_0x24d366),updateCharts(_0x35acc4,_0x162b3a),renderActivityFeed(_0x24175f),renderTable(_0x24175f),window[_0x49ef3c(0x17c)][_0x49ef3c(0x229)](),document[_0x49ef3c(0x17d)](_0x49ef3c(0x154))[_0x49ef3c(0x13b)][_0x49ef3c(0xf9)](_0x49ef3c(0x169))===![]&&window[_0x49ef3c(0x17c)][_0x49ef3c(0x10f)]();}function csvToJson(_0x544c5f){const _0x11f9d3=_0x4c92d7,_0x4c0c7c=_0x544c5f['split']('\x0a'),_0x1bbe61=_0x4c0c7c[0x0][_0x11f9d3(0x127)](',')['map'](_0x2a9fe3=>_0x2a9fe3[_0x11f9d3(0x112)]());return _0x4c0c7c[_0x11f9d3(0x206)](0x1)[_0x11f9d3(0x16a)](_0x38f0aa=>{const _0x25e5b1=_0x11f9d3,_0x267b99=_0x38f0aa[_0x25e5b1(0x127)](',');if(_0x267b99[_0x25e5b1(0x248)]<_0x1bbe61['length'])return null;return _0x1bbe61[_0x25e5b1(0x16e)]((_0x36ce58,_0x3f7f07,_0x47673a)=>{return _0x36ce58[_0x3f7f07]=_0x267b99[_0x47673a]?_0x267b99[_0x47673a]['trim']():'',_0x36ce58;},{});})[_0x11f9d3(0x121)](_0x41dbd4=>_0x41dbd4);}function updateDashboardUI(_0x1cb2dd){const _0x2ddf5a=_0x4c92d7;document['getElementById'](_0x2ddf5a(0x218))[_0x2ddf5a(0x1b9)]=_0x1cb2dd['checkin'],document[_0x2ddf5a(0x17d)]('stat-checkout')[_0x2ddf5a(0x1b9)]=_0x1cb2dd[_0x2ddf5a(0x18e)],document['getElementById'](_0x2ddf5a(0x1dc))[_0x2ddf5a(0x1b9)]=_0x1cb2dd[_0x2ddf5a(0x1a7)],document[_0x2ddf5a(0x17d)]('stat-claimed')[_0x2ddf5a(0x1b9)]=_0x1cb2dd[_0x2ddf5a(0x18f)],document['getElementById']('stat-eligible')['innerText']=_0x2ddf5a(0x21a)+_0x1cb2dd[_0x2ddf5a(0x177)]+'\x20คน';if(document[_0x2ddf5a(0x17d)]('stat-noreward'))document[_0x2ddf5a(0x17d)](_0x2ddf5a(0x11e))[_0x2ddf5a(0x1b9)]=_0x1cb2dd[_0x2ddf5a(0x205)];document[_0x2ddf5a(0x17d)]('chart-total-checkin')['innerText']=_0x1cb2dd[_0x2ddf5a(0x230)],document[_0x2ddf5a(0x17d)]('chart-total-checkout')['innerText']=_0x1cb2dd[_0x2ddf5a(0x18e)],document[_0x2ddf5a(0x17d)](_0x2ddf5a(0x1c8))[_0x2ddf5a(0x1b9)]=_0x1cb2dd['eligible'],document['getElementById'](_0x2ddf5a(0x192))['innerText']=_0x1cb2dd[_0x2ddf5a(0x1f0)];const _0x2d80fd=_0x1cb2dd[_0x2ddf5a(0x230)]>0x0?_0x1cb2dd[_0x2ddf5a(0x18e)]/_0x1cb2dd[_0x2ddf5a(0x230)]*0x64:0x0;document[_0x2ddf5a(0x17d)](_0x2ddf5a(0x132))[_0x2ddf5a(0x19c)][_0x2ddf5a(0x165)]=_0x2d80fd+'%';}function renderTable(_0x2da076){const _0x4e837f=_0x4c92d7,_0x791a93=document[_0x4e837f(0x17d)](_0x4e837f(0x15d)),_0x5c63ff=document[_0x4e837f(0x17d)](_0x4e837f(0x1ee)),_0x562cf7=[..._0x2da076]['sort']((_0x366962,_0x437365)=>{const _0x529766=_0x4e837f,_0x125723=state[_0x529766(0x199)]||_0x529766(0x168);let _0x315e06=_0x366962[_0x125723],_0xc2088d=_0x437365[_0x125723];if(_0x125723===_0x529766(0x168)||_0x125723===_0x529766(0x1b4)){const _0xcfdc31=_0x315e06?_0x315e06[_0x529766(0x181)]?_0x315e06[_0x529766(0x181)]()['getTime']():new Date(_0x315e06)['getTime']():0x0,_0x505b63=_0xc2088d?_0xc2088d[_0x529766(0x181)]?_0xc2088d[_0x529766(0x181)]()[_0x529766(0x178)]():new Date(_0xc2088d)[_0x529766(0x178)]():0x0;return state[_0x529766(0x158)]==='asc'?_0xcfdc31-_0x505b63:_0x505b63-_0xcfdc31;}if(typeof _0x315e06===_0x529766(0x1f9))_0x315e06=_0x315e06[_0x529766(0x1af)]();else _0x315e06='';if(typeof _0xc2088d===_0x529766(0x1f9))_0xc2088d=_0xc2088d[_0x529766(0x1af)]();else _0xc2088d='';if(_0x315e06<_0xc2088d)return state['sortOrder']===_0x529766(0xfa)?-0x1:0x1;if(_0x315e06>_0xc2088d)return state[_0x529766(0x158)]===_0x529766(0xfa)?0x1:-0x1;return 0x0;}),_0x12dcca=state[_0x4e837f(0x197)]===0x1869f?_0x562cf7[_0x4e837f(0x248)]:state['rowsPerPage'],_0x2a0888=Math['ceil'](_0x562cf7[_0x4e837f(0x248)]/_0x12dcca);if(state[_0x4e837f(0x220)]>_0x2a0888)state[_0x4e837f(0x220)]=_0x2a0888>0x0?_0x2a0888:0x1;const _0x1a0abd=(state['currentPage']-0x1)*_0x12dcca,_0x305b71=_0x1a0abd+_0x12dcca,_0x14d6f1=_0x562cf7[_0x4e837f(0x206)](_0x1a0abd,_0x305b71);document[_0x4e837f(0x17d)](_0x4e837f(0x109))[_0x4e837f(0x1b9)]='Page\x20'+state[_0x4e837f(0x220)]+_0x4e837f(0x21e)+(_0x2a0888||0x1),document[_0x4e837f(0x17d)](_0x4e837f(0x156))[_0x4e837f(0x1d2)]=state[_0x4e837f(0x220)]<=0x1,document['getElementById'](_0x4e837f(0x143))[_0x4e837f(0x1d2)]=state['currentPage']>=_0x2a0888;const _0x250168=state[_0x4e837f(0x158)]==='asc'?_0x4e837f(0x1c0):_0x4e837f(0x21d);_0x5c63ff['innerText']='แสดงผล\x20'+_0x14d6f1['length']+'\x20จากทั้งหมด\x20'+_0x2da076[_0x4e837f(0x248)]+_0x4e837f(0x1e3)+sortByToLabel(state[_0x4e837f(0x199)])+_0x250168+')',_0x791a93[_0x4e837f(0x13d)]=_0x14d6f1['map']((_0x153858,_0x1ee3cc)=>{const _0x1026df=_0x4e837f,_0x421f15=_0x153858[_0x1026df(0x168)]?(_0x153858[_0x1026df(0x168)]['toDate']?_0x153858[_0x1026df(0x168)][_0x1026df(0x181)]():new Date(_0x153858[_0x1026df(0x168)]))[_0x1026df(0x228)](_0x1026df(0x1cc)):'-',_0x49c400=_0x153858[_0x1026df(0x1b4)]?(_0x153858[_0x1026df(0x1b4)]['toDate']?_0x153858[_0x1026df(0x1b4)][_0x1026df(0x181)]():new Date(_0x153858[_0x1026df(0x1b4)]))[_0x1026df(0x228)](_0x1026df(0x1cc)):'-',_0x19554b=_0x153858[_0x1026df(0x1c3)]||_0x1026df(0x167),_0x359c99=_0x153858[_0x1026df(0x1b0)]?_0x1026df(0x20b):_0x153858[_0x1026df(0x1c3)]?_0x153858[_0x1026df(0x1c3)]==='ไม่ได้รับรางวัล'?'<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x22>ไม่ได้รางวัล</span>':_0x1026df(0x235):'-',_0x3c4503=_0x153858[_0x1026df(0x1bf)]||_0x1026df(0x1f2)+_0x153858[_0x1026df(0x22c)][_0x1026df(0xf8)](0x0,0x6)+_0x1026df(0x241);return _0x1026df(0x247)+(_0x1a0abd+_0x1ee3cc+0x1)+'</td><td\x20class=\x22px-6\x20font-medium\x20text-slate-700\x20text-base\x22>'+_0x3c4503+'</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>'+_0x421f15+'</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>'+_0x49c400+_0x1026df(0x200)+_0x19554b+_0x1026df(0x191)+_0x359c99+'</td><td\x20class=\x22px-6\x20text-right\x22><button\x20onclick=\x22window.app.deleteSingleData(\x27'+_0x153858['id']+'\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i></button></td></tr>';})[_0x4e837f(0x1ae)]('');if(window[_0x4e837f(0x17a)])lucide[_0x4e837f(0x126)]();}function sortByToLabel(_0x44c860){const _0x33e628=_0x4c92d7;switch(_0x44c860){case _0x33e628(0x168):return _0x33e628(0x11d);case'CheckOUT':return _0x33e628(0x14c);case _0x33e628(0x1c3):return _0x33e628(0x1e7);case _0x33e628(0x1bf):return _0x33e628(0x139);default:return _0x44c860;}}window[_0x4c92d7(0x17c)][_0x4c92d7(0x229)]=()=>{const _0x20d854=_0x4c92d7,_0xd3f1f2=state[_0x20d854(0x16f)];document['getElementById'](_0x20d854(0x11c))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x1f0)],document['getElementById'](_0x20d854(0x1c5))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x10b)],document[_0x20d854(0x17d)](_0x20d854(0x12b))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x1a7)],document[_0x20d854(0x17d)](_0x20d854(0x20e))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x1a7)],document[_0x20d854(0x17d)](_0x20d854(0x1c6))['innerText']=_0xd3f1f2['notRewarded'],document[_0x20d854(0x17d)]('rand-stat-total')[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x1f0)];if(document[_0x20d854(0x17d)]('rand-stat-noreward'))document[_0x20d854(0x17d)](_0x20d854(0x198))['innerText']=_0xd3f1f2['notYetDrawn'];if(document[_0x20d854(0x17d)](_0x20d854(0x124)))document[_0x20d854(0x17d)](_0x20d854(0x124))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x24a)];if(document[_0x20d854(0x17d)](_0x20d854(0x147)))document[_0x20d854(0x17d)](_0x20d854(0x147))['innerText']=_0xd3f1f2['drawnWon'];document[_0x20d854(0x17d)](_0x20d854(0x12e))&&(document[_0x20d854(0x17d)](_0x20d854(0x12e))[_0x20d854(0x1b9)]=_0xd3f1f2[_0x20d854(0x177)]);const _0xc01fc7=document[_0x20d854(0x17d)](_0x20d854(0x108))[_0x20d854(0x1a6)];let _0xb19fa6=[];if(_0xc01fc7===_0x20d854(0x100))_0xb19fa6=state[_0x20d854(0x13a)][_0x20d854(0x121)](_0x46bbd8=>_0x46bbd8[_0x20d854(0x1c3)]==='ไม่ได้รับรางวัล');else{let _0xc1270=state[_0x20d854(0x13a)][_0x20d854(0x121)](_0x5b6386=>_0x5b6386[_0x20d854(0x1c3)]&&_0x5b6386[_0x20d854(0x1c3)]!==_0x20d854(0x1ca));if(_0xc01fc7==='claimed')_0xb19fa6=_0xc1270[_0x20d854(0x121)](_0x2773cd=>_0x2773cd[_0x20d854(0x1b0)]);else _0xc01fc7==='unclaimed'?_0xb19fa6=_0xc1270[_0x20d854(0x121)](_0x51f306=>!_0x51f306[_0x20d854(0x1b0)]):_0xb19fa6=_0xc1270;}_0xb19fa6[_0x20d854(0x226)]((_0x25fd81,_0x6c13c6)=>{const _0x5809ff=_0x20d854,_0xee8f63=_0x25fd81[_0x5809ff(0x115)]?_0x25fd81[_0x5809ff(0x115)][_0x5809ff(0x181)]?_0x25fd81['rewardTime'][_0x5809ff(0x181)]():new Date(_0x25fd81[_0x5809ff(0x115)]):new Date(0x0),_0x14dfde=_0x6c13c6[_0x5809ff(0x115)]?_0x6c13c6[_0x5809ff(0x115)]['toDate']?_0x6c13c6[_0x5809ff(0x115)][_0x5809ff(0x181)]():new Date(_0x6c13c6[_0x5809ff(0x115)]):new Date(0x0);return _0x14dfde-_0xee8f63;});const _0x4b98cd=document['getElementById'](_0x20d854(0x153));if(_0xb19fa6['length']===0x0){_0x4b98cd[_0x20d854(0x13d)]=_0x20d854(0x18a);return;}_0x4b98cd['innerHTML']=_0xb19fa6[_0x20d854(0x16a)]((_0x4873f6,_0x16838c)=>{const _0x2293d5=_0x20d854,_0x5d4469=_0x4873f6[_0x2293d5(0x115)]?_0x4873f6['rewardTime'][_0x2293d5(0x181)]?_0x4873f6[_0x2293d5(0x115)][_0x2293d5(0x181)]():new Date(_0x4873f6[_0x2293d5(0x115)]):new Date(),_0x360056=_0x4873f6[_0x2293d5(0x1bf)]||(_0x4873f6[_0x2293d5(0x22c)]?_0x4873f6[_0x2293d5(0x22c)][_0x2293d5(0xf8)](0x0,0xa)+_0x2293d5(0x1f8):'-');let _0x3d4c4d='';if(_0x4873f6['reward']===_0x2293d5(0x1ca))_0x3d4c4d=_0x2293d5(0x159);else _0x4873f6[_0x2293d5(0x1b0)]?_0x3d4c4d=_0x2293d5(0x22d):_0x3d4c4d=_0x2293d5(0x163);const _0x4b5846=_0x4873f6[_0x2293d5(0x1c3)]===_0x2293d5(0x1ca)?_0x2293d5(0x180):_0x2293d5(0x1d5)+_0x4873f6[_0x2293d5(0x1c3)]+_0x2293d5(0x161);return _0x2293d5(0x212)+(_0x16838c+0x1)+_0x2293d5(0x1e2)+_0x360056+_0x2293d5(0x12c)+_0x4b5846+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-mono\x20text-sm\x22>'+(_0x4873f6[_0x2293d5(0x115)]?_0x5d4469[_0x2293d5(0x129)](_0x2293d5(0x1cc)):'-')+_0x2293d5(0x12c)+_0x3d4c4d+_0x2293d5(0x234);})[_0x20d854(0x1ae)]('');};function renderActivityFeed(_0xe30562){const _0x373b0a=_0x4c92d7,_0x29da52=document[_0x373b0a(0x17d)](_0x373b0a(0x1ad));let _0x52b45a=[];_0xe30562[_0x373b0a(0x1cb)](_0xbeb38=>{const _0x1721e3=_0x373b0a,_0x2810b5=_0xbeb38['EmpName']||_0x1721e3(0x14d)+(_0xbeb38['citizenId']?_0xbeb38[_0x1721e3(0x22c)]['slice'](-0x4):_0x1721e3(0x150));if(_0xbeb38[_0x1721e3(0x168)])_0x52b45a[_0x1721e3(0x123)]({'type':'in','date':_0xbeb38[_0x1721e3(0x168)][_0x1721e3(0x181)]?_0xbeb38['CheckIN'][_0x1721e3(0x181)]():new Date(_0xbeb38['CheckIN']),'name':_0x2810b5,'id':_0xbeb38['id']});if(_0xbeb38[_0x1721e3(0x1b4)])_0x52b45a[_0x1721e3(0x123)]({'type':'out','date':_0xbeb38[_0x1721e3(0x1b4)][_0x1721e3(0x181)]?_0xbeb38[_0x1721e3(0x1b4)][_0x1721e3(0x181)]():new Date(_0xbeb38[_0x1721e3(0x1b4)]),'name':_0x2810b5,'id':_0xbeb38['id']});}),_0x52b45a[_0x373b0a(0x226)]((_0x43f2c8,_0x3103e1)=>_0x3103e1['date']-_0x43f2c8[_0x373b0a(0x175)]);const _0x3f4cfd=_0x52b45a[_0x373b0a(0x206)](0x0,0x32);if(_0x3f4cfd['length']===0x0){_0x29da52[_0x373b0a(0x13d)]=_0x373b0a(0x15c);return;}_0x29da52[_0x373b0a(0x13d)]=_0x3f4cfd[_0x373b0a(0x16a)](_0x3faff2=>{const _0x218f1f=_0x373b0a,_0x2ebd08=_0x3faff2['date']['toLocaleDateString'](_0x218f1f(0x1cc))+'\x20'+_0x3faff2[_0x218f1f(0x175)][_0x218f1f(0x129)]('th-TH');let _0x8c052a='user-plus',_0x334572=_0x218f1f(0x14a),_0x19cb84=_0x218f1f(0x10a);return _0x3faff2[_0x218f1f(0x1f4)]===_0x218f1f(0x1f1)&&(_0x8c052a=_0x218f1f(0x173),_0x334572=_0x218f1f(0x133),_0x19cb84=_0x218f1f(0x24c)),_0x218f1f(0x231)+_0x334572+_0x218f1f(0x202)+_0x8c052a+_0x218f1f(0x23a)+_0x3faff2[_0x218f1f(0x104)]+_0x218f1f(0x17e)+_0x19cb84+_0x218f1f(0x138)+_0x2ebd08+_0x218f1f(0x14b);})[_0x373b0a(0x1ae)]('');if(window[_0x373b0a(0x17a)])lucide[_0x373b0a(0x126)]();}function processPrizesSnapshot(_0x7f706f){const _0x775de0=_0x4c92d7,_0x399673=[];_0x7f706f['forEach'](_0xe4630c=>{const _0xac5ffd=_0x2180;_0x399673[_0xac5ffd(0x123)]({'id':_0xe4630c['id'],..._0xe4630c[_0xac5ffd(0x106)]()});}),state[_0x775de0(0x148)]=_0x399673,renderPrizeList(_0x399673),renderPrizeOptions(_0x399673),document[_0x775de0(0x17d)](_0x775de0(0x154))[_0x775de0(0x13b)][_0x775de0(0xf9)](_0x775de0(0x169))===![]&&window['app']['onPrizeSelect']();}function renderPrizeList(_0x5146cd){const _0x1c4a86=_0x4c92d7,_0x5f509b=document['getElementById'](_0x1c4a86(0x122)),_0x722e66=document[_0x1c4a86(0x17d)](_0x1c4a86(0x23e)),_0x2bcf83=_0x5146cd[_0x1c4a86(0x16e)]((_0x29b6d7,_0x5b3c91)=>_0x29b6d7+(parseInt(_0x5b3c91[_0x1c4a86(0x24b)])||0x0),0x0);_0x722e66[_0x1c4a86(0x1b9)]=_0x2bcf83['toLocaleString']();if(_0x5146cd[_0x1c4a86(0x248)]===0x0){_0x5f509b[_0x1c4a86(0x13d)]=_0x1c4a86(0x11f);return;}_0x5f509b[_0x1c4a86(0x13d)]=_0x5146cd[_0x1c4a86(0x16a)]((_0x576c23,_0x15fc7b)=>'<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22><td\x20class=\x22px-4\x20py-3\x20font-medium\x20text-slate-700\x22>'+_0x576c23[_0x1c4a86(0x104)]+'</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-slate-500\x22>'+(_0x576c23[_0x1c4a86(0x1dd)]||0x1)+'</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-slate-500\x22>'+(_0x576c23[_0x1c4a86(0x24b)]||'-')+_0x1c4a86(0x232)+_0x576c23['id']+'\x27,\x20\x27'+_0x576c23['name']+_0x1c4a86(0x1ff)+(_0x576c23[_0x1c4a86(0x1dd)]||0x1)+',\x20'+(_0x576c23[_0x1c4a86(0x24b)]||0x1)+_0x1c4a86(0x1df)+_0x576c23['id']+_0x1c4a86(0x20a))[_0x1c4a86(0x1ae)]('');if(window[_0x1c4a86(0x17a)])lucide['createIcons']();}function renderPrizeOptions(_0x260b57){const _0x4c64e9=_0x4c92d7,_0x6ad39a=document[_0x4c64e9(0x17d)](_0x4c64e9(0x1be)),_0x55fcca=_0x6ad39a['value'];_0x6ad39a[_0x4c64e9(0x13d)]=_0x4c64e9(0x243)+_0x260b57[_0x4c64e9(0x16a)](_0x3afc9d=>_0x4c64e9(0x1c7)+_0x3afc9d['id']+'\x22\x20data-qty=\x22'+_0x3afc9d[_0x4c64e9(0x1dd)]+_0x4c64e9(0x1b8)+(_0x3afc9d[_0x4c64e9(0x24b)]||0x270f)+'\x22>'+_0x3afc9d['name']+'</option>')['join'](''),_0x6ad39a[_0x4c64e9(0x1a6)]=_0x55fcca;}window[_0x4c92d7(0x17c)][_0x4c92d7(0x10f)]=()=>{const _0x1dc096=_0x4c92d7,_0x35a963=document[_0x1dc096(0x17d)](_0x1dc096(0x1be));if(_0x35a963[_0x1dc096(0x1db)]===-0x1||!_0x35a963['options'][_0x35a963[_0x1dc096(0x1db)]])return;const _0x12aba4=_0x35a963[_0x1dc096(0x1fa)][_0x35a963['selectedIndex']];if(!_0x35a963[_0x1dc096(0x1a6)]||!_0x12aba4[_0x1dc096(0x23f)](_0x1dc096(0x151))){document['getElementById'](_0x1dc096(0x1f5))[_0x1dc096(0x1d2)]=!![],document['getElementById'](_0x1dc096(0x1f5))[_0x1dc096(0x13b)]['add'](_0x1dc096(0x1b7),_0x1dc096(0x111));return;}const _0x1bb4a2=_0x12aba4[_0x1dc096(0x245)](_0x1dc096(0x151)),_0x339a86=parseInt(_0x12aba4['getAttribute'](_0x1dc096(0x19e))||0x0),_0x56c4d0=_0x12aba4[_0x1dc096(0xff)],_0x27ea79=state[_0x1dc096(0x13a)][_0x1dc096(0x121)](_0xce2098=>_0xce2098[_0x1dc096(0x1c3)]===_0x56c4d0)[_0x1dc096(0x248)],_0x529c36=_0x339a86-_0x27ea79,_0x1dee8d=document[_0x1dc096(0x17d)](_0x1dc096(0x215));document['getElementById'](_0x1dc096(0x1e8))[_0x1dc096(0x1b9)]=_0x529c36+_0x1dc096(0x1c2)+_0x339a86,_0x1dee8d['max']=_0x529c36>0x0?_0x529c36:0x0,window[_0x1dc096(0x17c)]['validateRandomizerInput']();},window[_0x4c92d7(0x17c)][_0x4c92d7(0x16d)]=()=>{const _0x20f628=_0x4c92d7,_0x1905c5=document[_0x20f628(0x17d)](_0x20f628(0x1be)),_0x5e831d=document[_0x20f628(0x17d)](_0x20f628(0x215)),_0x1668b8=document[_0x20f628(0x17d)]('btn-start-random'),_0x3d3250=_0x1905c5[_0x20f628(0x1a6)],_0x12fdcf=parseInt(_0x5e831d[_0x20f628(0x1a6)]);if(!_0x3d3250){_0x1668b8[_0x20f628(0x1d2)]=!![],_0x1668b8[_0x20f628(0x13b)][_0x20f628(0x1ea)](_0x20f628(0x1b7),_0x20f628(0x111));return;}const _0x10fffc=_0x1905c5[_0x20f628(0x1fa)][_0x1905c5[_0x20f628(0x1db)]],_0x2a1d45=parseInt(_0x10fffc[_0x20f628(0x245)](_0x20f628(0x19e))||0x0),_0x1a69a6=_0x10fffc['text'],_0x23b5e8=state[_0x20f628(0x13a)][_0x20f628(0x121)](_0x235457=>_0x235457['reward']===_0x1a69a6)['length'],_0x58635c=_0x2a1d45-_0x23b5e8;if(_0x12fdcf>0x0&&_0x12fdcf<=_0x58635c)_0x1668b8[_0x20f628(0x1d2)]=![],_0x1668b8['classList'][_0x20f628(0x1d8)](_0x20f628(0x1b7),'cursor-not-allowed'),document['getElementById'](_0x20f628(0x183))['classList'][_0x20f628(0x1ea)](_0x20f628(0x169));else{_0x1668b8['disabled']=!![],_0x1668b8[_0x20f628(0x13b)][_0x20f628(0x1ea)](_0x20f628(0x1b7),'cursor-not-allowed');if(_0x12fdcf>_0x58635c)document['getElementById'](_0x20f628(0x183))[_0x20f628(0x1b9)]=_0x20f628(0x172)+_0x58635c+')',document['getElementById'](_0x20f628(0x183))['classList'][_0x20f628(0x1d8)](_0x20f628(0x169));else _0x12fdcf<=0x0&&document['getElementById'](_0x20f628(0x183))[_0x20f628(0x13b)][_0x20f628(0x1ea)](_0x20f628(0x169));}};function fireConfetti(){const _0x202122=_0x4c92d7;typeof confetti===_0x202122(0x219)&&confetti({'particleCount':0x96,'spread':0x46,'origin':{'y':0.6},'colors':[_0x202122(0x1eb),_0x202122(0x113),'#FF4500',_0x202122(0x19f),'#0000FF']});}function createWinnerCard(_0x5eda4c,_0xe6f1,_0x3eaad0){const _0x80573b=_0x4c92d7,_0x13b294=document[_0x80573b(0x18c)](_0x80573b(0x101));_0x13b294[_0x80573b(0x22a)]=_0x80573b(0x160);const _0x189e25=_0x5eda4c[_0x80573b(0x1bf)]||_0x80573b(0x149)+(_0x5eda4c[_0x80573b(0x22c)]?_0x5eda4c[_0x80573b(0x22c)][_0x80573b(0xf8)](0x0,0xa):_0x80573b(0x240))+_0x80573b(0x1f8);return _0x13b294[_0x80573b(0x13d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-4\x20z-10\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex-shrink-0\x20w-10\x20h-10\x20bg-gradient-to-br\x20from-yellow-400\x20to-orange-600\x20rounded-full\x20flex\x20items-center\x20justify-center\x20text-white\x20font-bold\x20text-lg\x20shadow-md\x20ring-2\x20ring-yellow-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xe6f1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-bold\x20text-slate-800\x20truncate\x20leading-tight\x22>'+_0x189e25+_0x80573b(0x223)+_0x3eaad0+_0x80573b(0x1bc),_0x13b294;}function addHistoryLog(_0x143fcc,_0x112207){}function _0x2180(_0x172d59,_0x4f8686){_0x172d59=_0x172d59-0xf8;const _0x12ff56=_0x12ff();let _0x2180c9=_0x12ff56[_0x172d59];return _0x2180c9;}window[_0x4c92d7(0x17c)][_0x4c92d7(0x21f)]=()=>{},window['app'][_0x4c92d7(0xfd)]=async()=>{const _0x4c5882=_0x4c92d7;if(state[_0x4c5882(0x1b3)])return;const _0x58fe4f=document[_0x4c5882(0x17d)](_0x4c5882(0x1be)),_0x5aad53=_0x58fe4f[_0x4c5882(0x1fa)][_0x58fe4f[_0x4c5882(0x1db)]]?.[_0x4c5882(0xff)],_0x3efbcd=parseInt(document[_0x4c5882(0x17d)]('input-draw-qty')[_0x4c5882(0x1a6)]),_0x4179cd=parseInt(_0x58fe4f[_0x4c5882(0x1fa)][_0x58fe4f[_0x4c5882(0x1db)]][_0x4c5882(0x245)](_0x4c5882(0x19e))),_0x2402b4=state[_0x4c5882(0x13a)]['filter'](_0x2dec7c=>_0x2dec7c[_0x4c5882(0x1c3)]===_0x5aad53)[_0x4c5882(0x248)],_0x47b9d4=_0x4179cd-_0x2402b4;if(!_0x5aad53)return window[_0x4c5882(0x17c)][_0x4c5882(0x225)]('แจ้งเตือน',_0x4c5882(0x15b));if(_0x3efbcd<0x1)return window[_0x4c5882(0x17c)][_0x4c5882(0x225)](_0x4c5882(0x141),'จำนวนต้องมากกว่า\x200');if(_0x3efbcd>_0x47b9d4)return window[_0x4c5882(0x17c)][_0x4c5882(0x225)](_0x4c5882(0x141),'ของรางวัลมีไม่พอสำหรับการสุ่ม\x20(คงเหลือ\x20'+_0x47b9d4+_0x4c5882(0x1a9));const _0x216a26=state[_0x4c5882(0x13a)][_0x4c5882(0x121)](_0x1a64a3=>_0x1a64a3[_0x4c5882(0x193)]&&_0x1a64a3[_0x4c5882(0x193)][_0x4c5882(0x112)]()!==''&&!_0x1a64a3[_0x4c5882(0x1c3)]);if(_0x216a26['length']===0x0)return window[_0x4c5882(0x17c)]['showModal'](_0x4c5882(0x141),'ไม่มีผู้มีสิทธิ์ลุ้นรางวัลเหลืออยู่');if(_0x216a26[_0x4c5882(0x248)]<_0x3efbcd){if(!confirm(_0x4c5882(0x15f)+_0x216a26[_0x4c5882(0x248)]+'\x20คน\x20ต้องการสุ่มทั้งหมดหรือไม่?'))return;}state[_0x4c5882(0x1b3)]=!![];const _0x3590ad=document[_0x4c5882(0x17d)](_0x4c5882(0x1f5));_0x3590ad[_0x4c5882(0x1d2)]=!![],_0x3590ad['classList']['add'](_0x4c5882(0x1b7),_0x4c5882(0x111)),document['getElementById'](_0x4c5882(0x1de))[_0x4c5882(0x1b9)]=_0x5aad53,document[_0x4c5882(0x17d)](_0x4c5882(0x1d9))['innerHTML']='';const _0x2dc66f=document[_0x4c5882(0x17d)](_0x4c5882(0x103));_0x2dc66f[_0x4c5882(0x13b)][_0x4c5882(0x1d8)](_0x4c5882(0x169)),await new Promise(_0x164590=>setTimeout(_0x164590,0x3e8)),_0x2dc66f[_0x4c5882(0x13b)][_0x4c5882(0x1ea)](_0x4c5882(0x169));const _0x2a1a8b=_0x216a26[_0x4c5882(0x226)](()=>0.5-Math[_0x4c5882(0x155)]())[_0x4c5882(0x206)](0x0,_0x3efbcd);for(let _0x3bf14c=0x0;_0x3bf14c<_0x2a1a8b[_0x4c5882(0x248)];_0x3bf14c++){const _0x24fbd1=_0x2a1a8b[_0x3bf14c],_0x1f4d26=createWinnerCard(_0x24fbd1,_0x3bf14c+0x1,_0x5aad53),_0x423eba=document[_0x4c5882(0x17d)](_0x4c5882(0x1d9));_0x423eba[_0x4c5882(0x210)](_0x1f4d26),_0x423eba[_0x4c5882(0x17b)]=_0x423eba[_0x4c5882(0x15e)];if(window[_0x4c5882(0x17a)])lucide['createIcons']();fireConfetti();try{await updateDoc(doc(db,finalCollectionPath,_0x24fbd1['id']),{'reward':_0x5aad53,'rewardTime':serverTimestamp()});}catch(_0x2025a0){console[_0x4c5882(0x185)](_0x4c5882(0x11b),_0x2025a0);}_0x3bf14c<_0x2a1a8b[_0x4c5882(0x248)]-0x1&&await new Promise(_0xc925e7=>setTimeout(_0xc925e7,0xbb8));}state[_0x4c5882(0x1b3)]=![],window['app'][_0x4c5882(0x10f)](),window[_0x4c5882(0x17c)]['showToast'](_0x4c5882(0x209),_0x4c5882(0x1fc));},setInterval(()=>{const _0x678676=_0x4c92d7;document[_0x678676(0x17d)]('current-time')[_0x678676(0x1b9)]=new Date()[_0x678676(0x129)]('th-TH');},0x3e8);async function init(){const _0x47287c=_0x4c92d7;try{typeof __initial_auth_token!==_0x47287c(0x1b1)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);document[_0x47287c(0x17d)](_0x47287c(0x186))[_0x47287c(0x13b)][_0x47287c(0x1d8)](_0x47287c(0x1bb)),document['getElementById'](_0x47287c(0x186))[_0x47287c(0x13b)][_0x47287c(0x1ea)]('bg-green-500'),document[_0x47287c(0x17d)]('status-text')[_0x47287c(0x1b9)]=_0x47287c(0x179),document[_0x47287c(0x17d)]('status-text')[_0x47287c(0x13b)]['replace'](_0x47287c(0x1b2),_0x47287c(0x118));const _0x51e57c=query(collection(db,finalCollectionPath));onSnapshot(_0x51e57c,_0x3fd75d=>{processSnapshot(_0x3fd75d);},_0x2610ad=>{const _0x4aa4ed=_0x47287c;console[_0x4aa4ed(0x185)](_0x4aa4ed(0x22e),_0x2610ad);});const _0x680a9=query(collection(db,prizesCollectionPath));onSnapshot(_0x680a9,_0x1cb916=>{processPrizesSnapshot(_0x1cb916);});}catch(_0xf4fcae){console[_0x47287c(0x185)]('Initialization\x20Error:',_0xf4fcae);}}init();if(window[_0x4c92d7(0x17a)])lucide[_0x4c92d7(0x126)]();

    </script>
</body>
</html>