<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Lightbox/Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        /* Toast Animation */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        /* Compact Table Rows */
        .table-compact td {
            padding-top: 4px;
            padding-bottom: 4px;
            height: 24px;
        }

        /* Custom Scroll for Dark Area */
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
        
        /* Winner Card Animation */
        @keyframes cardSlideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .winner-card-enter {
            animation: cardSlideIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="play-circle" width="20"></i> จับรางวัล (Randomizer)
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-700 text-white transition-all hover:bg-slate-700">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckIN
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckOUT
                </button>
            </div>

            <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all border-t border-slate-700 mt-2 pt-4">
                <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
            </button>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Top Bar -->
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ข้อมูลลงทะเบียน</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">
                    A
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD OVERVIEW -->
            <div id="view-dashboard" class="view-section hidden space-y-6 fade-in-up">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="users" width="60" height="60" class="text-blue-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนเข้า</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-green-500 text-xs mt-2 flex items-center gap-1"><i data-lucide="arrow-up" width="12"></i> Update Real-time</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="log-out" width="60" height="60" class="text-orange-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนออก</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <div class="w-full bg-orange-100 rounded-full h-1.5 mt-3">
                            <div id="bar-checkout" class="bg-orange-500 h-1.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- NEW: Not Rewarded Box -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="frown" width="60" height="60" class="text-slate-400"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ผู้ไม่ได้รางวัล</p>
                        <h3 id="stat-noreward" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-slate-400 text-xs mt-2">สุ่มแล้วไม่ได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="gift" width="60" height="60" class="text-purple-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ได้รับรางวัลแล้ว</p>
                        <h3 id="stat-rewarded" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p id="stat-eligible" class="text-slate-400 text-xs mt-2">สุ่มและได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="check-square" width="60" height="60" class="text-green-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ยืนยันรับรางวัลแล้ว</p>
                        <h3 id="stat-claimed" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <!-- Charts & Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <!-- Left Column: Two Charts Stacked -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Chart Check-IN -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียนเข้า (Check-IN)
                                </h3>
                                <span class="text-2xl font-bold text-indigo-600" id="chart-total-checkin">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="registrationChart"></canvas>
                            </div>
                        </div>
                        <!-- Chart Check-OUT -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-orange-500 rounded-full"></div> สถิติการลงทะเบียนออก (Check-OUT)
                                </h3>
                                <span class="text-2xl font-bold text-orange-600" id="chart-total-checkout">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="checkoutChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Recent Activity (Full Height) -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1">
                            <!-- Activity Items injected here -->
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZE MANAGEMENT -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Form -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="plus-circle" width="20" class="text-indigo-600"></i> เพิ่ม/แก้ไข ของรางวัล
                        </h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                                    <input type="number" id="prize-qty" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition">บันทึกข้อมูล</button>
                        </form>
                    </div>

                    <!-- List -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-200 text-slate-700 font-bold">
                                    <tr>
                                        <th class="px-4 py-3 rounded-l-lg">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">รางวัลที่จะสุ่ม</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right rounded-r-lg">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y divide-slate-100">
                                    <tr><td colspan="4" class="text-center py-4 text-slate-400">กำลังโหลด...</td></tr>
                                </tbody>
                                <tfoot class="bg-slate-100 font-bold text-slate-700">
                                    <tr>
                                        <td class="px-4 py-3 text-right" colspan="2">รวมสิทธิ์ทั้งหมด:</td>
                                        <td class="px-4 py-3 text-center text-indigo-600" id="total-prize-quota">0</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER SYSTEM -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <!-- Box 1 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-blue-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 2 (Eligible/Total Status Valid) -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-indigo-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้มีสิทธิ์สุ่มรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 3 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-slate-400">
                        <p class="text-slate-500 text-xs font-medium">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 4 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-red-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วไม่ได้รางวัล</p>
                        <h3 id="rand-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 5 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-green-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วได้รางวัล</p>
                        <h3 id="rand-stat-claimed" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                    <!-- Left: Control Panel -->
                    <div class="lg:col-span-4 space-y-6">
                        <!-- Setup Card -->
                        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-100">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                                <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600"><i data-lucide="settings-2" width="20"></i></div>
                                ตั้งค่าการสุ่ม
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">เลือกของรางวัล</label>
                                    <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none bg-white">
                                        <option value="">-- กรุณาเลือก --</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนผู้โชคดี (คน)</label>
                                    <div class="flex items-center gap-4">
                                        <input type="number" id="input-draw-qty" value="1" min="1" max="50" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-center text-lg">
                                        <span class="text-slate-400 text-sm whitespace-nowrap">คน / รอบ</span>
                                    </div>
                                    <p class="text-xs text-orange-500 mt-1 hidden" id="qty-warning">จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ!</p>
                                </div>
                                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">คงเหลือในสต็อก</span>
                                        <span id="label-stock-count" class="font-bold text-orange-600 text-lg">0</span>
                                    </div>
                                     <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span>
                                        <span id="label-eligible-count" class="font-bold text-indigo-600 text-lg">0</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-1.5">
                                        <div class="bg-indigo-500 h-1.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-2">*เฉพาะผู้ที่สถานะไม่ว่างและยังไม่เคยได้รางวัล</p>
                                </div>
                                <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all transform active:scale-95 flex items-center justify-center gap-2 text-lg opacity-50 cursor-not-allowed">
                                    <i data-lucide="play" width="24" class="fill-current"></i> เริ่มสุ่มรางวัล
                                </button>
                            </div>
                        </div>
                        
                        <!-- History Log Box REMOVED as requested -->
                        
                    </div>
                    <!-- Right: Big Screen Display Area -->
                    <div class="lg:col-span-8">
                        <div class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 rounded-3xl h-[650px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700/50">
                             <!-- Header inside screen -->
                            <div class="relative z-10 flex justify-between items-start mb-8 border-b border-white/10 pb-4">
                                <div>
                                    <h1 id="screen-prize-title" class="text-xg font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200 drop-shadow-md">
                                        ระบบสุ่มรางวัล
                                    </h1>
                                </div>
                                <!-- Status removed as requested -->
                            </div>
                            <!-- Display Grid -->
                            <div id="screen-display-area" class="relative z-10 flex-1 grid grid-cols-1 content-start gap-4 overflow-y-auto custom-scroll-dark px-2 pb-4">
                                <div class="text-center text-slate-500/50 flex flex-col items-center justify-center h-full">
                                    <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm">
                                        <i data-lucide="gift" width="40" height="40" class="text-white/20"></i>
                                    </div>
                                    <p class="text-white/40 font-light text-xm">พร้อมสำหรับการจับรางวัล</p>
                                </div>
                            </div>
                            <!-- Controls overlay -->
                            <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/80 backdrop-blur-sm z-20 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                    <h2 class="text-2xl font-bold tracking-tight">กำลังประมวลผล...</h2>
                                    <p class="text-blue-300 mt-2">กรุณารอสักครู่</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: LIVE RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- 1. Total DB -->
                    <div class="bg-gradient-to-br from-gray-600 to-gray-700 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-gray-200 text-xs">สมาชิกทั้งหมดในระบบ</p>
                        <h3 id="monitor-total-db" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 2. Registered (Status valid) -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-blue-100 text-xs">สมาชิกที่ลงทะเบียน (Active)</p>
                        <h3 id="monitor-registered" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 3. Draws -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-purple-100 text-xs">จำนวนรางวัลที่แจกแล้ว</p>
                        <h3 id="monitor-draws" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 4. Rewarded -->
                    <div class="bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-green-100 text-xs">สมาชิกที่ได้รางวัลแล้ว</p>
                        <h3 id="monitor-rewarded" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 5. No Reward -->
                    <div class="bg-gradient-to-br from-slate-500 to-slate-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-slate-200 text-xs">สมาชิกที่ไม่ได้รางวัล</p>
                        <h3 id="monitor-noreward" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                </div>
                <!-- Table -->
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 bg-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-slate-800">รายการผู้โชคดี (Real-time)</h3>
                        <select id="filter-results-status" onchange="window.app.renderResults()" class="bg-white border border-slate-300 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                            <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                            <option value="unclaimed">ผู้ที่ยังไม่รับรางวัล</option>
                            <option value="claimed">ผู้ที่รับรางวัลแล้ว</option>
                            <option value="no_reward">ผู้ที่ไม่ได้รับรางวัล</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-6 py-4">ลำดับ</th>
                                    <th class="px-6 py-4">ชื่อ-นามสกุล</th>
                                    <th class="px-6 py-4">รางวัลที่ได้</th>
                                    <th class="px-6 py-4">เวลาที่สุ่มได้</th>
                                    <th class="px-6 py-4">สถานะการรับรางวัล</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE -->
            <div id="view-data" class="view-section space-y-6 fade-in-up">
                 <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-end">
                             <select id="sort-by" onchange="window.app.changeSort(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="CheckIN">เรียงตาม Check-In</option>
                                <option value="CheckOUT">เรียงตาม Check-Out</option>
                                <option value="reward">เรียงตามของรางวัล</option>
                                <option value="EmpName">เรียงตามชื่อ-นามสกุล</option>
                             </select>
                             <select id="sort-order" onchange="window.app.changeSortOrder(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="desc">มาก -> น้อย (ล่าสุด/Z-A)</option>
                                <option value="asc">น้อย -> มาก (เก่าสุด/A-Z)</option>
                             </select>
                             <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="20">20 แถว</option>
                                <option value="50" selected>50 แถว</option>
                                <option value="100">100 แถว</option>
                                <option value="500">500 แถว</option>
                                <option value="99999">ทั้งหมด</option>
                             </select>
                             <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100 text-sm">
                                <tr>
                                    <th class="px-6 py-2">#</th>
                                    <th class="px-6 py-2">ชื่อ-นามสกุล (EmpName)</th>
                                    <th class="px-6 py-2">Check-In</th>
                                    <th class="px-6 py-2">Check-Out</th>
                                    <th class="px-6 py-2">ของรางวัล</th>
                                    <th class="px-6 py-2">สถานะรับรางวัล</th>
                                    <th class="px-6 py-2 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100 text-sm"></tbody>
                        </table>
                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex justify-between items-center">
                            <p class="text-xs text-slate-400" id="data-table-info">แสดงผล...</p>
                            <div class="flex gap-2" id="pagination-controls">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-prev">Previous</button>
                                <span class="text-xs self-center font-bold text-slate-600" id="page-indicator">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: IMPORT / MANAGE DATA -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Import Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูล (JSON/CSV)
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">
                            รองรับไฟล์ JSON ที่มีฟิวด์ <code>citizenId</code> ระบบจะทำการแปลง Citizen ID เป็นรหัส Hash (SHA-256) โดยอัตโนมัติก่อนบันทึก
                        </p>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:bg-slate-50 transition cursor-pointer" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                                <p class="text-sm font-medium text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากไฟล์มาวางที่นี่</p>
                                <p class="text-xs text-slate-400 mt-1">รองรับ .json, .csv</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700">
                                <span id="file-name">filename.json</span>
                                <button onclick="window.app.clearFileSelection()" class="text-blue-500 hover:text-blue-700"><i data-lucide="x" width="16"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                เริ่มนำเข้าข้อมูล
                            </button>
                            <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5">
                                <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Database Management Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="database" width="20" class="text-slate-600"></i> ข้อมูลระบบ
                        </h3>
                        
                        <div class="bg-slate-50 p-4 rounded-xl mb-6 flex justify-between items-center">
                            <div>
                                <p class="text-sm text-slate-500">จำนวนข้อมูลทั้งหมด (Records)</p>
                                <h2 class="text-2xl font-bold text-slate-800 mt-1" id="manage-total-docs">0</h2>
                            </div>
                            <div class="bg-white p-3 rounded-full shadow-sm text-slate-400">
                                <i data-lucide="hard-drive" width="24"></i>
                            </div>
                        </div>

                        <div class="border-t border-slate-100 pt-6 space-y-4">
                            <h4 class="font-bold text-red-600 mb-2 flex items-center gap-2"><i data-lucide="alert-octagon" width="18"></i> Danger Zone</h4>
                            
                            <!-- Reset Registration Status -->
                             <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                <p class="text-sm font-bold text-orange-800 mb-1">รีเซ็ตการลงทะเบียน (Reset Status)</p>
                                <p class="text-xs text-orange-600 mb-3">ล้างสถานะ Check-In, Check-Out และการรับรางวัลทั้งหมด แต่เก็บข้อมูลรายชื่อพนักงานไว้</p>
                                <button onclick="window.app.openResetModal()" class="w-full border border-orange-300 text-orange-700 hover:bg-orange-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="rotate-ccw" width="16"></i> รีเซ็ตสถานะ (Clear Transaction)
                                </button>
                            </div>

                            <!-- Delete All Data -->
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                                <p class="text-sm font-bold text-red-800 mb-1">ลบข้อมูลทั้งหมด (Delete All)</p>
                                <p class="text-xs text-red-600 mb-3">ลบข้อมูลพนักงานและการลงทะเบียนทั้งหมดออกจากระบบ ไม่สามารถกู้คืนได้</p>
                                <button onclick="window.app.deleteAllData()" class="w-full border border-red-300 text-red-700 hover:bg-red-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="trash-2" width="16"></i> ลบข้อมูลทั้งหมด (Clear DB)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- VIEW 7: QR Code CheckIN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2">ลงทะเบียนเข้าประชุม (Check-IN)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนเข้าร่วมงาน</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-login.png" alt="Check-IN QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmb-coop-line.html</p>
                    <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

            <!-- VIEW 8: QR Code CheckOUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-orange-600 mb-2">ลงทะเบียนออก (Check-OUT)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนออกและลุ้นรางวัล</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-out.png" alt="Check-OUT QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmbcoop-outrandom-line.html</p>
                     <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

        </div>
    </main>

    <!-- Modal: Edit Prize -->
    <div id="edit-prize-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4 border-b border-slate-100 pb-2">
                <h3 class="text-lg font-bold text-slate-800">แก้ไขของรางวัล</h3>
                <button onclick="window.app.closeEditPrizeModal()" class="text-slate-400 hover:text-slate-600">
                    <i data-lucide="x" width="24"></i>
                </button>
            </div>
            <form id="edit-prize-form" onsubmit="window.app.handlePrizeUpdate(event)" class="space-y-4">
                <input type="hidden" id="edit-prize-id">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                    <input type="text" id="edit-prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                        <input type="number" id="edit-prize-qty" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                        <input type="number" id="edit-prize-total" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                </div>
                
                <div class="flex gap-3 pt-2">
                    <button type="button" onclick="window.app.closeEditPrizeModal()" class="flex-1 py-3 rounded-xl text-slate-600 bg-slate-100 hover:bg-slate-200 font-bold transition">ยกเลิก</button>
                    <button type="submit" class="flex-1 py-3 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 font-bold transition">บันทึก</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- General Modal -->
    <div id="general-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500">
                <i data-lucide="alert-circle" width="24"></i>
            </div>
            <h3 id="general-modal-title" class="text-lg font-bold text-slate-800 mb-2">แจ้งเตือน</h3>
            <p id="general-modal-message" class="text-slate-500 text-sm mb-6">ข้อความแจ้งเตือน</p>
            <button onclick="window.app.closeGeneralModal()" class="w-full py-2.5 rounded-xl bg-slate-800 text-white font-bold hover:bg-slate-900 transition">ตกลง</button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600">
                <i data-lucide="alert-triangle" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ยืนยันการรีเซ็ต?</h3>
            <p class="text-slate-500 text-sm mb-6">
                ระบบจะล้างข้อมูลการลงทะเบียน (Check-In/Out) และประวัติการรับรางวัลทั้งหมด <br>
                <span class="font-bold text-orange-600">แต่จะเก็บรายชื่อพนักงานไว้</span>
            </p>
            <div class="flex gap-3">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition">ยืนยันรีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
const _0x35147a=_0x6744;(function(_0x1df2a9,_0x2597dc){const _0x3f56c4=_0x6744,_0x2d35b9=_0x1df2a9();while(!![]){try{const _0x5f5db3=-parseInt(_0x3f56c4(0x180))/0x1*(parseInt(_0x3f56c4(0xae))/0x2)+-parseInt(_0x3f56c4(0xe1))/0x3+-parseInt(_0x3f56c4(0x116))/0x4+parseInt(_0x3f56c4(0x1cb))/0x5+parseInt(_0x3f56c4(0x18e))/0x6*(-parseInt(_0x3f56c4(0x192))/0x7)+parseInt(_0x3f56c4(0x16a))/0x8+-parseInt(_0x3f56c4(0x18f))/0x9*(-parseInt(_0x3f56c4(0x1dd))/0xa);if(_0x5f5db3===_0x2597dc)break;else _0x2d35b9['push'](_0x2d35b9['shift']());}catch(_0x31d387){_0x2d35b9['push'](_0x2d35b9['shift']());}}}(_0x25a4,0x7f609));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x35147a(0x1b9),PRIZES_COLLECTION_NAME=_0x35147a(0x100),isSandboxEnv=typeof __firebase_config!=='undefined';let firebaseConfig,finalCollectionPath,prizesCollectionPath;function _0x25a4(){const _0x3348fc=['<span\x20class=\x22px-2\x20py-1\x20bg-yellow-100\x20text-yellow-700\x20rounded-full\x20text-xs\x22>ยังไม่รับรางวัล</span>','\x20รายการ\x20(เรียงตาม\x20','#f97316','CheckOUT','importedAt','chartOutInstance','remove','</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>','ลบข้อมูลทั้งหมดเรียบร้อย\x20(','Delete\x20Error','toDate','stat-eligible','querySelector','text-white','delete','text-blue-500','status-indicator','stats','searchTerm','forEach','label-stock-count','getElementById','</td><td\x20class=\x22px-6\x20font-medium\x20text-slate-700\x20text-base\x22>','sort','rand-stat-noreward','success','<div\x20class=\x22flex-1\x20text-sm\x20font-medium\x22>','<div\x20class=\x22text-blue-500\x22><i\x20data-lucide=\x22info\x22\x20width=\x2220\x22></i></div>','getAttribute','toLowerCase','เวลาออก','clearFileSelection','4799624ZAilhg','monitor-draws','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-4\x20z-10\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex-shrink-0\x20w-10\x20h-10\x20bg-gradient-to-br\x20from-yellow-400\x20to-orange-600\x20rounded-full\x20flex\x20items-center\x20justify-center\x20text-white\x20font-bold\x20text-lg\x20shadow-md\x20ring-2\x20ring-yellow-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','map','undefined','slice','ไม่พบข้อมูล','add','type','handleFileSelect','totalDocs','<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22><td\x20class=\x22px-4\x20py-3\x20font-medium\x20text-slate-700\x22>','\x20คน','stat-checkin','</td><td\x20class=\x22px-6\x22>','ภาพรวมระบบ','edit-prize-total','ref','ttb-register.firebasestorage.app','<div\x20class=\x22flex\x20items-start\x20gap-3\x20text-sm\x20p-2\x20rounded-lg\x20bg-slate-50\x20hover:bg-slate-100\x20transition\x22><div\x20class=\x22','general-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','8317mgodwr','\x20รายการ','screen-display-area','file-name','เกิดข้อผิดพลาดในการอัปเดต','<div\x20class=\x22text-center\x20text-slate-400\x20text-sm\x20py-8\x22>ยังไม่มีกิจกรรม</div>','\x20<span\x20class=\x22text-slate-400\x20font-normal\x22>(','Check-OUT','sortOrder','asc','date','data-qty','th-TH','openEditPrizeModal','42pLPMMg','6255IZeCxp','chartInInstance','text-slate-400','401485KcRnJS','rewardClaimTime','toLocaleString','registered','ไม่ได้รางวัล','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x22>','reduce','app','#view-import\x20button[onclick*=\x22deleteAll\x22]','</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-slate-500\x22>','monitor-rewarded','select-prize','bg-slate-700','Add\x20Prize\x20Error','</div><button\x20onclick=\x22this.parentElement.remove()\x22\x20class=\x22text-slate-400\x20hover:text-slate-600\x22><i\x20data-lucide=\x22x\x22\x20width=\x2216\x22></i></button>',':00','bg-white\x20border-l-4\x20border-red-500\x20text-slate-700','nav-','artifacts/','checkout','#view-import\x20button[onclick*=\x22openResetModal\x22]','btn-import','/public/data/coop_registrations',')</span></p><p\x20class=\x22text-[10px]\x20text-slate-400\x22>','getTime','translate-x-full','substring','isDrawing','claimed','showToast','manage-total-docs','เวลาเข้า','\x22\x20data-qty=\x22','<tr><td\x20colspan=\x224\x22\x20class=\x22text-center\x20py-4\x20text-slate-400\x22>ยังไม่มีข้อมูลของรางวัล</td></tr>','\x20(มากไปน้อย)','currentPage','general-modal-title','แจ้งเตือน','#FFD700','tmb_coop','\x20รางวัล)','rand-stat-claimed','ไม่ได้รับรางวัล','bg-green-500','onPrizeSelect','handleSearch','Delete\x20Prize\x20Error','แสดงผล\x20','classList','push','file-upload','notRewarded','message','prize-qty','QR\x20Code\x20ลงทะเบียนเข้า','showModal','commit','3827355YlwsDR','Update\x20Prize\x20Error','padStart','files','cursor-not-allowed','startRandomizer','datasets','btn-prev','validateRandomizerInput','เกิดข้อผิดพลาด:\x20','string','view-','EmpID','รีเซ็ตข้อมูลสำเร็จ\x20','file-info','toLocaleTimeString','preventDefault','บันทึกข้อมูลเรียบร้อย','17870wlspfk','กำลังประมวลผล...','btn-start-random','line','citizenId','notYetDrawn','registrationChart','ไม่มีผู้มีสิทธิ์ลุ้นรางวัลเหลืออยู่','max','hasAttribute','handlePrizeSubmit','recent-activity-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-400\x22>','<span\x20class=\x22font-bold\x20text-indigo-600\x22>','\x20(น้อยไปมาก)','</td><td\x20class=\x22px-6\x20font-medium\x20text-indigo-600\x20text-xs\x22>','lucide','filter-results-status','processImport','กำลังลบข้อมูล...','filter','changeSortOrder','options','qtyPerDraw','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','reward','ลบไม่สำเร็จ','disabled','prize-form','onload','changeRowsLimit','update','width','chart-total-checkin','deleteAllData','Reset\x20Error','การสุ่มเสร็จสิ้น!','parse','...</span>','import-progress','</td><td\x20class=\x22px-4\x20py-3\x20text-right\x22><button\x20onclick=\x22window.app.openEditPrizeModal(\x27','ของรางวัล','closeResetModal','closeGeneralModal','checkin','fileToImport','table-body','selectedIndex','<tr><td\x20colspan=\x225\x22\x20class=\x22px-6\x20py-8\x20text-center\x20text-slate-400\x22>ไม่พบข้อมูลตามเงื่อนไขที่เลือก</td></tr>','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','.csv','EmpName','ttb-register','86PxxBiu','split','\x20จากทั้งหมด\x20','import','rand-stat-total','closeEditPrizeModal','innerHTML','\x20mt-0.5\x22><i\x20data-lucide=\x22','Update\x20Error','status-text','bg-red-500','rewardTime','import-bar','drawnNoReward','.nav-item','function','Unknown','div','readAsText','changePage','label-eligible-count','name','data-total','พิมพ์\x20\x27DELETE\x27\x20เพื่อยืนยันการลบข้อมูลทั้งหมด','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับรางวัลแล้ว</span>','นำเข้าข้อมูลสำเร็จ\x20','monitor-noreward','drawnWon','opacity-0','#4B0082','results','getContext','...','changeSort','edit-prize-id','text','hidden','subtle','result','อัปเดตข้อมูลเรียบร้อย','edit-prize-modal','เกิดข้อผิดพลาดในการบันทึก','innerText','<span\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x22>ยังไม่รับรางวัล</span>','join','G-9DJLWJ5LQ1','opacity-50','CheckIN','.view-section','random','user-plus','2139873llaOTQ',')\x22\x20class=\x22text-blue-500\x20hover:text-blue-700\x20mr-2\x22><i\x20data-lucide=\x22edit-3\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button><button\x20onclick=\x22window.app.deletePrize(\x27','<span\x20class=\x22text-slate-400\x20italic\x22>ไม่ได้รับรางวัล</span>','</p></div></div>','ประกาศผลรางวัล','reset-confirm-modal','users','Snapshot\x20error:','<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x20table-compact\x20text-sm\x22><td\x20class=\x22px-6\x20text-slate-500\x22>','\x20รายการ)','rgba(249,\x20115,\x2022,\x200.1)','จากผู้มีสิทธิ์ลุ้น\x20','input-draw-qty','scrollHeight','exists','<div\x20class=\x22text-red-500\x22><i\x20data-lucide=\x22alert-circle\x22\x20width=\x2220\x22></i></div>','<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x22>ไม่ได้รางวัล</span>','ลงทะเบียนออก','prize-total','createIcons','edit-prize-name','querySelectorAll','replace','toLocaleDateString','info','trim','Online','className','stat-rewarded','total-prize-quota','/public/data/','coop_gift','contains','from','randomizer','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x22>รับแล้ว</span>','length','rand-stat-rewarded','data-table-info','DELETE','เกิดข้อผิดพลาดในการรีเซ็ต','QR\x20Code\x20ลงทะเบียนออก','data','confirmResetData','จัดการข้อมูล\x20(Import)','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button></td></tr>','status','เกิดข้อผิดพลาด','#4f46e5','ceil','#FF4500','no_reward','size','2452980IdzOqw','desc','sortBy','log-out','text-orange-500','createElement','renderResults','\x22\x20width=\x2216\x22></i></div><div\x20class=\x22text-slate-600\x22><p\x20class=\x22font-medium\x22>','จำนวนต้องมากกว่า\x200','rand-stat-eligible-view','จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ\x20(','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-mono\x20text-sm\x22>','ttb-register.firebaseapp.com','rowsPerPage','eligible','bg-white\x20border-l-4\x20border-blue-500\x20text-slate-700','ลบของรางวัลสำเร็จ','out','totalQty','rewarded','<span\x20class=\x22text-slate-400\x20text-xs\x20italic\x22>ID:\x20','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','bar-checkout','#FFA500','\x20คน\x20ต้องการสุ่มทั้งหมดหรือไม่?','qrcode-out','value','ต้องการลบของรางวัลนี้ใช่หรือไม่?','appendChild','page-indicator','ข้อมูลลงทะเบียน','switchTab','\x27,\x20','มีผู้มีสิทธิ์เพียง\x20','monitor-total-db','style','จัดการของรางวัล','toast-container','stat-claimed','toString','handlePrizeUpdate','ชื่อ','ID:\x20','page-title','Format\x20Invalid:\x20Root\x20must\x20be\x20an\x20array','unclaimed','openResetModal','getHours','error','ต้องการลบสถานะการลงทะเบียนของพนักงานท่านนี้ใช่หรือไม่?\x20(ข้อมูลรายชื่อจะยังคงอยู่)','edit-prize-qty','view-randomizer'];_0x25a4=function(){return _0x3348fc;};return _0x25a4();}if(isSandboxEnv){firebaseConfig=JSON[_0x35147a(0x202)](__firebase_config);const appId=typeof __app_id!==_0x35147a(0x16e)?__app_id:'default-app-id';finalCollectionPath=_0x35147a(0x1a4)+appId+_0x35147a(0x1a8),prizesCollectionPath='artifacts/'+appId+_0x35147a(0xff)+PRIZES_COLLECTION_NAME;}else firebaseConfig={'apiKey':_0x35147a(0xaa),'authDomain':_0x35147a(0x122),'databaseURL':_0x35147a(0x12b),'projectId':_0x35147a(0xad),'storageBucket':_0x35147a(0x17c),'messagingSenderId':'1070273157855','appId':'1:1070273157855:web:5c8120e1df27e233d8676a','measurementId':_0x35147a(0xdb)},finalCollectionPath=TARGET_COLLECTION_NAME,prizesCollectionPath=PRIZES_COLLECTION_NAME;const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notRewarded':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0},'isDrawing':![],'fileToImport':null,'rowsPerPage':0x32,'currentPage':0x1,'sortBy':'CheckIN','sortOrder':_0x35147a(0x117),'searchTerm':''};async function sha256(_0x1959ad){const _0x4c2685=_0x35147a,_0x2d105e=new TextEncoder()['encode'](_0x1959ad),_0x42dd33=await crypto[_0x4c2685(0xd3)]['digest']('SHA-256',_0x2d105e),_0x1583dd=Array[_0x4c2685(0x102)](new Uint8Array(_0x42dd33));return _0x1583dd['map'](_0x1c6d9d=>_0x1c6d9d[_0x4c2685(0x13d)](0x10)[_0x4c2685(0x1cd)](0x2,'0'))[_0x4c2685(0xda)]('');}window[_0x35147a(0x199)]=window['app']||{},window[_0x35147a(0x199)][_0x35147a(0x1af)]=(_0x40fc2d,_0x3afae9=_0x35147a(0x163))=>{const _0x35c1f4=_0x35147a,_0x5e1ec4=document[_0x35c1f4(0x15f)](_0x35c1f4(0x13b)),_0xa32adf=document[_0x35c1f4(0x11b)](_0x35c1f4(0xbf));let _0x3ac51f,_0x4ad44c;if(_0x3afae9==='success')_0x3ac51f='bg-white\x20border-l-4\x20border-green-500\x20text-slate-700',_0x4ad44c='<div\x20class=\x22text-green-500\x22><i\x20data-lucide=\x22check-circle\x22\x20width=\x2220\x22></i></div>';else _0x3afae9===_0x35c1f4(0x146)?(_0x3ac51f=_0x35c1f4(0x1a2),_0x4ad44c=_0x35c1f4(0xf0)):(_0x3ac51f=_0x35c1f4(0x125),_0x4ad44c=_0x35c1f4(0x165));_0xa32adf[_0x35c1f4(0xfc)]=_0x3ac51f+'\x20p-4\x20rounded-lg\x20shadow-lg\x20flex\x20items-start\x20gap-3\x20toast-enter\x20pointer-events-auto\x20transform\x20transition-all\x20duration-300',_0xa32adf[_0x35c1f4(0xb4)]=_0x4ad44c+_0x35c1f4(0x164)+_0x40fc2d+_0x35c1f4(0x1a0),_0x5e1ec4[_0x35c1f4(0x132)](_0xa32adf);if(window['lucide'])lucide['createIcons']();setTimeout(()=>{const _0x187dab=_0x35c1f4;_0xa32adf[_0x187dab(0x1c2)][_0x187dab(0x171)](_0x187dab(0xca),_0x187dab(0x1ab)),setTimeout(()=>_0xa32adf['remove'](),0x12c);},0xbb8);},window['app'][_0x35147a(0x1c9)]=(_0x3f6ec5,_0x85e710)=>{const _0x239d34=_0x35147a;document[_0x239d34(0x15f)](_0x239d34(0x1b6))[_0x239d34(0xd8)]=_0x3f6ec5,document[_0x239d34(0x15f)]('general-modal-message')['innerText']=_0x85e710,document['getElementById'](_0x239d34(0x17e))[_0x239d34(0x1c2)][_0x239d34(0x150)](_0x239d34(0xd2));},window[_0x35147a(0x199)][_0x35147a(0x208)]=()=>document[_0x35147a(0x15f)]('general-modal')[_0x35147a(0x1c2)][_0x35147a(0x171)](_0x35147a(0xd2)),window[_0x35147a(0x199)][_0x35147a(0x144)]=()=>document[_0x35147a(0x15f)]('reset-confirm-modal')[_0x35147a(0x1c2)][_0x35147a(0x150)](_0x35147a(0xd2)),window[_0x35147a(0x199)][_0x35147a(0x207)]=()=>document[_0x35147a(0x15f)](_0x35147a(0xe6))['classList'][_0x35147a(0x171)](_0x35147a(0xd2)),window['app'][_0x35147a(0x135)]=_0x40d9c7=>{const _0x56686f=_0x35147a;document[_0x56686f(0xf6)](_0x56686f(0xde))[_0x56686f(0x15d)](_0x103f6f=>_0x103f6f[_0x56686f(0x1c2)][_0x56686f(0x171)]('hidden')),document[_0x56686f(0x15f)](_0x56686f(0x1d6)+_0x40d9c7)[_0x56686f(0x1c2)][_0x56686f(0x150)](_0x56686f(0xd2)),document[_0x56686f(0xf6)](_0x56686f(0xbc))[_0x56686f(0x15d)](_0x5365b6=>{const _0x3dd2e3=_0x56686f;_0x5365b6['classList'][_0x3dd2e3(0x150)](_0x3dd2e3(0x19e),_0x3dd2e3(0x157)),_0x5365b6['classList']['add'](_0x3dd2e3(0x191));});const _0x5255c2=document[_0x56686f(0x15f)](_0x56686f(0x1a3)+_0x40d9c7);_0x5255c2['classList'][_0x56686f(0x150)]('text-slate-400'),_0x5255c2[_0x56686f(0x1c2)][_0x56686f(0x171)](_0x56686f(0x19e),_0x56686f(0x157));let _0x11d7ef=_0x56686f(0x179);if(_0x40d9c7===_0x56686f(0x103))_0x11d7ef='ระบบสุ่มรางวัล';if(_0x40d9c7==='prizes')_0x11d7ef=_0x56686f(0x13a);if(_0x40d9c7===_0x56686f(0xcc))_0x11d7ef=_0x56686f(0xe5);if(_0x40d9c7===_0x56686f(0x10b))_0x11d7ef=_0x56686f(0x134);if(_0x40d9c7===_0x56686f(0xb1))_0x11d7ef=_0x56686f(0x10d);if(_0x40d9c7==='qrcode-in')_0x11d7ef=_0x56686f(0x1c8);if(_0x40d9c7===_0x56686f(0x12f))_0x11d7ef=_0x56686f(0x10a);document[_0x56686f(0x15f)](_0x56686f(0x141))['innerText']=_0x11d7ef,_0x40d9c7===_0x56686f(0x103)&&window[_0x56686f(0x199)][_0x56686f(0x1be)]();},window[_0x35147a(0x199)][_0x35147a(0x1fb)]=_0x237040=>{const _0x55de8c=_0x35147a;state[_0x55de8c(0x123)]=parseInt(_0x237040),state['currentPage']=0x1,renderTable(state[_0x55de8c(0xe7)]);},window[_0x35147a(0x199)][_0x35147a(0xc1)]=_0x3da2ed=>{const _0x35732d=_0x35147a;state[_0x35732d(0x1b5)]+=_0x3da2ed,renderTable(state[_0x35732d(0xe7)]);},window[_0x35147a(0x199)][_0x35147a(0xcf)]=_0x5d85fd=>{const _0x342080=_0x35147a;state[_0x342080(0x118)]=_0x5d85fd,state[_0x342080(0x1b5)]=0x1,renderTable(state[_0x342080(0xe7)]);},window[_0x35147a(0x199)][_0x35147a(0x1f2)]=_0x2c511e=>{const _0x78c5ac=_0x35147a;state[_0x78c5ac(0x188)]=_0x2c511e,state[_0x78c5ac(0x1b5)]=0x1,renderTable(state[_0x78c5ac(0xe7)]);},window[_0x35147a(0x199)][_0x35147a(0x173)]=_0xbcaf79=>{const _0x18937c=_0x35147a,_0x499b2c=_0xbcaf79['target'][_0x18937c(0x1ce)][0x0];_0x499b2c&&(state[_0x18937c(0x20a)]=_0x499b2c,document[_0x18937c(0x15f)](_0x18937c(0x183))[_0x18937c(0xd8)]=_0x499b2c['name'],document['getElementById'](_0x18937c(0x1d9))[_0x18937c(0x1c2)][_0x18937c(0x150)](_0x18937c(0xd2)),document[_0x18937c(0x15f)](_0x18937c(0x1a7))[_0x18937c(0x1f8)]=![]);},window['app'][_0x35147a(0x169)]=()=>{const _0x12718f=_0x35147a;state[_0x12718f(0x20a)]=null,document[_0x12718f(0x15f)](_0x12718f(0x1c4))[_0x12718f(0x130)]='',document['getElementById'](_0x12718f(0x1d9))['classList'][_0x12718f(0x171)](_0x12718f(0xd2)),document[_0x12718f(0x15f)]('btn-import')['disabled']=!![];},window[_0x35147a(0x199)][_0x35147a(0x1bf)]=_0x3f03c8=>{const _0x1c9152=_0x35147a;state['searchTerm']=_0x3f03c8[_0x1c9152(0xfa)]()[_0x1c9152(0x167)](),state[_0x1c9152(0x1b5)]=0x1,renderTable(state[_0x1c9152(0xe7)]);},window['app'][_0x35147a(0x1ef)]=()=>{const _0x191858=_0x35147a;if(!state[_0x191858(0x20a)])return;const _0x5a779e=state['fileToImport'],_0xd753ce=new FileReader();document[_0x191858(0x15f)]('btn-import')['disabled']=!![],document[_0x191858(0x15f)](_0x191858(0x1a7))[_0x191858(0xd8)]=_0x191858(0x1de),document[_0x191858(0x15f)](_0x191858(0x204))['classList'][_0x191858(0x150)](_0x191858(0xd2)),_0xd753ce[_0x191858(0x1fa)]=async _0x3cb5c0=>{const _0xfbcdf6=_0x191858;try{let _0x22190f=[];const _0xc17b20=_0x3cb5c0['target'][_0xfbcdf6(0xd4)];_0x5a779e[_0xfbcdf6(0xc3)]['endsWith'](_0xfbcdf6(0xab))?_0x22190f=csvToJson(_0xc17b20):_0x22190f=JSON['parse'](_0xc17b20);if(!Array['isArray'](_0x22190f))throw new Error(_0xfbcdf6(0x142));const _0x52781f=_0x22190f[_0xfbcdf6(0x105)];let _0x349ad6=0x0;const _0x316f4c=0x190;for(let _0x13f566=0x0;_0x13f566<_0x52781f;_0x13f566+=_0x316f4c){const _0x221cd5=_0x22190f['slice'](_0x13f566,_0x13f566+_0x316f4c),_0x5731b0=writeBatch(db);for(const _0x1a349b of _0x221cd5){if(_0x1a349b['citizenId']){const _0x1401f0=_0x1a349b[_0xfbcdf6(0x1e1)][_0xfbcdf6(0x13d)]()['replace'](/-/g,'')[_0xfbcdf6(0xfa)](),_0x2ce710=await sha256(_0x1401f0),_0x4e0a96=doc(collection(db,finalCollectionPath));_0x5731b0['set'](_0x4e0a96,{..._0x1a349b,'citizenId':_0x2ce710,'importedAt':serverTimestamp()});}}await _0x5731b0[_0xfbcdf6(0x1ca)](),_0x349ad6+=_0x221cd5[_0xfbcdf6(0x105)];const _0x204a6=_0x349ad6/_0x52781f*0x64;document[_0xfbcdf6(0x15f)](_0xfbcdf6(0xba))[_0xfbcdf6(0x139)][_0xfbcdf6(0x1fd)]=_0x204a6+'%';}window[_0xfbcdf6(0x199)]['showToast'](_0xfbcdf6(0xc7)+_0x52781f+_0xfbcdf6(0x181),_0xfbcdf6(0x163)),window[_0xfbcdf6(0x199)]['clearFileSelection']();}catch(_0xb579c0){console[_0xfbcdf6(0x146)](_0xb579c0),window[_0xfbcdf6(0x199)][_0xfbcdf6(0x1af)](_0xfbcdf6(0x1d4)+_0xb579c0[_0xfbcdf6(0x1c6)],_0xfbcdf6(0x146));}finally{document['getElementById'](_0xfbcdf6(0x1a7))['disabled']=![],document[_0xfbcdf6(0x15f)]('btn-import')['innerText']='เริ่มนำเข้าข้อมูล',document[_0xfbcdf6(0x15f)](_0xfbcdf6(0x204))[_0xfbcdf6(0x1c2)]['add'](_0xfbcdf6(0xd2));}},_0xd753ce[_0x191858(0xc0)](_0x5a779e);},window['app'][_0x35147a(0x1ff)]=async()=>{const _0x12aaa3=_0x35147a,_0x5c3f70=prompt(_0x12aaa3(0xc5));if(_0x5c3f70!==_0x12aaa3(0x108))return;const _0xca4f94=document['querySelector'](_0x12aaa3(0x19a)),_0x5c2a3e=_0xca4f94[_0x12aaa3(0xb4)];_0xca4f94['disabled']=!![],_0xca4f94[_0x12aaa3(0xd8)]=_0x12aaa3(0x1f0);try{const _0x3c18e=query(collection(db,finalCollectionPath)),_0x206074=await getDocs(_0x3c18e),_0x3496d6=_0x206074[_0x12aaa3(0x115)];if(_0x3496d6===0x0){window[_0x12aaa3(0x199)][_0x12aaa3(0x1af)]('ไม่มีข้อมูลให้ลบ',_0x12aaa3(0xf9));return;}const _0x59b238=0x190,_0x53f964=[];let _0x208366=[];_0x206074[_0x12aaa3(0x15d)](_0x406bbe=>{const _0x108a4a=_0x12aaa3;_0x208366[_0x108a4a(0x1c3)](_0x406bbe),_0x208366[_0x108a4a(0x105)]>=_0x59b238&&(_0x53f964[_0x108a4a(0x1c3)](_0x208366),_0x208366=[]);});if(_0x208366[_0x12aaa3(0x105)]>0x0)_0x53f964['push'](_0x208366);for(const _0x3ef317 of _0x53f964){const _0x35a6b5=writeBatch(db);_0x3ef317[_0x12aaa3(0x15d)](_0x159329=>_0x35a6b5[_0x12aaa3(0x158)](_0x159329[_0x12aaa3(0x17b)])),await _0x35a6b5[_0x12aaa3(0x1ca)]();}window[_0x12aaa3(0x199)]['showToast'](_0x12aaa3(0x152)+_0x3496d6+_0x12aaa3(0xea),_0x12aaa3(0x163));}catch(_0x44692f){console['error'](_0x44692f),window[_0x12aaa3(0x199)][_0x12aaa3(0x1af)]('เกิดข้อผิดพลาดในการลบ',_0x12aaa3(0x146));}finally{_0xca4f94['disabled']=![],_0xca4f94[_0x12aaa3(0xb4)]=_0x5c2a3e;}},window[_0x35147a(0x199)][_0x35147a(0x10c)]=async()=>{const _0xceefe0=_0x35147a;window[_0xceefe0(0x199)]['closeResetModal']();const _0x1ac69a=document[_0xceefe0(0x156)](_0xceefe0(0x1a6)),_0x1c3639=_0x1ac69a[_0xceefe0(0xb4)];_0x1ac69a[_0xceefe0(0x1f8)]=!![],_0x1ac69a[_0xceefe0(0xd8)]=_0xceefe0(0x1de);try{const _0x429b5a=0x190;let _0x4d37a8=0x0;const _0x2f6e48=query(collection(db,finalCollectionPath)),_0x1414b9=await getDocs(_0x2f6e48),_0x9acbaf=[];let _0xa020d2=[];_0x1414b9[_0xceefe0(0x15d)](_0x2d46f7=>{const _0x45f137=_0xceefe0;_0xa020d2['push'](_0x2d46f7),_0xa020d2[_0x45f137(0x105)]>=_0x429b5a&&(_0x9acbaf[_0x45f137(0x1c3)](_0xa020d2),_0xa020d2=[]);});if(_0xa020d2[_0xceefe0(0x105)]>0x0)_0x9acbaf[_0xceefe0(0x1c3)](_0xa020d2);for(const _0x5183fb of _0x9acbaf){const _0x5b05c2=writeBatch(db);_0x5183fb[_0xceefe0(0x15d)](_0x5e54df=>{const _0x167944=_0xceefe0;_0x5b05c2[_0x167944(0x1fc)](_0x5e54df[_0x167944(0x17b)],{'CheckIN':deleteField(),'CheckOUT':deleteField(),'status':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'rewardClaimTime':deleteField(),'deviceId':deleteField(),'deviceUserAgent':deleteField()});}),await _0x5b05c2[_0xceefe0(0x1ca)](),_0x4d37a8+=_0x5183fb[_0xceefe0(0x105)];}window[_0xceefe0(0x199)][_0xceefe0(0x1af)](_0xceefe0(0x1d8)+_0x4d37a8+_0xceefe0(0x181),_0xceefe0(0x163));}catch(_0x276f30){console[_0xceefe0(0x146)](_0xceefe0(0x200),_0x276f30),window[_0xceefe0(0x199)][_0xceefe0(0x1af)](_0xceefe0(0x109),_0xceefe0(0x146));}finally{_0x1ac69a[_0xceefe0(0x1f8)]=![],_0x1ac69a[_0xceefe0(0xb4)]=_0x1c3639;}},window[_0x35147a(0x199)][_0x35147a(0x1e7)]=async _0x34fa9c=>{const _0x161820=_0x35147a;_0x34fa9c['preventDefault']();const _0x553152=document[_0x161820(0x15f)]('prize-name')[_0x161820(0x130)][_0x161820(0xfa)](),_0xb50155=parseInt(document[_0x161820(0x15f)](_0x161820(0x1c7))['value']),_0x3d2ee1=parseInt(document[_0x161820(0x15f)](_0x161820(0xf3))[_0x161820(0x130)]||0x1);if(!_0x553152||_0xb50155<0x1)return;try{await addDoc(collection(db,prizesCollectionPath),{'name':_0x553152,'qtyPerDraw':_0xb50155,'totalQty':_0x3d2ee1,'createdAt':serverTimestamp()}),document['getElementById'](_0x161820(0x1f9))['reset'](),window[_0x161820(0x199)][_0x161820(0x1af)](_0x161820(0x1dc),'success');}catch(_0x5ce242){console[_0x161820(0x146)](_0x161820(0x19f),_0x5ce242),window['app'][_0x161820(0x1af)](_0x161820(0xd7),_0x161820(0x146));}},window[_0x35147a(0x199)]['deletePrize']=async _0x26d8f2=>{const _0x28a90f=_0x35147a;if(!confirm(_0x28a90f(0x131)))return;try{await deleteDoc(doc(db,prizesCollectionPath,_0x26d8f2)),window[_0x28a90f(0x199)]['showToast'](_0x28a90f(0x126),'success');}catch(_0x25827d){console[_0x28a90f(0x146)](_0x28a90f(0x1c0),_0x25827d),window[_0x28a90f(0x199)][_0x28a90f(0x1af)](_0x28a90f(0x1f7),_0x28a90f(0x146));}},window[_0x35147a(0x199)][_0x35147a(0x18d)]=(_0x406bcf,_0x3fd832,_0x5d7d63,_0x254add)=>{const _0x828d0c=_0x35147a;document[_0x828d0c(0x15f)]('edit-prize-id')[_0x828d0c(0x130)]=_0x406bcf,document[_0x828d0c(0x15f)](_0x828d0c(0xf5))[_0x828d0c(0x130)]=_0x3fd832,document['getElementById'](_0x828d0c(0x148))['value']=_0x5d7d63,document['getElementById'](_0x828d0c(0x17a))[_0x828d0c(0x130)]=_0x254add||0x1,document[_0x828d0c(0x15f)](_0x828d0c(0xd6))[_0x828d0c(0x1c2)]['remove'](_0x828d0c(0xd2));},window[_0x35147a(0x199)][_0x35147a(0xb3)]=()=>document['getElementById']('edit-prize-modal')[_0x35147a(0x1c2)]['add'](_0x35147a(0xd2)),window[_0x35147a(0x199)][_0x35147a(0x13e)]=async _0x19b954=>{const _0x55b070=_0x35147a;_0x19b954[_0x55b070(0x1db)]();const _0x1ee2d0=document['getElementById'](_0x55b070(0xd0))[_0x55b070(0x130)],_0x1636e3=document[_0x55b070(0x15f)](_0x55b070(0xf5))[_0x55b070(0x130)][_0x55b070(0xfa)](),_0x199d87=parseInt(document[_0x55b070(0x15f)](_0x55b070(0x148))[_0x55b070(0x130)]),_0xd4faa3=parseInt(document[_0x55b070(0x15f)](_0x55b070(0x17a))['value']);if(!_0x1ee2d0||!_0x1636e3||_0x199d87<0x1)return;try{await updateDoc(doc(db,prizesCollectionPath,_0x1ee2d0),{'name':_0x1636e3,'qtyPerDraw':_0x199d87,'totalQty':_0xd4faa3}),window[_0x55b070(0x199)][_0x55b070(0xb3)](),window[_0x55b070(0x199)][_0x55b070(0x1af)](_0x55b070(0xd5),_0x55b070(0x163));}catch(_0x24a592){console[_0x55b070(0x146)](_0x55b070(0x1cc),_0x24a592),window[_0x55b070(0x199)][_0x55b070(0x1af)](_0x55b070(0x184),_0x55b070(0x146));}},window['app']['deleteSingleData']=async _0x494632=>{const _0x123ddc=_0x35147a;if(!confirm(_0x123ddc(0x147)))return;try{const _0x27f887=doc(db,finalCollectionPath,_0x494632),_0x2d022e=await getDoc(_0x27f887);if(!_0x2d022e[_0x123ddc(0xef)]()){window[_0x123ddc(0x199)]['showToast'](_0x123ddc(0x170),'error');return;}const _0x412e80=_0x2d022e[_0x123ddc(0x10b)](),_0x372770=[_0x123ddc(0x1d7),'EmpMember',_0x123ddc(0xac),'citizenId',_0x123ddc(0x14e)],_0xdbfbd5={};_0x372770[_0x123ddc(0x15d)](_0x263039=>{if(_0x412e80[_0x263039]!==undefined)_0xdbfbd5[_0x263039]=_0x412e80[_0x263039];}),await setDoc(_0x27f887,_0xdbfbd5),window[_0x123ddc(0x199)]['showToast']('รีเซ็ตสถานะเรียบร้อย',_0x123ddc(0x163));}catch(_0x2d929b){console[_0x123ddc(0x146)](_0x123ddc(0x153),_0x2d929b),window[_0x123ddc(0x199)][_0x123ddc(0x1af)](_0x123ddc(0x110),'error');}};function _0x6744(_0x44e9af,_0x895e27){_0x44e9af=_0x44e9af-0xa8;const _0x25a433=_0x25a4();let _0x67440d=_0x25a433[_0x44e9af];return _0x67440d;}function updateCharts(_0x53790b,_0x3ab125){const _0x2c8ded=_0x35147a,_0x398d39=document[_0x2c8ded(0x15f)](_0x2c8ded(0x1e3))[_0x2c8ded(0xcd)]('2d'),_0x12b20b=Array[_0x2c8ded(0x102)]({'length':0x18},(_0x5d7231,_0x3e137e)=>_0x3e137e+_0x2c8ded(0x1a1)),_0x19d3be=_0x12b20b[_0x2c8ded(0x16d)]((_0x5b7bf1,_0x587b85)=>_0x53790b[_0x587b85]||0x0);window[_0x2c8ded(0x190)]?(window[_0x2c8ded(0x190)][_0x2c8ded(0x10b)][_0x2c8ded(0x1d1)][0x0][_0x2c8ded(0x10b)]=_0x19d3be,window[_0x2c8ded(0x190)][_0x2c8ded(0x1fc)]()):window[_0x2c8ded(0x190)]=new Chart(_0x398d39,{'type':_0x2c8ded(0x1e0),'data':{'labels':_0x12b20b,'datasets':[{'label':'Check-IN','data':_0x19d3be,'borderColor':_0x2c8ded(0x111),'backgroundColor':'rgba(79,\x2070,\x20229,\x200.1)','fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});const _0x124749=document[_0x2c8ded(0x15f)]('checkoutChart')[_0x2c8ded(0xcd)]('2d'),_0x123743=_0x12b20b['map']((_0x34982f,_0x838780)=>_0x3ab125[_0x838780]||0x0);window['chartOutInstance']?(window[_0x2c8ded(0x14f)][_0x2c8ded(0x10b)][_0x2c8ded(0x1d1)][0x0]['data']=_0x123743,window[_0x2c8ded(0x14f)][_0x2c8ded(0x1fc)]()):window[_0x2c8ded(0x14f)]=new Chart(_0x124749,{'type':_0x2c8ded(0x1e0),'data':{'labels':_0x12b20b,'datasets':[{'label':_0x2c8ded(0x187),'data':_0x123743,'borderColor':_0x2c8ded(0x14c),'backgroundColor':_0x2c8ded(0xeb),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function processSnapshot(_0x3a7079){const _0x6332ce=_0x35147a,_0x18c7ba=[],_0x1745ff=[],_0x24f569={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0};_0x24f569[_0x6332ce(0x174)]=_0x3a7079[_0x6332ce(0x115)];const _0x52addf={},_0x3beac5={};_0x3a7079[_0x6332ce(0x15d)](_0x4782e3=>{const _0x17784b=_0x6332ce,_0x476703=_0x4782e3[_0x17784b(0x10b)](),_0x3c766e={'id':_0x4782e3['id'],..._0x476703};_0x18c7ba[_0x17784b(0x1c3)](_0x3c766e);if(_0x476703[_0x17784b(0xdd)]){_0x24f569[_0x17784b(0x209)]++;const _0x2102d9=_0x476703[_0x17784b(0xdd)][_0x17784b(0x154)]?_0x476703['CheckIN']['toDate']():new Date(_0x476703[_0x17784b(0xdd)]),_0x4c9e65=_0x2102d9[_0x17784b(0x145)]();_0x52addf[_0x4c9e65]=(_0x52addf[_0x4c9e65]||0x0)+0x1;}if(_0x476703[_0x17784b(0x14d)]){_0x24f569[_0x17784b(0x1a5)]++;const _0x58caca=_0x476703[_0x17784b(0x14d)]['toDate']?_0x476703['CheckOUT']['toDate']():new Date(_0x476703['CheckOUT']),_0x1558c1=_0x58caca[_0x17784b(0x145)]();_0x3beac5[_0x1558c1]=(_0x3beac5[_0x1558c1]||0x0)+0x1;}_0x476703[_0x17784b(0x1f6)]&&(_0x476703[_0x17784b(0x1f6)]===_0x17784b(0x1bc)?_0x24f569[_0x17784b(0x1c5)]++:(_0x24f569[_0x17784b(0x129)]++,_0x1745ff[_0x17784b(0x1c3)](_0x3c766e)));if(_0x476703['rewardClaimTime'])_0x24f569[_0x17784b(0x1ae)]++;if(_0x476703[_0x17784b(0x10f)]&&_0x476703[_0x17784b(0x10f)]['trim']()!==''){_0x24f569[_0x17784b(0x195)]++,_0x24f569[_0x17784b(0x124)]++;if(!_0x476703['reward'])_0x24f569[_0x17784b(0x1e2)]++;else _0x476703[_0x17784b(0x1f6)]===_0x17784b(0x196)?_0x24f569[_0x17784b(0xbb)]++:_0x24f569['drawnWon']++;}}),_0x18c7ba[_0x6332ce(0x161)]((_0x181f1e,_0x26e820)=>{return 0x0;}),state[_0x6332ce(0xe7)]=_0x18c7ba,state['stats']=_0x24f569,updateDashboardUI(_0x24f569),updateCharts(_0x52addf,_0x3beac5),renderActivityFeed(_0x18c7ba),renderTable(_0x18c7ba),window[_0x6332ce(0x199)]['renderResults'](),document['getElementById'](_0x6332ce(0x149))['classList'][_0x6332ce(0x101)](_0x6332ce(0xd2))===![]&&window['app'][_0x6332ce(0x1be)]();}function csvToJson(_0x36b038){const _0x117e43=_0x35147a,_0x32d490=_0x36b038[_0x117e43(0xaf)]('\x0a'),_0x37f1fc=_0x32d490[0x0][_0x117e43(0xaf)](',')[_0x117e43(0x16d)](_0x2edf6f=>_0x2edf6f[_0x117e43(0xfa)]());return _0x32d490['slice'](0x1)[_0x117e43(0x16d)](_0x2bc254=>{const _0x3af85d=_0x117e43,_0x5821a1=_0x2bc254[_0x3af85d(0xaf)](',');if(_0x5821a1['length']<_0x37f1fc[_0x3af85d(0x105)])return null;return _0x37f1fc[_0x3af85d(0x198)]((_0x5558e6,_0xdf0a70,_0x3528f6)=>{const _0x1cdd41=_0x3af85d;return _0x5558e6[_0xdf0a70]=_0x5821a1[_0x3528f6]?_0x5821a1[_0x3528f6][_0x1cdd41(0xfa)]():'',_0x5558e6;},{});})[_0x117e43(0x1f1)](_0x7567f1=>_0x7567f1);}function updateDashboardUI(_0x3793de){const _0x376bba=_0x35147a;document[_0x376bba(0x15f)](_0x376bba(0x177))[_0x376bba(0xd8)]=_0x3793de[_0x376bba(0x209)],document['getElementById']('stat-checkout')[_0x376bba(0xd8)]=_0x3793de['checkout'],document['getElementById'](_0x376bba(0xfd))['innerText']=_0x3793de[_0x376bba(0x129)],document[_0x376bba(0x15f)](_0x376bba(0x13c))['innerText']=_0x3793de['claimed'],document[_0x376bba(0x15f)](_0x376bba(0x155))[_0x376bba(0xd8)]=_0x376bba(0xec)+_0x3793de[_0x376bba(0x124)]+_0x376bba(0x176);if(document[_0x376bba(0x15f)]('stat-noreward'))document[_0x376bba(0x15f)]('stat-noreward')['innerText']=_0x3793de[_0x376bba(0x1c5)];document[_0x376bba(0x15f)](_0x376bba(0x1fe))[_0x376bba(0xd8)]=_0x3793de[_0x376bba(0x209)],document[_0x376bba(0x15f)]('chart-total-checkout')[_0x376bba(0xd8)]=_0x3793de[_0x376bba(0x1a5)],document[_0x376bba(0x15f)](_0x376bba(0xc2))['innerText']=_0x3793de[_0x376bba(0x124)],document[_0x376bba(0x15f)](_0x376bba(0x1b0))[_0x376bba(0xd8)]=_0x3793de[_0x376bba(0x174)];const _0x515386=_0x3793de[_0x376bba(0x209)]>0x0?_0x3793de[_0x376bba(0x1a5)]/_0x3793de[_0x376bba(0x209)]*0x64:0x0;document[_0x376bba(0x15f)](_0x376bba(0x12c))[_0x376bba(0x139)][_0x376bba(0x1fd)]=_0x515386+'%';}function renderTable(_0x2383fa){const _0x3613c8=_0x35147a,_0x2e042c=document[_0x3613c8(0x15f)](_0x3613c8(0x20b)),_0x4555f1=document[_0x3613c8(0x15f)](_0x3613c8(0x107));let _0x3dbb11=_0x2383fa;state[_0x3613c8(0x15c)]&&(_0x3dbb11=_0x2383fa[_0x3613c8(0x1f1)](_0x9dd9a6=>{const _0x27eb70=_0x3613c8,_0x4e84a1=(_0x9dd9a6[_0x27eb70(0xac)]||'')['toLowerCase'](),_0x2afa5a=(_0x9dd9a6[_0x27eb70(0x1d7)]||'')[_0x27eb70(0x13d)]()['toLowerCase']();return _0x4e84a1['includes'](state[_0x27eb70(0x15c)])||_0x2afa5a['includes'](state[_0x27eb70(0x15c)]);}));const _0x4f9de3=[..._0x3dbb11]['sort']((_0xc099ff,_0x5d98e0)=>{const _0x5c1d5d=_0x3613c8,_0x43d4f3=state['sortBy']||_0x5c1d5d(0xdd);let _0x1bfccd=_0xc099ff[_0x43d4f3],_0x674849=_0x5d98e0[_0x43d4f3];if(_0x43d4f3===_0x5c1d5d(0xdd)||_0x43d4f3==='CheckOUT'){const _0x14f945=_0x1bfccd?_0x1bfccd[_0x5c1d5d(0x154)]?_0x1bfccd['toDate']()[_0x5c1d5d(0x1aa)]():new Date(_0x1bfccd)['getTime']():0x0,_0x13094d=_0x674849?_0x674849[_0x5c1d5d(0x154)]?_0x674849[_0x5c1d5d(0x154)]()[_0x5c1d5d(0x1aa)]():new Date(_0x674849)[_0x5c1d5d(0x1aa)]():0x0;return state['sortOrder']===_0x5c1d5d(0x189)?_0x14f945-_0x13094d:_0x13094d-_0x14f945;}if(typeof _0x1bfccd===_0x5c1d5d(0x1d5))_0x1bfccd=_0x1bfccd[_0x5c1d5d(0x167)]();else _0x1bfccd='';if(typeof _0x674849===_0x5c1d5d(0x1d5))_0x674849=_0x674849[_0x5c1d5d(0x167)]();else _0x674849='';if(_0x1bfccd<_0x674849)return state[_0x5c1d5d(0x188)]===_0x5c1d5d(0x189)?-0x1:0x1;if(_0x1bfccd>_0x674849)return state['sortOrder']===_0x5c1d5d(0x189)?0x1:-0x1;return 0x0;}),_0x65d7a9=state[_0x3613c8(0x123)]===0x1869f?_0x4f9de3['length']:state[_0x3613c8(0x123)],_0x25da59=Math[_0x3613c8(0x112)](_0x4f9de3['length']/_0x65d7a9);if(state['currentPage']>_0x25da59)state[_0x3613c8(0x1b5)]=_0x25da59>0x0?_0x25da59:0x1;const _0x44f125=(state['currentPage']-0x1)*_0x65d7a9,_0x4ef715=_0x44f125+_0x65d7a9,_0x5eca69=_0x4f9de3[_0x3613c8(0x16f)](_0x44f125,_0x4ef715);document[_0x3613c8(0x15f)](_0x3613c8(0x133))['innerText']='Page\x20'+state[_0x3613c8(0x1b5)]+'\x20of\x20'+(_0x25da59||0x1),document[_0x3613c8(0x15f)](_0x3613c8(0x1d2))[_0x3613c8(0x1f8)]=state[_0x3613c8(0x1b5)]<=0x1,document['getElementById']('btn-next')['disabled']=state[_0x3613c8(0x1b5)]>=_0x25da59;const _0x458092=state['sortOrder']===_0x3613c8(0x189)?_0x3613c8(0x1eb):_0x3613c8(0x1b4);_0x4555f1[_0x3613c8(0xd8)]=_0x3613c8(0x1c1)+_0x5eca69[_0x3613c8(0x105)]+_0x3613c8(0xb0)+_0x2383fa['length']+_0x3613c8(0x14b)+sortByToLabel(state[_0x3613c8(0x118)])+_0x458092+')',_0x2e042c['innerHTML']=_0x5eca69[_0x3613c8(0x16d)]((_0x19fcbd,_0x595ca2)=>{const _0x344ae7=_0x3613c8,_0x328859=_0x19fcbd[_0x344ae7(0xdd)]?(_0x19fcbd['CheckIN']['toDate']?_0x19fcbd[_0x344ae7(0xdd)][_0x344ae7(0x154)]():new Date(_0x19fcbd[_0x344ae7(0xdd)]))[_0x344ae7(0x194)](_0x344ae7(0x18c)):'-',_0x41ef56=_0x19fcbd[_0x344ae7(0x14d)]?(_0x19fcbd[_0x344ae7(0x14d)][_0x344ae7(0x154)]?_0x19fcbd[_0x344ae7(0x14d)][_0x344ae7(0x154)]():new Date(_0x19fcbd[_0x344ae7(0x14d)]))[_0x344ae7(0x194)](_0x344ae7(0x18c)):'-',_0x4f71c5=_0x19fcbd[_0x344ae7(0x1f6)]||'<span\x20class=\x22text-slate-300\x22>-</span>',_0x29a7f3=_0x19fcbd[_0x344ae7(0x193)]?_0x344ae7(0x104):_0x19fcbd[_0x344ae7(0x1f6)]?_0x19fcbd[_0x344ae7(0x1f6)]===_0x344ae7(0x1bc)?_0x344ae7(0xf1):_0x344ae7(0x14a):'-',_0x165f06=_0x19fcbd[_0x344ae7(0xac)]||_0x344ae7(0x12a)+_0x19fcbd['citizenId'][_0x344ae7(0x1ac)](0x0,0x6)+_0x344ae7(0x203);return _0x344ae7(0xe9)+(_0x44f125+_0x595ca2+0x1)+_0x344ae7(0x160)+_0x165f06+'</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>'+_0x328859+_0x344ae7(0x151)+_0x41ef56+_0x344ae7(0x1ec)+_0x4f71c5+_0x344ae7(0x178)+_0x29a7f3+'</td><td\x20class=\x22px-6\x20text-right\x22><button\x20onclick=\x22window.app.deleteSingleData(\x27'+_0x19fcbd['id']+'\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i></button></td></tr>';})[_0x3613c8(0xda)]('');if(window['lucide'])lucide[_0x3613c8(0xf4)]();}function sortByToLabel(_0x14a895){const _0x4187ef=_0x35147a;switch(_0x14a895){case'CheckIN':return _0x4187ef(0x1b1);case'CheckOUT':return _0x4187ef(0x168);case _0x4187ef(0x1f6):return _0x4187ef(0x206);case _0x4187ef(0xac):return _0x4187ef(0x13f);default:return _0x14a895;}}window[_0x35147a(0x199)][_0x35147a(0x11c)]=()=>{const _0x9ba8bf=_0x35147a,_0x321a33=state[_0x9ba8bf(0x15b)];document['getElementById'](_0x9ba8bf(0x138))['innerText']=_0x321a33[_0x9ba8bf(0x174)],document[_0x9ba8bf(0x15f)]('monitor-registered')[_0x9ba8bf(0xd8)]=_0x321a33['registered'],document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x16b))['innerText']=_0x321a33[_0x9ba8bf(0x129)],document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x19c))[_0x9ba8bf(0xd8)]=_0x321a33[_0x9ba8bf(0x129)],document[_0x9ba8bf(0x15f)](_0x9ba8bf(0xc8))['innerText']=_0x321a33[_0x9ba8bf(0x1c5)],document[_0x9ba8bf(0x15f)](_0x9ba8bf(0xb2))[_0x9ba8bf(0xd8)]=_0x321a33[_0x9ba8bf(0x174)];if(document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x162)))document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x162))[_0x9ba8bf(0xd8)]=_0x321a33['notYetDrawn'];if(document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x106)))document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x106))[_0x9ba8bf(0xd8)]=_0x321a33[_0x9ba8bf(0xbb)];if(document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x1bb)))document['getElementById'](_0x9ba8bf(0x1bb))['innerText']=_0x321a33[_0x9ba8bf(0xc9)];document['getElementById'](_0x9ba8bf(0x11f))&&(document['getElementById'](_0x9ba8bf(0x11f))['innerText']=_0x321a33[_0x9ba8bf(0x124)]);const _0x50961c=document[_0x9ba8bf(0x15f)](_0x9ba8bf(0x1ee))[_0x9ba8bf(0x130)];let _0x229668=[];if(_0x50961c===_0x9ba8bf(0x114))_0x229668=state[_0x9ba8bf(0xe7)]['filter'](_0x582162=>_0x582162['reward']===_0x9ba8bf(0x1bc));else{let _0x9ad0a1=state[_0x9ba8bf(0xe7)]['filter'](_0x5a49ae=>_0x5a49ae[_0x9ba8bf(0x1f6)]&&_0x5a49ae[_0x9ba8bf(0x1f6)]!==_0x9ba8bf(0x1bc));if(_0x50961c===_0x9ba8bf(0x1ae))_0x229668=_0x9ad0a1[_0x9ba8bf(0x1f1)](_0xf8220c=>_0xf8220c['rewardClaimTime']);else _0x50961c===_0x9ba8bf(0x143)?_0x229668=_0x9ad0a1[_0x9ba8bf(0x1f1)](_0x49603c=>!_0x49603c[_0x9ba8bf(0x193)]):_0x229668=_0x9ad0a1;}_0x229668[_0x9ba8bf(0x161)]((_0x652d86,_0x355986)=>{const _0x1f353e=_0x9ba8bf,_0x3530d0=_0x652d86['rewardTime']?_0x652d86[_0x1f353e(0xb9)]['toDate']?_0x652d86[_0x1f353e(0xb9)][_0x1f353e(0x154)]():new Date(_0x652d86[_0x1f353e(0xb9)]):new Date(0x0),_0x56cb01=_0x355986['rewardTime']?_0x355986['rewardTime'][_0x1f353e(0x154)]?_0x355986[_0x1f353e(0xb9)][_0x1f353e(0x154)]():new Date(_0x355986[_0x1f353e(0xb9)]):new Date(0x0);return _0x56cb01-_0x3530d0;});const _0x45eb4a=document[_0x9ba8bf(0x15f)]('results-table-body');if(_0x229668[_0x9ba8bf(0x105)]===0x0){_0x45eb4a[_0x9ba8bf(0xb4)]=_0x9ba8bf(0xa9);return;}_0x45eb4a[_0x9ba8bf(0xb4)]=_0x229668[_0x9ba8bf(0x16d)]((_0x15c499,_0x56921e)=>{const _0xd89ab6=_0x9ba8bf,_0x54894f=_0x15c499[_0xd89ab6(0xb9)]?_0x15c499['rewardTime'][_0xd89ab6(0x154)]?_0x15c499[_0xd89ab6(0xb9)][_0xd89ab6(0x154)]():new Date(_0x15c499[_0xd89ab6(0xb9)]):new Date(),_0x12ace5=_0x15c499[_0xd89ab6(0xac)]||(_0x15c499[_0xd89ab6(0x1e1)]?_0x15c499['citizenId'][_0xd89ab6(0x1ac)](0x0,0xa)+_0xd89ab6(0xce):'-');let _0x4704eb='';if(_0x15c499[_0xd89ab6(0x1f6)]==='ไม่ได้รับรางวัล')_0x4704eb='<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x20font-bold\x22>ไม่ได้รางวัล</span>';else _0x15c499[_0xd89ab6(0x193)]?_0x4704eb=_0xd89ab6(0xc6):_0x4704eb=_0xd89ab6(0xd9);const _0x3d2323=_0x15c499[_0xd89ab6(0x1f6)]===_0xd89ab6(0x1bc)?_0xd89ab6(0xe3):_0xd89ab6(0x1ea)+_0x15c499['reward']+'</span>';return _0xd89ab6(0x1e9)+(_0x56921e+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-medium\x20text-slate-700\x22>'+_0x12ace5+_0xd89ab6(0x197)+_0x3d2323+_0xd89ab6(0x121)+(_0x15c499['rewardTime']?_0x54894f['toLocaleTimeString']('th-TH'):'-')+_0xd89ab6(0x197)+_0x4704eb+_0xd89ab6(0x1f5);})[_0x9ba8bf(0xda)]('');};function renderActivityFeed(_0x24d228){const _0x5d6417=_0x35147a,_0x47edc2=document[_0x5d6417(0x15f)](_0x5d6417(0x1e8));let _0x5e990f=[];_0x24d228['forEach'](_0x1ece47=>{const _0x41e9b2=_0x5d6417,_0x4870ef=_0x1ece47[_0x41e9b2(0xac)]||'User\x20...'+(_0x1ece47[_0x41e9b2(0x1e1)]?_0x1ece47[_0x41e9b2(0x1e1)][_0x41e9b2(0x16f)](-0x4):'UNKNOWN');if(_0x1ece47[_0x41e9b2(0xdd)])_0x5e990f['push']({'type':'in','date':_0x1ece47['CheckIN']['toDate']?_0x1ece47['CheckIN'][_0x41e9b2(0x154)]():new Date(_0x1ece47['CheckIN']),'name':_0x4870ef,'id':_0x1ece47['id']});if(_0x1ece47[_0x41e9b2(0x14d)])_0x5e990f[_0x41e9b2(0x1c3)]({'type':'out','date':_0x1ece47[_0x41e9b2(0x14d)]['toDate']?_0x1ece47[_0x41e9b2(0x14d)][_0x41e9b2(0x154)]():new Date(_0x1ece47[_0x41e9b2(0x14d)]),'name':_0x4870ef,'id':_0x1ece47['id']});}),_0x5e990f[_0x5d6417(0x161)]((_0x37c78a,_0x357f94)=>_0x357f94['date']-_0x37c78a[_0x5d6417(0x18a)]);const _0x45bb5b=_0x5e990f[_0x5d6417(0x16f)](0x0,0x32);if(_0x45bb5b[_0x5d6417(0x105)]===0x0){_0x47edc2[_0x5d6417(0xb4)]=_0x5d6417(0x185);return;}_0x47edc2[_0x5d6417(0xb4)]=_0x45bb5b[_0x5d6417(0x16d)](_0x3922ee=>{const _0x4eb04d=_0x5d6417,_0x6f9dea=_0x3922ee['date'][_0x4eb04d(0xf8)](_0x4eb04d(0x18c))+'\x20'+_0x3922ee[_0x4eb04d(0x18a)][_0x4eb04d(0x1da)]('th-TH');let _0x1c4971=_0x4eb04d(0xe0),_0xcc7aae=_0x4eb04d(0x159),_0x591e55='ลงทะเบียนเข้า';return _0x3922ee[_0x4eb04d(0x172)]===_0x4eb04d(0x127)&&(_0x1c4971=_0x4eb04d(0x119),_0xcc7aae=_0x4eb04d(0x11a),_0x591e55=_0x4eb04d(0xf2)),_0x4eb04d(0x17d)+_0xcc7aae+_0x4eb04d(0xb5)+_0x1c4971+_0x4eb04d(0x11d)+_0x3922ee['name']+_0x4eb04d(0x186)+_0x591e55+_0x4eb04d(0x1a9)+_0x6f9dea+_0x4eb04d(0xe4);})[_0x5d6417(0xda)]('');if(window[_0x5d6417(0x1ed)])lucide[_0x5d6417(0xf4)]();}function processPrizesSnapshot(_0x2670fd){const _0x207184=_0x35147a,_0x44df04=[];_0x2670fd[_0x207184(0x15d)](_0x174474=>{const _0x57d6b8=_0x207184;_0x44df04[_0x57d6b8(0x1c3)]({'id':_0x174474['id'],..._0x174474['data']()});}),state['prizes']=_0x44df04,renderPrizeList(_0x44df04),renderPrizeOptions(_0x44df04),document[_0x207184(0x15f)](_0x207184(0x149))['classList'][_0x207184(0x101)](_0x207184(0xd2))===![]&&window['app']['onPrizeSelect']();}function renderPrizeList(_0x4db8b9){const _0x2c7d2c=_0x35147a,_0x5bbed2=document[_0x2c7d2c(0x15f)]('prize-list-body'),_0xabeb74=document[_0x2c7d2c(0x15f)](_0x2c7d2c(0xfe)),_0x529b53=_0x4db8b9[_0x2c7d2c(0x198)]((_0x38f02a,_0x235efa)=>_0x38f02a+(parseInt(_0x235efa['totalQty'])||0x0),0x0);_0xabeb74[_0x2c7d2c(0xd8)]=_0x529b53[_0x2c7d2c(0x194)]();if(_0x4db8b9[_0x2c7d2c(0x105)]===0x0){_0x5bbed2[_0x2c7d2c(0xb4)]=_0x2c7d2c(0x1b3);return;}_0x5bbed2[_0x2c7d2c(0xb4)]=_0x4db8b9[_0x2c7d2c(0x16d)]((_0x5d2145,_0x13c5cf)=>_0x2c7d2c(0x175)+_0x5d2145[_0x2c7d2c(0xc3)]+_0x2c7d2c(0x19b)+(_0x5d2145[_0x2c7d2c(0x1f4)]||0x1)+_0x2c7d2c(0x19b)+(_0x5d2145[_0x2c7d2c(0x128)]||'-')+_0x2c7d2c(0x205)+_0x5d2145['id']+'\x27,\x20\x27'+_0x5d2145[_0x2c7d2c(0xc3)]+_0x2c7d2c(0x136)+(_0x5d2145['qtyPerDraw']||0x1)+',\x20'+(_0x5d2145['totalQty']||0x1)+_0x2c7d2c(0xe2)+_0x5d2145['id']+_0x2c7d2c(0x10e))['join']('');if(window[_0x2c7d2c(0x1ed)])lucide[_0x2c7d2c(0xf4)]();}function renderPrizeOptions(_0x27b7fd){const _0x181bfb=_0x35147a,_0x5f4e9c=document[_0x181bfb(0x15f)](_0x181bfb(0x19d)),_0x3c71cf=_0x5f4e9c['value'];_0x5f4e9c[_0x181bfb(0xb4)]='<option\x20value=\x22\x22>--\x20กรุณาเลือก\x20--</option>'+_0x27b7fd[_0x181bfb(0x16d)](_0x5df5a4=>'<option\x20value=\x22'+_0x5df5a4['id']+_0x181bfb(0x1b2)+_0x5df5a4['qtyPerDraw']+'\x22\x20data-total=\x22'+(_0x5df5a4[_0x181bfb(0x128)]||0x270f)+'\x22>'+_0x5df5a4[_0x181bfb(0xc3)]+'</option>')[_0x181bfb(0xda)](''),_0x5f4e9c[_0x181bfb(0x130)]=_0x3c71cf;}window['app'][_0x35147a(0x1be)]=()=>{const _0x72f957=_0x35147a,_0x2160dd=document[_0x72f957(0x15f)](_0x72f957(0x19d)),_0x3c6650=_0x2160dd[_0x72f957(0x1f3)][_0x2160dd[_0x72f957(0xa8)]];if(!_0x2160dd[_0x72f957(0x130)]||!_0x3c6650[_0x72f957(0x1e6)](_0x72f957(0x18b))){document[_0x72f957(0x15f)](_0x72f957(0x1df))[_0x72f957(0x1f8)]=!![],document['getElementById']('btn-start-random')[_0x72f957(0x1c2)][_0x72f957(0x171)]('opacity-50',_0x72f957(0x1cf));return;}const _0x4db0b3=_0x3c6650[_0x72f957(0x166)](_0x72f957(0x18b)),_0xdb66bc=parseInt(_0x3c6650[_0x72f957(0x166)](_0x72f957(0xc4))||0x0),_0x987069=_0x3c6650['text'],_0x492690=state['users'][_0x72f957(0x1f1)](_0x54461d=>_0x54461d[_0x72f957(0x1f6)]===_0x987069)['length'],_0x2884e1=_0xdb66bc-_0x492690;document[_0x72f957(0x15f)]('input-draw-qty')[_0x72f957(0x130)]=_0x4db0b3,document[_0x72f957(0x15f)](_0x72f957(0x15e))['innerText']=_0x2884e1+'\x20/\x20'+_0xdb66bc,document[_0x72f957(0x15f)]('input-draw-qty')[_0x72f957(0x1e5)]=_0x2884e1>0x0?_0x2884e1:0x0,window[_0x72f957(0x199)][_0x72f957(0x1d3)]();},window[_0x35147a(0x199)]['validateRandomizerInput']=()=>{const _0x5efdf7=_0x35147a,_0x559eed=document[_0x5efdf7(0x15f)](_0x5efdf7(0x19d)),_0x5efad2=document[_0x5efdf7(0x15f)](_0x5efdf7(0xed)),_0x499a47=document[_0x5efdf7(0x15f)](_0x5efdf7(0x1df)),_0x35b9f9=_0x559eed[_0x5efdf7(0x130)],_0x190107=parseInt(_0x5efad2['value']);if(!_0x35b9f9){_0x499a47[_0x5efdf7(0x1f8)]=!![],_0x499a47[_0x5efdf7(0x1c2)][_0x5efdf7(0x171)]('opacity-50',_0x5efdf7(0x1cf));return;}const _0x33b8a3=_0x559eed['options'][_0x559eed[_0x5efdf7(0xa8)]],_0x40d69c=parseInt(_0x33b8a3[_0x5efdf7(0x166)](_0x5efdf7(0xc4))||0x0),_0x2b7f8d=_0x33b8a3[_0x5efdf7(0xd1)],_0x549ea0=state[_0x5efdf7(0xe7)][_0x5efdf7(0x1f1)](_0x28cfec=>_0x28cfec['reward']===_0x2b7f8d)[_0x5efdf7(0x105)],_0x11316b=_0x40d69c-_0x549ea0;_0x190107>0x0&&_0x190107<=_0x11316b?(_0x499a47['disabled']=![],_0x499a47[_0x5efdf7(0x1c2)]['remove'](_0x5efdf7(0xdc),_0x5efdf7(0x1cf)),document[_0x5efdf7(0x15f)]('qty-warning')[_0x5efdf7(0x1c2)]['add'](_0x5efdf7(0xd2))):(_0x499a47[_0x5efdf7(0x1f8)]=!![],_0x499a47[_0x5efdf7(0x1c2)][_0x5efdf7(0x171)](_0x5efdf7(0xdc),'cursor-not-allowed'),_0x190107>_0x11316b&&(document['getElementById']('qty-warning')[_0x5efdf7(0xd8)]=_0x5efdf7(0x120)+_0x11316b+')',document[_0x5efdf7(0x15f)]('qty-warning')['classList'][_0x5efdf7(0x150)]('hidden')));};function fireConfetti(){const _0x347f65=_0x35147a;typeof confetti===_0x347f65(0xbd)&&confetti({'particleCount':0x96,'spread':0x46,'origin':{'y':0.6},'colors':[_0x347f65(0x1b8),_0x347f65(0x12d),_0x347f65(0x113),_0x347f65(0xcb),'#0000FF']});}function createWinnerCard(_0x4ec535,_0x25aa00,_0x5dc147){const _0x45e0b1=_0x35147a,_0x5983de=document[_0x45e0b1(0x11b)](_0x45e0b1(0xbf));_0x5983de['className']='winner-card-enter\x20bg-white/95\x20backdrop-blur-sm\x20h-[65px]\x20px-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-500\x20flex\x20items-center\x20justify-between\x20relative\x20overflow-hidden\x20mb-2\x20transform\x20transition-all\x20hover:scale-[1.01]';const _0x53e646=_0x4ec535['EmpName']||_0x45e0b1(0x140)+(_0x4ec535[_0x45e0b1(0x1e1)]?_0x4ec535[_0x45e0b1(0x1e1)]['substring'](0x0,0xa):_0x45e0b1(0xbe))+_0x45e0b1(0xce);return _0x5983de[_0x45e0b1(0xb4)]=_0x45e0b1(0x16c)+_0x25aa00+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-bold\x20text-slate-800\x20truncate\x20leading-tight\x22>'+_0x53e646+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22z-10\x20pl-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22px-3\x20py-1\x20bg-gradient-to-r\x20from-blue-600\x20to-indigo-600\x20text-white\x20rounded-lg\x20text-sm\x20font-bold\x20shadow-sm\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22gift\x22\x20width=\x2214\x22></i>\x20'+_0x5dc147+_0x45e0b1(0x17f),_0x5983de;}function addHistoryLog(_0x2d0cdd,_0x1a740b){}window[_0x35147a(0x199)]['clearHistoryLog']=()=>{},window[_0x35147a(0x199)][_0x35147a(0x1d0)]=async()=>{const _0x204139=_0x35147a;if(state['isDrawing'])return;const _0xaa2925=document['getElementById'](_0x204139(0x19d)),_0x206609=_0xaa2925[_0x204139(0x1f3)][_0xaa2925[_0x204139(0xa8)]]?.['text'],_0x376102=parseInt(document[_0x204139(0x15f)]('input-draw-qty')[_0x204139(0x130)]),_0x42dd89=parseInt(_0xaa2925[_0x204139(0x1f3)][_0xaa2925[_0x204139(0xa8)]]['getAttribute'](_0x204139(0xc4))),_0x16402b=state[_0x204139(0xe7)][_0x204139(0x1f1)](_0x1dff6d=>_0x1dff6d[_0x204139(0x1f6)]===_0x206609)[_0x204139(0x105)],_0x3f50ee=_0x42dd89-_0x16402b;if(!_0x206609)return window[_0x204139(0x199)][_0x204139(0x1c9)](_0x204139(0x1b7),'กรุณาระบุชื่อของรางวัล');if(_0x376102<0x1)return window[_0x204139(0x199)]['showModal']('แจ้งเตือน',_0x204139(0x11e));if(_0x376102>_0x3f50ee)return window['app'][_0x204139(0x1c9)](_0x204139(0x1b7),'ของรางวัลมีไม่พอสำหรับการสุ่ม\x20(คงเหลือ\x20'+_0x3f50ee+_0x204139(0x1ba));const _0xa8d33=state[_0x204139(0xe7)]['filter'](_0x44cebd=>_0x44cebd[_0x204139(0x10f)]&&_0x44cebd[_0x204139(0x10f)]['trim']()!==''&&!_0x44cebd[_0x204139(0x1f6)]);if(_0xa8d33['length']===0x0)return window[_0x204139(0x199)][_0x204139(0x1c9)]('แจ้งเตือน',_0x204139(0x1e4));if(_0xa8d33[_0x204139(0x105)]<_0x376102){if(!confirm(_0x204139(0x137)+_0xa8d33[_0x204139(0x105)]+_0x204139(0x12e)))return;}state[_0x204139(0x1ad)]=!![];const _0x4db745=document['getElementById'](_0x204139(0x1df));_0x4db745[_0x204139(0x1f8)]=!![],_0x4db745[_0x204139(0x1c2)][_0x204139(0x171)](_0x204139(0xdc),_0x204139(0x1cf)),document['getElementById']('screen-prize-title')[_0x204139(0xd8)]=_0x206609,document[_0x204139(0x15f)](_0x204139(0x182))[_0x204139(0xb4)]='';const _0x3bb6e6=document['getElementById']('screen-overlay-controls');_0x3bb6e6[_0x204139(0x1c2)][_0x204139(0x150)](_0x204139(0xd2)),await new Promise(_0x120e91=>setTimeout(_0x120e91,0x3e8)),_0x3bb6e6[_0x204139(0x1c2)][_0x204139(0x171)](_0x204139(0xd2));const _0x49dd33=_0xa8d33[_0x204139(0x161)](()=>0.5-Math[_0x204139(0xdf)]())[_0x204139(0x16f)](0x0,_0x376102);for(let _0x2d923b=0x0;_0x2d923b<_0x49dd33[_0x204139(0x105)];_0x2d923b++){const _0x3e2d62=_0x49dd33[_0x2d923b],_0x3511a5=createWinnerCard(_0x3e2d62,_0x2d923b+0x1,_0x206609),_0x239539=document[_0x204139(0x15f)]('screen-display-area');_0x239539[_0x204139(0x132)](_0x3511a5),_0x239539['scrollTop']=_0x239539[_0x204139(0xee)];if(window[_0x204139(0x1ed)])lucide[_0x204139(0xf4)]();fireConfetti();try{await updateDoc(doc(db,finalCollectionPath,_0x3e2d62['id']),{'reward':_0x206609,'rewardTime':serverTimestamp()});}catch(_0x25f315){console['error'](_0x204139(0xb6),_0x25f315);}_0x2d923b<_0x49dd33[_0x204139(0x105)]-0x1&&await new Promise(_0x145c24=>setTimeout(_0x145c24,0xbb8));}state[_0x204139(0x1ad)]=![],window[_0x204139(0x199)]['onPrizeSelect'](),window[_0x204139(0x199)][_0x204139(0x1af)](_0x204139(0x201),_0x204139(0x163));},setInterval(()=>{const _0x1fc8e4=_0x35147a;document[_0x1fc8e4(0x15f)]('current-time')[_0x1fc8e4(0xd8)]=new Date()[_0x1fc8e4(0x1da)](_0x1fc8e4(0x18c));},0x3e8);async function init(){const _0x2e4a90=_0x35147a;try{typeof __initial_auth_token!==_0x2e4a90(0x16e)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);document['getElementById'](_0x2e4a90(0x15a))['classList'][_0x2e4a90(0x150)](_0x2e4a90(0xb8)),document[_0x2e4a90(0x15f)](_0x2e4a90(0x15a))[_0x2e4a90(0x1c2)][_0x2e4a90(0x171)](_0x2e4a90(0x1bd)),document[_0x2e4a90(0x15f)]('status-text')['innerText']=_0x2e4a90(0xfb),document['getElementById'](_0x2e4a90(0xb7))[_0x2e4a90(0x1c2)][_0x2e4a90(0xf7)](_0x2e4a90(0x191),'text-green-400');const _0x478823=query(collection(db,finalCollectionPath));onSnapshot(_0x478823,_0x21335e=>{processSnapshot(_0x21335e);},_0x2b45c4=>{const _0x329ac5=_0x2e4a90;console[_0x329ac5(0x146)](_0x329ac5(0xe8),_0x2b45c4);});const _0x211674=query(collection(db,prizesCollectionPath));onSnapshot(_0x211674,_0x245b19=>{processPrizesSnapshot(_0x245b19);});}catch(_0x55bbde){console[_0x2e4a90(0x146)]('Initialization\x20Error:',_0x55bbde);}}init();if(window['lucide'])lucide['createIcons']();

    </script>
</body>
</html>