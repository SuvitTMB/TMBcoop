<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ระบบบริหารจัดการงานประชุม</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Lightbox/Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        /* Toast Animation */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast-enter { animation: slideInRight 0.3s ease-out forwards; }
        
        /* Compact Table Rows */
        .table-compact td {
            padding-top: 4px;
            padding-bottom: 4px;
            height: 24px;
        }

        /* Custom Scroll for Dark Area */
        .custom-scroll-dark::-webkit-scrollbar { width: 6px; }
        .custom-scroll-dark::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .custom-scroll-dark::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
        
        /* Winner Card Animation */
        @keyframes cardSlideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .winner-card-enter {
            animation: cardSlideIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-6 right-6 z-50 flex flex-col gap-3 w-80 pointer-events-none"></div>

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-slate-800 text-white flex-shrink-0 flex flex-col h-screen overflow-y-auto z-20 shadow-xl">
        <div class="p-6 border-b border-slate-700 flex items-center gap-3">
            <div class="bg-blue-500 p-2 rounded-lg">
                <i data-lucide="layout-dashboard" width="24" height="24"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">Coop Admin</h1>
                <p class="text-xs text-slate-400">ระบบจัดการงานประชุม</p>
            </div>
        </div>
        
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <button onclick="window.app.switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-700 text-white transition-all hover:bg-slate-700">
                <i data-lucide="pie-chart" width="20"></i> ภาพรวม (Dashboard)
            </button>
            <button onclick="window.app.switchTab('prizes')" id="nav-prizes" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="gift" width="20"></i> จัดการของรางวัล
            </button>
            <button onclick="window.app.switchTab('randomizer')" id="nav-randomizer" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="play-circle" width="20"></i> จับรางวัล (Randomizer)
            </button>
            <button onclick="window.app.switchTab('results')" id="nav-results" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="list-checks" width="20"></i> ประกาศผลรางวัล
            </button>
            <button onclick="window.app.switchTab('data')" id="nav-data" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                <i data-lucide="table" width="20"></i> ข้อมูลลงทะเบียน
            </button>
            
            <div class="pt-4 mt-4 border-t border-slate-700">
                <p class="px-4 text-xs text-slate-500 mb-2 font-bold">QR Code Management</p>
                <button onclick="window.app.switchTab('qrcode-in')" id="nav-qrcode-in" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckIN
                </button>
                <button onclick="window.app.switchTab('qrcode-out')" id="nav-qrcode-out" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
                    <i data-lucide="qr-code" width="20"></i> QR Code CheckOUT
                </button>
            </div>

            <button onclick="window.app.switchTab('import')" id="nav-import" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all border-t border-slate-700 mt-2 pt-4">
                <i data-lucide="database" width="20"></i> จัดการข้อมูล (Import)
            </button>
        </nav>

        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-900 rounded-xl p-4">
                <p class="text-xs text-slate-500 mb-1">สถานะระบบ</p>
                <div class="flex items-center gap-2">
                    <div id="status-indicator" class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span id="status-text" class="text-sm text-slate-400">Connecting...</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Top Bar -->
        <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm z-10">
            <h2 id="page-title" class="text-xl font-bold text-slate-800">ภาพรวมระบบ</h2>
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-sm font-bold text-slate-700">ผู้ดูแลระบบ</p>
                    <p class="text-xs text-slate-500" id="current-time">--:--:--</p>
                </div>
                <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">
                    A
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-6 bg-slate-50 relative" id="main-scroll">
            
            <!-- VIEW 1: DASHBOARD OVERVIEW -->
            <div id="view-dashboard" class="view-section space-y-6 fade-in-up">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="users" width="60" height="60" class="text-blue-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนเข้า</p>
                        <h3 id="stat-checkin" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-green-500 text-xs mt-2 flex items-center gap-1"><i data-lucide="arrow-up" width="12"></i> Update Real-time</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="log-out" width="60" height="60" class="text-orange-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ลงทะเบียนออก</p>
                        <h3 id="stat-checkout" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <div class="w-full bg-orange-100 rounded-full h-1.5 mt-3">
                            <div id="bar-checkout" class="bg-orange-500 h-1.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- NEW: Not Rewarded Box -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="frown" width="60" height="60" class="text-slate-400"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ผู้ไม่ได้รางวัล</p>
                        <h3 id="stat-noreward" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p class="text-slate-400 text-xs mt-2">สุ่มแล้วไม่ได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="gift" width="60" height="60" class="text-purple-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ได้รับรางวัลแล้ว</p>
                        <h3 id="stat-rewarded" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                        <p id="stat-eligible" class="text-slate-400 text-xs mt-2">สุ่มและได้รางวัล</p>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:scale-110 transition-transform">
                            <i data-lucide="check-square" width="60" height="60" class="text-green-600"></i>
                        </div>
                        <p class="text-slate-500 text-sm font-medium">ยืนยันรับรางวัลแล้ว</p>
                        <h3 id="stat-claimed" class="text-2xl font-bold text-slate-800 mt-2">0</h3>
                    </div>
                </div>

                <!-- Charts & Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                    <!-- Left Column: Two Charts Stacked -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Chart Check-IN -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-indigo-500 rounded-full"></div> สถิติการลงทะเบียนเข้า (Check-IN)
                                </h3>
                                <span class="text-2xl font-bold text-indigo-600" id="chart-total-checkin">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="registrationChart"></canvas>
                            </div>
                        </div>
                        <!-- Chart Check-OUT -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-lg text-slate-700 flex items-center gap-2">
                                    <div class="w-3 h-3 bg-orange-500 rounded-full"></div> สถิติการลงทะเบียนออก (Check-OUT)
                                </h3>
                                <span class="text-2xl font-bold text-orange-600" id="chart-total-checkout">0</span>
                            </div>
                            <div class="h-64">
                                <canvas id="checkoutChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Recent Activity (Full Height) -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full max-h-[730px]"> 
                        <h3 class="font-bold text-lg text-slate-700 mb-4">กิจกรรมล่าสุด</h3>
                        <div id="recent-activity-list" class="space-y-4 overflow-y-auto pr-2 flex-1">
                            <!-- Activity Items injected here -->
                            <div class="text-center text-slate-400 text-sm py-8">รอข้อมูล...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: PRIZE MANAGEMENT -->
            <div id="view-prizes" class="view-section hidden space-y-6 fade-in-up">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Form -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="plus-circle" width="20" class="text-indigo-600"></i> เพิ่ม/แก้ไข ของรางวัล
                        </h3>
                        <form id="prize-form" onsubmit="window.app.handlePrizeSubmit(event)" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                                <input type="text" id="prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                                    <input type="number" id="prize-qty" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                                    <input type="number" id="prize-total" value="1" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition">บันทึกข้อมูล</button>
                        </form>
                    </div>

                    <!-- List -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4">รายการของรางวัลทั้งหมด</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-200 text-slate-700 font-bold">
                                    <tr>
                                        <th class="px-4 py-3 rounded-l-lg">ชื่อของรางวัล</th>
                                        <th class="px-4 py-3 text-center">รางวัลที่จะสุ่ม</th>
                                        <th class="px-4 py-3 text-center">คงเหลือ / ทั้งหมด</th>
                                        <th class="px-4 py-3 text-right rounded-r-lg">จัดการ</th>
                                    </tr>
                                </thead>
                                <tbody id="prize-list-body" class="divide-y divide-slate-100">
                                    <tr><td colspan="4" class="text-center py-4 text-slate-400">กำลังโหลด...</td></tr>
                                </tbody>
                                <tfoot class="bg-slate-100 font-bold text-slate-700">
                                    <tr>
                                        <td class="px-4 py-3 text-right" colspan="2">รวมสิทธิ์ทั้งหมด:</td>
                                        <td class="px-4 py-3 text-center text-indigo-600" id="total-prize-quota">0</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: RANDOMIZER SYSTEM -->
            <div id="view-randomizer" class="view-section hidden space-y-6">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <!-- Box 1 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-blue-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้ลงทะเบียนทั้งหมด</p>
                        <h3 id="rand-stat-total" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 2 (Eligible/Total Status Valid) -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-indigo-500">
                        <p class="text-slate-500 text-xs font-medium">ผู้มีสิทธิ์สุ่มรางวัล</p>
                        <h3 id="rand-stat-eligible-view" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 3 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-slate-400">
                        <p class="text-slate-500 text-xs font-medium">ยังไม่ได้สุ่ม</p>
                        <h3 id="rand-stat-noreward" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 4 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-red-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วไม่ได้รางวัล</p>
                        <h3 id="rand-stat-rewarded" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                    <!-- Box 5 -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 border-l-4 border-green-500">
                        <p class="text-slate-500 text-xs font-medium">สุ่มแล้วได้รางวัล</p>
                        <h3 id="rand-stat-claimed" class="text-2xl font-bold text-slate-800 mt-1">0</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                    <!-- Left: Control Panel -->
                    <div class="lg:col-span-4 space-y-6">
                        <!-- Setup Card -->
                        <div class="bg-white p-6 rounded-2xl shadow-md border border-slate-100">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                                <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600"><i data-lucide="settings-2" width="20"></i></div>
                                ตั้งค่าการสุ่ม
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">เลือกของรางวัล</label>
                                    <select id="select-prize" onchange="window.app.onPrizeSelect()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none bg-white">
                                        <option value="">-- กรุณาเลือก --</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนผู้โชคดี (คน)</label>
                                    <div class="flex items-center gap-4">
                                        <input type="number" id="input-draw-qty" value="1" min="1" max="50" oninput="window.app.validateRandomizerInput()" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-center text-lg">
                                        <span class="text-slate-400 text-sm whitespace-nowrap">คน / รอบ</span>
                                    </div>
                                    <p class="text-xs text-orange-500 mt-1 hidden" id="qty-warning">จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ!</p>
                                </div>
                                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">คงเหลือในสต็อก</span>
                                        <span id="label-stock-count" class="font-bold text-orange-600 text-lg">0</span>
                                    </div>
                                     <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-slate-500">ผู้มีสิทธิ์ลุ้นรางวัล</span>
                                        <span id="label-eligible-count" class="font-bold text-indigo-600 text-lg">0</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-1.5">
                                        <div class="bg-indigo-500 h-1.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-2">*เฉพาะผู้ที่สถานะไม่ว่างและยังไม่เคยได้รางวัล</p>
                                </div>
                                <button onclick="window.app.startRandomizer()" id="btn-start-random" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all transform active:scale-95 flex items-center justify-center gap-2 text-lg opacity-50 cursor-not-allowed">
                                    <i data-lucide="play" width="24" class="fill-current"></i> เริ่มสุ่มรางวัล
                                </button>
                            </div>
                        </div>
                        
                        <!-- History Log Box REMOVED as requested -->
                        
                    </div>
                    <!-- Right: Big Screen Display Area -->
                    <div class="lg:col-span-8">
                        <div class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 rounded-3xl h-[650px] p-8 flex flex-col relative overflow-hidden shadow-2xl border border-slate-700/50">
                             <!-- Header inside screen -->
                            <div class="relative z-10 flex justify-between items-start mb-8 border-b border-white/10 pb-4">
                                <div>
                                    <h1 id="screen-prize-title" class="text-xg font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200 drop-shadow-md">
                                        ระบบสุ่มรางวัล
                                    </h1>
                                </div>
                                <!-- Status removed as requested -->
                            </div>
                            <!-- Display Grid -->
                            <div id="screen-display-area" class="relative z-10 flex-1 grid grid-cols-1 content-start gap-4 overflow-y-auto custom-scroll-dark px-2 pb-4">
                                <div class="text-center text-slate-500/50 flex flex-col items-center justify-center h-full">
                                    <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm">
                                        <i data-lucide="gift" width="40" height="40" class="text-white/20"></i>
                                    </div>
                                    <p class="text-white/40 font-light text-xm">พร้อมสำหรับการจับรางวัล</p>
                                </div>
                            </div>
                            <!-- Controls overlay -->
                            <div id="screen-overlay-controls" class="hidden absolute inset-0 bg-black/80 backdrop-blur-sm z-20 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6 mx-auto"></div>
                                    <h2 class="text-2xl font-bold tracking-tight">กำลังประมวลผล...</h2>
                                    <p class="text-blue-300 mt-2">กรุณารอสักครู่</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: LIVE RESULTS -->
            <div id="view-results" class="view-section hidden space-y-6 fade-in-up">
                 <!-- Stats -->
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <!-- 1. Total DB -->
                    <div class="bg-gradient-to-br from-gray-600 to-gray-700 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-gray-200 text-xs">สมาชิกทั้งหมดในระบบ</p>
                        <h3 id="monitor-total-db" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 2. Registered (Status valid) -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-blue-100 text-xs">สมาชิกที่ลงทะเบียน (Active)</p>
                        <h3 id="monitor-registered" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 3. Draws -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-purple-100 text-xs">จำนวนรางวัลที่แจกแล้ว</p>
                        <h3 id="monitor-draws" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 4. Rewarded -->
                    <div class="bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-green-100 text-xs">สมาชิกที่ได้รางวัลแล้ว</p>
                        <h3 id="monitor-rewarded" class="text-2xl font-bold mt-1">0</h3>
                    </div>

                    <!-- 5. No Reward -->
                    <div class="bg-gradient-to-br from-slate-500 to-slate-600 p-4 rounded-xl shadow-lg text-white">
                        <p class="text-slate-200 text-xs">สมาชิกที่ไม่ได้รางวัล</p>
                        <h3 id="monitor-noreward" class="text-2xl font-bold mt-1">0</h3>
                    </div>
                </div>
                <!-- Table -->
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 bg-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-slate-800">รายการผู้โชคดี (Real-time)</h3>
                        <select id="filter-results-status" onchange="window.app.renderResults()" class="bg-white border border-slate-300 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                            <option value="all_winners">ผู้ได้รับรางวัลทั้งหมด</option>
                            <option value="unclaimed">ผู้ที่ยังไม่รับรางวัล</option>
                            <option value="claimed">ผู้ที่รับรางวัลแล้ว</option>
                            <option value="no_reward">ผู้ที่ไม่ได้รับรางวัล</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100">
                                <tr>
                                    <th class="px-6 py-4">ลำดับ</th>
                                    <th class="px-6 py-4">ชื่อ-นามสกุล</th>
                                    <th class="px-6 py-4">รางวัลที่ได้</th>
                                    <th class="px-6 py-4">เวลาที่สุ่มได้</th>
                                    <th class="px-6 py-4">สถานะการรับรางวัล</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VIEW 5: DATA TABLE -->
            <div id="view-data" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center bg-slate-200 gap-4">
                        <h3 class="font-bold text-lg text-slate-800">ข้อมูลการลงทะเบียนทั้งหมด</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-end">
                             <select id="sort-by" onchange="window.app.changeSort(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="CheckIN">เรียงตาม Check-In</option>
                                <option value="CheckOUT">เรียงตาม Check-Out</option>
                                <option value="reward">เรียงตามของรางวัล</option>
                                <option value="EmpName">เรียงตามชื่อ-นามสกุล</option>
                             </select>
                             <select id="sort-order" onchange="window.app.changeSortOrder(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="desc">มาก -> น้อย (ล่าสุด/Z-A)</option>
                                <option value="asc">น้อย -> มาก (เก่าสุด/A-Z)</option>
                             </select>
                             <select id="rows-per-page" onchange="window.app.changeRowsLimit(this.value)" class="bg-slate-50 border border-slate-200 text-slate-600 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2">
                                <option value="20">20 แถว</option>
                                <option value="50" selected>50 แถว</option>
                                <option value="100">100 แถว</option>
                                <option value="500">500 แถว</option>
                                <option value="99999">ทั้งหมด</option>
                             </select>
                             <input type="text" id="search-data" oninput="window.app.handleSearch(this.value)" placeholder="ค้นหาชื่อ..." class="px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-compact">
                            <thead class="bg-slate-200 text-slate-700 font-bold border-b border-slate-100 text-sm">
                                <tr>
                                    <th class="px-6 py-2">#</th>
                                    <th class="px-6 py-2">ชื่อ-นามสกุล (EmpName)</th>
                                    <th class="px-6 py-2">Check-In</th>
                                    <th class="px-6 py-2">Check-Out</th>
                                    <th class="px-6 py-2">ของรางวัล</th>
                                    <th class="px-6 py-2">สถานะรับรางวัล</th>
                                    <th class="px-6 py-2 text-right">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-slate-100 text-sm"></tbody>
                        </table>
                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex justify-between items-center">
                            <p class="text-xs text-slate-400" id="data-table-info">แสดงผล...</p>
                            <div class="flex gap-2" id="pagination-controls">
                                <button onclick="window.app.changePage(-1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-prev">Previous</button>
                                <span class="text-xs self-center font-bold text-slate-600" id="page-indicator">Page 1</span>
                                <button onclick="window.app.changePage(1)" class="px-3 py-1 bg-white border border-slate-300 rounded-md text-xs hover:bg-slate-50 disabled:opacity-50" id="btn-next">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 6: IMPORT / MANAGE DATA -->
            <div id="view-import" class="view-section hidden space-y-6 fade-in-up">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Import Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="upload-cloud" width="20" class="text-blue-600"></i> นำเข้าข้อมูล (JSON/CSV)
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">
                            รองรับไฟล์ JSON ที่มีฟิวด์ <code>citizenId</code> ระบบจะทำการแปลง Citizen ID เป็นรหัส Hash (SHA-256) โดยอัตโนมัติก่อนบันทึก
                        </p>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:bg-slate-50 transition cursor-pointer" onclick="document.getElementById('file-upload').click()">
                                <i data-lucide="file-up" width="40" class="mx-auto text-slate-400 mb-2"></i>
                                <p class="text-sm font-medium text-slate-600">คลิกเพื่อเลือกไฟล์ หรือลากไฟล์มาวางที่นี่</p>
                                <p class="text-xs text-slate-400 mt-1">รองรับ .json, .csv</p>
                                <input type="file" id="file-upload" class="hidden" accept=".json,.csv" onchange="window.app.handleFileSelect(event)">
                            </div>
                            <div id="file-info" class="hidden bg-blue-50 p-3 rounded-lg flex items-center justify-between text-sm text-blue-700">
                                <span id="file-name">filename.json</span>
                                <button onclick="window.app.clearFileSelection()" class="text-blue-500 hover:text-blue-700"><i data-lucide="x" width="16"></i></button>
                            </div>
                            <button onclick="window.app.processImport()" id="btn-import" disabled class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                                เริ่มนำเข้าข้อมูล
                            </button>
                            <div id="import-progress" class="hidden w-full bg-slate-200 rounded-full h-2.5">
                                <div id="import-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Database Management Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="database" width="20" class="text-slate-600"></i> ข้อมูลระบบ
                        </h3>
                        
                        <div class="bg-slate-50 p-4 rounded-xl mb-6 flex justify-between items-center">
                            <div>
                                <p class="text-sm text-slate-500">จำนวนข้อมูลทั้งหมด (Records)</p>
                                <h2 class="text-2xl font-bold text-slate-800 mt-1" id="manage-total-docs">0</h2>
                            </div>
                            <div class="bg-white p-3 rounded-full shadow-sm text-slate-400">
                                <i data-lucide="hard-drive" width="24"></i>
                            </div>
                        </div>

                        <div class="border-t border-slate-100 pt-6 space-y-4">
                            <h4 class="font-bold text-red-600 mb-2 flex items-center gap-2"><i data-lucide="alert-octagon" width="18"></i> Danger Zone</h4>
                            
                            <!-- Reset Registration Status -->
                             <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                                <p class="text-sm font-bold text-orange-800 mb-1">รีเซ็ตการลงทะเบียน (Reset Status)</p>
                                <p class="text-xs text-orange-600 mb-3">ล้างสถานะ Check-In, Check-Out และการรับรางวัลทั้งหมด แต่เก็บข้อมูลรายชื่อพนักงานไว้</p>
                                <button onclick="window.app.openResetModal()" class="w-full border border-orange-300 text-orange-700 hover:bg-orange-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="rotate-ccw" width="16"></i> รีเซ็ตสถานะ (Clear Transaction)
                                </button>
                            </div>

                            <!-- Delete All Data -->
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                                <p class="text-sm font-bold text-red-800 mb-1">ลบข้อมูลทั้งหมด (Delete All)</p>
                                <p class="text-xs text-red-600 mb-3">ลบข้อมูลพนักงานและการลงทะเบียนทั้งหมดออกจากระบบ ไม่สามารถกู้คืนได้</p>
                                <button onclick="window.app.deleteAllData()" class="w-full border border-red-300 text-red-700 hover:bg-red-100 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2 text-sm">
                                    <i data-lucide="trash-2" width="16"></i> ลบข้อมูลทั้งหมด (Clear DB)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- VIEW 7: QR Code CheckIN -->
            <div id="view-qrcode-in" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-blue-800 mb-2">ลงทะเบียนเข้าประชุม (Check-IN)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนเข้าร่วมงาน</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-login.png" alt="Check-IN QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmb-coop-line.html</p>
                    <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

            <!-- VIEW 8: QR Code CheckOUT -->
            <div id="view-qrcode-out" class="view-section hidden space-y-6 fade-in-up">
                 <div class="bg-white p-10 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center justify-center text-center min-h-[60vh]">
                    <h2 class="text-2xl font-bold text-orange-600 mb-2">ลงทะเบียนออก (Check-OUT)</h2>
                    <p class="text-slate-500 mb-8">สแกน QR Code เพื่อลงทะเบียนออกและลุ้นรางวัล</p>
                    <div class="bg-white p-4 rounded-xl shadow-inner border border-slate-300 mb-6">
                        <img src="./images/Coop-out.png" alt="Check-OUT QR Code" class="w-80 h-80 object-contain">
                    </div>
                    <p class="text-xs text-slate-400">URL: https://suvittmb.github.io/TMBcoop/tmbcoop-outrandom-line.html</p>
                     <button class="mt-6 px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg text-sm transition flex items-center gap-2">
                        <i data-lucide="printer" width="16"></i> พิมพ์หน้านี้
                    </button>
                </div>
            </div>

        </div>
    </main>

    <!-- Modal: Edit Prize -->
    <div id="edit-prize-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4 border-b border-slate-100 pb-2">
                <h3 class="text-lg font-bold text-slate-800">แก้ไขของรางวัล</h3>
                <button onclick="window.app.closeEditPrizeModal()" class="text-slate-400 hover:text-slate-600">
                    <i data-lucide="x" width="24"></i>
                </button>
            </div>
            <form id="edit-prize-form" onsubmit="window.app.handlePrizeUpdate(event)" class="space-y-4">
                <input type="hidden" id="edit-prize-id">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-1">ชื่อของรางวัล</label>
                    <input type="text" id="edit-prize-name" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">รางวัลที่จะสุ่ม (ต่อรอบ)</label>
                        <input type="number" id="edit-prize-qty" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">จำนวนสิทธิ์ทั้งหมด</label>
                        <input type="number" id="edit-prize-total" min="1" required class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-200 outline-none">
                    </div>
                </div>
                
                <div class="flex gap-3 pt-2">
                    <button type="button" onclick="window.app.closeEditPrizeModal()" class="flex-1 py-3 rounded-xl text-slate-600 bg-slate-100 hover:bg-slate-200 font-bold transition">ยกเลิก</button>
                    <button type="submit" class="flex-1 py-3 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 font-bold transition">บันทึก</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- General Modal -->
    <div id="general-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500">
                <i data-lucide="alert-circle" width="24"></i>
            </div>
            <h3 id="general-modal-title" class="text-lg font-bold text-slate-800 mb-2">แจ้งเตือน</h3>
            <p id="general-modal-message" class="text-slate-500 text-sm mb-6">ข้อความแจ้งเตือน</p>
            <button onclick="window.app.closeGeneralModal()" class="w-full py-2.5 rounded-xl bg-slate-800 text-white font-bold hover:bg-slate-900 transition">ตกลง</button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
            <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600">
                <i data-lucide="alert-triangle" width="32"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">ยืนยันการรีเซ็ต?</h3>
            <p class="text-slate-500 text-sm mb-6">
                ระบบจะล้างข้อมูลการลงทะเบียน (Check-In/Out) และประวัติการรับรางวัลทั้งหมด <br>
                <span class="font-bold text-orange-600">แต่จะเก็บรายชื่อพนักงานไว้</span>
            </p>
            <div class="flex gap-3">
                <button onclick="window.app.closeResetModal()" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition">ยกเลิก</button>
                <button onclick="window.app.confirmResetData()" class="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold hover:bg-orange-700 transition">ยืนยันรีเซ็ต</button>
            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
const _0x21739d=_0xf910;(function(_0xd3df1c,_0x1b3566){const _0x5269d3=_0xf910,_0x42d054=_0xd3df1c();while(!![]){try{const _0x921576=parseInt(_0x5269d3(0x105))/0x1*(parseInt(_0x5269d3(0x108))/0x2)+-parseInt(_0x5269d3(0xbd))/0x3+-parseInt(_0x5269d3(0x196))/0x4*(-parseInt(_0x5269d3(0x13b))/0x5)+parseInt(_0x5269d3(0xdf))/0x6*(-parseInt(_0x5269d3(0x148))/0x7)+-parseInt(_0x5269d3(0x186))/0x8+-parseInt(_0x5269d3(0x11e))/0x9*(parseInt(_0x5269d3(0xf4))/0xa)+-parseInt(_0x5269d3(0x172))/0xb*(-parseInt(_0x5269d3(0x209))/0xc);if(_0x921576===_0x1b3566)break;else _0x42d054['push'](_0x42d054['shift']());}catch(_0x4132e4){_0x42d054['push'](_0x42d054['shift']());}}}(_0x250c,0x269d8));function _0xf910(_0x4c9095,_0x18fb89){_0x4c9095=_0x4c9095-0xba;const _0x250c78=_0x250c();let _0x35e44d=_0x250c78[_0x4c9095];return _0x35e44d;}import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,query,where,getDocs,updateDoc,doc,serverTimestamp,onSnapshot,addDoc,deleteDoc,writeBatch,deleteField,getDoc,setDoc}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x21739d(0xf2),PRIZES_COLLECTION_NAME=_0x21739d(0x168),isSandboxEnv=typeof __firebase_config!=='undefined';let firebaseConfig,finalCollectionPath,prizesCollectionPath;if(isSandboxEnv){firebaseConfig=JSON[_0x21739d(0x171)](__firebase_config);const appId=typeof __app_id!=='undefined'?__app_id:_0x21739d(0x21c);finalCollectionPath=_0x21739d(0xc2)+appId+_0x21739d(0x201),prizesCollectionPath=_0x21739d(0xc2)+appId+_0x21739d(0xcb)+PRIZES_COLLECTION_NAME;}else firebaseConfig={'apiKey':_0x21739d(0x1ff),'authDomain':'ttb-register.firebaseapp.com','databaseURL':_0x21739d(0x152),'projectId':_0x21739d(0x115),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x21739d(0x194),'appId':_0x21739d(0x145),'measurementId':_0x21739d(0x1a7)},finalCollectionPath=TARGET_COLLECTION_NAME,prizesCollectionPath=PRIZES_COLLECTION_NAME;function _0x250c(){const _0x19bd2b=['rand-stat-eligible-view','1070273157855','rgba(79,\x2070,\x20229,\x200.1)','4xdyBDd','totalDocs','ไม่มีข้อมูลให้ลบ','<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x20font-bold\x22>ไม่ได้รางวัล</span>','</td><td\x20class=\x22px-6\x22>','scrollHeight','getAttribute','sortOrder','จำนวนต้องมากกว่า\x200','rand-stat-noreward','rand-stat-claimed','nav-','openEditPrizeModal','prize-list-body','\x22\x20data-qty=\x22','users','ภาพรวมระบบ','G-9DJLWJ5LQ1','manage-total-docs','chart-total-checkout','\x27,\x20','padStart','ต้องการลบสถานะการลงทะเบียนของพนักงานท่านนี้ใช่หรือไม่?\x20(ข้อมูลรายชื่อจะยังคงอยู่)','<span\x20class=\x22px-2\x20py-1\x20bg-yellow-100\x20text-yellow-700\x20rounded-full\x20text-xs\x22>ยังไม่รับรางวัล</span>','closeResetModal','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button></td></tr>','bg-red-500','sortBy','screen-prize-title','unclaimed','forEach','rowsPerPage','no_reward','\x20(มากไปน้อย)','qty-warning','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-medium\x20text-slate-700\x22>','result','\x20<span\x20class=\x22text-slate-400\x20font-normal\x22>(','<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22><td\x20class=\x22px-4\x20py-3\x20font-medium\x20text-slate-700\x22>','openResetModal','importedAt','div','clearHistoryLog','reward','บันทึกข้อมูลเรียบร้อย','btn-prev','th-TH','CheckOUT','onPrizeSelect','</td><td\x20class=\x22px-6\x20font-medium\x20text-slate-700\x20text-base\x22>','เกิดข้อผิดพลาดในการลบ','rewarded','Check-IN','ceil','Reset\x20Error','max','\x27,\x20\x27','file-info','จัดการข้อมูล\x20(Import)','error','general-modal-title','processImport','app','.nav-item','datasets','เวลาเข้า','\x20รายการ\x20(เรียงตาม\x20','changeSortOrder','Add\x20Prize\x20Error','rgba(249,\x20115,\x2022,\x200.1)','</option>','qrcode-in','hidden','substring','querySelector','แจ้งเตือน','ของรางวัลมีไม่พอสำหรับการสุ่ม\x20(คงเหลือ\x20','className','monitor-total-db','<tr><td\x20colspan=\x224\x22\x20class=\x22text-center\x20py-4\x20text-slate-400\x22>ยังไม่มีข้อมูลของรางวัล</td></tr>','\x20of\x20','ไม่ได้รับรางวัล','ระบบสุ่มรางวัล','rewardClaimTime','classList','showModal','Page\x20','getHours','กำลังลบข้อมูล...','bg-slate-700','#FFA500','createIcons','รีเซ็ตข้อมูลสำเร็จ\x20','edit-prize-qty','data-total','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-bold\x20text-slate-800\x20truncate\x20leading-tight\x22>','</td><td\x20class=\x22px-6\x20font-medium\x20text-indigo-600\x20text-xs\x22>','<span\x20class=\x22text-slate-400\x20italic\x22>ไม่ได้รับรางวัล</span>','toDate','citizenId','อัปเดตข้อมูลเรียบร้อย','input-draw-qty','push','total-prize-quota','endsWith','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','</div><button\x20onclick=\x22this.parentElement.remove()\x22\x20class=\x22text-slate-400\x20hover:text-slate-600\x22><i\x20data-lucide=\x22x\x22\x20width=\x2216\x22></i></button>','/public/data/coop_registrations','label-stock-count','เกิดข้อผิดพลาดในการอัปเดต','handleFileSelect','SHA-256','#f97316','recent-activity-list','\x22\x20data-total=\x22','156ZoqBOu','options','registered','string','fileToImport','เกิดข้อผิดพลาดในการรีเซ็ต','checkin','deleteSingleData','isDrawing','stat-checkin','appendChild','#view-import\x20button[onclick*=\x22openResetModal\x22]','clearFileSelection','length','ข้อมูลลงทะเบียน','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','<div\x20class=\x22text-red-500\x22><i\x20data-lucide=\x22alert-circle\x22\x20width=\x2220\x22></i></div>','checkoutChart','prizes','default-app-id','view-randomizer','name','cursor-not-allowed','760725LcEGZV','random','currentPage','getTime','closeEditPrizeModal','artifacts/','#FF4500','validateRandomizerInput','#4f46e5','จำนวนสุ่มเกินกว่าของรางวัลที่เหลือ\x20(','prize-total','<option\x20value=\x22\x22>--\x20กรุณาเลือก\x20--</option>','เกิดข้อผิดพลาด:\x20','data','/public/data/','stat-claimed','handlePrizeSubmit','changeSort','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-bold\x22>รับรางวัลแล้ว</span>','<div\x20class=\x22text-blue-500\x22><i\x20data-lucide=\x22info\x22\x20width=\x2220\x22></i></div>','QR\x20Code\x20ลงทะเบียนเข้า','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','status-indicator','replace','qtyPerDraw','เวลาออก','remove','User\x20...','<span\x20class=\x22text-slate-400\x20text-xs\x20italic\x22>ID:\x20','#0000FF','...','stat-noreward','toString','</td><td\x20class=\x22px-6\x20text-right\x22><button\x20onclick=\x22window.app.deleteSingleData(\x27','10950aDimxG','Delete\x20Prize\x20Error','กรุณาระบุชื่อของรางวัล','btn-start-random','Update\x20Error','select-prize','monitor-noreward','นำเข้าข้อมูลสำเร็จ\x20','stats','results','btn-next','drawnNoReward','toLocaleTimeString','\x20รายการ','success','slice','toLocaleString','<span\x20class=\x22px-2\x20py-1\x20bg-red-100\x20text-red-700\x20rounded-full\x20text-xs\x20font-bold\x22>ยังไม่รับรางวัล</span>','import-progress','tmb_coop','general-modal-message','10bzfQXU','กำลังประมวลผล...','Unknown','width','ประกาศผลรางวัล','EmpID','preventDefault','เกิดข้อผิดพลาดในการบันทึก','แสดงผล\x20','winner-card-enter\x20bg-white/95\x20backdrop-blur-sm\x20h-[65px]\x20px-4\x20rounded-xl\x20shadow-lg\x20border-l-4\x20border-yellow-500\x20flex\x20items-center\x20justify-between\x20relative\x20overflow-hidden\x20mb-2\x20transform\x20transition-all\x20hover:scale-[1.01]','join','monitor-draws','renderResults','trim','#FFD700','Update\x20Prize\x20Error','lucide','185238DYkPOV','.csv','\x20/\x20','2GiNlay','bg-green-500','toLowerCase','rewardTime','QR\x20Code\x20ลงทะเบียนออก','querySelectorAll','prize-form','qrcode-out','target','files','<tr><td\x20colspan=\x225\x22\x20class=\x22px-6\x20py-8\x20text-center\x20text-slate-400\x22>ไม่พบข้อมูลตามเงื่อนไขที่เลือก</td></tr>','stat-eligible','date','ttb-register','readAsText','bg-white\x20border-l-4\x20border-blue-500\x20text-slate-700','status','style','text-blue-500','digest','ลบไม่สำเร็จ','createElement','2716677omsJHB','split','<div\x20class=\x22text-center\x20text-slate-400\x20text-sm\x20py-8\x22>ยังไม่มีกิจกรรม</div>','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22z-10\x20pl-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22px-3\x20py-1\x20bg-gradient-to-r\x20from-blue-600\x20to-indigo-600\x20text-white\x20rounded-lg\x20text-sm\x20font-bold\x20shadow-sm\x20flex\x20items-center\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20data-lucide=\x22gift\x22\x20width=\x2214\x22></i>\x20','totalQty','edit-prize-total','results-table-body','checkout','<span\x20class=\x22px-2\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x22>รับแล้ว</span>','<span\x20class=\x22px-2\x20py-1\x20bg-gray-100\x20text-gray-500\x20rounded-full\x20text-xs\x22>ไม่ได้รางวัล</span>','rand-stat-rewarded','message','text-slate-400','DELETE','reduce','data-table-info','getContext','stat-rewarded','Check-OUT','general-modal','translate-x-full','<span\x20class=\x22text-slate-300\x22>-</span>','info','from','drawnWon','bg-white\x20border-l-4\x20border-green-500\x20text-slate-700','prize-qty','\x20รายการ)','</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-slate-500\x22>','622415vpegxa','Format\x20Invalid:\x20Root\x20must\x20be\x20an\x20array','map','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20text-slate-500\x20font-mono\x20text-sm\x22>','btn-import','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-4\x20z-10\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex-shrink-0\x20w-10\x20h-10\x20bg-gradient-to-br\x20from-yellow-400\x20to-orange-600\x20rounded-full\x20flex\x20items-center\x20justify-center\x20text-white\x20font-bold\x20text-lg\x20shadow-md\x20ring-2\x20ring-yellow-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ลบข้อมูลทั้งหมดเรียบร้อย\x20(','file-upload','Online','value','1:1070273157855:web:5c8120e1df27e233d8676a','opacity-50','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x22>','798XSWVBN','ref','size','encode','sort','\x27)\x22\x20class=\x22text-slate-400\x20hover:text-red-600\x20p-1\x22><i\x20data-lucide=\x22trash-2\x22\x20width=\x2214\x22></i></button></td></tr>','update','ลบของรางวัลสำเร็จ','ลงทะเบียนเข้า','text-white','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','handlePrizeUpdate','switchTab','notRewarded','bar-checkout','edit-prize-modal','edit-prize-name','commit','text','reset-confirm-modal',':00','ไม่ได้รางวัล','getElementById','claimed','data-qty','current-time','view-','EmpMember','onload','import-bar','chart-total-checkin','<div\x20class=\x22flex\x20items-start\x20gap-3\x20text-sm\x20p-2\x20rounded-lg\x20bg-slate-50\x20hover:bg-slate-100\x20transition\x22><div\x20class=\x22','coop_gift','line','\x20p-4\x20rounded-lg\x20shadow-lg\x20flex\x20items-start\x20gap-3\x20toast-enter\x20pointer-events-auto\x20transform\x20transition-all\x20duration-300','ต้องการลบของรางวัลนี้ใช่หรือไม่?','includes','text-green-400','Delete\x20Error','innerHTML','searchTerm','parse','596453UgLDSg','CheckIN','<div\x20class=\x22text-green-500\x22><i\x20data-lucide=\x22check-circle\x22\x20width=\x2220\x22></i></div>','filter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-6\x20py-4\x20font-bold\x20text-slate-400\x22>','\x20จากทั้งหมด\x20','EmpName','contains','เริ่มนำเข้าข้อมูล','undefined','screen-display-area','monitor-rewarded','out','selectedIndex','disabled','</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>','scrollTop','screen-overlay-controls','asc','eligible','743792xdOSTS','edit-prize-id','confirmResetData','chartInInstance','</p></div></div>','chartOutInstance','add','randomizer','innerText','showToast','handleSearch','startRandomizer','<span\x20class=\x22font-bold\x20text-indigo-600\x22>'];_0x250c=function(){return _0x19bd2b;};return _0x250c();}const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'users':[],'prizes':[],'stats':{'checkin':0x0,'checkout':0x0,'rewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notRewarded':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0},'isDrawing':![],'fileToImport':null,'rowsPerPage':0x32,'currentPage':0x1,'sortBy':_0x21739d(0x173),'sortOrder':'desc','searchTerm':''};async function sha256(_0xe43377){const _0x5bd9e5=_0x21739d,_0x3b10d5=new TextEncoder()[_0x5bd9e5(0x14b)](_0xe43377),_0x2a69aa=await crypto['subtle'][_0x5bd9e5(0x11b)](_0x5bd9e5(0x205),_0x3b10d5),_0x4d6ea5=Array[_0x5bd9e5(0x135)](new Uint8Array(_0x2a69aa));return _0x4d6ea5[_0x5bd9e5(0x13d)](_0x4e652e=>_0x4e652e[_0x5bd9e5(0xdd)](0x10)[_0x5bd9e5(0x1ab)](0x2,'0'))[_0x5bd9e5(0xfe)]('');}window['app']=window[_0x21739d(0x1d4)]||{},window[_0x21739d(0x1d4)][_0x21739d(0x18f)]=(_0x5b0713,_0x5c3ad9=_0x21739d(0xed))=>{const _0x396e11=_0x21739d,_0x1e7ed8=document[_0x396e11(0x15e)]('toast-container'),_0x45d474=document['createElement'](_0x396e11(0x1bf));let _0x5ce971,_0x115600;if(_0x5c3ad9===_0x396e11(0xed))_0x5ce971=_0x396e11(0x137),_0x115600=_0x396e11(0x174);else _0x5c3ad9===_0x396e11(0x1d1)?(_0x5ce971='bg-white\x20border-l-4\x20border-red-500\x20text-slate-700',_0x115600=_0x396e11(0x219)):(_0x5ce971=_0x396e11(0x117),_0x115600=_0x396e11(0xd0));_0x45d474[_0x396e11(0x1e3)]=_0x5ce971+_0x396e11(0x16a),_0x45d474[_0x396e11(0x16f)]=_0x115600+'<div\x20class=\x22flex-1\x20text-sm\x20font-medium\x22>'+_0x5b0713+_0x396e11(0x200),_0x1e7ed8[_0x396e11(0x213)](_0x45d474);if(window[_0x396e11(0x104)])lucide[_0x396e11(0x1f1)]();setTimeout(()=>{const _0x27ac47=_0x396e11;_0x45d474[_0x27ac47(0x1ea)]['add']('opacity-0',_0x27ac47(0x132)),setTimeout(()=>_0x45d474[_0x27ac47(0xd7)](),0x12c);},0xbb8);},window[_0x21739d(0x1d4)][_0x21739d(0x1eb)]=(_0x4050e2,_0x34fdd3)=>{const _0x4a5071=_0x21739d;document[_0x4a5071(0x15e)](_0x4a5071(0x1d2))['innerText']=_0x4050e2,document[_0x4a5071(0x15e)](_0x4a5071(0xf3))['innerText']=_0x34fdd3,document['getElementById'](_0x4a5071(0x131))[_0x4a5071(0x1ea)][_0x4a5071(0xd7)](_0x4a5071(0x1de));},window[_0x21739d(0x1d4)]['closeGeneralModal']=()=>document[_0x21739d(0x15e)]('general-modal')[_0x21739d(0x1ea)]['add'](_0x21739d(0x1de)),window[_0x21739d(0x1d4)][_0x21739d(0x1bd)]=()=>document[_0x21739d(0x15e)](_0x21739d(0x15b))[_0x21739d(0x1ea)][_0x21739d(0xd7)](_0x21739d(0x1de)),window[_0x21739d(0x1d4)]['closeResetModal']=()=>document[_0x21739d(0x15e)]('reset-confirm-modal')[_0x21739d(0x1ea)][_0x21739d(0x18c)](_0x21739d(0x1de)),window['app'][_0x21739d(0x154)]=_0x38950f=>{const _0x5d2584=_0x21739d;document[_0x5d2584(0x10d)]('.view-section')['forEach'](_0x3ec7e6=>_0x3ec7e6['classList']['add'](_0x5d2584(0x1de))),document[_0x5d2584(0x15e)](_0x5d2584(0x162)+_0x38950f)[_0x5d2584(0x1ea)][_0x5d2584(0xd7)](_0x5d2584(0x1de)),document[_0x5d2584(0x10d)](_0x5d2584(0x1d5))[_0x5d2584(0x1b4)](_0x3d3476=>{const _0x14f9f8=_0x5d2584;_0x3d3476[_0x14f9f8(0x1ea)][_0x14f9f8(0xd7)](_0x14f9f8(0x1ef),_0x14f9f8(0x151)),_0x3d3476['classList'][_0x14f9f8(0x18c)](_0x14f9f8(0x12a));});const _0x4141fa=document[_0x5d2584(0x15e)](_0x5d2584(0x1a1)+_0x38950f);_0x4141fa[_0x5d2584(0x1ea)]['remove'](_0x5d2584(0x12a)),_0x4141fa['classList']['add']('bg-slate-700',_0x5d2584(0x151));let _0x5f0157=_0x5d2584(0x1a6);if(_0x38950f===_0x5d2584(0x18d))_0x5f0157=_0x5d2584(0x1e8);if(_0x38950f==='prizes')_0x5f0157='จัดการของรางวัล';if(_0x38950f===_0x5d2584(0xe8))_0x5f0157=_0x5d2584(0xf8);if(_0x38950f===_0x5d2584(0xca))_0x5f0157=_0x5d2584(0x217);if(_0x38950f==='import')_0x5f0157=_0x5d2584(0x1d0);if(_0x38950f===_0x5d2584(0x1dd))_0x5f0157=_0x5d2584(0xd1);if(_0x38950f===_0x5d2584(0x10f))_0x5f0157=_0x5d2584(0x10c);document[_0x5d2584(0x15e)]('page-title')['innerText']=_0x5f0157,_0x38950f===_0x5d2584(0x18d)&&window['app'][_0x5d2584(0x1c6)]();},window[_0x21739d(0x1d4)]['changeRowsLimit']=_0x4490eb=>{const _0x475b52=_0x21739d;state[_0x475b52(0x1b5)]=parseInt(_0x4490eb),state[_0x475b52(0xbf)]=0x1,renderTable(state['users']);},window[_0x21739d(0x1d4)]['changePage']=_0x48c5a=>{const _0x36e6d8=_0x21739d;state[_0x36e6d8(0xbf)]+=_0x48c5a,renderTable(state[_0x36e6d8(0x1a5)]);},window[_0x21739d(0x1d4)][_0x21739d(0xce)]=_0x30159f=>{const _0x122298=_0x21739d;state[_0x122298(0x1b1)]=_0x30159f,state['currentPage']=0x1,renderTable(state[_0x122298(0x1a5)]);},window[_0x21739d(0x1d4)][_0x21739d(0x1d9)]=_0x5635e5=>{const _0x423ba1=_0x21739d;state[_0x423ba1(0x19d)]=_0x5635e5,state['currentPage']=0x1,renderTable(state[_0x423ba1(0x1a5)]);},window[_0x21739d(0x1d4)][_0x21739d(0x204)]=_0x1b7f06=>{const _0x3c7c4e=_0x21739d,_0x453352=_0x1b7f06[_0x3c7c4e(0x110)][_0x3c7c4e(0x111)][0x0];_0x453352&&(state[_0x3c7c4e(0x20d)]=_0x453352,document[_0x3c7c4e(0x15e)]('file-name')['innerText']=_0x453352['name'],document[_0x3c7c4e(0x15e)](_0x3c7c4e(0x1cf))['classList'][_0x3c7c4e(0xd7)](_0x3c7c4e(0x1de)),document[_0x3c7c4e(0x15e)](_0x3c7c4e(0x13f))['disabled']=![]);},window[_0x21739d(0x1d4)][_0x21739d(0x215)]=()=>{const _0x180f05=_0x21739d;state[_0x180f05(0x20d)]=null,document[_0x180f05(0x15e)](_0x180f05(0x142))[_0x180f05(0x144)]='',document[_0x180f05(0x15e)]('file-info')['classList']['add'](_0x180f05(0x1de)),document[_0x180f05(0x15e)](_0x180f05(0x13f))[_0x180f05(0x180)]=!![];},window[_0x21739d(0x1d4)][_0x21739d(0x190)]=_0x1624e0=>{const _0x41e3a3=_0x21739d;state[_0x41e3a3(0x170)]=_0x1624e0[_0x41e3a3(0x101)]()[_0x41e3a3(0x10a)](),state['currentPage']=0x1,renderTable(state[_0x41e3a3(0x1a5)]);},window['app'][_0x21739d(0x1d3)]=()=>{const _0x123f09=_0x21739d;if(!state[_0x123f09(0x20d)])return;const _0x2e3a02=state[_0x123f09(0x20d)],_0x286a0b=new FileReader();document['getElementById']('btn-import')[_0x123f09(0x180)]=!![],document[_0x123f09(0x15e)](_0x123f09(0x13f))[_0x123f09(0x18e)]=_0x123f09(0xf5),document[_0x123f09(0x15e)](_0x123f09(0xf1))[_0x123f09(0x1ea)][_0x123f09(0xd7)]('hidden'),_0x286a0b[_0x123f09(0x164)]=async _0x3fda90=>{const _0x118db5=_0x123f09;try{let _0xc4f7d1=[];const _0x40cefe=_0x3fda90[_0x118db5(0x110)][_0x118db5(0x1ba)];_0x2e3a02['name'][_0x118db5(0x1fe)](_0x118db5(0x106))?_0xc4f7d1=csvToJson(_0x40cefe):_0xc4f7d1=JSON[_0x118db5(0x171)](_0x40cefe);if(!Array['isArray'](_0xc4f7d1))throw new Error(_0x118db5(0x13c));const _0x10c578=_0xc4f7d1[_0x118db5(0x216)];let _0x1a54e6=0x0;const _0x53d7f2=0x190;for(let _0x4d7705=0x0;_0x4d7705<_0x10c578;_0x4d7705+=_0x53d7f2){const _0x134a8b=_0xc4f7d1['slice'](_0x4d7705,_0x4d7705+_0x53d7f2),_0x1e2d6e=writeBatch(db);for(const _0x8c14c4 of _0x134a8b){if(_0x8c14c4[_0x118db5(0x1f9)]){const _0x2991a6=_0x8c14c4[_0x118db5(0x1f9)][_0x118db5(0xdd)]()[_0x118db5(0xd4)](/-/g,'')[_0x118db5(0x101)](),_0x378731=await sha256(_0x2991a6),_0x5a95d3=doc(collection(db,finalCollectionPath));_0x1e2d6e['set'](_0x5a95d3,{..._0x8c14c4,'citizenId':_0x378731,'importedAt':serverTimestamp()});}}await _0x1e2d6e['commit'](),_0x1a54e6+=_0x134a8b[_0x118db5(0x216)];const _0x12606d=_0x1a54e6/_0x10c578*0x64;document[_0x118db5(0x15e)](_0x118db5(0x165))[_0x118db5(0x119)]['width']=_0x12606d+'%';}window[_0x118db5(0x1d4)][_0x118db5(0x18f)](_0x118db5(0xe6)+_0x10c578+_0x118db5(0xec),_0x118db5(0xed)),window[_0x118db5(0x1d4)][_0x118db5(0x215)]();}catch(_0x19883c){console[_0x118db5(0x1d1)](_0x19883c),window['app'][_0x118db5(0x18f)](_0x118db5(0xc9)+_0x19883c[_0x118db5(0x129)],_0x118db5(0x1d1));}finally{document[_0x118db5(0x15e)](_0x118db5(0x13f))[_0x118db5(0x180)]=![],document[_0x118db5(0x15e)](_0x118db5(0x13f))[_0x118db5(0x18e)]=_0x118db5(0x17a),document[_0x118db5(0x15e)](_0x118db5(0xf1))[_0x118db5(0x1ea)][_0x118db5(0x18c)](_0x118db5(0x1de));}},_0x286a0b[_0x123f09(0x116)](_0x2e3a02);},window[_0x21739d(0x1d4)]['deleteAllData']=async()=>{const _0x167d74=_0x21739d,_0x43ee93=prompt('พิมพ์\x20\x27DELETE\x27\x20เพื่อยืนยันการลบข้อมูลทั้งหมด');if(_0x43ee93!==_0x167d74(0x12b))return;const _0x5645bc=document[_0x167d74(0x1e0)]('#view-import\x20button[onclick*=\x22deleteAll\x22]'),_0x1bbaa2=_0x5645bc[_0x167d74(0x16f)];_0x5645bc[_0x167d74(0x180)]=!![],_0x5645bc[_0x167d74(0x18e)]=_0x167d74(0x1ee);try{const _0x3ad5d9=query(collection(db,finalCollectionPath)),_0x361675=await getDocs(_0x3ad5d9),_0x196bde=_0x361675[_0x167d74(0x14a)];if(_0x196bde===0x0){window[_0x167d74(0x1d4)][_0x167d74(0x18f)](_0x167d74(0x198),_0x167d74(0x134));return;}const _0x5f559f=0x190,_0xa25b77=[];let _0x56fff4=[];_0x361675['forEach'](_0x1b5b40=>{const _0xafc33f=_0x167d74;_0x56fff4[_0xafc33f(0x1fc)](_0x1b5b40),_0x56fff4[_0xafc33f(0x216)]>=_0x5f559f&&(_0xa25b77[_0xafc33f(0x1fc)](_0x56fff4),_0x56fff4=[]);});if(_0x56fff4[_0x167d74(0x216)]>0x0)_0xa25b77[_0x167d74(0x1fc)](_0x56fff4);for(const _0x351b52 of _0xa25b77){const _0x3d62b2=writeBatch(db);_0x351b52[_0x167d74(0x1b4)](_0x1c9cbd=>_0x3d62b2['delete'](_0x1c9cbd[_0x167d74(0x149)])),await _0x3d62b2[_0x167d74(0x159)]();}window['app']['showToast'](_0x167d74(0x141)+_0x196bde+_0x167d74(0x139),_0x167d74(0xed));}catch(_0x13e2ef){console[_0x167d74(0x1d1)](_0x13e2ef),window['app'][_0x167d74(0x18f)](_0x167d74(0x1c8),_0x167d74(0x1d1));}finally{_0x5645bc[_0x167d74(0x180)]=![],_0x5645bc[_0x167d74(0x16f)]=_0x1bbaa2;}},window[_0x21739d(0x1d4)][_0x21739d(0x188)]=async()=>{const _0x3718dd=_0x21739d;window[_0x3718dd(0x1d4)][_0x3718dd(0x1ae)]();const _0x454991=document[_0x3718dd(0x1e0)](_0x3718dd(0x214)),_0x3c2010=_0x454991['innerHTML'];_0x454991[_0x3718dd(0x180)]=!![],_0x454991[_0x3718dd(0x18e)]=_0x3718dd(0xf5);try{const _0x54e336=0x190;let _0x245322=0x0;const _0x4626b0=query(collection(db,finalCollectionPath)),_0x472a1b=await getDocs(_0x4626b0),_0x465d70=[];let _0x5c8c09=[];_0x472a1b['forEach'](_0x3deda5=>{const _0x406723=_0x3718dd;_0x5c8c09[_0x406723(0x1fc)](_0x3deda5),_0x5c8c09[_0x406723(0x216)]>=_0x54e336&&(_0x465d70[_0x406723(0x1fc)](_0x5c8c09),_0x5c8c09=[]);});if(_0x5c8c09['length']>0x0)_0x465d70[_0x3718dd(0x1fc)](_0x5c8c09);for(const _0xcd0146 of _0x465d70){const _0x5c2272=writeBatch(db);_0xcd0146['forEach'](_0x1b4b1e=>{const _0xd49fc=_0x3718dd;_0x5c2272[_0xd49fc(0x14e)](_0x1b4b1e[_0xd49fc(0x149)],{'CheckIN':deleteField(),'CheckOUT':deleteField(),'status':deleteField(),'reward':deleteField(),'rewardTime':deleteField(),'rewardClaimTime':deleteField(),'deviceId':deleteField(),'deviceUserAgent':deleteField()});}),await _0x5c2272['commit'](),_0x245322+=_0xcd0146[_0x3718dd(0x216)];}window[_0x3718dd(0x1d4)]['showToast'](_0x3718dd(0x1f2)+_0x245322+_0x3718dd(0xec),_0x3718dd(0xed));}catch(_0x18c892){console[_0x3718dd(0x1d1)](_0x3718dd(0x1cc),_0x18c892),window[_0x3718dd(0x1d4)][_0x3718dd(0x18f)](_0x3718dd(0x20e),_0x3718dd(0x1d1));}finally{_0x454991['disabled']=![],_0x454991[_0x3718dd(0x16f)]=_0x3c2010;}},window[_0x21739d(0x1d4)][_0x21739d(0xcd)]=async _0x52692d=>{const _0x4d79a0=_0x21739d;_0x52692d['preventDefault']();const _0x4a2820=document[_0x4d79a0(0x15e)]('prize-name')['value'][_0x4d79a0(0x101)](),_0x33f470=parseInt(document[_0x4d79a0(0x15e)](_0x4d79a0(0x138))['value']),_0x3befe7=parseInt(document['getElementById'](_0x4d79a0(0xc7))[_0x4d79a0(0x144)]||0x1);if(!_0x4a2820||_0x33f470<0x1)return;try{await addDoc(collection(db,prizesCollectionPath),{'name':_0x4a2820,'qtyPerDraw':_0x33f470,'totalQty':_0x3befe7,'createdAt':serverTimestamp()}),document['getElementById'](_0x4d79a0(0x10e))['reset'](),window[_0x4d79a0(0x1d4)][_0x4d79a0(0x18f)](_0x4d79a0(0x1c2),_0x4d79a0(0xed));}catch(_0x4df4d9){console[_0x4d79a0(0x1d1)](_0x4d79a0(0x1da),_0x4df4d9),window[_0x4d79a0(0x1d4)][_0x4d79a0(0x18f)](_0x4d79a0(0xfb),'error');}},window['app']['deletePrize']=async _0x31a818=>{const _0x2d0707=_0x21739d;if(!confirm(_0x2d0707(0x16b)))return;try{await deleteDoc(doc(db,prizesCollectionPath,_0x31a818)),window[_0x2d0707(0x1d4)][_0x2d0707(0x18f)](_0x2d0707(0x14f),_0x2d0707(0xed));}catch(_0x40639a){console['error'](_0x2d0707(0xe0),_0x40639a),window[_0x2d0707(0x1d4)][_0x2d0707(0x18f)](_0x2d0707(0x11c),'error');}},window[_0x21739d(0x1d4)][_0x21739d(0x1a2)]=(_0x2bac38,_0x1f0830,_0x1a84c3,_0x535078)=>{const _0x65e3b2=_0x21739d;document['getElementById'](_0x65e3b2(0x187))[_0x65e3b2(0x144)]=_0x2bac38,document['getElementById'](_0x65e3b2(0x158))['value']=_0x1f0830,document[_0x65e3b2(0x15e)]('edit-prize-qty')[_0x65e3b2(0x144)]=_0x1a84c3,document[_0x65e3b2(0x15e)](_0x65e3b2(0x123))[_0x65e3b2(0x144)]=_0x535078||0x1,document['getElementById'](_0x65e3b2(0x157))[_0x65e3b2(0x1ea)][_0x65e3b2(0xd7)](_0x65e3b2(0x1de));},window['app'][_0x21739d(0xc1)]=()=>document[_0x21739d(0x15e)]('edit-prize-modal')['classList']['add'](_0x21739d(0x1de)),window[_0x21739d(0x1d4)][_0x21739d(0x153)]=async _0x1d1cbe=>{const _0x313bc9=_0x21739d;_0x1d1cbe[_0x313bc9(0xfa)]();const _0xbaf813=document[_0x313bc9(0x15e)](_0x313bc9(0x187))[_0x313bc9(0x144)],_0x54dd31=document[_0x313bc9(0x15e)](_0x313bc9(0x158))['value'][_0x313bc9(0x101)](),_0x47b70e=parseInt(document[_0x313bc9(0x15e)](_0x313bc9(0x1f3))[_0x313bc9(0x144)]),_0xd1c3f1=parseInt(document[_0x313bc9(0x15e)]('edit-prize-total')[_0x313bc9(0x144)]);if(!_0xbaf813||!_0x54dd31||_0x47b70e<0x1)return;try{await updateDoc(doc(db,prizesCollectionPath,_0xbaf813),{'name':_0x54dd31,'qtyPerDraw':_0x47b70e,'totalQty':_0xd1c3f1}),window['app'][_0x313bc9(0xc1)](),window[_0x313bc9(0x1d4)][_0x313bc9(0x18f)](_0x313bc9(0x1fa),_0x313bc9(0xed));}catch(_0x3416c5){console[_0x313bc9(0x1d1)](_0x313bc9(0x103),_0x3416c5),window[_0x313bc9(0x1d4)][_0x313bc9(0x18f)](_0x313bc9(0x203),_0x313bc9(0x1d1));}},window[_0x21739d(0x1d4)][_0x21739d(0x210)]=async _0x50a57f=>{const _0x77369a=_0x21739d;if(!confirm(_0x77369a(0x1ac)))return;try{const _0x40ba71=doc(db,finalCollectionPath,_0x50a57f),_0x62d193=await getDoc(_0x40ba71);if(!_0x62d193['exists']()){window['app'][_0x77369a(0x18f)]('ไม่พบข้อมูล','error');return;}const _0x57ea5a=_0x62d193['data'](),_0x19630b=[_0x77369a(0xf9),_0x77369a(0x163),_0x77369a(0x178),_0x77369a(0x1f9),_0x77369a(0x1be)],_0x385a50={};_0x19630b[_0x77369a(0x1b4)](_0x43d0ed=>{if(_0x57ea5a[_0x43d0ed]!==undefined)_0x385a50[_0x43d0ed]=_0x57ea5a[_0x43d0ed];}),await setDoc(_0x40ba71,_0x385a50),window['app'][_0x77369a(0x18f)]('รีเซ็ตสถานะเรียบร้อย','success');}catch(_0x7ab8de){console[_0x77369a(0x1d1)](_0x77369a(0x16e),_0x7ab8de),window[_0x77369a(0x1d4)][_0x77369a(0x18f)]('เกิดข้อผิดพลาด',_0x77369a(0x1d1));}};function updateCharts(_0x26c0df,_0x1b7b60){const _0x27b65f=_0x21739d,_0x534e8e=document['getElementById']('registrationChart')['getContext']('2d'),_0x277a60=Array['from']({'length':0x18},(_0x33b5f7,_0x16d803)=>_0x16d803+_0x27b65f(0x15c)),_0x360cf8=_0x277a60[_0x27b65f(0x13d)]((_0x8dc63,_0x8f0234)=>_0x26c0df[_0x8f0234]||0x0);window[_0x27b65f(0x189)]?(window['chartInInstance']['data'][_0x27b65f(0x1d6)][0x0][_0x27b65f(0xca)]=_0x360cf8,window[_0x27b65f(0x189)][_0x27b65f(0x14e)]()):window[_0x27b65f(0x189)]=new Chart(_0x534e8e,{'type':_0x27b65f(0x169),'data':{'labels':_0x277a60,'datasets':[{'label':_0x27b65f(0x1ca),'data':_0x360cf8,'borderColor':_0x27b65f(0xc5),'backgroundColor':_0x27b65f(0x195),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});const _0x3ec8c7=document[_0x27b65f(0x15e)](_0x27b65f(0x21a))[_0x27b65f(0x12e)]('2d'),_0x119313=_0x277a60[_0x27b65f(0x13d)]((_0xc67233,_0x46b9f7)=>_0x1b7b60[_0x46b9f7]||0x0);window['chartOutInstance']?(window[_0x27b65f(0x18b)][_0x27b65f(0xca)][_0x27b65f(0x1d6)][0x0][_0x27b65f(0xca)]=_0x119313,window[_0x27b65f(0x18b)][_0x27b65f(0x14e)]()):window[_0x27b65f(0x18b)]=new Chart(_0x3ec8c7,{'type':'line','data':{'labels':_0x277a60,'datasets':[{'label':_0x27b65f(0x130),'data':_0x119313,'borderColor':_0x27b65f(0x206),'backgroundColor':_0x27b65f(0x1db),'fill':!![],'tension':0.4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function processSnapshot(_0x5d002b){const _0x12a4e2=_0x21739d,_0x1302a2=[],_0x490b06=[],_0xdf57d={'checkin':0x0,'checkout':0x0,'rewarded':0x0,'notRewarded':0x0,'claimed':0x0,'eligible':0x0,'totalDocs':0x0,'registered':0x0,'notYetDrawn':0x0,'drawnNoReward':0x0,'drawnWon':0x0};_0xdf57d[_0x12a4e2(0x197)]=_0x5d002b[_0x12a4e2(0x14a)];const _0x2f4979={},_0x5665d6={};_0x5d002b[_0x12a4e2(0x1b4)](_0x1d0609=>{const _0xf1c625=_0x12a4e2,_0x5d50bb=_0x1d0609[_0xf1c625(0xca)](),_0x143357={'id':_0x1d0609['id'],..._0x5d50bb};_0x1302a2[_0xf1c625(0x1fc)](_0x143357);if(_0x5d50bb[_0xf1c625(0x173)]){_0xdf57d['checkin']++;const _0x5d9018=_0x5d50bb['CheckIN']['toDate']?_0x5d50bb[_0xf1c625(0x173)][_0xf1c625(0x1f8)]():new Date(_0x5d50bb[_0xf1c625(0x173)]),_0x64ad24=_0x5d9018[_0xf1c625(0x1ed)]();_0x2f4979[_0x64ad24]=(_0x2f4979[_0x64ad24]||0x0)+0x1;}if(_0x5d50bb[_0xf1c625(0x1c5)]){_0xdf57d['checkout']++;const _0x38894f=_0x5d50bb[_0xf1c625(0x1c5)][_0xf1c625(0x1f8)]?_0x5d50bb[_0xf1c625(0x1c5)][_0xf1c625(0x1f8)]():new Date(_0x5d50bb[_0xf1c625(0x1c5)]),_0x30cdb6=_0x38894f['getHours']();_0x5665d6[_0x30cdb6]=(_0x5665d6[_0x30cdb6]||0x0)+0x1;}_0x5d50bb[_0xf1c625(0x1c1)]&&(_0x5d50bb[_0xf1c625(0x1c1)]==='ไม่ได้รับรางวัล'?_0xdf57d[_0xf1c625(0x155)]++:(_0xdf57d[_0xf1c625(0x1c9)]++,_0x490b06[_0xf1c625(0x1fc)](_0x143357)));if(_0x5d50bb[_0xf1c625(0x1e9)])_0xdf57d[_0xf1c625(0x15f)]++;if(_0x5d50bb[_0xf1c625(0x118)]&&_0x5d50bb['status'][_0xf1c625(0x101)]()!==''){_0xdf57d[_0xf1c625(0x20b)]++,_0xdf57d[_0xf1c625(0x185)]++;if(!_0x5d50bb['reward'])_0xdf57d['notYetDrawn']++;else _0x5d50bb['reward']===_0xf1c625(0x15d)?_0xdf57d['drawnNoReward']++:_0xdf57d[_0xf1c625(0x136)]++;}}),_0x1302a2['sort']((_0x24da8c,_0x362f7f)=>{return 0x0;}),state['users']=_0x1302a2,state[_0x12a4e2(0xe7)]=_0xdf57d,updateDashboardUI(_0xdf57d),updateCharts(_0x2f4979,_0x5665d6),renderActivityFeed(_0x1302a2),renderTable(_0x1302a2),window['app'][_0x12a4e2(0x100)](),document[_0x12a4e2(0x15e)](_0x12a4e2(0xba))[_0x12a4e2(0x1ea)][_0x12a4e2(0x179)]('hidden')===![]&&window[_0x12a4e2(0x1d4)]['onPrizeSelect']();}function csvToJson(_0x4921fe){const _0x35d681=_0x21739d,_0x20aa41=_0x4921fe[_0x35d681(0x11f)]('\x0a'),_0x2537bf=_0x20aa41[0x0][_0x35d681(0x11f)](',')[_0x35d681(0x13d)](_0x12e09a=>_0x12e09a['trim']());return _0x20aa41[_0x35d681(0xee)](0x1)['map'](_0xbe7bef=>{const _0x5d23c7=_0x35d681,_0x43aec6=_0xbe7bef[_0x5d23c7(0x11f)](',');if(_0x43aec6['length']<_0x2537bf['length'])return null;return _0x2537bf[_0x5d23c7(0x12c)]((_0x3d8283,_0x2cb7ca,_0x41aa77)=>{return _0x3d8283[_0x2cb7ca]=_0x43aec6[_0x41aa77]?_0x43aec6[_0x41aa77]['trim']():'',_0x3d8283;},{});})[_0x35d681(0x175)](_0x13d4ce=>_0x13d4ce);}function updateDashboardUI(_0x38462b){const _0x1e3477=_0x21739d;document['getElementById'](_0x1e3477(0x212))['innerText']=_0x38462b[_0x1e3477(0x20f)],document['getElementById']('stat-checkout')[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x125)],document[_0x1e3477(0x15e)](_0x1e3477(0x12f))[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x1c9)],document[_0x1e3477(0x15e)](_0x1e3477(0xcc))[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x15f)],document['getElementById'](_0x1e3477(0x113))[_0x1e3477(0x18e)]='จากผู้มีสิทธิ์ลุ้น\x20'+_0x38462b['eligible']+'\x20คน';if(document[_0x1e3477(0x15e)](_0x1e3477(0xdc)))document[_0x1e3477(0x15e)]('stat-noreward')[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x155)];document[_0x1e3477(0x15e)](_0x1e3477(0x166))[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x20f)],document['getElementById'](_0x1e3477(0x1a9))[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x125)],document[_0x1e3477(0x15e)]('label-eligible-count')['innerText']=_0x38462b[_0x1e3477(0x185)],document[_0x1e3477(0x15e)](_0x1e3477(0x1a8))[_0x1e3477(0x18e)]=_0x38462b[_0x1e3477(0x197)];const _0x4f4da9=_0x38462b[_0x1e3477(0x20f)]>0x0?_0x38462b[_0x1e3477(0x125)]/_0x38462b['checkin']*0x64:0x0;document[_0x1e3477(0x15e)](_0x1e3477(0x156))[_0x1e3477(0x119)][_0x1e3477(0xf7)]=_0x4f4da9+'%';}function renderTable(_0x48e62c){const _0x50a0bd=_0x21739d,_0x391ff5=document[_0x50a0bd(0x15e)]('table-body'),_0x4b641f=document[_0x50a0bd(0x15e)](_0x50a0bd(0x12d));let _0x35cfd1=_0x48e62c;state[_0x50a0bd(0x170)]&&(_0x35cfd1=_0x48e62c[_0x50a0bd(0x175)](_0x49ab5e=>{const _0x12bf5f=_0x50a0bd,_0x4e0e35=(_0x49ab5e[_0x12bf5f(0x178)]||'')[_0x12bf5f(0x10a)](),_0x1264f9=(_0x49ab5e[_0x12bf5f(0xf9)]||'')[_0x12bf5f(0xdd)]()[_0x12bf5f(0x10a)]();return _0x4e0e35[_0x12bf5f(0x16c)](state[_0x12bf5f(0x170)])||_0x1264f9[_0x12bf5f(0x16c)](state[_0x12bf5f(0x170)]);}));const _0x1d8cc2=[..._0x35cfd1][_0x50a0bd(0x14c)]((_0x5276c0,_0x394c06)=>{const _0x3ec386=_0x50a0bd,_0x4ea441=state[_0x3ec386(0x1b1)]||'CheckIN';let _0x2fe324=_0x5276c0[_0x4ea441],_0x1bac86=_0x394c06[_0x4ea441];if(_0x4ea441===_0x3ec386(0x173)||_0x4ea441===_0x3ec386(0x1c5)){const _0xd77e07=_0x2fe324?_0x2fe324[_0x3ec386(0x1f8)]?_0x2fe324['toDate']()[_0x3ec386(0xc0)]():new Date(_0x2fe324)[_0x3ec386(0xc0)]():0x0,_0x2c724a=_0x1bac86?_0x1bac86['toDate']?_0x1bac86['toDate']()['getTime']():new Date(_0x1bac86)['getTime']():0x0;return state[_0x3ec386(0x19d)]==='asc'?_0xd77e07-_0x2c724a:_0x2c724a-_0xd77e07;}if(typeof _0x2fe324===_0x3ec386(0x20c))_0x2fe324=_0x2fe324[_0x3ec386(0x10a)]();else _0x2fe324='';if(typeof _0x1bac86===_0x3ec386(0x20c))_0x1bac86=_0x1bac86[_0x3ec386(0x10a)]();else _0x1bac86='';if(_0x2fe324<_0x1bac86)return state[_0x3ec386(0x19d)]===_0x3ec386(0x184)?-0x1:0x1;if(_0x2fe324>_0x1bac86)return state[_0x3ec386(0x19d)]===_0x3ec386(0x184)?0x1:-0x1;return 0x0;}),_0x46f643=state['rowsPerPage']===0x1869f?_0x1d8cc2[_0x50a0bd(0x216)]:state[_0x50a0bd(0x1b5)],_0x316e66=Math[_0x50a0bd(0x1cb)](_0x1d8cc2[_0x50a0bd(0x216)]/_0x46f643);if(state[_0x50a0bd(0xbf)]>_0x316e66)state['currentPage']=_0x316e66>0x0?_0x316e66:0x1;const _0x33c060=(state[_0x50a0bd(0xbf)]-0x1)*_0x46f643,_0x1726e1=_0x33c060+_0x46f643,_0x5f59e9=_0x1d8cc2[_0x50a0bd(0xee)](_0x33c060,_0x1726e1);document[_0x50a0bd(0x15e)]('page-indicator')[_0x50a0bd(0x18e)]=_0x50a0bd(0x1ec)+state[_0x50a0bd(0xbf)]+_0x50a0bd(0x1e6)+(_0x316e66||0x1),document[_0x50a0bd(0x15e)](_0x50a0bd(0x1c3))[_0x50a0bd(0x180)]=state[_0x50a0bd(0xbf)]<=0x1,document[_0x50a0bd(0x15e)](_0x50a0bd(0xe9))[_0x50a0bd(0x180)]=state[_0x50a0bd(0xbf)]>=_0x316e66;const _0x4d8dcf=state[_0x50a0bd(0x19d)]===_0x50a0bd(0x184)?'\x20(น้อยไปมาก)':_0x50a0bd(0x1b7);_0x4b641f[_0x50a0bd(0x18e)]=_0x50a0bd(0xfc)+_0x5f59e9['length']+_0x50a0bd(0x177)+_0x48e62c[_0x50a0bd(0x216)]+_0x50a0bd(0x1d8)+sortByToLabel(state[_0x50a0bd(0x1b1)])+_0x4d8dcf+')',_0x391ff5[_0x50a0bd(0x16f)]=_0x5f59e9['map']((_0x594adc,_0x3f9807)=>{const _0x6cb0=_0x50a0bd,_0x301a80=_0x594adc['CheckIN']?(_0x594adc[_0x6cb0(0x173)][_0x6cb0(0x1f8)]?_0x594adc['CheckIN'][_0x6cb0(0x1f8)]():new Date(_0x594adc[_0x6cb0(0x173)]))[_0x6cb0(0xef)](_0x6cb0(0x1c4)):'-',_0x164c4c=_0x594adc[_0x6cb0(0x1c5)]?(_0x594adc[_0x6cb0(0x1c5)][_0x6cb0(0x1f8)]?_0x594adc[_0x6cb0(0x1c5)][_0x6cb0(0x1f8)]():new Date(_0x594adc[_0x6cb0(0x1c5)]))[_0x6cb0(0xef)](_0x6cb0(0x1c4)):'-',_0x243f74=_0x594adc[_0x6cb0(0x1c1)]||_0x6cb0(0x133),_0x5f45d4=_0x594adc[_0x6cb0(0x1e9)]?_0x6cb0(0x126):_0x594adc[_0x6cb0(0x1c1)]?_0x594adc[_0x6cb0(0x1c1)]===_0x6cb0(0x1e7)?_0x6cb0(0x127):_0x6cb0(0x1ad):'-',_0x22f566=_0x594adc[_0x6cb0(0x178)]||_0x6cb0(0xd9)+_0x594adc[_0x6cb0(0x1f9)]['substring'](0x0,0x6)+'...</span>';return'<tr\x20class=\x22bg-white\x20even:bg-slate-50\x20hover:bg-indigo-50\x20transition\x20table-compact\x20text-sm\x22><td\x20class=\x22px-6\x20text-slate-500\x22>'+(_0x33c060+_0x3f9807+0x1)+_0x6cb0(0x1c7)+_0x22f566+'</td><td\x20class=\x22px-6\x20text-slate-600\x20text-xs\x22>'+_0x301a80+_0x6cb0(0x181)+_0x164c4c+_0x6cb0(0x1f6)+_0x243f74+_0x6cb0(0x19a)+_0x5f45d4+_0x6cb0(0xde)+_0x594adc['id']+_0x6cb0(0x14d);})[_0x50a0bd(0xfe)]('');if(window[_0x50a0bd(0x104)])lucide[_0x50a0bd(0x1f1)]();}function sortByToLabel(_0x1bd275){const _0x20360a=_0x21739d;switch(_0x1bd275){case _0x20360a(0x173):return _0x20360a(0x1d7);case _0x20360a(0x1c5):return _0x20360a(0xd6);case _0x20360a(0x1c1):return'ของรางวัล';case _0x20360a(0x178):return'ชื่อ';default:return _0x1bd275;}}window[_0x21739d(0x1d4)][_0x21739d(0x100)]=()=>{const _0x584a62=_0x21739d,_0x135158=state[_0x584a62(0xe7)];document['getElementById'](_0x584a62(0x1e4))['innerText']=_0x135158[_0x584a62(0x197)],document[_0x584a62(0x15e)]('monitor-registered')['innerText']=_0x135158['registered'],document['getElementById'](_0x584a62(0xff))[_0x584a62(0x18e)]=_0x135158[_0x584a62(0x1c9)],document[_0x584a62(0x15e)](_0x584a62(0x17d))['innerText']=_0x135158[_0x584a62(0x1c9)],document[_0x584a62(0x15e)](_0x584a62(0xe5))['innerText']=_0x135158['notRewarded'],document[_0x584a62(0x15e)]('rand-stat-total')['innerText']=_0x135158['totalDocs'];if(document[_0x584a62(0x15e)](_0x584a62(0x19f)))document[_0x584a62(0x15e)](_0x584a62(0x19f))[_0x584a62(0x18e)]=_0x135158['notYetDrawn'];if(document[_0x584a62(0x15e)](_0x584a62(0x128)))document[_0x584a62(0x15e)](_0x584a62(0x128))[_0x584a62(0x18e)]=_0x135158[_0x584a62(0xea)];if(document[_0x584a62(0x15e)]('rand-stat-claimed'))document['getElementById'](_0x584a62(0x1a0))[_0x584a62(0x18e)]=_0x135158[_0x584a62(0x136)];document[_0x584a62(0x15e)](_0x584a62(0x193))&&(document[_0x584a62(0x15e)](_0x584a62(0x193))[_0x584a62(0x18e)]=_0x135158[_0x584a62(0x185)]);const _0xca7653=document[_0x584a62(0x15e)]('filter-results-status')[_0x584a62(0x144)];let _0x1b9dcc=[];if(_0xca7653===_0x584a62(0x1b6))_0x1b9dcc=state[_0x584a62(0x1a5)]['filter'](_0x4084a8=>_0x4084a8['reward']===_0x584a62(0x1e7));else{let _0x290160=state[_0x584a62(0x1a5)][_0x584a62(0x175)](_0x1b3e47=>_0x1b3e47[_0x584a62(0x1c1)]&&_0x1b3e47['reward']!==_0x584a62(0x1e7));if(_0xca7653===_0x584a62(0x15f))_0x1b9dcc=_0x290160[_0x584a62(0x175)](_0xf2f6c3=>_0xf2f6c3[_0x584a62(0x1e9)]);else _0xca7653===_0x584a62(0x1b3)?_0x1b9dcc=_0x290160['filter'](_0x3a355e=>!_0x3a355e[_0x584a62(0x1e9)]):_0x1b9dcc=_0x290160;}_0x1b9dcc[_0x584a62(0x14c)]((_0x502f3e,_0x283f59)=>{const _0x5bcc24=_0x584a62,_0x515006=_0x502f3e[_0x5bcc24(0x10b)]?_0x502f3e['rewardTime'][_0x5bcc24(0x1f8)]?_0x502f3e[_0x5bcc24(0x10b)]['toDate']():new Date(_0x502f3e[_0x5bcc24(0x10b)]):new Date(0x0),_0x416e12=_0x283f59['rewardTime']?_0x283f59[_0x5bcc24(0x10b)][_0x5bcc24(0x1f8)]?_0x283f59[_0x5bcc24(0x10b)][_0x5bcc24(0x1f8)]():new Date(_0x283f59[_0x5bcc24(0x10b)]):new Date(0x0);return _0x416e12-_0x515006;});const _0x1a430a=document['getElementById'](_0x584a62(0x124));if(_0x1b9dcc['length']===0x0){_0x1a430a[_0x584a62(0x16f)]=_0x584a62(0x112);return;}_0x1a430a[_0x584a62(0x16f)]=_0x1b9dcc[_0x584a62(0x13d)]((_0x2bb767,_0x519f3f)=>{const _0x5e086a=_0x584a62,_0x565c21=_0x2bb767[_0x5e086a(0x10b)]?_0x2bb767[_0x5e086a(0x10b)][_0x5e086a(0x1f8)]?_0x2bb767[_0x5e086a(0x10b)][_0x5e086a(0x1f8)]():new Date(_0x2bb767[_0x5e086a(0x10b)]):new Date(),_0x18d34a=_0x2bb767[_0x5e086a(0x178)]||(_0x2bb767[_0x5e086a(0x1f9)]?_0x2bb767[_0x5e086a(0x1f9)][_0x5e086a(0x1df)](0x0,0xa)+_0x5e086a(0xdb):'-');let _0x2396e2='';if(_0x2bb767[_0x5e086a(0x1c1)]===_0x5e086a(0x1e7))_0x2396e2=_0x5e086a(0x199);else _0x2bb767[_0x5e086a(0x1e9)]?_0x2396e2=_0x5e086a(0xcf):_0x2396e2=_0x5e086a(0xf0);const _0x5cb392=_0x2bb767['reward']===_0x5e086a(0x1e7)?_0x5e086a(0x1f7):_0x5e086a(0x192)+_0x2bb767[_0x5e086a(0x1c1)]+'</span>';return _0x5e086a(0x176)+(_0x519f3f+0x1)+_0x5e086a(0x1b9)+_0x18d34a+_0x5e086a(0x147)+_0x5cb392+_0x5e086a(0x13e)+(_0x2bb767[_0x5e086a(0x10b)]?_0x565c21[_0x5e086a(0xeb)]('th-TH'):'-')+_0x5e086a(0x147)+_0x2396e2+_0x5e086a(0x218);})[_0x584a62(0xfe)]('');};function renderActivityFeed(_0x3cdef5){const _0x204f45=_0x21739d,_0x342b65=document[_0x204f45(0x15e)](_0x204f45(0x207));let _0x3476fc=[];_0x3cdef5[_0x204f45(0x1b4)](_0x8f0ea7=>{const _0x10d5ce=_0x204f45,_0x4239dc=_0x8f0ea7[_0x10d5ce(0x178)]||_0x10d5ce(0xd8)+(_0x8f0ea7[_0x10d5ce(0x1f9)]?_0x8f0ea7[_0x10d5ce(0x1f9)]['slice'](-0x4):'UNKNOWN');if(_0x8f0ea7[_0x10d5ce(0x173)])_0x3476fc[_0x10d5ce(0x1fc)]({'type':'in','date':_0x8f0ea7[_0x10d5ce(0x173)][_0x10d5ce(0x1f8)]?_0x8f0ea7['CheckIN'][_0x10d5ce(0x1f8)]():new Date(_0x8f0ea7[_0x10d5ce(0x173)]),'name':_0x4239dc,'id':_0x8f0ea7['id']});if(_0x8f0ea7['CheckOUT'])_0x3476fc[_0x10d5ce(0x1fc)]({'type':'out','date':_0x8f0ea7[_0x10d5ce(0x1c5)][_0x10d5ce(0x1f8)]?_0x8f0ea7[_0x10d5ce(0x1c5)]['toDate']():new Date(_0x8f0ea7[_0x10d5ce(0x1c5)]),'name':_0x4239dc,'id':_0x8f0ea7['id']});}),_0x3476fc[_0x204f45(0x14c)]((_0x2414ad,_0xb94f96)=>_0xb94f96['date']-_0x2414ad[_0x204f45(0x114)]);const _0x40b369=_0x3476fc[_0x204f45(0xee)](0x0,0x32);if(_0x40b369[_0x204f45(0x216)]===0x0){_0x342b65[_0x204f45(0x16f)]=_0x204f45(0x120);return;}_0x342b65['innerHTML']=_0x40b369[_0x204f45(0x13d)](_0x954c9d=>{const _0x1d402d=_0x204f45,_0x4348e1=_0x954c9d['date']['toLocaleDateString'](_0x1d402d(0x1c4))+'\x20'+_0x954c9d[_0x1d402d(0x114)]['toLocaleTimeString'](_0x1d402d(0x1c4));let _0x343da9='user-plus',_0x554069=_0x1d402d(0x11a),_0x1fe576=_0x1d402d(0x150);return _0x954c9d['type']===_0x1d402d(0x17e)&&(_0x343da9='log-out',_0x554069='text-orange-500',_0x1fe576='ลงทะเบียนออก'),_0x1d402d(0x167)+_0x554069+'\x20mt-0.5\x22><i\x20data-lucide=\x22'+_0x343da9+'\x22\x20width=\x2216\x22></i></div><div\x20class=\x22text-slate-600\x22><p\x20class=\x22font-medium\x22>'+_0x954c9d[_0x1d402d(0xbb)]+_0x1d402d(0x1bb)+_0x1fe576+')</span></p><p\x20class=\x22text-[10px]\x20text-slate-400\x22>'+_0x4348e1+_0x1d402d(0x18a);})[_0x204f45(0xfe)]('');if(window['lucide'])lucide[_0x204f45(0x1f1)]();}function processPrizesSnapshot(_0x450ca8){const _0x1566b4=_0x21739d,_0x53e967=[];_0x450ca8[_0x1566b4(0x1b4)](_0xdf1d89=>{const _0x4b6b8b=_0x1566b4;_0x53e967[_0x4b6b8b(0x1fc)]({'id':_0xdf1d89['id'],..._0xdf1d89[_0x4b6b8b(0xca)]()});}),state[_0x1566b4(0x21b)]=_0x53e967,renderPrizeList(_0x53e967),renderPrizeOptions(_0x53e967),document[_0x1566b4(0x15e)](_0x1566b4(0xba))[_0x1566b4(0x1ea)][_0x1566b4(0x179)](_0x1566b4(0x1de))===![]&&window[_0x1566b4(0x1d4)][_0x1566b4(0x1c6)]();}function renderPrizeList(_0x32b209){const _0x4dcd0c=_0x21739d,_0x558e1f=document[_0x4dcd0c(0x15e)](_0x4dcd0c(0x1a3)),_0x3c0720=document[_0x4dcd0c(0x15e)](_0x4dcd0c(0x1fd)),_0x503d25=_0x32b209[_0x4dcd0c(0x12c)]((_0x6ed754,_0x3d7e89)=>_0x6ed754+(parseInt(_0x3d7e89['totalQty'])||0x0),0x0);_0x3c0720[_0x4dcd0c(0x18e)]=_0x503d25[_0x4dcd0c(0xef)]();if(_0x32b209[_0x4dcd0c(0x216)]===0x0){_0x558e1f[_0x4dcd0c(0x16f)]=_0x4dcd0c(0x1e5);return;}_0x558e1f[_0x4dcd0c(0x16f)]=_0x32b209['map']((_0x244de4,_0x38432b)=>_0x4dcd0c(0x1bc)+_0x244de4[_0x4dcd0c(0xbb)]+_0x4dcd0c(0x13a)+(_0x244de4[_0x4dcd0c(0xd5)]||0x1)+'</td><td\x20class=\x22px-4\x20py-3\x20text-center\x20text-slate-500\x22>'+(_0x244de4[_0x4dcd0c(0x122)]||'-')+'</td><td\x20class=\x22px-4\x20py-3\x20text-right\x22><button\x20onclick=\x22window.app.openEditPrizeModal(\x27'+_0x244de4['id']+_0x4dcd0c(0x1ce)+_0x244de4[_0x4dcd0c(0xbb)]+_0x4dcd0c(0x1aa)+(_0x244de4[_0x4dcd0c(0xd5)]||0x1)+',\x20'+(_0x244de4[_0x4dcd0c(0x122)]||0x1)+')\x22\x20class=\x22text-blue-500\x20hover:text-blue-700\x20mr-2\x22><i\x20data-lucide=\x22edit-3\x22\x20width=\x2216\x22\x20class=\x22inline\x22></i></button><button\x20onclick=\x22window.app.deletePrize(\x27'+_0x244de4['id']+_0x4dcd0c(0x1af))['join']('');if(window[_0x4dcd0c(0x104)])lucide[_0x4dcd0c(0x1f1)]();}function renderPrizeOptions(_0x52865e){const _0x38d642=_0x21739d,_0x340af5=document[_0x38d642(0x15e)]('select-prize'),_0x5e81df=_0x340af5['value'];_0x340af5[_0x38d642(0x16f)]=_0x38d642(0xc8)+_0x52865e[_0x38d642(0x13d)](_0xf08b83=>'<option\x20value=\x22'+_0xf08b83['id']+_0x38d642(0x1a4)+_0xf08b83[_0x38d642(0xd5)]+_0x38d642(0x208)+(_0xf08b83[_0x38d642(0x122)]||0x270f)+'\x22>'+_0xf08b83[_0x38d642(0xbb)]+_0x38d642(0x1dc))[_0x38d642(0xfe)](''),_0x340af5['value']=_0x5e81df;}window[_0x21739d(0x1d4)][_0x21739d(0x1c6)]=()=>{const _0x4b61c6=_0x21739d,_0x2ffc4b=document[_0x4b61c6(0x15e)](_0x4b61c6(0xe4)),_0x6c72fc=_0x2ffc4b[_0x4b61c6(0x20a)][_0x2ffc4b[_0x4b61c6(0x17f)]];if(!_0x2ffc4b[_0x4b61c6(0x144)]||!_0x6c72fc['hasAttribute'](_0x4b61c6(0x160))){document[_0x4b61c6(0x15e)](_0x4b61c6(0xe2))[_0x4b61c6(0x180)]=!![],document[_0x4b61c6(0x15e)]('btn-start-random')[_0x4b61c6(0x1ea)][_0x4b61c6(0x18c)](_0x4b61c6(0x146),'cursor-not-allowed');return;}const _0x2e2b0f=_0x6c72fc[_0x4b61c6(0x19c)]('data-qty'),_0xa73dbc=parseInt(_0x6c72fc[_0x4b61c6(0x19c)]('data-total')||0x0),_0x24a5ff=_0x6c72fc['text'],_0x3d4240=state[_0x4b61c6(0x1a5)]['filter'](_0x7c16c2=>_0x7c16c2[_0x4b61c6(0x1c1)]===_0x24a5ff)['length'],_0x352b8a=_0xa73dbc-_0x3d4240;document[_0x4b61c6(0x15e)]('input-draw-qty')[_0x4b61c6(0x144)]=_0x2e2b0f,document[_0x4b61c6(0x15e)](_0x4b61c6(0x202))[_0x4b61c6(0x18e)]=_0x352b8a+_0x4b61c6(0x107)+_0xa73dbc,document[_0x4b61c6(0x15e)](_0x4b61c6(0x1fb))[_0x4b61c6(0x1cd)]=_0x352b8a>0x0?_0x352b8a:0x0,window['app']['validateRandomizerInput']();},window[_0x21739d(0x1d4)][_0x21739d(0xc4)]=()=>{const _0x1a6205=_0x21739d,_0x5b20fc=document['getElementById'](_0x1a6205(0xe4)),_0x438816=document[_0x1a6205(0x15e)](_0x1a6205(0x1fb)),_0x837372=document[_0x1a6205(0x15e)](_0x1a6205(0xe2)),_0x20e8d5=_0x5b20fc[_0x1a6205(0x144)],_0x2ebd69=parseInt(_0x438816['value']);if(!_0x20e8d5){_0x837372[_0x1a6205(0x180)]=!![],_0x837372[_0x1a6205(0x1ea)][_0x1a6205(0x18c)]('opacity-50',_0x1a6205(0xbc));return;}const _0x1a3f08=_0x5b20fc[_0x1a6205(0x20a)][_0x5b20fc['selectedIndex']],_0x4fc147=parseInt(_0x1a3f08[_0x1a6205(0x19c)](_0x1a6205(0x1f4))||0x0),_0x56e212=_0x1a3f08[_0x1a6205(0x15a)],_0x70cdac=state['users'][_0x1a6205(0x175)](_0xf0e5d5=>_0xf0e5d5[_0x1a6205(0x1c1)]===_0x56e212)[_0x1a6205(0x216)],_0x45958a=_0x4fc147-_0x70cdac;_0x2ebd69>0x0&&_0x2ebd69<=_0x45958a?(_0x837372[_0x1a6205(0x180)]=![],_0x837372[_0x1a6205(0x1ea)][_0x1a6205(0xd7)](_0x1a6205(0x146),_0x1a6205(0xbc)),document[_0x1a6205(0x15e)](_0x1a6205(0x1b8))[_0x1a6205(0x1ea)][_0x1a6205(0x18c)](_0x1a6205(0x1de))):(_0x837372[_0x1a6205(0x180)]=!![],_0x837372[_0x1a6205(0x1ea)][_0x1a6205(0x18c)](_0x1a6205(0x146),_0x1a6205(0xbc)),_0x2ebd69>_0x45958a&&(document[_0x1a6205(0x15e)](_0x1a6205(0x1b8))[_0x1a6205(0x18e)]=_0x1a6205(0xc6)+_0x45958a+')',document[_0x1a6205(0x15e)]('qty-warning')[_0x1a6205(0x1ea)][_0x1a6205(0xd7)](_0x1a6205(0x1de))));};function fireConfetti(){const _0x2ea784=_0x21739d;typeof confetti==='function'&&confetti({'particleCount':0x96,'spread':0x46,'origin':{'y':0.6},'colors':[_0x2ea784(0x102),_0x2ea784(0x1f0),_0x2ea784(0xc3),'#4B0082',_0x2ea784(0xda)]});}function createWinnerCard(_0x122c88,_0x1463a6,_0x122b5c){const _0x572cd7=_0x21739d,_0x25e049=document[_0x572cd7(0x11d)](_0x572cd7(0x1bf));_0x25e049['className']=_0x572cd7(0xfd);const _0xa0aaf6=_0x122c88[_0x572cd7(0x178)]||'ID:\x20'+(_0x122c88[_0x572cd7(0x1f9)]?_0x122c88[_0x572cd7(0x1f9)][_0x572cd7(0x1df)](0x0,0xa):_0x572cd7(0xf6))+_0x572cd7(0xdb);return _0x25e049[_0x572cd7(0x16f)]=_0x572cd7(0x140)+_0x1463a6+_0x572cd7(0x1f5)+_0xa0aaf6+_0x572cd7(0x121)+_0x122b5c+_0x572cd7(0xd2),_0x25e049;}function addHistoryLog(_0x35eee5,_0x3cdc86){}window[_0x21739d(0x1d4)][_0x21739d(0x1c0)]=()=>{},window[_0x21739d(0x1d4)][_0x21739d(0x191)]=async()=>{const _0x48f202=_0x21739d;if(state[_0x48f202(0x211)])return;const _0xdb0f93=document[_0x48f202(0x15e)](_0x48f202(0xe4)),_0x2636b7=_0xdb0f93[_0x48f202(0x20a)][_0xdb0f93[_0x48f202(0x17f)]]?.[_0x48f202(0x15a)],_0x31b11f=parseInt(document['getElementById'](_0x48f202(0x1fb))['value']),_0x40af00=parseInt(_0xdb0f93[_0x48f202(0x20a)][_0xdb0f93[_0x48f202(0x17f)]][_0x48f202(0x19c)](_0x48f202(0x1f4))),_0x2558c2=state[_0x48f202(0x1a5)]['filter'](_0x507682=>_0x507682[_0x48f202(0x1c1)]===_0x2636b7)['length'],_0x5c8b88=_0x40af00-_0x2558c2;if(!_0x2636b7)return window[_0x48f202(0x1d4)][_0x48f202(0x1eb)](_0x48f202(0x1e1),_0x48f202(0xe1));if(_0x31b11f<0x1)return window[_0x48f202(0x1d4)]['showModal'](_0x48f202(0x1e1),_0x48f202(0x19e));if(_0x31b11f>_0x5c8b88)return window['app'][_0x48f202(0x1eb)](_0x48f202(0x1e1),_0x48f202(0x1e2)+_0x5c8b88+'\x20รางวัล)');const _0x5a25ac=state[_0x48f202(0x1a5)][_0x48f202(0x175)](_0x2787fa=>_0x2787fa[_0x48f202(0x118)]&&_0x2787fa[_0x48f202(0x118)]['trim']()!==''&&!_0x2787fa[_0x48f202(0x1c1)]);if(_0x5a25ac[_0x48f202(0x216)]===0x0)return window[_0x48f202(0x1d4)][_0x48f202(0x1eb)](_0x48f202(0x1e1),'ไม่มีผู้มีสิทธิ์ลุ้นรางวัลเหลืออยู่');if(_0x5a25ac[_0x48f202(0x216)]<_0x31b11f){if(!confirm('มีผู้มีสิทธิ์เพียง\x20'+_0x5a25ac[_0x48f202(0x216)]+'\x20คน\x20ต้องการสุ่มทั้งหมดหรือไม่?'))return;}state[_0x48f202(0x211)]=!![];const _0x339ab5=document[_0x48f202(0x15e)](_0x48f202(0xe2));_0x339ab5[_0x48f202(0x180)]=!![],_0x339ab5[_0x48f202(0x1ea)][_0x48f202(0x18c)](_0x48f202(0x146),_0x48f202(0xbc)),document['getElementById'](_0x48f202(0x1b2))[_0x48f202(0x18e)]=_0x2636b7,document[_0x48f202(0x15e)](_0x48f202(0x17c))[_0x48f202(0x16f)]='';const _0x121576=document[_0x48f202(0x15e)](_0x48f202(0x183));_0x121576[_0x48f202(0x1ea)][_0x48f202(0xd7)](_0x48f202(0x1de)),await new Promise(_0x4ec8af=>setTimeout(_0x4ec8af,0x3e8)),_0x121576[_0x48f202(0x1ea)][_0x48f202(0x18c)](_0x48f202(0x1de));const _0x8bcee0=_0x5a25ac['sort'](()=>0.5-Math[_0x48f202(0xbe)]())[_0x48f202(0xee)](0x0,_0x31b11f);for(let _0xad5099=0x0;_0xad5099<_0x8bcee0[_0x48f202(0x216)];_0xad5099++){const _0x301235=_0x8bcee0[_0xad5099],_0x3ed350=createWinnerCard(_0x301235,_0xad5099+0x1,_0x2636b7),_0x3481e3=document[_0x48f202(0x15e)](_0x48f202(0x17c));_0x3481e3[_0x48f202(0x213)](_0x3ed350),_0x3481e3[_0x48f202(0x182)]=_0x3481e3[_0x48f202(0x19b)];if(window[_0x48f202(0x104)])lucide['createIcons']();fireConfetti();try{await updateDoc(doc(db,finalCollectionPath,_0x301235['id']),{'reward':_0x2636b7,'rewardTime':serverTimestamp()});}catch(_0x316e9c){console[_0x48f202(0x1d1)](_0x48f202(0xe3),_0x316e9c);}_0xad5099<_0x8bcee0[_0x48f202(0x216)]-0x1&&await new Promise(_0x5c58d6=>setTimeout(_0x5c58d6,0xbb8));}state['isDrawing']=![],window[_0x48f202(0x1d4)][_0x48f202(0x1c6)](),window['app'][_0x48f202(0x18f)]('การสุ่มเสร็จสิ้น!',_0x48f202(0xed));},setInterval(()=>{const _0x1cd897=_0x21739d;document['getElementById'](_0x1cd897(0x161))['innerText']=new Date()[_0x1cd897(0xeb)](_0x1cd897(0x1c4));},0x3e8);async function init(){const _0x1c8867=_0x21739d;try{typeof __initial_auth_token!==_0x1c8867(0x17b)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);document[_0x1c8867(0x15e)](_0x1c8867(0xd3))[_0x1c8867(0x1ea)][_0x1c8867(0xd7)](_0x1c8867(0x1b0)),document['getElementById'](_0x1c8867(0xd3))[_0x1c8867(0x1ea)][_0x1c8867(0x18c)](_0x1c8867(0x109)),document[_0x1c8867(0x15e)]('status-text')['innerText']=_0x1c8867(0x143),document[_0x1c8867(0x15e)]('status-text')[_0x1c8867(0x1ea)]['replace'](_0x1c8867(0x12a),_0x1c8867(0x16d));const _0x3d80e5=query(collection(db,finalCollectionPath));onSnapshot(_0x3d80e5,_0x4350a2=>{processSnapshot(_0x4350a2);},_0x53b4bc=>{const _0x3e8b9f=_0x1c8867;console[_0x3e8b9f(0x1d1)]('Snapshot\x20error:',_0x53b4bc);});const _0x59106c=query(collection(db,prizesCollectionPath));onSnapshot(_0x59106c,_0x47abe2=>{processPrizesSnapshot(_0x47abe2);});}catch(_0x3c9ff7){console[_0x1c8867(0x1d1)]('Initialization\x20Error:',_0x3c9ff7);}}init();if(window['lucide'])lucide[_0x21739d(0x1f1)]();

    </script>
</body>
</html>