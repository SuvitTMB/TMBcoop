<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ลงทะเบียนออกและลุ้นรางวัล - สหกรณ์ออมทรัพย์ฯ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Confetti for Lucky Draw -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        /* Custom Animations */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(-5%); }
            50% { transform: translateY(5%); }
        }
        .animate-bounce-slow { animation: bounce-slow 2s infinite; }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10">

    <!-- Header Section -->
    <div class="bg-gradient-to-r from-purple-600 to-indigo-700 text-white p-6 rounded-b-[2.5rem] shadow-lg mb-8 relative overflow-hidden">
        <div class="absolute top-0 right-0 opacity-10 transform translate-x-10 -translate-y-10">
            <i data-lucide="gift" width="150" height="150"></i>
        </div>
        
        <div class="relative z-10 flex flex-col items-center">
            <div class="bg-white/20 p-3 rounded-full mb-3 backdrop-blur-sm">
                <i data-lucide="party-popper" width="32" height="32" class="text-white"></i>
            </div>
            <h1 class="text-xl font-bold text-center">กิจกรรมลุ้นรางวัล</h1>
            <p class="text-purple-100 text-sm mt-1">สหกรณ์ออมทรัพย์พนักงานธนาคารทหารไทย จำกัด</p>
        </div>
    </div>

    <!-- Main Content Container -->
    <main class="px-2 sm:px-4 max-w-lg mx-auto -mt-10">
        
        <!-- Form Screen (Check-out first) -->
        <div id="screen-form" class="bg-white rounded-2xl shadow-xl p-6 border border-slate-100 relative z-20">
            <form id="registration-form" class="space-y-6 pt-2">
                <center>
                    <h2 class="text-lg font-bold text-gray-700 mb-4">ลงทะเบียนออกเพื่อลุ้นรางวัล</h2>
                    <div>
                        <label for="idCard" class="block text-sm font-semibold text-gray-700 mb-2">
                            เลขบัตรประจำตัวประชาชน
                        </label>
                        <div class="relative">
                            <input
                                type="text"
                                id="idCard"
                                placeholder="x-xxxx-xxxxx-xx-x"
                                class="w-full text-xl font-mono tracking-wide p-4 rounded-xl border-2 border-gray-200 bg-white focus:border-purple-400 focus:ring-4 focus:ring-purple-100 outline-none transition-all text-center"
                                inputmode="numeric"
                                maxlength="17"
                            />
                            <i id="icon-check-valid" data-lucide="check-circle" class="hidden absolute right-4 top-1/2 transform -translate-y-1/2 text-green-500 w-6 h-6 animate-fade-in"></i>
                        </div>
                        <p class="text-xs text-gray-400 mt-2 ml-1">กรุณากรอกตัวเลข 13 หลักให้ครบถ้วน</p>
                    </div>

                    <div class="p-3 bg-purple-50 text-purple-800 rounded-lg text-xs flex gap-2 items-start" style="margin-top:25px;">
                        <i data-lucide="shield-alert" class="w-4 h-4 shrink-0 mt-0.5"></i>
                        <span>ระบบจำกัดสิทธิ์ 1 เครื่อง / 1 ท่าน หากลงทะเบียนแล้วจะไม่สามารถเปลี่ยนเครื่องได้</span>
                    </div>
                </center>

                <button
                    type="submit"
                    id="btn-submit"
                    disabled
                    class="w-full py-3 rounded-lg font-semibold text-base shadow-lg transition-all transform active:scale-95 flex items-center justify-center gap-2 bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"
                >
                    <span id="btn-text">ลงทะเบียนออก</span>
                    <i id="btn-loader" data-lucide="loader-2" class="hidden animate-spin"></i>
                </button>
            </form>
        </div>

        <!-- Success Screen (Check-out Done & Reward Summary) -->
        <div id="screen-success" class="hidden bg-white rounded-2xl shadow-xl p-8 w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="check-circle" class="text-green-600 w-10 h-10"></i>
            </div>
            
            <!-- Added Name Display -->
            <h3 id="success-user-name" class="text-lg font-bold text-blue-600 mb-1 hidden"></h3>
            <h2 id="success-title" class="text-xl font-bold text-gray-800 mb-4">ลงทะเบียนออกสำเร็จ</h2>
            
            <!-- Time Grid -->
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 flex flex-col items-center justify-center">
                    <p class="text-xs font-bold text-blue-800 uppercase mb-1">ลงทะเบียนเข้า</p>
                    <p id="success-checkin-time" class="text-blue-600 font-mono text-sm font-semibold">--:--</p>
                </div>
                <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 flex flex-col items-center justify-center">
                    <p class="text-xs font-bold text-orange-800 uppercase mb-1">ลงทะเบียนออก</p>
                    <p id="success-checkout-time" class="text-orange-600 font-mono text-sm font-semibold">--:--</p>
                </div>
            </div>
            
            <!-- Message Box (Will be hidden when reward exists) -->
            <div id="msg-box-recorded" class="bg-green-50 border border-green-100 rounded-xl p-5 mb-6 text-left shadow-sm">
                <h3 id="success-msg-header" class="font-bold text-green-900 mb-2 text-lg flex items-center gap-2">
                    <i data-lucide="calendar-check" width="20"></i> บันทึกเวลาเรียบร้อย
                </h3>
                <p id="success-msg-body" class="text-sm text-gray-700">
                    ท่านได้ลงทะเบียนออกและมีสิทธิ์ลุ้นรับรางวัลพิเศษจำนวน 50 รางวัล และขอให้ท่านเดินทางกลับโดยสวัสดิภาพ
                </p>
            </div>
            
            <!-- Lucky Draw Action Area -->
            <div id="lucky-draw-action-container">
                <!-- Case 1: Button for new draw -->
                <button id="btn-start-draw" onclick="window.app.goToLuckyDraw()" class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white py-4 rounded-xl font-bold shadow-lg shadow-orange-200 hover:shadow-orange-300 transform hover:-translate-y-1 transition-all flex items-center justify-center gap-2 text-lg animate-bounce-slow">
                    <i data-lucide="gift" width="24"></i> กดเพื่อสุ่มของรางวัล
                </button>

                <!-- Case 2: Display Reward (Already drawn) -->
                <div id="reward-display-badge" class="hidden w-full bg-gradient-to-r from-purple-100 to-pink-100 border-2 border-purple-300 rounded-xl p-4 text-center shadow-inner mb-4">
                    <p class="text-sm text-purple-600 font-semibold mb-1">ของรางวัลของคุณคือ</p>
                    <p id="reward-name-text" class="text-xl font-bold text-purple-800">...</p>
                </div>

                <!-- Case 3: Claim Button (Added for Summary Page) -->
                <div id="claim-section-summary" class="hidden">
                    <button id="btn-claim-reward-summary" onclick="window.app.claimReward('summary')" class="w-full bg-green-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:bg-green-700 transition transform hover:scale-105 mb-2">
                        <i data-lucide="check-square" class="inline-block w-5 h-5 mr-1 mb-1"></i> ยืนยันการรับรางวัลแล้ว
                    </button>
                    <p id="text-claim-time-summary" class="text-xs text-gray-600 font-sm bg-green-50 p-3 rounded-lg border border-green-200 hidden">
                        <i data-lucide="clock" class="inline-block w-4 h-4 mr-1"></i> รับรางวัลเมื่อ: <span id="claim-time-val-summary"></span>
                    </p>
                </div>
            </div>

            <!-- Back to Registration Button -->
            <button onclick="window.app.resetForm()" class="mt-6 w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition flex items-center justify-center gap-2">
                <i data-lucide="log-out" width="18"></i> กลับสู่หน้าลงทะเบียน
            </button>
        </div>

        <!-- Lucky Draw Screen (Spinning & Result) -->
        <div id="screen-luckydraw" class="hidden bg-white rounded-2xl shadow-xl p-6 w-full text-center animate-fade-in relative z-20 min-h-[400px] flex flex-col items-center justify-center">
            
            <!-- State 1: Validating -->
            <div id="draw-state-validating" class="w-full">
                <div class="w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse">
                    <i data-lucide="scan-face" class="text-blue-500 w-12 h-12"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">กำลังตรวจสอบข้อมูลพนักงาน...</h2>
                <p class="text-gray-500 text-sm">กรุณารอสักครู่ ระบบกำลังยืนยันสิทธิ์ของท่าน</p>
                <div class="mt-6 w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-200 overflow-hidden">
                    <div class="bg-blue-600 h-2.5 rounded-full" style="width: 0%; transition: width 2s ease-in-out;" id="validate-progress"></div>
                </div>
            </div>

            <!-- State 2: Spinning -->
            <div id="draw-state-spinning" class="hidden w-full">
                <div class="relative w-32 h-32 mx-auto mb-6">
                    <div class="absolute inset-0 border-4 border-t-purple-500 border-gray-200 rounded-full animate-spin"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i data-lucide="gift" class="text-purple-500 w-12 h-12"></i>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-purple-700 mb-2" id="spin-text">กำลังสุ่มรางวัล...</h2>
                <div class="h-8 overflow-hidden relative mt-2">
                    <div id="prize-ticker" class="text-gray-400 text-lg transition-all duration-100">...</div>
                </div>
            </div>

            <!-- State 3: Result -->
            <div id="draw-state-result" class="hidden w-full">
                <div class="mb-2" id="result-icon-container">
                    <i data-lucide="crown" width="60" height="60" class="mx-auto text-yellow-500"></i>
                </div>
                <h2 id="result-title" class="text-lg font-bold text-gray-500 mb-1">ยินดีด้วย! ท่านได้รับ</h2>
                <div id="result-card" class="bg-gradient-to-r from-yellow-100 to-orange-100 border-2 border-yellow-300 p-6 rounded-2xl mb-6 shadow-inner relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-2 opacity-20"><i data-lucide="sparkles" width="40"></i></div>
                    <h1 id="prize-result-name" class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-600 to-red-600 drop-shadow-sm mb-4">
                        รอสักครู่...
                    </h1>
                </div>
                
                <!-- Claim Reward Section -->
                <div id="claim-section" class="mb-6">
                    <button id="btn-claim-reward" onclick="window.app.claimReward('result')" class="bg-green-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:bg-green-700 transition transform hover:scale-105 hidden">
                        <i data-lucide="check-square" class="inline-block w-5 h-5 mr-1 mb-1"></i> ยืนยันการรับรางวัลแล้ว
                    </button>
                    <p id="text-claim-time" class="text-green-700 font-medium bg-green-50 p-3 rounded-lg border border-green-200 hidden">
                        <i data-lucide="clock" class="inline-block w-4 h-4 mr-1"></i> รับรางวัลเมื่อ: <span id="claim-time-val" class="font-bold"></span>
                    </p>
                </div>

                <p id="result-footer-text" class="text-xs text-gray-400 mb-6">กรุณาให้เจ้าน้าที่ทำการกดปุ่มยืนยันการรับรางวัล</p>

                <button onclick="window.app.backToSummary()" class="w-full bg-gray-800 text-white py-3 rounded-xl font-semibold hover:bg-gray-900 transition">
                    กลับสู่หน้าหลัก (Check-out)
                </button>
            </div>

        </div>

        <!-- Error Screen -->
        <div id="screen-error-device" class="hidden bg-white rounded-2xl shadow-xl p-8 w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="alert-triangle" class="text-red-600 w-10 h-10"></i>
            </div>
            <h2 class="text-xl font-bold text-red-700 mb-2">เกิดข้อผิดพลาด</h2>
            <p id="error-msg-text" class="text-gray-600 mb-6 text-sm">ไม่สามารถดำเนินการได้</p>
            <button onclick="window.location.reload()" class="w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition">ปิด</button>
        </div>

        <!-- Not Found Screen -->
        <div id="screen-not-found" class="hidden bg-white rounded-2xl shadow-xl p-8 w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="user-x" class="text-amber-600 w-10 h-10"></i>
            </div>
            <h2 class="text-xl font-bold text-amber-700 mb-2">ไม่พบข้อมูล</h2>
            <p class="text-gray-600 mb-6 text-sm">กรุณาลงทะเบียนเข้าก่อนทำการลงทะเบียนออก</p>
            <button onclick="window.app.resetForm()" class="w-full bg-amber-500 text-white py-3 rounded-xl font-semibold hover:bg-amber-600 transition">ปิด</button>
        </div>

        <p class="text-center text-gray-400 text-xs mt-8">
            ระบบสุ่มรางวัลสมาชิกสหกรณ์ <br/>
            © 2024 สหกรณ์ออมทรัพย์พนักงานธนาคารทหารไทย จำกัด
        </p>
    </main>

    <script type="module">
const _0x4b6f5b=_0x3994;(function(_0x26f1b0,_0x32e93e){const _0x28ceaf=_0x3994,_0x13ee9f=_0x26f1b0();while(!![]){try{const _0xbce1cb=-parseInt(_0x28ceaf(0x1cd))/0x1*(-parseInt(_0x28ceaf(0x179))/0x2)+parseInt(_0x28ceaf(0x1b1))/0x3+parseInt(_0x28ceaf(0x1c1))/0x4*(-parseInt(_0x28ceaf(0x186))/0x5)+parseInt(_0x28ceaf(0x227))/0x6+-parseInt(_0x28ceaf(0x1e4))/0x7*(-parseInt(_0x28ceaf(0x1e7))/0x8)+parseInt(_0x28ceaf(0x1b2))/0x9+-parseInt(_0x28ceaf(0x1da))/0xa*(parseInt(_0x28ceaf(0x215))/0xb);if(_0xbce1cb===_0x32e93e)break;else _0x13ee9f['push'](_0x13ee9f['shift']());}catch(_0xb45614){_0x13ee9f['push'](_0x13ee9f['shift']());}}}(_0x4d0c,0x70ff7));function _0x3994(_0x118959,_0x362f91){_0x118959=_0x118959-0x176;const _0x4d0c16=_0x4d0c();let _0x39945b=_0x4d0c16[_0x118959];return _0x39945b;}import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,updateDoc,doc,serverTimestamp,query,where,getDocs,getDoc,addDoc,onSnapshot}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x4b6f5b(0x1ab),PRIZES_COLLECTION_NAME='coop_gift',isSandboxEnv=typeof __firebase_config!==_0x4b6f5b(0x187);let firebaseConfig,finalCollectionPath,prizesCollectionPath;if(isSandboxEnv){firebaseConfig=JSON[_0x4b6f5b(0x18f)](__firebase_config);const appId=typeof __app_id!=='undefined'?__app_id:_0x4b6f5b(0x213);finalCollectionPath=_0x4b6f5b(0x222)+appId+_0x4b6f5b(0x1a2),prizesCollectionPath='artifacts/'+appId+_0x4b6f5b(0x229)+PRIZES_COLLECTION_NAME;}else firebaseConfig={'apiKey':'AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','authDomain':_0x4b6f5b(0x21f),'databaseURL':_0x4b6f5b(0x1d2),'projectId':_0x4b6f5b(0x1d0),'storageBucket':_0x4b6f5b(0x20b),'messagingSenderId':_0x4b6f5b(0x228),'appId':_0x4b6f5b(0x18b),'measurementId':_0x4b6f5b(0x21e)},finalCollectionPath=TARGET_COLLECTION_NAME,prizesCollectionPath=PRIZES_COLLECTION_NAME;const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),state={'user':null,'idCard':'','currentDocId':null,'userHash':null,'currentReward':null,'prizesList':[],'winnersCount':{}};async function sha256(_0x10280a){const _0x583b05=_0x4b6f5b,_0x117351=new TextEncoder()[_0x583b05(0x19a)](_0x10280a),_0xe6d4d9=await crypto['subtle'][_0x583b05(0x17b)](_0x583b05(0x1db),_0x117351),_0xf5d757=Array[_0x583b05(0x20f)](new Uint8Array(_0xe6d4d9));return _0xf5d757[_0x583b05(0x1f7)](_0x449ffa=>_0x449ffa[_0x583b05(0x223)](0x10)[_0x583b05(0x1aa)](0x2,'0'))[_0x583b05(0x1dc)]('');}function getDeviceId(){const _0x44ff2b=_0x4b6f5b,_0x2bf9de=_0x44ff2b(0x1b6);let _0x18583e=localStorage['getItem'](_0x2bf9de);if(!_0x18583e){const _0x503f40=document[_0x44ff2b(0x1b0)][_0x44ff2b(0x21d)](new RegExp(_0x44ff2b(0x1ed)+_0x2bf9de+'=([^;]+)'));_0x503f40&&(_0x18583e=_0x503f40[0x2],localStorage[_0x44ff2b(0x220)](_0x2bf9de,_0x18583e));}return!_0x18583e?(_0x18583e=_0x44ff2b(0x1c5)+Date[_0x44ff2b(0x19d)]()[_0x44ff2b(0x223)](0x24)+Math[_0x44ff2b(0x19e)]()[_0x44ff2b(0x223)](0x24)[_0x44ff2b(0x17a)](0x2,0x9),localStorage[_0x44ff2b(0x220)](_0x2bf9de,_0x18583e),document[_0x44ff2b(0x1b0)]=_0x2bf9de+'='+_0x18583e+_0x44ff2b(0x1e2)):document['cookie']=_0x2bf9de+'='+_0x18583e+_0x44ff2b(0x1e2),_0x18583e;}function setLocalRegistration(_0x4bd603){const _0x9aef76=_0x4b6f5b;localStorage[_0x9aef76(0x220)]('coop_registered_citizen_id',_0x4bd603);}function getLocalRegistration(){return localStorage['getItem']('coop_registered_citizen_id');}function setupDataListeners(){const _0x1fd453=_0x4b6f5b,_0x1781a3=query(collection(db,prizesCollectionPath));onSnapshot(_0x1781a3,_0x3fcce9=>{const _0x37006d=_0x3994,_0x1fa25d=[];_0x3fcce9[_0x37006d(0x1df)](_0x526748=>{const _0x52f4a1=_0x37006d;_0x1fa25d[_0x52f4a1(0x192)]({'id':_0x526748['id'],..._0x526748[_0x52f4a1(0x1f0)]()});}),state[_0x37006d(0x1d1)]=_0x1fa25d;});const _0x2c7332=query(collection(db,finalCollectionPath),where(_0x1fd453(0x218),'>',''));onSnapshot(_0x2c7332,_0x59d717=>{const _0x3d2aeb=_0x1fd453,_0x450485={};_0x59d717[_0x3d2aeb(0x1df)](_0xae7037=>{const _0x3aa2c3=_0x3d2aeb,_0x3a15d0=_0xae7037[_0x3aa2c3(0x1f0)]()[_0x3aa2c3(0x218)];if(_0x3a15d0)_0x450485[_0x3a15d0]=(_0x450485[_0x3a15d0]||0x0)+0x1;}),state[_0x3d2aeb(0x1c8)]=_0x450485;});}window[_0x4b6f5b(0x19f)]={'resetForm':()=>{const _0x1c4b22=_0x4b6f5b;['screen-success',_0x1c4b22(0x1c4),'screen-not-found','screen-luckydraw'][_0x1c4b22(0x1df)](_0xd72cfa=>document[_0x1c4b22(0x19b)](_0xd72cfa)[_0x1c4b22(0x193)]['add'](_0x1c4b22(0x1d9))),document[_0x1c4b22(0x19b)](_0x1c4b22(0x217))[_0x1c4b22(0x193)][_0x1c4b22(0x208)](_0x1c4b22(0x1d9)),document[_0x1c4b22(0x19b)](_0x1c4b22(0x178))[_0x1c4b22(0x1c0)]='',document[_0x1c4b22(0x19b)]('icon-check-valid')['classList'][_0x1c4b22(0x1cf)](_0x1c4b22(0x1d9)),document[_0x1c4b22(0x19b)](_0x1c4b22(0x17d))[_0x1c4b22(0x193)]['add']('hidden'),document[_0x1c4b22(0x19b)](_0x1c4b22(0x197))['classList']['remove'](_0x1c4b22(0x1d9)),document[_0x1c4b22(0x19b)](_0x1c4b22(0x221))[_0x1c4b22(0x193)][_0x1c4b22(0x1cf)](_0x1c4b22(0x1d9));const _0x11b2a0=document[_0x1c4b22(0x19b)](_0x1c4b22(0x189));_0x11b2a0[_0x1c4b22(0x194)]=!![],_0x11b2a0['classList'][_0x1c4b22(0x1cf)](_0x1c4b22(0x1b8),'text-gray-400'),_0x11b2a0['classList'][_0x1c4b22(0x208)]('bg-purple-600',_0x1c4b22(0x1a0)),document[_0x1c4b22(0x19b)]('btn-text')[_0x1c4b22(0x1ee)]=_0x1c4b22(0x1ef),document[_0x1c4b22(0x19b)]('btn-loader')['classList'][_0x1c4b22(0x1cf)](_0x1c4b22(0x1d9)),state[_0x1c4b22(0x178)]='',state[_0x1c4b22(0x1dd)]=null,state[_0x1c4b22(0x1fa)]=null,document[_0x1c4b22(0x19b)](_0x1c4b22(0x178))[_0x1c4b22(0x17c)]();},'goToLuckyDraw':async()=>{const _0x34706e=_0x4b6f5b;document[_0x34706e(0x19b)](_0x34706e(0x1eb))['classList'][_0x34706e(0x1cf)](_0x34706e(0x1d9)),document[_0x34706e(0x19b)](_0x34706e(0x18c))[_0x34706e(0x193)][_0x34706e(0x208)](_0x34706e(0x1d9)),document[_0x34706e(0x19b)](_0x34706e(0x1f5))[_0x34706e(0x193)][_0x34706e(0x208)](_0x34706e(0x1d9)),document[_0x34706e(0x19b)](_0x34706e(0x1bd))[_0x34706e(0x193)][_0x34706e(0x1cf)](_0x34706e(0x1d9)),document['getElementById']('draw-state-result')[_0x34706e(0x193)][_0x34706e(0x1cf)](_0x34706e(0x1d9)),setTimeout(()=>{const _0xd0ae2b=_0x34706e;document[_0xd0ae2b(0x19b)](_0xd0ae2b(0x1d8))[_0xd0ae2b(0x1d5)][_0xd0ae2b(0x1f3)]=_0xd0ae2b(0x1f2);},0x64),setTimeout(()=>{const _0x3c6813=_0x34706e;document[_0x3c6813(0x19b)]('validate-progress')['style']['width']=_0x3c6813(0x210);},0x5dc),setTimeout(async()=>{const _0x3c6fcd=_0x34706e;if(state[_0x3c6fcd(0x1dd)])try{const _0x1238b4=doc(db,finalCollectionPath,state[_0x3c6fcd(0x1dd)]),_0x4e0c52=await getDoc(_0x1238b4),_0x56d80f=_0x4e0c52[_0x3c6fcd(0x1f0)]();_0x4e0c52['exists']()&&_0x56d80f['reward']?showResult(_0x56d80f[_0x3c6fcd(0x218)],!![],_0x56d80f[_0x3c6fcd(0x1cc)]):startSpinning();}catch(_0x5415b2){console[_0x3c6fcd(0x1b3)](_0x5415b2),alert(_0x3c6fcd(0x1a3)),window[_0x3c6fcd(0x19f)][_0x3c6fcd(0x196)]();}else alert(_0x3c6fcd(0x1e1)),window[_0x3c6fcd(0x19f)]['resetForm']();},0x7d0);},'backToSummary':()=>{const _0x1ac874=_0x4b6f5b;document['getElementById']('screen-luckydraw')[_0x1ac874(0x193)]['add']('hidden'),document[_0x1ac874(0x19b)](_0x1ac874(0x1eb))[_0x1ac874(0x193)]['remove']('hidden'),state[_0x1ac874(0x1fa)]&&(state[_0x1ac874(0x1dd)]&&getDoc(doc(db,finalCollectionPath,state[_0x1ac874(0x1dd)]))[_0x1ac874(0x1bc)](_0x563730=>{const _0x3545e2=_0x1ac874;if(_0x563730['exists']()){const _0x1b934b=_0x563730[_0x3545e2(0x1f0)]();updateSuccessUI('-','-',_0x1b934b['reward'],_0x1b934b[_0x3545e2(0x1cc)],![],_0x1b934b[_0x3545e2(0x202)]);}}));},'claimReward':async _0x5579c0=>{const _0x3064ab=_0x4b6f5b;if(!state[_0x3064ab(0x1dd)])return;const _0x211a5e=_0x5579c0===_0x3064ab(0x1fd),_0xaf8e88=_0x211a5e?_0x3064ab(0x1ec):'btn-claim-reward',_0x538c60=_0x211a5e?_0x3064ab(0x1e5):_0x3064ab(0x1a5),_0x29128b=_0x211a5e?_0x3064ab(0x177):_0x3064ab(0x1e3),_0x24ddda=document[_0x3064ab(0x19b)](_0xaf8e88),_0x30cd78=_0x24ddda[_0x3064ab(0x20e)];_0x24ddda[_0x3064ab(0x194)]=!![],_0x24ddda[_0x3064ab(0x1ee)]=_0x3064ab(0x1d3);try{await updateDoc(doc(db,finalCollectionPath,state[_0x3064ab(0x1dd)]),{'rewardClaimTime':serverTimestamp()});const _0x1e6e5b=new Date(),_0x206341=_0x1e6e5b[_0x3064ab(0x20c)](_0x3064ab(0x18a));_0x24ddda[_0x3064ab(0x193)][_0x3064ab(0x1cf)]('hidden'),document[_0x3064ab(0x19b)](_0x538c60)[_0x3064ab(0x193)]['remove'](_0x3064ab(0x1d9)),document[_0x3064ab(0x19b)](_0x29128b)[_0x3064ab(0x1ee)]=_0x206341,confetti({'particleCount':0x64,'spread':0x3c,'origin':{'y':0.7}});}catch(_0x91018a){console[_0x3064ab(0x1b3)](_0x91018a),console[_0x3064ab(0x1b3)]('Reward\x20claim\x20failed'),_0x24ddda[_0x3064ab(0x194)]=![],_0x24ddda[_0x3064ab(0x20e)]=_0x30cd78;}}};function updateSuccessUI(_0x2e7a8c,_0x42a6e0,_0x384512,_0x56439d,_0x504538,_0x2fbf76){const _0x81a836=_0x4b6f5b;document[_0x81a836(0x19b)](_0x81a836(0x21a))['innerText']=_0x504538?_0x81a836(0x1a4):_0x81a836(0x1a9),document['getElementById']('success-msg-header')[_0x81a836(0x1ee)]=_0x504538?_0x81a836(0x1e6):'บันทึกเวลาเรียบร้อย',document[_0x81a836(0x19b)](_0x81a836(0x1ad))[_0x81a836(0x1ee)]=_0x504538?'ท่านได้ทำการลงทะเบียนเข้าและออกเรียบร้อยแล้ว\x20มีสิทธิ์ลุ้นรับรางวัลพิเศษ':_0x81a836(0x21c);if(_0x2e7a8c!=='-')document[_0x81a836(0x19b)]('success-checkin-time')[_0x81a836(0x1ee)]=_0x2e7a8c;if(_0x42a6e0!=='-')document['getElementById'](_0x81a836(0x1ca))['innerText']=_0x42a6e0;const _0x3980fd=document['getElementById'](_0x81a836(0x221));_0x2fbf76?(_0x3980fd[_0x81a836(0x1ee)]=_0x2fbf76,_0x3980fd[_0x81a836(0x193)]['remove'](_0x81a836(0x1d9))):_0x3980fd[_0x81a836(0x193)][_0x81a836(0x1cf)](_0x81a836(0x1d9)),document[_0x81a836(0x19b)](_0x81a836(0x217))[_0x81a836(0x193)][_0x81a836(0x1cf)](_0x81a836(0x1d9)),document[_0x81a836(0x19b)](_0x81a836(0x1eb))[_0x81a836(0x193)][_0x81a836(0x208)](_0x81a836(0x1d9)),_0x384512?(state[_0x81a836(0x1fa)]=_0x384512,updateSuccessScreen(_0x384512,_0x56439d)):(state[_0x81a836(0x1fa)]=null,document[_0x81a836(0x19b)]('btn-start-draw')['classList'][_0x81a836(0x208)](_0x81a836(0x1d9)),document[_0x81a836(0x19b)]('reward-display-badge')[_0x81a836(0x193)]['add']('hidden'),document[_0x81a836(0x19b)](_0x81a836(0x17d))['classList'][_0x81a836(0x1cf)](_0x81a836(0x1d9)),document[_0x81a836(0x19b)](_0x81a836(0x197))[_0x81a836(0x193)]['remove'](_0x81a836(0x1d9)));}function updateSuccessScreen(_0x1a3555,_0xe002e4){const _0x4af051=_0x4b6f5b;document[_0x4af051(0x19b)]('btn-start-draw')[_0x4af051(0x193)][_0x4af051(0x1cf)](_0x4af051(0x1d9));const _0x3b4d4f=document[_0x4af051(0x19b)](_0x4af051(0x1b5));_0x3b4d4f[_0x4af051(0x193)]['remove'](_0x4af051(0x1d9));const _0x3f3faa=document[_0x4af051(0x19b)]('reward-name-text');_0x3f3faa[_0x4af051(0x1ee)]=_0x1a3555;_0x1a3555===_0x4af051(0x20d)?(_0x3b4d4f[_0x4af051(0x193)]['remove'](_0x4af051(0x224),'to-pink-100',_0x4af051(0x1ff)),_0x3b4d4f[_0x4af051(0x193)]['add'](_0x4af051(0x1a8),_0x4af051(0x1cb),'border-gray-300'),_0x3f3faa['classList'][_0x4af051(0x208)]('text-purple-800'),_0x3f3faa['classList'][_0x4af051(0x1cf)](_0x4af051(0x1c7))):(_0x3b4d4f[_0x4af051(0x193)][_0x4af051(0x1cf)]('from-purple-100','to-pink-100',_0x4af051(0x1ff)),_0x3b4d4f[_0x4af051(0x193)][_0x4af051(0x208)](_0x4af051(0x1a8),'to-gray-200','border-gray-300'),_0x3f3faa[_0x4af051(0x193)][_0x4af051(0x1cf)](_0x4af051(0x181)),_0x3f3faa['classList'][_0x4af051(0x208)](_0x4af051(0x1c7)));document['getElementById'](_0x4af051(0x197))[_0x4af051(0x193)]['add'](_0x4af051(0x1d9));const _0x43c216=document['getElementById'](_0x4af051(0x17d)),_0x185642=document[_0x4af051(0x19b)]('btn-claim-reward-summary'),_0x669894=document[_0x4af051(0x19b)](_0x4af051(0x1e5)),_0x3526a2=document[_0x4af051(0x19b)](_0x4af051(0x177));if(_0x1a3555===_0x4af051(0x20d))_0x43c216[_0x4af051(0x193)]['add']('hidden');else{_0x43c216['classList'][_0x4af051(0x208)](_0x4af051(0x1d9));if(_0xe002e4){_0x185642['classList'][_0x4af051(0x1cf)]('hidden'),_0x669894['classList'][_0x4af051(0x208)](_0x4af051(0x1d9));const _0x285a8f=_0xe002e4[_0x4af051(0x199)]?_0xe002e4[_0x4af051(0x199)]():new Date(_0xe002e4);_0x3526a2[_0x4af051(0x1ee)]=_0x285a8f[_0x4af051(0x20c)]('th-TH');}else _0x185642[_0x4af051(0x193)][_0x4af051(0x208)](_0x4af051(0x1d9)),_0x669894['classList'][_0x4af051(0x1cf)](_0x4af051(0x1d9));}}async function fetchPrizes(){const _0x54ca61=_0x4b6f5b,_0x4b15f3=query(collection(db,prizesCollectionPath));try{onSnapshot(_0x4b15f3,_0x5ba809=>{const _0x465df2=_0x3994,_0x344d97=[];_0x5ba809[_0x465df2(0x1df)](_0x180f14=>_0x344d97['push'](_0x180f14[_0x465df2(0x1f0)]())),state['prizesList']=_0x344d97;});}catch(_0x22d575){console['error'](_0x54ca61(0x207),_0x22d575),state[_0x54ca61(0x1d1)]=[{'name':'รางวัลพิเศษ'}];}}function startSpinning(){const _0x4689be=_0x4b6f5b;document[_0x4689be(0x19b)](_0x4689be(0x1f5))[_0x4689be(0x193)][_0x4689be(0x1cf)](_0x4689be(0x1d9)),document[_0x4689be(0x19b)]('draw-state-spinning')[_0x4689be(0x193)][_0x4689be(0x208)](_0x4689be(0x1d9));const _0x2dd5c5=[];state[_0x4689be(0x1d1)][_0x4689be(0x1df)](_0x5eb10d=>{const _0x131d3b=_0x4689be,_0x429669=parseInt(_0x5eb10d[_0x131d3b(0x1fb)])||0x0,_0x21f626=state[_0x131d3b(0x1c8)][_0x5eb10d[_0x131d3b(0x190)]]||0x0;_0x429669>_0x21f626&&_0x2dd5c5['push'](_0x5eb10d[_0x131d3b(0x190)]);});const _0x4cd0af=_0x2dd5c5['length']>0x0?_0x2dd5c5:['กำลังสุ่ม...',_0x4689be(0x1a1),'รางวัลใหญ่...'],_0xbaaf4e=document[_0x4689be(0x19b)]('prize-ticker');let _0x54a93d=0x0;const _0x3c7e79=setInterval(()=>{const _0x18ffab=_0x4689be;_0xbaaf4e['innerText']=_0x4cd0af[Math[_0x18ffab(0x18e)](Math['random']()*_0x4cd0af[_0x18ffab(0x219)])],_0x54a93d++,_0x54a93d>0x14&&(clearInterval(_0x3c7e79),finalizePrize());},0x64);}async function finalizePrize(){const _0x43a182=_0x4b6f5b,_0x38580c=[];state['prizesList']['forEach'](_0x524ac5=>{const _0x1ebd5e=_0x3994,_0x10145f=parseInt(_0x524ac5[_0x1ebd5e(0x1fb)])||0x0,_0x106cf7=state[_0x1ebd5e(0x1c8)][_0x524ac5[_0x1ebd5e(0x190)]]||0x0;_0x10145f>_0x106cf7&&_0x38580c[_0x1ebd5e(0x192)](_0x524ac5[_0x1ebd5e(0x190)]);});let _0x3c0725=_0x43a182(0x20d);const _0x3be16f=Math['random']()>0.3;_0x38580c[_0x43a182(0x219)]>0x0&&_0x3be16f&&(_0x3c0725=_0x38580c[Math['floor'](Math['random']()*_0x38580c[_0x43a182(0x219)])]);try{state[_0x43a182(0x1dd)]&&(await updateDoc(doc(db,finalCollectionPath,state['currentDocId']),{'reward':_0x3c0725,'rewardTime':serverTimestamp()}),showResult(_0x3c0725,![],null));}catch(_0x3fac03){console[_0x43a182(0x1b3)]('Save\x20Prize\x20Error:',_0x3fac03);}}function showResult(_0x2eb255,_0x3e346e,_0x37b9d7){const _0x3f3bce=_0x4b6f5b;state[_0x3f3bce(0x1fa)]=_0x2eb255,document['getElementById'](_0x3f3bce(0x1bd))[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)](_0x3f3bce(0x1d9)),document[_0x3f3bce(0x19b)](_0x3f3bce(0x1f5))[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)](_0x3f3bce(0x1d9)),document[_0x3f3bce(0x19b)]('draw-state-result')['classList'][_0x3f3bce(0x208)](_0x3f3bce(0x1d9));const _0x487175=document[_0x3f3bce(0x1bb)](_0x3f3bce(0x209)),_0x229bdb=document[_0x3f3bce(0x19b)](_0x3f3bce(0x212)),_0x3208c7=document[_0x3f3bce(0x19b)](_0x3f3bce(0x176)),_0x5500ec=document[_0x3f3bce(0x19b)]('result-icon-container');_0x3208c7[_0x3f3bce(0x1f9)]='text-2xl\x20font-black\x20drop-shadow-sm\x20mb-4';if(_0x2eb255===_0x3f3bce(0x20d))_0x487175[_0x3f3bce(0x1ee)]=_0x3e346e?_0x3f3bce(0x21b):_0x3f3bce(0x1c2),_0x3208c7[_0x3f3bce(0x1ee)]=_0x3f3bce(0x214),_0x3208c7[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)](_0x3f3bce(0x1e8)),_0x229bdb['classList'][_0x3f3bce(0x208)]('from-yellow-100','to-orange-100',_0x3f3bce(0x1c9)),_0x229bdb[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)](_0x3f3bce(0x1a8),_0x3f3bce(0x1cb),'border-gray-300'),_0x5500ec[_0x3f3bce(0x20e)]=_0x3f3bce(0x1b9),document[_0x3f3bce(0x19b)](_0x3f3bce(0x1d7))['classList'][_0x3f3bce(0x1cf)](_0x3f3bce(0x1d9)),document['getElementById'](_0x3f3bce(0x184))[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)]('hidden');else{_0x487175[_0x3f3bce(0x1ee)]=_0x3e346e?_0x3f3bce(0x1de):_0x3f3bce(0x183),_0x3208c7[_0x3f3bce(0x1ee)]=_0x2eb255,_0x3208c7[_0x3f3bce(0x193)]['add'](_0x3f3bce(0x1c3),_0x3f3bce(0x211),_0x3f3bce(0x182),_0x3f3bce(0x1c6),'to-red-600'),_0x229bdb['classList']['add']('from-yellow-100',_0x3f3bce(0x1f1),_0x3f3bce(0x1c9)),_0x229bdb[_0x3f3bce(0x193)][_0x3f3bce(0x208)](_0x3f3bce(0x1a8),_0x3f3bce(0x1cb),_0x3f3bce(0x200)),_0x5500ec[_0x3f3bce(0x20e)]=_0x3f3bce(0x1ce),document[_0x3f3bce(0x19b)](_0x3f3bce(0x1d7))[_0x3f3bce(0x193)][_0x3f3bce(0x208)](_0x3f3bce(0x1d9)),document[_0x3f3bce(0x19b)]('result-footer-text')['classList'][_0x3f3bce(0x208)]('hidden');const _0x4e445e=document['getElementById'](_0x3f3bce(0x18d)),_0x25598b=document[_0x3f3bce(0x19b)]('text-claim-time'),_0x36e43e=document['getElementById']('claim-time-val');if(_0x37b9d7){_0x4e445e[_0x3f3bce(0x193)][_0x3f3bce(0x1cf)](_0x3f3bce(0x1d9)),_0x25598b['classList'][_0x3f3bce(0x208)](_0x3f3bce(0x1d9));const _0x32482e=_0x37b9d7[_0x3f3bce(0x199)]?_0x37b9d7[_0x3f3bce(0x199)]():new Date(_0x37b9d7);_0x36e43e[_0x3f3bce(0x1ee)]=_0x32482e[_0x3f3bce(0x20c)](_0x3f3bce(0x18a));}else _0x4e445e[_0x3f3bce(0x193)]['remove']('hidden'),_0x4e445e[_0x3f3bce(0x194)]=![],_0x25598b['classList'][_0x3f3bce(0x1cf)]('hidden');!_0x3e346e&&confetti({'particleCount':0x96,'spread':0x46,'origin':{'y':0.6}});}if(window[_0x3f3bce(0x188)])lucide['createIcons']();}async function submitForm(_0x177288){const _0x242f22=_0x4b6f5b;_0x177288[_0x242f22(0x17f)]();if(!state['user'])return;const _0x1f2abe=document[_0x242f22(0x19b)](_0x242f22(0x189)),_0x282edc=document[_0x242f22(0x19b)](_0x242f22(0x1a6)),_0xf0da88=document['getElementById'](_0x242f22(0x19c));_0x1f2abe['disabled']=!![],_0x282edc[_0x242f22(0x1ee)]=_0x242f22(0x1e0),_0xf0da88[_0x242f22(0x193)][_0x242f22(0x208)](_0x242f22(0x1d9));try{const _0x460c29=getDeviceId(),_0x193562=state['idCard'][_0x242f22(0x1f4)](/-/g,''),_0x4cfaa1=await sha256(_0x193562);state[_0x242f22(0x1b7)]=_0x4cfaa1;const _0x42e3bb=getLocalRegistration();if(_0x42e3bb&&_0x42e3bb!==_0x4cfaa1){document[_0x242f22(0x19b)]('error-msg-text')[_0x242f22(0x1ee)]='อุปกรณ์นี้ได้ทำการลงทะเบียนให้กับหมายเลขบัตรประชาชนอื่นไปแล้ว\x20ไม่สามารถลงทะเบียนซ้ำได้\x20(Local\x20Lock)',document['getElementById']('screen-form')[_0x242f22(0x193)][_0x242f22(0x1cf)]('hidden'),document[_0x242f22(0x19b)](_0x242f22(0x1c4))['classList'][_0x242f22(0x208)](_0x242f22(0x1d9));return;}const _0x1be155=query(collection(db,finalCollectionPath),where(_0x242f22(0x1bf),'==',_0x4cfaa1)),_0x28c4b5=await getDocs(_0x1be155);if(!_0x28c4b5[_0x242f22(0x1ea)]){const _0x289bfa=_0x28c4b5['docs'][0x0],_0x4ecb0f=_0x289bfa[_0x242f22(0x1f0)]();if(_0x4ecb0f[_0x242f22(0x1af)]&&_0x4ecb0f[_0x242f22(0x1af)]!==_0x460c29){document[_0x242f22(0x19b)](_0x242f22(0x216))[_0x242f22(0x20e)]=_0x242f22(0x17e),document[_0x242f22(0x19b)](_0x242f22(0x217))[_0x242f22(0x193)][_0x242f22(0x1cf)](_0x242f22(0x1d9)),document[_0x242f22(0x19b)](_0x242f22(0x1c4))[_0x242f22(0x193)][_0x242f22(0x208)]('hidden');return;}state[_0x242f22(0x1dd)]=_0x289bfa['id'];let _0x2fdae9='-';if(_0x4ecb0f[_0x242f22(0x225)]){const _0x4ad754=_0x4ecb0f[_0x242f22(0x225)][_0x242f22(0x199)]?_0x4ecb0f[_0x242f22(0x225)][_0x242f22(0x199)]():new Date(_0x4ecb0f[_0x242f22(0x225)]);_0x2fdae9=_0x4ad754[_0x242f22(0x20c)](_0x242f22(0x18a));}let _0x5cb5a9='';const _0xade61b=new Date();_0x5cb5a9=_0xade61b[_0x242f22(0x20c)](_0x242f22(0x18a));const _0x48366e={};let _0x4cf669=![];!_0x4ecb0f['deviceId']&&(_0x48366e[_0x242f22(0x1af)]=_0x460c29,_0x4cf669=!![]);if(!_0x4ecb0f[_0x242f22(0x185)])_0x48366e['CheckOUT']=serverTimestamp(),_0x4ecb0f[_0x242f22(0x225)]?_0x48366e['status']=_0x242f22(0x1fe):_0x48366e[_0x242f22(0x1e9)]=_0x242f22(0x1b4),_0x4cf669=!![];else{const _0x41668b=_0x4ecb0f[_0x242f22(0x185)]['toDate']?_0x4ecb0f[_0x242f22(0x185)][_0x242f22(0x199)]():new Date(_0x4ecb0f[_0x242f22(0x185)]);_0x5cb5a9=_0x41668b[_0x242f22(0x20c)](_0x242f22(0x18a));}_0x4cf669&&await updateDoc(doc(db,finalCollectionPath,_0x289bfa['id']),_0x48366e),setLocalRegistration(_0x4cfaa1),updateSuccessUI(_0x2fdae9,_0x5cb5a9,_0x4ecb0f[_0x242f22(0x218)],_0x4ecb0f[_0x242f22(0x1cc)],![],_0x4ecb0f[_0x242f22(0x202)]);}else{const _0x2240ed=query(collection(db,finalCollectionPath),where('deviceId','==',_0x460c29)),_0x5eabe1=await getDocs(_0x2240ed);if(!_0x5eabe1['empty'])document[_0x242f22(0x19b)](_0x242f22(0x216))[_0x242f22(0x1ee)]=_0x242f22(0x180),document[_0x242f22(0x19b)]('screen-form')[_0x242f22(0x193)]['add'](_0x242f22(0x1d9)),document[_0x242f22(0x19b)](_0x242f22(0x1c4))['classList']['remove'](_0x242f22(0x1d9));else{const _0x4eea48=await addDoc(collection(db,finalCollectionPath),{'citizenId':_0x4cfaa1,'deviceId':_0x460c29,'CheckIN':serverTimestamp(),'CheckOUT':serverTimestamp(),'status':_0x242f22(0x1fe)});state[_0x242f22(0x1dd)]=_0x4eea48['id'],setLocalRegistration(_0x4cfaa1);const _0x309d46=new Date(),_0x1b62fa=_0x309d46['toLocaleString']('th-TH');updateSuccessUI(_0x1b62fa,_0x1b62fa,null,null,!![],null);}}}catch(_0x21f0e7){console[_0x242f22(0x1b3)](_0x21f0e7),alert(_0x242f22(0x198)+_0x21f0e7[_0x242f22(0x203)]);}finally{_0x1f2abe[_0x242f22(0x194)]=![],_0x282edc[_0x242f22(0x1ee)]=_0x242f22(0x1ef),_0xf0da88[_0x242f22(0x193)][_0x242f22(0x1cf)](_0x242f22(0x1d9)),validateForm();}}function _0x4d0c(){const _0x11ab16=['<i\x20data-lucide=\x22crown\x22\x20width=\x2260\x22\x20height=\x2260\x22\x20class=\x22mx-auto\x20text-yellow-500\x22></i>','add','ttb-register','prizesList','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','กำลังบันทึก...','registration-form','style','user','claim-section','validate-progress','hidden','890TDLzeY','SHA-256','join','currentDocId','ท่านเคยได้รับรางวัลแล้ว','forEach','กำลังตรวจสอบ...','ไม่พบข้อมูลผู้ใช้\x20กรุณาลงทะเบียนใหม่',';\x20path=/;\x20max-age=31536000','claim-time-val','1450337MgYBsb','text-claim-time-summary','ยินดีต้อนรับ','24vXuNmP','text-gray-500','status','empty','screen-success','btn-claim-reward-summary','(^|\x20)','innerText','ลงทะเบียนออก','data','to-orange-100','50%','width','replace','draw-state-validating','hover:bg-purple-700','map','submit','className','currentReward','totalQty','createIcons','summary','ลงทะเบียนสำเร็จ','border-purple-300','border-gray-300','border-gray-200','EmpName','message','slice','shadow-purple-200','text-gray-400','Fetch\x20Prizes\x20Error','remove','#draw-state-result\x20h2','cursor-not-allowed','ttb-register.firebasestorage.app','toLocaleString','ไม่ได้รับรางวัล','innerHTML','from','100%','bg-clip-text','result-card','default-app-id','คุณไม่ได้รางวัล','104929eteEkZ','error-msg-text','screen-form','reward','length','success-title','ประวัติการสุ่มรางวัล','ท่านได้ลงทะเบียนออกและมีสิทธิ์ลุ้นรับรางวัลพิเศษจำนวน\x2050\x20รางวัล\x20และขอให้ท่านเดินทางกลับโดยสวัสดิภาพ','match','G-9DJLWJ5LQ1','ttb-register.firebaseapp.com','setItem','success-user-name','artifacts/','toString','from-purple-100','CheckIN','bg-purple-600','2016420yQKcLU','1070273157855','/public/data/','prize-result-name','claim-time-val-summary','idCard','1073710BGDmjb','substr','digest','focus','claim-section-summary','รหัสบัตรประชาชนนี้\x20ผูกกับโทรศัพท์เครื่องอื่นแล้ว<br>(ไม่สามารถเปลี่ยนเครื่องได้)','preventDefault','เครื่องนี้ถูกผูกบัญชีอื่นแล้ว\x20(ไม่สามารถลงทะเบียนใหม่ได้)','text-purple-800','bg-gradient-to-r','ยินดีด้วย!\x20ท่านได้รับ','result-footer-text','CheckOUT','425AZpNKp','undefined','lucide','btn-submit','th-TH','1:1070273157855:web:5c8120e1df27e233d8676a','screen-luckydraw','btn-claim-reward','floor','parse','name','target','push','classList','disabled','bg-purple-50/30','resetForm','msg-box-recorded','เกิดข้อผิดพลาด:\x20','toDate','encode','getElementById','btn-loader','now','random','app','text-white','โชคดี...','/public/data/coop_registrations','เกิดข้อผิดพลาดในการตรวจสอบข้อมูล','ลงทะเบียนเข้าและออกสำเร็จ','text-claim-time','btn-text','border-purple-500','from-gray-100','ลงทะเบียนออกสำเร็จ','padStart','tmb_coop','load','success-msg-body','shadow-none','deviceId','cookie','366171MhrHih','429750zEVMxa','error','checked-out','reward-display-badge','coop_device_identifier','userHash','bg-gray-200','<i\x20data-lucide=\x22frown\x22\x20width=\x2260\x22\x20height=\x2260\x22\x20class=\x22mx-auto\x20text-gray-400\x22></i>','icon-check-valid','querySelector','then','draw-state-spinning','input','citizenId','value','16588ovqQdf','เสียใจด้วย','text-transparent','screen-error-device','DEV-','from-yellow-600','text-gray-600','winnersCount','border-yellow-300','success-checkout-time','to-gray-200','rewardClaimTime','1GYUgsO'];_0x4d0c=function(){return _0x11ab16;};return _0x4d0c();}function handleIdInput(_0x692fce){const _0x130049=_0x4b6f5b;let _0xac65ea=_0x692fce[_0x130049(0x191)][_0x130049(0x1c0)]['replace'](/[^0-9]/g,'');if(_0xac65ea[_0x130049(0x219)]>0xd)_0xac65ea=_0xac65ea['slice'](0x0,0xd);let _0x5a5ed7=_0xac65ea;if(_0xac65ea[_0x130049(0x219)]>0x1)_0x5a5ed7=_0xac65ea[_0x130049(0x204)](0x0,0x1)+'-'+_0xac65ea[_0x130049(0x204)](0x1);if(_0xac65ea[_0x130049(0x219)]>0x5)_0x5a5ed7=_0x5a5ed7[_0x130049(0x204)](0x0,0x6)+'-'+_0x5a5ed7[_0x130049(0x204)](0x6);if(_0xac65ea[_0x130049(0x219)]>0xa)_0x5a5ed7=_0x5a5ed7[_0x130049(0x204)](0x0,0xc)+'-'+_0x5a5ed7[_0x130049(0x204)](0xc);if(_0xac65ea['length']>0xc)_0x5a5ed7=_0x5a5ed7['slice'](0x0,0xf)+'-'+_0x5a5ed7[_0x130049(0x204)](0xf);document[_0x130049(0x19b)](_0x130049(0x178))[_0x130049(0x1c0)]=_0x5a5ed7,state[_0x130049(0x178)]=_0x5a5ed7;const _0x39ac43=document[_0x130049(0x19b)](_0x130049(0x1ba)),_0x747c42=document[_0x130049(0x19b)](_0x130049(0x178));_0xac65ea[_0x130049(0x219)]===0xd?(_0x747c42['classList']['add'](_0x130049(0x1a7),_0x130049(0x195)),_0x747c42['classList'][_0x130049(0x208)](_0x130049(0x201)),_0x39ac43[_0x130049(0x193)][_0x130049(0x208)](_0x130049(0x1d9))):(_0x747c42[_0x130049(0x193)]['remove'](_0x130049(0x1a7),_0x130049(0x195)),_0x747c42[_0x130049(0x193)][_0x130049(0x1cf)](_0x130049(0x201)),_0x39ac43['classList']['add']('hidden')),validateForm();}function validateForm(){const _0x24b416=_0x4b6f5b,_0x523591=state['idCard'][_0x24b416(0x1f4)](/[^0-9]/g,'')[_0x24b416(0x219)]===0xd,_0xada9b8=document['getElementById'](_0x24b416(0x189));_0x523591?(_0xada9b8[_0x24b416(0x194)]=![],_0xada9b8[_0x24b416(0x193)][_0x24b416(0x1cf)](_0x24b416(0x226),_0x24b416(0x1a0),_0x24b416(0x1f6),_0x24b416(0x205)),_0xada9b8[_0x24b416(0x193)][_0x24b416(0x208)]('bg-gray-200',_0x24b416(0x206),_0x24b416(0x20a),_0x24b416(0x1ae))):(_0xada9b8[_0x24b416(0x194)]=!![],_0xada9b8['classList'][_0x24b416(0x208)](_0x24b416(0x226),_0x24b416(0x1a0),_0x24b416(0x1f6),_0x24b416(0x205)),_0xada9b8[_0x24b416(0x193)][_0x24b416(0x1cf)](_0x24b416(0x1b8),_0x24b416(0x206),_0x24b416(0x20a),_0x24b416(0x1ae)));}document[_0x4b6f5b(0x19b)](_0x4b6f5b(0x1d4))['addEventListener'](_0x4b6f5b(0x1f8),submitForm),document['getElementById']('idCard')['addEventListener'](_0x4b6f5b(0x1be),handleIdInput),window['addEventListener'](_0x4b6f5b(0x1ac),()=>document[_0x4b6f5b(0x19b)]('idCard')[_0x4b6f5b(0x17c)]());async function initAuth(){const _0x5d6b5b=_0x4b6f5b;typeof __initial_auth_token!==_0x5d6b5b(0x187)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth),setupDataListeners();}onAuthStateChanged(auth,_0x1d8f8d=>state[_0x4b6f5b(0x1d6)]=_0x1d8f8d),initAuth();if(window[_0x4b6f5b(0x188)])lucide[_0x4b6f5b(0x1fc)]();

    </script>
</body>
</html>