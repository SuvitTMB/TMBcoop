<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สหกรณ์ออมทรัพย์พนักงานธนาคารทหารไทย จำกัด</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font (Sarabun) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .hidden { display: none !important; }
        /* Custom Animations */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        
        /* Remove number arrows */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10">

    <!-- Header Section -->
    <div class="bg-gradient-to-r from-blue-700 to-indigo-800 text-white p-6 rounded-b-[2.5rem] shadow-lg mb-8 relative overflow-hidden">
        <div class="absolute top-0 right-0 opacity-10 transform translate-x-10 -translate-y-10">
            <i data-lucide="shield-check" width="150" height="150"></i>
        </div>
        
        <div class="relative z-10 flex flex-col items-center">
            <div class="bg-white/20 p-3 rounded-full mb-3 backdrop-blur-sm">
                <i data-lucide="user" width="32" height="32" class="text-white"></i>
            </div>
            <h1 class="text-xl font-bold text-center">ลงทะเบียนสมาชิก</h1>
            <p class="text-blue-100 text-sm mt-1">สหกรณ์ออมทรัพย์พนักงานธนาคารทหารไทย จำกัด</p>
        </div>
    </div>

    <!-- Main Content Container -->
    <main class="px-2 sm:px-4 max-w-lg mx-auto -mt-10">
        
        <!-- Registration Form Screen -->
        <div id="screen-form" class="bg-white rounded-2xl shadow-xl p-6 border border-slate-100 relative z-20">
            
            <form id="registration-form" class="space-y-6 pt-2">
                <center>
                <!-- Single Input ID Card -->
                <div>
                    <label for="idCard" class="block text-sm font-semibold text-gray-700 mb-2">
                        เลขบัตรประจำตัวประชาชน
                    </label>
                    <div class="relative">
                        <input
                            type="text"
                            id="idCard"
                            placeholder="x-xxxx-xxxxx-xx-x"
                            class="w-full text-xl font-mono tracking-wide p-4 rounded-xl border-2 border-gray-200 bg-white focus:border-blue-400 focus:ring-4 focus:ring-blue-100 outline-none transition-all text-center"
                            inputmode="numeric"
                            maxlength="17"
                        />
                        <i id="icon-check-valid" data-lucide="check-circle" class="hidden absolute right-4 top-1/2 transform -translate-y-1/2 text-green-500 w-6 h-6 animate-fade-in"></i>
                    </div>
                    <p class="text-xs text-gray-400 mt-2 ml-1">กรุณากรอกตัวเลข 13 หลักให้ครบถ้วน</p>
                </div>

                <!-- Info Box -->
                <div class="p-3 bg-blue-50 text-blue-800 rounded-lg text-xs flex gap-2 items-start" style="margin-top:25px; text-align: left;">
                    <i data-lucide="info" class="w-4 h-4 shrink-0 mt-0.5"></i>
                    <span>จำกัดสิทธิ์ 1 เครื่องโทรศัพท์ต่อ 1 หมายเลขบัตรฯ เท่านั้น<br>ผู้ที่จะได้รับรางวัลค่าตอบแทนการประชุม 200 บาทจะต้องลงทะเบียนเข้า และลงทะเบียนออก เท่านั้น</span>
                </div>
                </center>

                <!-- Submit Button -->
                <button
                    type="submit"
                    id="btn-submit"
                    disabled
                    class="w-full py-3 rounded-lg font-semibold text-base shadow-lg transition-all transform active:scale-95 flex items-center justify-center gap-2 bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"
                >
                    <span id="btn-text">ตรวจสอบ / ลงทะเบียน</span>
                    <i id="btn-loader" data-lucide="loader-2" class="hidden animate-spin"></i>
                </button>
            </form>
        </div>

        <!-- Success Screen -->
        <div id="screen-success" class="hidden bg-white rounded-2xl shadow-xl p-8 max-w-sm w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="check-circle" class="text-green-600 w-10 h-10"></i>
            </div>
            
            <h2 class="text-xl font-bold text-gray-800 mb-1" id="success-title">ลงทะเบียนสำเร็จ</h2>
            <p id="success-checkin-datetime" class="text-blue-600 font-medium mb-6 text-xs">--/--/---- --:--</p>
            
            <!-- Agenda Box -->
            <div class="bg-blue-50 border border-blue-100 rounded-xl p-5 mb-6 text-left shadow-sm">
                <h3 class="font-bold text-blue-900 mb-3 text-lg flex items-center gap-2 border-b border-blue-200 pb-2">
                    <i data-lucide="calendar-days" width="20"></i> กำหนดการประชุมสมาชิกฯ
                </h3>
                <ol class="list-decimal pl-5 space-y-2 text-sm text-gray-700">
                    <li>เรื่องแจ้งสมาชิก</li>
                    <li>รายงานผลประกอบการ</li>
                    <li>ประกาศผลการเลือกตั้งประธานฯ</li>
                    <li>ประกาศผลการเลือกตั้งกรรมการฯ</li>
                    <li>ลุ้นรางวัลพิเศษ 50 รางว้ล</li>
                </ol>
            </div>
            
            <button onclick="window.app.resetForm()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition shadow-lg shadow-blue-200">
                กลับสู่หน้าหลัก
            </button>
        </div>

        <!-- Error Screen (Device Limit) -->
        <div id="screen-error-device" class="hidden bg-white rounded-2xl shadow-xl p-8 max-w-sm w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="alert-triangle" class="text-red-600 w-10 h-10"></i>
            </div>
            <h2 class="text-xl font-bold text-red-700 mb-2">ไม่สามารถดำเนินการได้</h2>
            <p id="error-msg-text" class="text-gray-600 mb-6 text-sm">
                คุณไม่สามารถลงทะเบียนใหม่ได้อีก <br/>
                (เครื่องนี้ถูกใช้งานไปแล้ว)
            </p>
            <button onclick="window.location.reload()" class="w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition">
                ปิด
            </button>
        </div>

        <!-- Not Found Screen -->
        <div id="screen-not-found" class="hidden bg-white rounded-2xl shadow-xl p-8 max-w-sm w-full text-center animate-fade-in relative z-20">
            <div class="w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="user-x" class="text-amber-600 w-10 h-10"></i>
            </div>
            <h2 class="text-xl font-bold text-amber-700 mb-2">ไม่มีข้อมูลในระบบ</h2>
            <p class="text-gray-600 mb-6 text-sm">
                ไม่พบเลขบัตรประชาชนนี้ในฐานข้อมูล <br/>
                กรุณาตรวจสอบความถูกต้อง
            </p>
            <button onclick="window.app.resetForm()" class="w-full bg-amber-500 text-white py-3 rounded-xl font-semibold hover:bg-amber-600 transition shadow-lg shadow-amber-200">
                ปิด
            </button>
        </div>

        <!-- Footer -->
        <p class="text-center text-gray-400 text-xs mt-8">
            ระบบลงทะเบียนสมาชิกสหกรณ์ <br/>
            © 2024 สหกรณ์ออมทรัพย์พนักงานธนาคารทหารไทย จำกัด
        </p>
    </main>

    <!-- Firebase and Application Logic -->
    <script type="module">
const _0x37e4cf=_0x5764;function _0x3f94(){const _0x18d03a=['ttb-register','checked-in','เกิดข้อผิดพลาด:\x20','text-gray-400','bg-blue-600','data','cookie','1959774OLGXGT','ลงทะเบียนเมื่อ:\x20','padStart','error','disabled','3700428oGjwqM','getItem','coop_registered_citizen_id','border-gray-200','registration-form','getElementById','294NsRkKZ','value','artifacts/','=([^;]+)','CheckIN','subtle','75928KLEUbQ','Submit\x20Error:','hover:bg-blue-700','coop_device_identifier','14XBJfwc','toLocaleTimeString','default-app-id','/public/data/coop_registrations','hidden','digest','screen-success','createIcons','ตรวจสอบ\x20/\x20ลงทะเบียน','random','classList','add','app','Auth\x20failed','forEach','innerText','9844407pbbdqn','toDate','error-msg-text','CheckOUT','docs','setItem','toLocaleDateString','slice','5450150XRyAoF','screen-not-found',';\x20path=/;\x20max-age=31536000','1:1070273157855:web:5c8120e1df27e233d8676a','target','4iaINSA','match','7534370oipmtV','SHA-256','empty','join','shadow-blue-200','bg-blue-50/30','lucide','submit','1070273157855','ลงทะเบียนสำเร็จ','cursor-not-allowed','รหัสบัตรประชาชนนี้\x20ผูกกับโทรศัพท์เครื่องอื่นแล้ว<br>(ไม่สามารถเปลี่ยนเครื่องได้)','90734iGnPdK','length','DEV-','text-white','btn-loader','undefined','tmb_coop','เครื่องนี้ถูกใช้งานลงทะเบียนบัตรประชาชนอื่นไปแล้ว\x20(จำกัด\x201\x20เครื่อง\x20/\x201\x20ท่าน)','border-blue-500','icon-check-valid','btn-text','addEventListener','G-9DJLWJ5LQ1','status','map','encode','success-title','https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','success-checkin-datetime','screen-error-device','innerHTML','กำลังตรวจสอบ...','log','bg-white','screen-form','idCard','remove','focus','bg-gray-200','deviceId','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','th-TH','btn-submit','shadow-none','Checking\x20Device:','toString'];_0x3f94=function(){return _0x18d03a;};return _0x3f94();}(function(_0x17e9aa,_0x396f29){const _0x30cda2=_0x5764,_0x2999f7=_0x17e9aa();while(!![]){try{const _0x5283d3=-parseInt(_0x30cda2(0x1c4))/0x1*(parseInt(_0x30cda2(0x1ef))/0x2)+-parseInt(_0x30cda2(0x21f))/0x3*(-parseInt(_0x30cda2(0x1e1))/0x4)+-parseInt(_0x30cda2(0x1dc))/0x5+-parseInt(_0x30cda2(0x21a))/0x6+-parseInt(_0x30cda2(0x1ba))/0x7*(parseInt(_0x30cda2(0x1c0))/0x8)+parseInt(_0x30cda2(0x1d4))/0x9+parseInt(_0x30cda2(0x1e3))/0xa;if(_0x5283d3===_0x396f29)break;else _0x2999f7['push'](_0x2999f7['shift']());}catch(_0x5c9e38){_0x2999f7['push'](_0x2999f7['shift']());}}}(_0x3f94,0x99e2d));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,addDoc,updateDoc,doc,serverTimestamp,query,where,getDocs}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';const TARGET_COLLECTION_NAME=_0x37e4cf(0x1f5),isSandboxEnv=typeof __firebase_config!=='undefined';let firebaseConfig,finalCollectionPath;if(isSandboxEnv){firebaseConfig=JSON['parse'](__firebase_config);const appId=typeof __app_id!==_0x37e4cf(0x1f4)?__app_id:_0x37e4cf(0x1c6);finalCollectionPath=_0x37e4cf(0x1bc)+appId+_0x37e4cf(0x1c7);}else firebaseConfig={'apiKey':_0x37e4cf(0x20d),'authDomain':'ttb-register.firebaseapp.com','databaseURL':_0x37e4cf(0x200),'projectId':_0x37e4cf(0x213),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x37e4cf(0x1eb),'appId':_0x37e4cf(0x1df),'measurementId':_0x37e4cf(0x1fb)},finalCollectionPath=TARGET_COLLECTION_NAME;const state={'user':null,'idCard':''},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app);async function sha256(_0x4b57e6){const _0x1fe38f=_0x37e4cf,_0x155d88=new TextEncoder()[_0x1fe38f(0x1fe)](_0x4b57e6),_0x184f24=await crypto[_0x1fe38f(0x1bf)][_0x1fe38f(0x1c9)](_0x1fe38f(0x1e4),_0x155d88),_0x42752d=Array['from'](new Uint8Array(_0x184f24)),_0x5af7c4=_0x42752d[_0x1fe38f(0x1fd)](_0x28567f=>_0x28567f['toString'](0x10)[_0x1fe38f(0x21c)](0x2,'0'))[_0x1fe38f(0x1e6)]('');return _0x5af7c4;}function getDeviceId(){const _0xd6bc6e=_0x37e4cf,_0x513123=_0xd6bc6e(0x1c3);let _0xb9f056=localStorage[_0xd6bc6e(0x220)](_0x513123);if(!_0xb9f056){const _0xce1436=document[_0xd6bc6e(0x219)][_0xd6bc6e(0x1e2)](new RegExp('(^|\x20)'+_0x513123+_0xd6bc6e(0x1bd)));_0xce1436&&(_0xb9f056=_0xce1436[0x2],localStorage[_0xd6bc6e(0x1d9)](_0x513123,_0xb9f056));}return!_0xb9f056?(_0xb9f056=_0xd6bc6e(0x1f1)+Date['now']()[_0xd6bc6e(0x212)](0x24)+Math[_0xd6bc6e(0x1cd)]()['toString'](0x24)['substr'](0x2,0x9),localStorage[_0xd6bc6e(0x1d9)](_0x513123,_0xb9f056),document[_0xd6bc6e(0x219)]=_0x513123+'='+_0xb9f056+_0xd6bc6e(0x1de)):document[_0xd6bc6e(0x219)]=_0x513123+'='+_0xb9f056+';\x20path=/;\x20max-age=31536000',_0xb9f056;}function setLocalRegistration(_0x1820ce){const _0x4be4b7=_0x37e4cf;localStorage[_0x4be4b7(0x1d9)]('coop_registered_citizen_id',_0x1820ce);}function getLocalRegistration(){const _0x27cd98=_0x37e4cf;return localStorage[_0x27cd98(0x220)](_0x27cd98(0x221));}window[_0x37e4cf(0x1d0)]={'resetForm':()=>{const _0x5a3229=_0x37e4cf,_0x471e57=['screen-success','screen-error-device',_0x5a3229(0x1dd)];_0x471e57[_0x5a3229(0x1d2)](_0x251895=>document[_0x5a3229(0x1b9)](_0x251895)['classList'][_0x5a3229(0x1cf)](_0x5a3229(0x1c8))),document[_0x5a3229(0x1b9)]('screen-form')[_0x5a3229(0x1ce)]['remove'](_0x5a3229(0x1c8));const _0x580215=document['getElementById']('idCard');_0x580215['value']='',state[_0x5a3229(0x208)]='';const _0x40be2a=document[_0x5a3229(0x1b9)](_0x5a3229(0x20f)),_0x4fb848=document['getElementById'](_0x5a3229(0x1f9)),_0x319696=document[_0x5a3229(0x1b9)](_0x5a3229(0x1f3));_0x4fb848[_0x5a3229(0x1d3)]=_0x5a3229(0x1cc),_0x319696[_0x5a3229(0x1ce)][_0x5a3229(0x1cf)](_0x5a3229(0x1c8)),_0x40be2a['disabled']=!![],_0x40be2a[_0x5a3229(0x1ce)][_0x5a3229(0x1cf)](_0x5a3229(0x20b),_0x5a3229(0x216),_0x5a3229(0x1ed),_0x5a3229(0x210)),_0x40be2a[_0x5a3229(0x1ce)][_0x5a3229(0x209)](_0x5a3229(0x217),_0x5a3229(0x1f2),_0x5a3229(0x1c2),_0x5a3229(0x1e7));const _0x1a3996=document[_0x5a3229(0x1b9)](_0x5a3229(0x1f8));_0x1a3996[_0x5a3229(0x1ce)][_0x5a3229(0x1cf)](_0x5a3229(0x1c8)),_0x580215[_0x5a3229(0x1ce)][_0x5a3229(0x209)](_0x5a3229(0x1f7),_0x5a3229(0x1e8)),_0x580215['classList'][_0x5a3229(0x1cf)](_0x5a3229(0x1b7),_0x5a3229(0x206)),_0x580215[_0x5a3229(0x20a)]();}};function _0x5764(_0x285e19,_0x61b91b){_0x285e19=_0x285e19-0x1b7;const _0x3f94e5=_0x3f94();let _0x5764d1=_0x3f94e5[_0x285e19];return _0x5764d1;}async function initAuth(){const _0x31ca79=_0x37e4cf;try{typeof __initial_auth_token!==_0x31ca79(0x1f4)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);}catch(_0x4b10de){console[_0x31ca79(0x21d)](_0x31ca79(0x1d1),_0x4b10de);}}onAuthStateChanged(auth,_0x42f1e3=>{state['user']=_0x42f1e3;});function handleIdInput(_0x3e88ce){const _0x2efcc6=_0x37e4cf;let _0x4b289f=_0x3e88ce[_0x2efcc6(0x1e0)][_0x2efcc6(0x1bb)]['replace'](/[^0-9]/g,'');if(_0x4b289f[_0x2efcc6(0x1f0)]>0xd)_0x4b289f=_0x4b289f[_0x2efcc6(0x1db)](0x0,0xd);let _0x363357=_0x4b289f;if(_0x4b289f[_0x2efcc6(0x1f0)]>0x1)_0x363357=_0x4b289f[_0x2efcc6(0x1db)](0x0,0x1)+'-'+_0x4b289f[_0x2efcc6(0x1db)](0x1);if(_0x4b289f[_0x2efcc6(0x1f0)]>0x5)_0x363357=_0x363357['slice'](0x0,0x6)+'-'+_0x363357[_0x2efcc6(0x1db)](0x6);if(_0x4b289f[_0x2efcc6(0x1f0)]>0xa)_0x363357=_0x363357[_0x2efcc6(0x1db)](0x0,0xc)+'-'+_0x363357['slice'](0xc);if(_0x4b289f[_0x2efcc6(0x1f0)]>0xc)_0x363357=_0x363357['slice'](0x0,0xf)+'-'+_0x363357['slice'](0xf);state[_0x2efcc6(0x208)]=_0x363357,document[_0x2efcc6(0x1b9)](_0x2efcc6(0x208))[_0x2efcc6(0x1bb)]=_0x363357;const _0x17a329=document[_0x2efcc6(0x1b9)](_0x2efcc6(0x1f8)),_0x2417ee=document[_0x2efcc6(0x1b9)]('idCard');_0x4b289f[_0x2efcc6(0x1f0)]===0xd?(_0x2417ee['classList'][_0x2efcc6(0x1cf)](_0x2efcc6(0x1f7),_0x2efcc6(0x1e8)),_0x2417ee[_0x2efcc6(0x1ce)][_0x2efcc6(0x209)](_0x2efcc6(0x1b7),'bg-white'),_0x17a329[_0x2efcc6(0x1ce)][_0x2efcc6(0x209)](_0x2efcc6(0x1c8))):(_0x2417ee[_0x2efcc6(0x1ce)][_0x2efcc6(0x209)]('border-blue-500',_0x2efcc6(0x1e8)),_0x2417ee['classList'][_0x2efcc6(0x1cf)](_0x2efcc6(0x1b7),_0x2efcc6(0x206)),_0x17a329['classList'][_0x2efcc6(0x1cf)]('hidden')),validateForm();}function validateForm(){const _0x16529a=_0x37e4cf,_0x115ff5=state['idCard']['replace'](/-/g,''),_0x5ba0cc=_0x115ff5['length']===0xd,_0x52b8ba=document['getElementById']('btn-submit');_0x5ba0cc?(_0x52b8ba[_0x16529a(0x21e)]=![],_0x52b8ba[_0x16529a(0x1ce)]['remove'](_0x16529a(0x20b),_0x16529a(0x216),_0x16529a(0x1ed),_0x16529a(0x210)),_0x52b8ba[_0x16529a(0x1ce)][_0x16529a(0x1cf)](_0x16529a(0x217),_0x16529a(0x1f2),_0x16529a(0x1c2),'shadow-blue-200')):(_0x52b8ba[_0x16529a(0x21e)]=!![],_0x52b8ba['classList'][_0x16529a(0x1cf)](_0x16529a(0x20b),_0x16529a(0x216),_0x16529a(0x1ed),'shadow-none'),_0x52b8ba[_0x16529a(0x1ce)][_0x16529a(0x209)](_0x16529a(0x217),_0x16529a(0x1f2),_0x16529a(0x1c2),'shadow-blue-200'));}async function submitForm(_0x2e5d52){const _0x44c693=_0x37e4cf;_0x2e5d52['preventDefault']();if(!state['user'])return;const _0x24e522=document['getElementById'](_0x44c693(0x20f)),_0x516d2c=document[_0x44c693(0x1b9)](_0x44c693(0x1f9)),_0xc313a7=document[_0x44c693(0x1b9)](_0x44c693(0x1f3));_0x24e522[_0x44c693(0x21e)]=!![],_0x516d2c[_0x44c693(0x1d3)]=_0x44c693(0x204),_0xc313a7[_0x44c693(0x1ce)][_0x44c693(0x209)]('hidden');try{const _0x1ee3b8=getDeviceId(),_0x12ac7f=state[_0x44c693(0x208)]['replace'](/-/g,''),_0x35b4cb=await sha256(_0x12ac7f);console[_0x44c693(0x205)](_0x44c693(0x211),_0x1ee3b8),console[_0x44c693(0x205)]('Checking\x20ID\x20Hash:',_0x35b4cb);const _0x4ef0ef=getLocalRegistration();if(_0x4ef0ef&&_0x4ef0ef!==_0x35b4cb){document['getElementById'](_0x44c693(0x1d6))[_0x44c693(0x1d3)]=_0x44c693(0x1f6),document[_0x44c693(0x1b9)](_0x44c693(0x207))['classList']['add'](_0x44c693(0x1c8)),document[_0x44c693(0x1b9)](_0x44c693(0x202))[_0x44c693(0x1ce)][_0x44c693(0x209)](_0x44c693(0x1c8));return;}const _0xb0dc16=query(collection(db,finalCollectionPath),where('citizenId','==',_0x35b4cb)),_0x477048=await getDocs(_0xb0dc16);if(!_0x477048[_0x44c693(0x1e5)]){const _0x4f665e=_0x477048[_0x44c693(0x1d8)][0x0],_0x2ffac6=_0x4f665e[_0x44c693(0x218)]();if(_0x2ffac6[_0x44c693(0x20c)]&&_0x2ffac6[_0x44c693(0x20c)]!==_0x1ee3b8){document[_0x44c693(0x1b9)]('error-msg-text')[_0x44c693(0x203)]=_0x44c693(0x1ee),document[_0x44c693(0x1b9)](_0x44c693(0x207))[_0x44c693(0x1ce)]['add']('hidden'),document[_0x44c693(0x1b9)](_0x44c693(0x202))[_0x44c693(0x1ce)][_0x44c693(0x209)](_0x44c693(0x1c8));return;}const _0x4e74c4={};let _0x2e712a=![];!_0x2ffac6['deviceId']&&(_0x4e74c4[_0x44c693(0x20c)]=_0x1ee3b8,_0x2e712a=!![]);let _0x4e151b='',_0x1fe2ef=![];const _0x179072=!_0x2ffac6[_0x44c693(0x1be)];if(_0x179072){_0x4e74c4[_0x44c693(0x1be)]=serverTimestamp(),_0x1fe2ef=!![],_0x2e712a=!![];const _0x2eee97=new Date();_0x4e151b=_0x2eee97[_0x44c693(0x1da)](_0x44c693(0x20e))+'\x20'+_0x2eee97[_0x44c693(0x1c5)](_0x44c693(0x20e));}else{const _0x5319d9=_0x2ffac6['CheckIN']['toDate']?_0x2ffac6[_0x44c693(0x1be)][_0x44c693(0x1d5)]():new Date(_0x2ffac6[_0x44c693(0x1be)]);_0x4e151b=_0x5319d9[_0x44c693(0x1da)](_0x44c693(0x20e))+'\x20'+_0x5319d9[_0x44c693(0x1c5)](_0x44c693(0x20e));}const _0x379436=!_0x179072||_0x4e74c4[_0x44c693(0x1be)],_0x527d61=_0x2ffac6[_0x44c693(0x1d7)];if(_0x379436&&_0x527d61)_0x2ffac6[_0x44c693(0x1fc)]!==_0x44c693(0x1ec)&&(_0x4e74c4['status']=_0x44c693(0x1ec),_0x2e712a=!![]);else _0x379436&&!_0x527d61&&(_0x179072&&(_0x4e74c4[_0x44c693(0x1fc)]=_0x44c693(0x214),_0x2e712a=!![]));_0x2e712a&&await updateDoc(doc(db,finalCollectionPath,_0x4f665e['id']),_0x4e74c4),setLocalRegistration(_0x35b4cb),document[_0x44c693(0x1b9)](_0x44c693(0x1ff))[_0x44c693(0x1d3)]=_0x1fe2ef?_0x44c693(0x1ec):'ท่านได้ลงทะเบียนไปแล้ว',document['getElementById'](_0x44c693(0x201))[_0x44c693(0x1d3)]=_0x44c693(0x21b)+_0x4e151b,document['getElementById'](_0x44c693(0x207))[_0x44c693(0x1ce)][_0x44c693(0x1cf)](_0x44c693(0x1c8)),document[_0x44c693(0x1b9)]('screen-success')[_0x44c693(0x1ce)][_0x44c693(0x209)](_0x44c693(0x1c8));}else{const _0x1f9990=query(collection(db,finalCollectionPath),where(_0x44c693(0x20c),'==',_0x1ee3b8)),_0x4a0bc8=await getDocs(_0x1f9990);if(!_0x4a0bc8[_0x44c693(0x1e5)])document[_0x44c693(0x1b9)](_0x44c693(0x1d6))[_0x44c693(0x1d3)]='เครื่องนี้ถูกผูกบัญชีอื่นแล้ว\x20(ไม่สามารถลงทะเบียนใหม่ได้)',document['getElementById']('screen-form')[_0x44c693(0x1ce)][_0x44c693(0x1cf)](_0x44c693(0x1c8)),document[_0x44c693(0x1b9)](_0x44c693(0x202))[_0x44c693(0x1ce)][_0x44c693(0x209)](_0x44c693(0x1c8));else{await addDoc(collection(db,finalCollectionPath),{'citizenId':_0x35b4cb,'deviceId':_0x1ee3b8,'CheckIN':serverTimestamp(),'status':_0x44c693(0x214)}),setLocalRegistration(_0x35b4cb);const _0x156236=new Date(),_0x288281=_0x156236[_0x44c693(0x1da)](_0x44c693(0x20e))+'\x20'+_0x156236[_0x44c693(0x1c5)](_0x44c693(0x20e));document[_0x44c693(0x1b9)]('success-title')[_0x44c693(0x1d3)]=_0x44c693(0x1ec),document[_0x44c693(0x1b9)](_0x44c693(0x201))[_0x44c693(0x1d3)]=_0x44c693(0x21b)+_0x288281,document[_0x44c693(0x1b9)](_0x44c693(0x207))[_0x44c693(0x1ce)][_0x44c693(0x1cf)](_0x44c693(0x1c8)),document[_0x44c693(0x1b9)](_0x44c693(0x1ca))[_0x44c693(0x1ce)][_0x44c693(0x209)](_0x44c693(0x1c8));}}}catch(_0x226564){console[_0x44c693(0x21d)](_0x44c693(0x1c1),_0x226564),alert(_0x44c693(0x215)+_0x226564['message']);}finally{_0x24e522[_0x44c693(0x21e)]=![],_0x516d2c[_0x44c693(0x1d3)]=_0x44c693(0x1cc),_0xc313a7[_0x44c693(0x1ce)][_0x44c693(0x1cf)]('hidden'),validateForm();}}document[_0x37e4cf(0x1b9)](_0x37e4cf(0x1b8))['addEventListener'](_0x37e4cf(0x1ea),submitForm),document[_0x37e4cf(0x1b9)]('idCard')['addEventListener']('input',handleIdInput),window[_0x37e4cf(0x1fa)]('load',()=>{const _0x36b85f=_0x37e4cf;document[_0x36b85f(0x1b9)]('idCard')['focus']();}),initAuth();if(window[_0x37e4cf(0x1e9)])lucide[_0x37e4cf(0x1cb)]();

    </script>
</body>
</html>